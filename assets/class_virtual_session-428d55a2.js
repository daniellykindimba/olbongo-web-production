import{r as o,j as e,aT as n,a1 as E,cn as w,aW as k,aP as g,S as q,av as F,c as Q,a8 as X,aR as $,aU as p,_ as s,aZ as D,cm as I,g as h}from"./index-05772eb7.js";import{d as ee,C as te}from"./ckeditor-2288a1dc.js";import{D as re}from"./index-67b86639.js";import{I as ie}from"./index-c1d7a4fa.js";import{E as ae}from"./edit_class_virtual_form-8f6e61d9.js";import{c as S}from"./data_objects-e0ab4116.js";import{L as v}from"./index-7c727271.js";import{C as se}from"./index-7b68fa8b.js";import{S as oe}from"./Skeleton-4d93f06a.js";import{A as ne}from"./index-26ba155a.js";import{f as M}from"./pager-bc6e8668.js";import{M as le}from"./index-013e811c.js";import{S as de}from"./SearchOutlined-0e97f4a9.js";import{L as ue}from"./LinkOutlined-eb4f10b8.js";import{D as me}from"./DownloadOutlined-581febce.js";import{D as ce}from"./DeleteOutlined-9fe75e98.js";import{E as pe}from"./EditOutlined-2e749454.js";import{M as he}from"./MoreOutlined-acda24b1.js";import{E as ge}from"./ExclamationCircleOutlined-0a20a855.js";import"./index-6d2464e0.js";import"./index-cedb4c3d.js";import"./localeData-ea0dd020.js";import"./SwapRightOutlined-c4e52b1e.js";import"./SinglePicker-9fafe884.js";import"./UpOutlined-7082c42f.js";import"./InputNumber-677354a2.js";import"./ckeditor-32df5e5c.js";import"./data_objects-fdecb024.js";import"./index-88e92a4a.js";import"./DotChartOutlined-f39c986e.js";import"./index-54251132.js";import"./index-2dc20dbd.js";import"./defineProperty-4d9f4f1d.js";import"./useNotification-fddf6c6b.js";import"./DialogWrap-c515d700.js";import"./useMutateObserver-3cfc8689.js";import"./index-fa9d428a.js";import"./Image-256411dd.js";import"./Upload-890ff9ff.js";import"./Rate-fbbf0fc9.js";import"./index-849a35e1.js";import"./index-ad8bef66.js";import"./RollbackOutlined-49df8c34.js";import"./FolderOpenOutlined-d14d88e1.js";import"./Alert-18b496d0.js";import"./index-c1ab6d96.js";import"./EditOutlined-401a1613.js";import"./transButton-35d2d6df.js";import"./index-0d3a98f8.js";import"./index-a29a8baa.js";import"./fade-6bc080d2.js";import"./DeleteOutlined-25685737.js";import"./DownloadOutlined-6cd35f11.js";import"./UploadOutlined-e863922c.js";import"./FileImageOutlined-b48637a4.js";import"./index-50c8e22a.js";import"./ZoomOutOutlined-4d40b3b9.js";import"./index-fe2fbeda.js";import"./darasa_card-54e03f3d.js";import"./remove_html_tags-be9c976e.js";import"./ShareAltOutlined-19ee08b3.js";import"./InfoCircleOutlined-a2af6d4a.js";import"./PlusCircleOutlined-b2635e81.js";import"./SmileOutlined-fb91edb3.js";import"./index-1461aa9c.js";import"./ActionButton-e20fca38.js";import"./SettingOutlined-a02c5bfc.js";import"./CloseOutlined-52c809f4.js";import"./CheckOutlined-9c8d4839.js";import"./index-65e4b638.js";import"./text_truncate-315d9efa.js";import"./index-ab185c8e.js";import"./book_payment_form-d2b9d220.js";import"./index-951488b4.js";import"./InfoCircleFilled-219488c9.js";import"./InfoCircleFilled-baaa675e.js";import"./index-f20852d4.js";import"./PrinterOutlined-7a80aae4.js";import"./index.es-c1ef3861.js";const{Option:fe}=q,V=[{value:"",label:"Select Duration Type"},{value:"minutes",label:"Minutes"},{value:"hours",label:"Hours"},{value:"days",label:"Days"}],xe=l=>{const[d,u]=o.useState("");return e.jsx(e.Fragment,{children:e.jsxs(n,{layout:"vertical",form:l.form,onFinish:i=>{i.description=d,l.onFinish(i),u("")},requiredMark:!1,children:[e.jsx(n.Item,{name:"name",label:"Name",rules:[{required:!0,type:"string",message:"Please input name"}],children:e.jsx(E,{size:"large",placeholder:"Enter Name ..."})}),e.jsx(n.Item,{name:"startDate",label:"start Date",rules:[{required:!0,type:"date",message:"Please select date"}],children:e.jsx(re,{showTime:{format:"HH:mm"},disabledDate:i=>{const m=w().format("YYYY-MM-DD");return i&&i<w(m,"YYYY-MM-DD")},style:{width:"100%"},popupStyle:{zIndex:9999}})}),e.jsxs(k,{children:[e.jsx(g,{span:12,children:e.jsx(n.Item,{name:"duration",label:"Duration",style:{width:"100%"},rules:[{required:!0,type:"integer",message:"Enter Duration"}],children:e.jsx(ie,{min:1,defaultValue:1,style:{width:"100%"},size:"large"})})}),e.jsx(g,{span:12,children:e.jsx(n.Item,{name:"durationType",label:"Duration Type",style:{width:"100%"},rules:[{required:!0,type:"string",message:"Please select duration type"}],children:e.jsx(q,{defaultValue:V[0].value,size:"large",style:{width:"100%"},dropdownStyle:{zIndex:9999},children:V.map(i=>e.jsx(fe,{children:i.label},i.value))})})})]}),e.jsx("h3",{children:"Description"}),e.jsx(ee.CKEditor,{editor:te,data:d,onReady:i=>{i.editing.view.change(m=>{m.setStyle("min-height","100px",i.editing.view.document.getRoot())})},onChange:(i,m)=>{const f=m.getData();u(f)},config:{toolbar:{items:["bold","italic","strikethrough","underline","code","subscript","superscript","removeFormat","|","bulletedList","numberedList","todoList","|","outdent","indent","|","-","fontSize","fontFamily","fontColor","fontBackgroundColor","highlight","|","alignment","|","EmojiPanel"],shouldNotGroupWhenFull:!0},fontFamily:{options:["default","Arial, Helvetica, sans-serif","Courier New, Courier, monospace","Georgia, serif","Lucida Sans Unicode, Lucida Grande, sans-serif","Tahoma, Geneva, sans-serif","Times New Roman, Times, serif","Trebuchet MS, Helvetica, sans-serif","Verdana, Geneva, sans-serif"],supportAllValues:!0},fontSize:{options:[10,12,14,"default",18,20,22],supportAllValues:!0}}}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(F,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},Jt=l=>{const[d,u]=o.useState([]),[i,m]=o.useState(),[f,T]=o.useState(!0),[b,L]=o.useState(1),[z]=n.useForm(),[ye,N]=o.useState(0),[je,P]=o.useState(0),[H,O]=o.useState(!0),{push:C}=Q(),[Y,x]=o.useState(!1),[A]=n.useForm(),[R,y]=o.useState(!1),[B]=n.useForm(),G=t=>{m(t),y(!0)},J=()=>{x(!0)},_=async t=>{const{data:r}=await h.custom({url:"",method:"post",meta:{operation:"editVirtualClass",variables:{id:{value:t.id,type:"Int",required:!0},name:{value:t.name,type:"String",required:!0},description:{value:t.description,type:"String",required:!0},duration:{value:t.duration,type:"Int",required:!0},durationType:{value:t.durationType.toUpperCase(),type:"String",required:!0},startDate:{value:t.startDate,type:"DateTime",required:!0},isPublic:{value:!0,type:"Boolean",required:!0}},fields:["success","message",{virtual:S}]}}).catch(()=>(s.error("Error editing class"),{data:null})).then(a=>a);r&&(r.success?(s.success(r.message),u(d.map(a=>a.id===r.virtual.id?r.virtual:a)),y(!1)):s.error(r.message))},U=async t=>{const{data:r}=await h.custom({url:"",method:"post",meta:{operation:"createVirtualClass",variables:{darasaId:{value:parseInt(l.id?l.id.toString():"0"),type:"Int",required:!1},name:{value:t.name,type:"String",required:!0},description:{value:t.description,type:"String",required:!0},duration:{value:t.duration,type:"Int",required:!0},durationType:{value:t.durationType.toUpperCase(),type:"String",required:!0},startDate:{value:t.startDate,type:"DateTime",required:!0},isPublic:{value:!0,type:"Boolean",required:!0}},fields:["success","message",{virtual:S}]}}).catch(()=>(s.error("Error creating virtual class"),{data:null})).then(a=>a);r&&(r.success?(s.success(r.message),x(!1),u([r.virtual,...d])):s.error(r.message))},j=async(t,r="",a=!1)=>{const{data:c}=await h.custom({url:"",method:"get",meta:{operation:"darasaVirtuals",variables:{page:{value:t,type:"Int",required:!0},key:{value:r,type:"String",required:!1},id:{value:parseInt(l.id===void 0?"0":l.id.toString()),type:"Int",required:!0}},fields:["total","page","pages","hasNext","hasPrev",{results:S}]}}).catch(()=>(s.error("Error fetching virtual classes"),{data:null})).then(Z=>Z);c&&(P(c.total),N(c.pages),L(c.page),O(c.hasNext),u(a?c.results:[...d,...c.results])),T(!1)},W=async t=>{const{data:r}=await h.custom({url:"",method:"post",meta:{operation:"deleteVirtualClass",variables:{id:{value:t,type:"Int",required:!0}},fields:["success","message"]}}).catch(()=>(s.error("Error deleting virtual class"),{data:null})).then(a=>a);r&&(r.success?(s.success(r.message),u(d.filter(a=>a.id!==t))):s.error(r.message))},K=t=>{le.confirm({title:"Deleting Virtual Class Session",icon:e.jsx(ge,{}),content:"Are you sure ...",okText:"Delete",cancelText:"Cancel",onOk:()=>W(t)})};return o.useEffect(()=>{j(b)},[]),e.jsxs(e.Fragment,{children:[e.jsxs(k,{children:[e.jsx(g,{span:12,children:e.jsx(n,{layout:"vertical",form:z,onFinish:t=>j(0,t.key,!0),children:e.jsx(n.Item,{name:"key",children:e.jsx(E,{size:"large",placeholder:"Search Virtual Sessions...",prefix:e.jsx(de,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(g,{span:12,style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(F,{icon:e.jsx(ue,{}),onClick:J,disabled:!l.canManage,size:"large",children:"Create Virtual Session"})})]}),e.jsx("div",{id:"scrollableDiv",style:{height:"74vh",overflow:"auto"},children:e.jsxs(X,{spinning:f,children:[e.jsx(v,{itemLayout:"horizontal",dataSource:d,renderItem:t=>e.jsx("div",{style:{background:"white",marginBottom:5,paddingLeft:10,paddingTop:10},children:e.jsx(se,{children:e.jsx(v.Item,{actions:[e.jsx($,{trigger:["click"],overlay:e.jsxs(p,{children:[e.jsx(p.Item,{icon:e.jsx(me,{}),disabled:!t.canJoin,onClick:()=>C("/oclass/virtual/class/session/"+t.id+"/"+t.token),children:e.jsx("a",{children:"Join"})}),t.canDelete?e.jsx(p.Item,{disabled:!t.canDelete,icon:e.jsx(ce,{}),onClick:()=>K(t.id),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Delete"})}):e.jsx(e.Fragment,{}),t.canEdit&&e.jsx(p.Item,{icon:e.jsx(pe,{}),disabled:!t.canEdit,onClick:()=>G(t),children:e.jsx("a",{children:"Edit"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:r=>r.preventDefault(),children:e.jsx(he,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})],children:e.jsx(oe,{avatar:!0,title:!1,loading:!1,active:!0,children:e.jsx(v.Item.Meta,{avatar:e.jsx(ne,{}),title:e.jsx("a",{onClick:()=>t.canJoin?C("/oclass/virtual/class/session/"+t.id+"/"+t.token):s("You can't join this session"),children:t.name}),description:e.jsxs(e.Fragment,{children:[e.jsx("div",{dangerouslySetInnerHTML:{__html:t.description}}),e.jsxs("p",{children:[e.jsxs(D,{color:"green",children:["Start At:"," ",M(new Date(t.startDate),"MMMM do, yyyy H:mma")]}),e.jsxs(D,{color:"green",children:["End In:"," ",M(new Date(t.endDate),"MMMM do, yyyy H:mma")]}),t.canJoin?e.jsx(e.Fragment,{}):e.jsx(e.Fragment,{children:e.jsx(D,{color:"red",children:"Not Joinable"})})]})]})})})})})},"class-virtual-session-item-container-"+t.id)}),H&&e.jsx("div",{style:{textAlign:"center",marginTop:12},children:e.jsx("button",{onClick:()=>{j(b+1)},children:"Load More"})})]})}),e.jsx(I,{title:"Creating Class Virtual Session",open:Y,onClose:t=>x(t),width:"50vw",children:e.jsx(xe,{form:A,onFinish:U})}),e.jsx(I,{title:"Editting "+(i==null?void 0:i.name),width:"40vw",open:R,onClose:t=>y(t),children:e.jsx(ae,{form:B,darasa:i,onFinish:_})})]})};export{Jt as ClassVirtualSessions};
