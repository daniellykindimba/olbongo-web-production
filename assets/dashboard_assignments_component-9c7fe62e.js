import{r as n,aT as p,c as $,j as e,aW as k,aP as v,a1 as ee,a8 as te,aR as se,aU as g,aZ as u,af as A,av as ie,cm as x,g as S,hJ as c,cv as ne}from"./index-e44e1a6d.js";import{E as re,A as ae,a as oe,b as le}from"./edit_assignment-26654d98.js";import{L as y}from"./index-ed0e0783.js";import{M as de}from"./index-dc3323d2.js";import{S as ce}from"./SearchOutlined-b1a83866.js";import{F as O}from"./FolderViewOutlined-b6ed47a9.js";import{E as me}from"./EditOutlined-d161fd6b.js";import{D as ue}from"./DeleteOutlined-8a43a500.js";import{M as he}from"./MoreOutlined-f640145b.js";import{B as pe}from"./BookOutlined-dc41c0a0.js";import{U as ge}from"./UploadOutlined-541f1152.js";import{E as xe}from"./ExclamationCircleOutlined-503ce594.js";import{T as R}from"./index-24834ec9.js";import"./data_objects-7c205354.js";import"./data_objects-d2efaecb.js";import"./PlusSquareFilled-f76120ab.js";import"./index-85059cf6.js";import"./index-7a457e26.js";import"./index-92f630b4.js";import"./InfoCircleFilled-6c32ebc6.js";import"./InfoCircleFilled-baaa675e.js";import"./index-d944ffc2.js";import"./Upload-a6a83d70.js";import"./fade-c9034687.js";import"./DeleteOutlined-25685737.js";import"./DownloadOutlined-6cd35f11.js";import"./DownloadOutlined-ffbc588f.js";import"./InboxOutlined-f18efb6b.js";import"./ckeditor-d04642d8.js";import"./ckeditor-d31eb44a.js";import"./index-7ac37ba9.js";import"./index-680dd58e.js";import"./index-0a655ddb.js";import"./localeData-5d4238c7.js";import"./SwapRightOutlined-c4e52b1e.js";import"./SinglePicker-657c4a86.js";import"./ActionButton-330c6123.js";import"./DialogWrap-f973f288.js";import"./index-406e87b5.js";import"./EditOutlined-401a1613.js";const W=m=>{const[o,a]=n.useState([]),[s,d]=n.useState(),[h,L]=n.useState(!0),[M,V]=n.useState(1);n.useState(25);const[q]=p.useForm(),[je,N]=n.useState(0),[fe,z]=n.useState(0),[B,_]=n.useState(!0);$(),n.useState(!1);const[P,C]=n.useState(!1),[U,j]=n.useState(!1),[H,f]=n.useState(!1),[Y,w]=n.useState(!1);p.useForm();const[D]=p.useForm(),Z=t=>{d(t),w(!0)},J=t=>{a(o.map(i=>i.id===t.id?t:i))},F=t=>{d(t),f(!0)},E=t=>{d(t),C(!0)},K=t=>{d(t),j(!0)},b=async(t,i="",r=!1)=>{const{data:l}=await S.custom({url:"",method:"get",meta:{operation:"myAssignments",variables:{page:{value:t,type:"Int",required:!0},key:{value:i,type:"String",required:!1},overdue:{value:m.overdue?m.overdue:!1,type:"Boolean",required:!0}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","title","description","totalAttachments","deadline","onlineSubmission","submitted","canSubmit","created","updated","isActive","canDelete","canEdit","canManage","canUploadAttachment","attachmentZippedFolderPath",{user:["id","firstName","middleName","lastName","fullName","pic"]},{darasa:["id"]}]}]}}).catch(I=>(c.error("Failed to fetch assignments"),{data:null})).then(I=>I);l&&(z(l.total),N(l.pages),V(l.page),_(l.hasNext),a(o.concat(l.results)),a(t===1?[...l.results]:[...o,...l.results])),L(!1)},G=async t=>{const{data:i}=await S.custom({url:"",method:"post",meta:{operation:"deleteDarasaAssignment",variables:{id:{value:t,type:"Int",required:!0}},fields:["success","message"]}}).catch(r=>(c.error("Failed to delete assignment"),{data:null})).then(r=>r);i&&(i.success?(c.success(i.message),a(o.filter(r=>r.id!==t))):c.error(i.message))},Q=async t=>{const{data:i}=await S.custom({url:"",method:"post",meta:{operation:"updateDarasaAssignment",variables:{id:{value:s===void 0?0:s.id,type:"Int",required:!0},title:{value:t.title,type:"String",required:!0},description:{value:t.description,type:"String",required:!0},deadline:{value:t.deadline,type:"DateTime",required:!0},online:{value:t.online,type:"Boolean",required:!0}},fields:["success","message",{assignment:["id","title","description","deadline","onlineSubmission","submitted","canSubmit",{user:["id"]},{darasa:["id"]},"created","updated","isActive","canDelete","canEdit","canManage"]}]}}).catch(r=>(c.error("Failed to update assignment"),{data:null})).then(r=>r);i&&(i.success?(c(i.message),a(o.map(r=>r.id===i.assignment.id?i.assignment:r)),D.resetFields(),j(!1)):c.error(i.message))},X=t=>{de.confirm({title:"Deleting Assignment",icon:e.jsx(xe,{}),content:"Are you sure ...",okText:"Delete",cancelText:"Cancel",onOk:()=>G(t)})};return n.useEffect(()=>{b(M)},[]),e.jsxs(e.Fragment,{children:[e.jsx(k,{children:e.jsx(v,{span:16,children:e.jsx(p,{layout:"vertical",form:q,onFinish:t=>b(0,t.key,!0),children:e.jsx(p.Item,{name:"key",children:e.jsx(ee,{size:"large",placeholder:"Search Assignments...",prefix:e.jsx(ce,{}),autoComplete:"off",allowClear:!0})})})})}),e.jsx("div",{id:"scrollableDiv",style:{height:"62vh",overflow:"auto"},children:e.jsxs(te,{spinning:h,children:[e.jsx(y,{itemLayout:"horizontal",dataSource:o,renderItem:t=>e.jsx("div",{style:{background:"white",marginBottom:5,paddingLeft:10,paddingTop:10},children:e.jsx(y.Item,{style:{margin:0,padding:0},actions:[e.jsx(se,{trigger:["click"],overlay:e.jsxs(g,{children:[e.jsx(g.Item,{icon:e.jsx(O,{}),children:e.jsx("a",{target:"_blank",onClick:()=>F(t),children:"Submissions"})}),e.jsx(g.Item,{icon:e.jsx(O,{}),children:e.jsx("a",{target:"_blank",onClick:()=>E(t),children:"Attachements"})}),e.jsx(g.Item,{icon:e.jsx(me,{}),disabled:!t.canDelete,onClick:()=>K(t),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Edit"})}),e.jsx(g.Item,{icon:e.jsx(ue,{}),disabled:!t.canDelete,onClick:()=>X(t.id),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Delete"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:i=>i.preventDefault(),children:e.jsx(he,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})],children:e.jsx(y.Item.Meta,{style:{borderBottom:"1px solid #e8e8e8",paddingBottom:10},avatar:e.jsx(pe,{}),title:e.jsxs("a",{target:"_blank",rel:"noreferrer",children:[t.title,t.onlineSubmission&&e.jsx("span",{style:{marginLeft:20},children:e.jsx(u,{color:"red",children:"Online Submission"})})]}),description:e.jsxs(e.Fragment,{children:[e.jsx("span",{dangerouslySetInnerHTML:{__html:t.description}}),e.jsxs("p",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs("span",{children:[e.jsxs(u,{color:"cyan",children:[e.jsx("span",{style:{marginRight:5},children:"Created:"}),new Date(t.created).toLocaleString()]}),e.jsxs(u,{color:"green",children:[e.jsx("span",{style:{marginRight:5},children:"Deadline:"}),new Date(t.deadline).toLocaleString()]}),e.jsx(A,{title:"Click to View Attachments",children:e.jsx("a",{onClick:()=>E(t),children:e.jsxs(u,{color:"orange",children:[e.jsx("span",{style:{marginRight:5},children:"Attachments:"}),t.totalAttachments]})})})]}),e.jsxs("span",{children:[t.canSubmit&&!t.canManage&&e.jsx(A,{title:t.submitted?"Click to Re-submitt Your Assignment Work":"Click to Submitt Your Assignment Work",color:t.submitted?"green":"red",children:e.jsx("a",{onClick:()=>Z(t),children:e.jsx(u,{color:t.submitted?"green":"red",icon:e.jsx(ge,{}),children:e.jsxs("span",{style:{marginRight:5},children:[t.submitted?"Re-submitt":"Submitt"," ","Assignment Work:"]})})})}),t.canManage&&e.jsx(A,{title:"Click to View Students Submissions",color:"green",children:e.jsx("a",{onClick:()=>F(t),children:e.jsx(u,{color:"green",children:e.jsx("span",{style:{marginRight:5},children:"Submissions"})})})})]})]})]})})},"class-assignment-link-"+t.id)},"class-resource-link-item-container-"+t.id)}),B&&e.jsx("div",{style:{textAlign:"center",marginTop:12,height:32,lineHeight:"32px"},children:e.jsx(ie,{type:"primary",onClick:()=>{b(M+1)},children:"Load More"})})]})}),e.jsx(x,{title:"Edit Assignment",open:U,onClose:t=>j(t),width:"50vw",children:e.jsx(re,{assignment:s,form:D,onFinish:Q})}),e.jsx(x,{title:"Assignment Attachements",visible:P,onClose:t=>C(t),width:"50vw",children:e.jsx(ae,{assignment:s,canManage:(s==null?void 0:s.canManage)??!1})}),e.jsx(x,{title:"Assignment Submissions",open:H,onOk:()=>f(!1),onClose:t=>f(t),width:"50vw",children:e.jsx(oe,{assignment:s,canManage:(s==null?void 0:s.canManage)??!1})}),e.jsx(x,{title:"Assignment Work Submission",open:Y,onClose:t=>w(t),width:"50vw",children:e.jsx(le,{assignment:s,canManage:(s==null?void 0:s.canManage)??!1,submitted:s==null?void 0:s.submitted,onFinish:J})})]})},{TabPane:T}=R,rt=m=>{var d;const[o,a]=n.useState(!1),s=ne(h=>h.totalAssignments);return e.jsxs(e.Fragment,{children:[e.jsx("span",{children:e.jsx("a",{onClick:()=>a(!0),style:{padding:"0px !important",cursor:"pointer"},children:e.jsxs("span",{onClick:()=>a(!0),style:{padding:"0px !important",cursor:"pointer"},children:[e.jsx(k,{children:e.jsxs(v,{children:[e.jsx("span",{style:{marginRight:10,fontSize:20,color:"green",fontWeight:"bolder"},children:s}),e.jsx("span",{style:{fontSize:18},children:"Assignments"})]})}),e.jsx(k,{children:e.jsxs(v,{children:[e.jsx("span",{style:{marginRight:10,fontSize:20,color:"red",fontWeight:"bolder"},children:(d=m==null?void 0:m.data)==null?void 0:d.overdue_assignments}),e.jsx("span",{style:{fontSize:18},children:"Assignments Overdue"})]})})]})})}),e.jsx(x,{title:"Assignments",width:"60vw",open:o,onClose:h=>a(h),children:e.jsxs(R,{defaultActiveKey:"1",children:[e.jsx(T,{tab:"Assignments",children:e.jsx(W,{infinite:!0,overdue:!1})},"1"),e.jsx(T,{tab:"Overdue Assignments",children:e.jsx(W,{infinite:!0,overdue:!0})},"2")]})})]})};export{rt as DashboardAssignmentsComponent};
