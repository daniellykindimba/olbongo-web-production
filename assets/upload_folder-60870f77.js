import{r as d,ay as U,j as e,S,k as b,B as h,a as C,c,ax as x,a9 as k,aa as q,g,e6 as y,_ as l,y as N}from"./index-c92f9f6b.js";import{l as D}from"./index-742844e5.js";const I=s=>Array.isArray(s)?s:s==null?void 0:s.fileList,A=s=>{const[u,o]=d.useState(!1),[j,i]=d.useState(!1),v=U(),m=async n=>{o(!0),i(!1);const{data:r}=await g.custom({url:"",method:"post",meta:{operation:"uploadFile",variables:{files:{value:n.file,type:"[Upload]",required:!0}},fields:["success","message",{files:y}]}}).catch(()=>(l.error("Error occured while uploading file(s)"),{data:null})).then(f=>f);r&&(r.success?(l.success(r.message),i(!0),console.log(r.files),s.onFinish(r.files)):l.error(r.message)),o(!1)},F=async n=>{o(!0),i(!1);const{data:r}=await g.custom({url:"",method:"post",meta:{operation:"uploadDriveFile",variables:{files:{value:n.file,type:"[Upload]",required:!0},driveId:{value:parseInt(v.drive.toString()),type:"Int",required:!0}},fields:["success","message",{files:y}]}}).catch(()=>(l.error("Error occured while uploading file"),{data:null})).then(f=>f);r&&(r.success?(l.success(r.message),i(!0),s.onFinish(r.files)):l.error(r.message)),o(!1)};return j?e.jsx(e.Fragment,{children:e.jsx(S,{direction:"vertical",style:{display:"flex",justifyContent:"center"},children:e.jsx(b,{message:"Success",description:e.jsx(e.Fragment,{children:e.jsx("p",{children:"File uploaded successfully"})}),action:[e.jsx(h,{onClick:()=>i(!1),children:"Upload another file(s)"})],type:"success"})})}):e.jsx(e.Fragment,{children:e.jsx(C,{spinning:u,children:e.jsxs(c,{layout:"vertical",form:s.form,onFinish:n=>{s.mode==="drive"?F(n):m(n)},requiredMark:!0,autoComplete:"off",children:[e.jsx(c.Item,{label:"Pick Files ("+x.supported_file_extensions.join()+")",children:e.jsx(c.Item,{name:"file",valuePropName:"fileList",getValueFromEvent:I,noStyle:!0,rules:[{required:!0,type:"array",message:"Please upload students excel file"}],children:e.jsxs(k.Dragger,{name:"file",accept:x.supported_file_extensions.join(),multiple:!0,beforeUpload:()=>!1,children:[e.jsx("p",{className:"ant-upload-drag-icon",children:e.jsx(q,{})}),e.jsx("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"}),e.jsx("p",{className:"ant-upload-hint",children:"Support for a single or bulk upload."})]})})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(h,{type:"primary",size:"large",htmlType:"submit",loading:u,children:"Upload"})})]})})})},_=s=>Array.isArray(s)?s:s==null?void 0:s.fileList,B=s=>{const[u,o]=d.useState(!1),[j,i]=d.useState(!1),v=U(),[m,F]=d.useState(""),[n,r]=d.useState(!1),f=async a=>{o(!0),i(!1);const{data:t}=await g.custom({url:"",method:"post",meta:{operation:"uploadFile",variables:{files:{value:a.file,type:"[Upload]",required:!0},folderName:{value:m,type:"String",required:!1},autoCreateDrive:{value:n,type:"Boolean",required:!1}},fields:["success","message",{files:y}]}}).catch(()=>(l.error("Error occured while uploading file"),{data:null})).then(p=>p);t&&(t.success?(l.success(t.message),i(!0),s.onFinish(t.files)):l.error(t.message)),o(!1)},w=async a=>{o(!0),i(!1);const{data:t}=await g.custom({url:"",method:"post",meta:{operation:"uploadDriveFile",variables:{files:{value:a.file,type:"[Upload]",required:!0},driveId:{value:parseInt(v.drive.toString()),type:"Int",required:!0},folderName:{value:m,type:"String",required:!1}},fields:["success","message",{files:y}]}}).catch(()=>(l.error("Error occured while uploading file"),{data:null})).then(p=>p);t&&(t.success?(l.success(t.message),i(!0),s.onFinish(t.files)):l.error(t.message)),o(!1)};return j?e.jsx(e.Fragment,{children:e.jsx(S,{direction:"vertical",style:{display:"flex",justifyContent:"center"},children:e.jsx(b,{message:"Success",description:e.jsx(e.Fragment,{children:e.jsx("p",{children:"File uploaded successfully"})}),action:[e.jsx(h,{onClick:()=>i(!1),children:"Upload another file(s)"})],type:"success"})})}):e.jsx(e.Fragment,{children:e.jsx(C,{spinning:u,children:e.jsxs(c,{layout:"vertical",form:s.form,onFinish:a=>{s.mode==="drive"?w(a):f(a)},requiredMark:!0,autoComplete:"off",children:[s.mode==="file"&&e.jsx(N,{sx:{marginBottom:2},children:e.jsx(D.Checkbox,{onChange:a=>{console.log(a.target.checked),r(a.target.checked)},style:{zoom:1.5,marginTop:5,marginBottom:5},type:"checkbox",children:"Auto create drive if not exists (Note: This will create drive with name of folder)"})}),e.jsx(c.Item,{label:"Folder can only contains files with these extensions ("+x.supported_file_extensions.join()+")",style:{maxHeight:"70vh",overflowY:"auto"},children:e.jsx(c.Item,{name:"file",valuePropName:"fileList",getValueFromEvent:_,noStyle:!0,rules:[{required:!0,type:"array",message:"Please upload students excel file"}],children:e.jsxs(k.Dragger,{name:"file",accept:x.supported_file_extensions.join(),directory:!0,beforeUpload:(a,t)=>{if(a&&a.webkitRelativePath){const p=a.webkitRelativePath.split("/")[0];F(p)}return!1},children:[e.jsx("p",{className:"ant-upload-drag-icon",children:e.jsx(q,{})}),e.jsx("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"}),e.jsx("p",{className:"ant-upload-hint",children:"Support for a single or bulk upload."})]})})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(h,{type:"primary",size:"large",htmlType:"submit",loading:u,children:"Upload"})})]})})})};export{A as U,B as a};
