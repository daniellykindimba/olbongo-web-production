import{r as a,F as i,m as U,j as e,C as W,B as c,G as x,T as h,S as _,k,A as v,I as l,g as n,P as q,a as m,l as F,E,b as L,c as G,d as O,h as $}from"./index-cdd95245.js";/* empty css               */import{q as K}from"./base-e8aaf39e.js";import{E as V}from"./footer-6d7a6ade.js";import{t as H,m as g}from"./styles-8f561be7.js";import{E as J}from"./index-ffa88bb7.js";import"./index-c62eae5d.js";import"./useNotification-f11fc5a0.js";import"./index-d33120e9.js";const le=()=>{const[y,w]=a.useState(!1),[j]=i.useForm(),[z,f]=a.useState(!1),[D,d]=a.useState(""),[S,P]=a.useState(""),{push:C}=U(),p=K.parse(window.location.search),u=new Array(p.to).filter(o=>o!==null).join(","),[r,B]=a.useState(),[b,M]=a.useState(!1),[I,A]=a.useState(!1),T=async()=>{w(!0);const{data:o}=await n.custom({url:"",method:"get",meta:{operation:"systemSettings",variables:{},fields:["passwordComplexityMinLength","passwordComplexityMaxLength","passwordComplexityMinUppercase","passwordComplexityMinLowercase","passwordComplexityMinNumeric","passwordComplexityMinSpecial"]}}).catch(()=>(g.error("Error occured while get System Settings"),{data:null})).then(s=>s);o&&B(o),w(!1)},N=e.jsx(e.Fragment,{children:e.jsxs("ul",{children:[e.jsxs("li",{children:["Not less than ",(r==null?void 0:r.passwordComplexityMinLength)??6," characters"]}),(r==null?void 0:r.passwordComplexityMinUppercase)&&parseInt(r==null?void 0:r.passwordComplexityMinUppercase.toString())>0&&e.jsxs("li",{children:["At least ",(r==null?void 0:r.passwordComplexityMinUppercase)??0," uppercase letter"]}),(r==null?void 0:r.passwordComplexityMinLowercase)&&parseInt(r==null?void 0:r.passwordComplexityMinLowercase.toString())>0&&e.jsxs("li",{children:["At least ",(r==null?void 0:r.passwordComplexityMinLowercase)??0," lowercase letter"]}),(r==null?void 0:r.passwordComplexityMinNumeric)&&parseInt(r==null?void 0:r.passwordComplexityMinNumeric.toString())>0&&e.jsxs("li",{children:["At least ",(r==null?void 0:r.passwordComplexityMinNumeric)??0," ","number(Digit)"]}),(r==null?void 0:r.passwordComplexityMinSpecial)&&parseInt(r==null?void 0:r.passwordComplexityMinSpecial.toString())>0&&e.jsxs("li",{children:["At least ",(r==null?void 0:r.passwordComplexityMinSpecial)??0," special character"]})]})}),R=async o=>{P(""),d("");const{data:s}=await n.custom({url:"",method:"post",meta:{operation:"register",variables:{email:{value:o.email,type:"String",required:!0},phone:{value:o.phone,type:"String",required:!0},fullName:{value:o.fullName,type:"String",required:!0},password:{value:o.password,type:"String",required:!0},passwordRepeat:{value:o.confirmPassword,type:"String",required:!0}},fields:["success","message","accountAvailable","errors"]}});s.success?(f(!0),d(s.message),g.success(s.message),j.resetFields()):(P(s.message),g.error(s.message))},Z=async o=>{const{data:s}=await n.custom({url:"",method:"post",meta:{operation:"registerByGoogle",variables:{token:{value:o,type:"String",required:!0},sessionKey:{value:localStorage.getItem("sessionKey"),type:"String",required:!0}},fields:["success","message","token","expires","tokenExpires","accountDisabled","sessionKey","registered",{user:["id","firstName","middleName","lastName","fullName","pic","email","isAdmin","isStaff","isActive"]}]}}).catch(()=>({data:null})).then(t=>t);s&&(localStorage.setItem("accountDisabled",s.accountDisabled?"1":"0"),localStorage.getItem("loginAttemp")?(localStorage.setItem("loginAttemp",(parseInt(localStorage.getItem("loginAttemp")??"1")+1).toString()),localStorage.setItem("lastLoginAttemp",new Date().toString())):(localStorage.setItem("loginAttemp","1"),localStorage.setItem("lastLoginAttemp",new Date().toString())),s.token&&s.user&&!s.otpAuth&&(f(s.registered),d(s.message),localStorage.removeItem("loginAttemp"),$.setHeader("Authorization",`Bearer ${s.token}`),localStorage.setItem("token",s.token),localStorage.setItem("expires",s.expires),localStorage.setItem("tokenExpires",s.tokenExpires),localStorage.setItem("lastLoginAttemp",new Date().toString()),localStorage.setItem("expired","0"),localStorage.setItem("user",JSON.stringify(s.user)),setTimeout(()=>{var t;try{localStorage.removeItem("loginAttemp"),localStorage.removeItem("lastLoginAttemp")}catch{}p.to&&((t=p.to)==null?void 0:t.length)>0?window.location.href=u:window.location.href="/apps"},2e3)))};return a.useEffect(()=>{T()},[]),e.jsxs(e.Fragment,{children:[e.jsx(W,{maxWidth:"xl",children:e.jsxs(c,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx(x,{container:!0,spacing:0,children:e.jsx(J,{})}),e.jsx(x,{item:!0,xs:12,sm:12,md:12,lg:12,xl:12,children:e.jsx(c,{sx:{marginTop:"50px"},children:e.jsx(h,{component:"h1",variant:"h1",align:"center",style:{...H,fontSize:"38px"},color:"primary",fontWeight:700,children:"Make your learning journey easier"})})}),e.jsx(x,{item:!0,xs:12,sm:12,md:12,lg:12,xl:12,children:e.jsx(_,{spinning:y,children:e.jsx("div",{className:"container",style:{marginBottom:50},children:z?e.jsx(e.Fragment,{children:e.jsxs(k,{headStyle:{borderBottom:0},children:[e.jsx(v,{message:"Success",description:D,type:"success"}),e.jsx(m,{block:!0,style:{marginTop:20},onClick:()=>C("/login?to="+u),children:"Sign In Now"})]})}):e.jsxs(k,{headStyle:{borderBottom:0},children:[S.length>0?e.jsx(v,{message:"Error",description:S,type:"error",closable:!0}):e.jsx(e.Fragment,{}),e.jsxs(i,{layout:"vertical",form:j,onFinish:o=>R(o),requiredMark:!0,initialValues:{remember:!1,email:"",password:""},children:[e.jsx(i.Item,{name:"fullName",label:"Full Name",rules:[{required:!0,message:"Full Name is required"},({getFieldValue:o})=>({validator(s,t){return!t||t.length<3||!/^[a-zA-Z ]+$/.test(t)?Promise.reject("Full Name must be at least 3 Names and only letters are allowed"):Promise.resolve()}})],children:e.jsx(l,{size:"large",placeholder:"Full Name"})}),e.jsx(i.Item,{name:"phone",label:"Mobile Phone Number",rules:[{required:!0,type:"string",message:"Mobile Phone Number is required"},({getFieldValue:o})=>({validator(s,t){return!t||!/^[0-9]+$/.test(t)||t.length<9?Promise.reject("Mobile Phone Number must be at least 10 numbers"):Promise.resolve()}}),{validator:async(o,s)=>{if(!s)return Promise.reject();const{data:t}=await n.custom({url:"",method:"post",meta:{operation:"checkMobilePhoneNumber",variables:{phone:{value:s,type:"String",required:!0}},fields:["success","message"]}});return t.success?Promise.resolve():Promise.reject(t.message)}}],children:e.jsx(l,{prefix:e.jsx(e.Fragment,{children:e.jsx("span",{style:{color:"red"},children:"255"})}),size:"large",placeholder:"Mobile Phone Number ..."})}),e.jsx(i.Item,{name:"email",label:"Email",rules:[{required:!0,type:"email",message:"Email is required"},({getFieldValue:o})=>({validator(s,t){return!t||!/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(t)?Promise.reject("Please enter a valid email address"):Promise.resolve()}}),{validator:async(o,s)=>{if(!s)return Promise.reject();const{data:t}=await n.custom({url:"",method:"post",meta:{operation:"checkEmailWithAccount",variables:{email:{value:s,type:"String",required:!0}},fields:["success","message"]}});return t.success?Promise.resolve():Promise.reject(t.message)}}],children:e.jsx(l,{size:"large",placeholder:"Email"})}),e.jsx(i.Item,{name:"password",label:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Password"}),e.jsx(q,{content:N,title:"Password Complexity Definition",children:e.jsx(m,{type:"text",icon:e.jsx(F,{style:{color:"red"}})})})]}),rules:[{required:!0,message:"Password is required"},({getFieldValue:o})=>({validator(s,t){return!t||t.toLowerCase().includes(o("email").toLowerCase())?Promise.reject("Password must not contain "+o("email")):!t||t.length<((r==null?void 0:r.passwordComplexityMinLength)??6)?Promise.reject("Password must be at least "+(r==null?void 0:r.passwordComplexityMinLength)):((r==null?void 0:r.passwordComplexityMinLowercase)??0)>0&&!t.match(/[a-z]/)?Promise.reject("Password must contain at least one lowercase letter"):((r==null?void 0:r.passwordComplexityMinUppercase)??0)>0&&!t.match(/[A-Z]/)?Promise.reject("Password must contain at least one uppercase letter"):((r==null?void 0:r.passwordComplexityMinNumeric)??0)>0&&!t.match(/[0-9]/)?Promise.reject("Password must contain at least one number"):((r==null?void 0:r.passwordComplexityMinSpecial)??0)>0&&!t.match(/[^a-zA-Z0-9]/)?Promise.reject("Password must contain at least one special character"):Promise.resolve()}})],style:{marginBottom:"12px"},children:e.jsx(l,{type:b?"text":"password",placeholder:"",size:"large",suffix:b?e.jsx(E,{onClick:()=>{M(!1)}}):e.jsx(L,{onClick:()=>{M(!0)}})})}),e.jsx(i.Item,{name:"confirmPassword",label:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Confirm Password"}),e.jsx(q,{content:N,title:"Password Complexity Definition",children:e.jsx(m,{type:"text",icon:e.jsx(F,{style:{color:"red"}})})})]}),rules:[{required:!0,message:"Password is required"},({getFieldValue:o})=>({validator(s,t){return o("password")!==t?Promise.reject("Password and Confirm Password do not match"):Promise.resolve()}})],style:{marginBottom:"12px"},children:e.jsx(l,{type:I?"text":"password",placeholder:"",size:"large",suffix:I?e.jsx(E,{onClick:()=>{A(!1)}}):e.jsx(L,{onClick:()=>{A(!0)}})})}),e.jsx(m,{type:"primary",size:"large",htmlType:"submit",style:{backgroundColor:"red",color:"white",fontWeight:"bolder"},disabled:y||!r,block:!0,children:"Agree & Join"})]}),e.jsxs(c,{children:[e.jsx("div",{style:{marginTop:20},children:e.jsx("hr",{style:{width:"100%"}})}),e.jsx("div",{style:{position:"relative",top:"-20px",display:"flex",justifyContent:"center"},children:e.jsx(h,{sx:{backgroundColor:"#fff",padding:"0 10px",borderRadius:"50%"},children:"Or"})})]}),e.jsx("div",{style:{marginTop:8},children:e.jsx(G,{text:"signup_with",context:"signup",onSuccess:o=>{const s=o.credential;s&&Z(s)},useOneTap:!0,width:"350",shape:"pill",size:"large"})}),e.jsx(c,{sx:{marginTop:5,display:"flex",justifyContent:"center"},children:e.jsxs(h,{sx:{fontSize:"18px",color:"#000"},children:["Already on ",O.system_name," ?"," ",e.jsx("a",{onClick:()=>C("/login?to="+u),style:{fontWeight:"bold"},children:"Sign in"})]})})]})})})})]})}),e.jsx(V,{min:!0})]})};export{le as Register};
