import{r as t,b$ as se,aO as u,aY as e,aS as U,aK as g,Q as O,cY as Q,ao as I,aN as he,dw as qe,dl as ze,aV as Y,aT as ee,c3 as ne,bZ as v,b_ as p,aU as Ce,a6 as le,d6 as X,ak as pe,dx as W,S as ue,di as Te,dy as Ae,dz as Le,aM as oe,aP as L,c9 as de,dr as Se,dA as _e,cR as ce,bY as $,c$ as je,dB as ve,c7 as G,aI as C,cq as D,cG as me,c8 as xe,c0 as Ke,aQ as Oe,cI as Ve,cP as Re,c4 as Be,d0 as we}from"./index-60f2319e.js";import{L as ye}from"./index-d14c7ff5.js";import{C as P}from"./index-372942ca.js";import{A as Ne}from"./index-d67d24cb.js";import{S as B}from"./index-f0aaf17a.js";import{P as ge}from"./index-fec28892.js";import{M as fe}from"./index-62c85f30.js";import{l as Ie}from"./index-cc91b3ce.js";import{A as Ye}from"./index-52cf496e.js";import{F as He}from"./index-9989ab55.js";import{G as Ue}from"./index-0eeea9dd.js";import{U as We}from"./index-edf48d1e.js";import"./Skeleton-6d5c2967.js";import"./index-5d31df90.js";import"./ActionButton-3aa18717.js";import"./InfoCircleFilled-6d0588ac.js";import"./DialogWrap-d3722b37.js";import"./index-1081035e.js";import"./fade-5fa5b38f.js";import"./defineProperty-e9fa7962.js";import"./useNotification-719a2206.js";import"./index-800ba95c.js";import"./localeData-736dc761.js";import"./SinglePicker-6f340f44.js";import"./useMutateObserver-a0ddf4ac.js";import"./index-0a310456.js";import"./InputNumber-5a225fe7.js";import"./Image-2f26e9c9.js";import"./Upload-473b3c62.js";import"./index-fd3cca1c.js";import"./index-1bde99c1.js";const $e=()=>{const[r,o]=t.useState([]),[a,s]=t.useState(!1),[m,n]=t.useState(!1),[x,i]=t.useState(20),[c,y]=t.useState(0),[q,k]=t.useState(1);t.useState(""),se();const[_]=u.useForm(),K=async(b,N,S=20)=>{s(!0);const{data:F}=await v.custom({url:"",method:"get",meta:{operation:"messagesDispatches",variables:{page:{value:b,type:"Int",required:!0},key:{value:N,type:"String",required:!1},pageSize:{value:S,type:"Int",required:!1}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","receipientPhoneNumber","carrier",{channelMessage:["id","message",{channel:["id","name","code"]}]},{receipient:["id","firstName"]},"isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(T=>(p.error("Error fetching Recently Messages Dispatched"),{data:null})).then(T=>T);F&&(y(F.total),k(F.page+1),o([...r,...F.results])),s(!1),n(!1)},H=b=>{b.currentTarget.scrollHeight-b.currentTarget.scrollTop===window.innerHeight/1.4&&K(q,"",20)};return t.useEffect(()=>{K(q,"",20)},[]),e.jsx(e.Fragment,{children:e.jsxs(U,{children:[e.jsx(g,{children:e.jsx("span",{style:{fontSize:16,fontWeight:"bolder"},children:"Recently Dispatched Messages"})}),e.jsx(g,{span:20,style:{height:45},children:e.jsx(u,{layout:"vertical",form:_,onFinish:b=>{n(!0),K(q,b.key,x)},children:e.jsx(u.Item,{name:"key",children:e.jsx(O,{size:"large",disabled:m,placeholder:"Search Phone Number(s)...",prefix:e.jsx(Q,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(g,{span:4,style:{display:"flex",justifyContent:"flex-start",height:45},children:e.jsx(I,{size:"large",icon:e.jsx(Q,{}),onClick:()=>{_.submit()},loading:m||a,disabled:m||a})}),e.jsxs(g,{span:24,children:[r.length===0&&e.jsx(he,{image:"/images/nodata.png",imageStyle:{height:160},description:e.jsx("span",{style:{fontSize:16},children:"No recently dispatched message ..."})}),e.jsx(ye,{style:{paddingRight:10},children:e.jsx(qe,{data:r,height:window.innerHeight/1.4,itemHeight:47,itemKey:"phoneNumber",onScroll:H,children:b=>{var N,S;return e.jsx(P,{children:e.jsx(ye.Item,{children:e.jsx(ye.Item.Meta,{avatar:e.jsx(Ne,{icon:e.jsx(ze,{})}),title:e.jsxs("a",{children:[b.receipientPhoneNumber,e.jsxs("span",{style:{marginLeft:5},children:[e.jsx(Y,{color:"green",children:(S=(N=b==null?void 0:b.channelMessage)==null?void 0:N.channel)==null?void 0:S.name}),b.carrier&&e.jsx(Y,{color:"red",children:b.carrier})]})]}),description:e.jsx(e.Fragment,{children:e.jsxs(ee,{direction:"vertical",children:[e.jsx("span",{children:b.channelMessage.message.length>100?b.channelMessage.message.substring(0,100)+"...":b.channelMessage.message}),e.jsxs("span",{children:[e.jsx("b",{children:"Dispatched"}),":"," ",ne(b.created).format("lll")]})]})})})},b.receipientPhoneNumber)})}})})]})]})})},Qe=r=>{const[o,a]=t.useState([]);t.useState();const[s,m]=t.useState(!1),[n,x]=t.useState(!1),[i,c]=t.useState(20),[y,q]=t.useState(0),[k,_]=t.useState("");se();const[K]=u.useForm(),H=async(N,S,F=20)=>{m(!0);const{data:T}=await v.custom({url:"",method:"get",meta:{operation:"channelMessageDispatches",variables:{page:{value:N,type:"Int",required:!0},key:{value:S,type:"String",required:!1},pageSize:{value:F,type:"Int",required:!1},filterType:{value:r.filterType,type:"String",required:!0},messageId:{value:r.messageId,type:"Int",required:!0}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","receipientPhoneNumber","status","statusColor","carrier","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(V=>(p.error("Error fetching Dispatches"),{data:null})).then(V=>V);T&&(q(T.total),a(T.results)),m(!1),x(!1)},b=[{title:"Phone Number",dataIndex:"phoneNumber",key:"phoneNumber",render:(N,S,F)=>e.jsx("a",{onClick:()=>{},children:S.receipientPhoneNumber})},{title:"Carrier",dataIndex:"carrier",key:"carrier",render:(N,S,F)=>e.jsx(Y,{color:"green",children:S.carrier})},{title:"Created",dataIndex:"created",key:"created",render:(N,S,F)=>e.jsx(le,{title:ne(S.created).format("Y-mm-d hh:mm:ss"),children:e.jsx("span",{children:ne(S.created).format("Y-mm-d hh:mm:ss")})})},{title:"Status",dataIndex:"status",key:"status",render:(N,S,F)=>e.jsx(Y,{color:S.statusColor,children:S.status})},{title:"",dataIndex:"Action",key:"action",render:(N,S,F)=>e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"}})}];return t.useEffect(()=>{H(1,"",20)},[r.randKey,r.filterType]),e.jsxs(e.Fragment,{children:[e.jsx(U,{children:e.jsx(g,{span:24,children:e.jsx(u,{layout:"vertical",form:K,onFinish:N=>{x(!0),H(0,N.key,i)},children:e.jsx(u.Item,{name:"key",children:e.jsx(O,{size:"large",disabled:n,placeholder:"Search Phone Number(s)...",prefix:e.jsx(Q,{}),autoComplete:"off",allowClear:!0})})})})}),e.jsx(Ce,{loading:s,columns:b,dataSource:o,pagination:{onChange:(N,S)=>{c(S),H(N,k,S)},total:y,pageSize:i,position:["bottomCenter"],showQuickJumper:!0},scroll:{x:!0,y:"40vh"}})]})},Je=["receipients","delivered","notdelivered","failed"],Ge=["All Receipients","All Delivered","All Not Delivered","All Failed"],Fe=r=>{var c;X(),se();const[o,a]=t.useState(!1),[s,m]=t.useState(),[n,x]=t.useState("receipients"),i=async()=>{var q;a(!0);const{data:y}=await v.custom({url:"",method:"get",meta:{operation:"channelMessageDispatchAnalytics",variables:{messageId:{value:(q=r.channelMessage)==null?void 0:q.id,type:"Int",required:!0}},fields:["analytics"]}}).catch(k=>(p.error("Error fetching Message Dispatch analytics"),{data:null})).then(k=>k);y&&m(y.analytics),a(!1)};return t.useEffect(()=>{i()},[r.randKey]),e.jsx(e.Fragment,{children:e.jsxs(pe,{spinning:o,children:[e.jsxs(U,{style:{display:"flex",justifyContent:"center",marginTop:2},children:[e.jsx(g,{span:6,children:e.jsx("a",{onClick:()=>x("receipients"),children:e.jsx(P,{children:e.jsx(B,{title:"Total Receipients",value:s==null?void 0:s.total_receipients,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:6,children:e.jsx("a",{onClick:()=>x("delivered"),children:e.jsx(P,{children:e.jsx(B,{title:"Delivered",value:s==null?void 0:s.total_delivered,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:6,children:e.jsx("a",{onClick:()=>x("notdelivered"),children:e.jsx(P,{children:e.jsx(B,{title:"Not Delievered",value:s==null?void 0:s.total_not_delivered,precision:0,valueStyle:{color:"#5E0321"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:6,children:e.jsx("a",{onClick:()=>x("failed"),children:e.jsx(P,{children:e.jsx(B,{title:"Failed",value:s==null?void 0:s.total_failed,precision:0,valueStyle:{color:"#700107"},prefix:e.jsx(W,{})})})})})]}),e.jsxs("div",{style:{marginTop:2},children:[e.jsx("h3",{children:Ge[Je.indexOf(n)]}),e.jsx(Qe,{randKey:Math.random(),filterType:n,messageId:(c=r.channelMessage)==null?void 0:c.id})]})]})})},{TextArea:Ze}=O,Xe=r=>{const[o,a]=t.useState([]),s=async(i=1,c=25,y="")=>{const{data:q}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannels",variables:{page:{value:i,type:"Int",required:!0},pageSize:{value:c,type:"Int",required:!0},key:{value:y,type:"String",required:!1}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","name","code"]}]}}).catch(k=>(p.error("Error fetching Channels"),{data:null})).then(k=>k);q&&a(q.results)},m=async i=>{const{data:c}=await v.custom({url:"",method:"post",meta:{operation:"createNjiwaChannelMessage",variables:{channelId:{value:parseInt(i.channel),type:"Int",required:!0},message:{value:i.message,type:"String",required:!1}},fields:["success","message",{njiwaChannelMessage:["id","message",{channel:["id","name","code"]},{creator:["id","firstName","middleName","lastName","fullName"]},"messageCount","dispatched","created","updated","isActive","canDelete","canEdit","canManage"]}]}}).catch(y=>(p.error("Error creating channel message"),{data:null})).then(y=>y);c&&(c.success?(p.success(c.message),r.onFinish(c.njiwaChannelMessage)):p.error(c.message))},n=i=>{},x=i=>{};return t.useEffect(()=>{s()},[r.randKey]),e.jsx(e.Fragment,{children:e.jsxs(u,{layout:"vertical",form:r.form,onFinish:i=>{m(i)},requiredMark:!0,children:[e.jsx(u.Item,{name:"message",label:"Message",rules:[{required:!0,type:"string",message:"Please input Message"}],children:e.jsx(Ze,{rows:4})}),e.jsx(u.Item,{name:"channel",label:"Channel",rules:[{required:!0,type:"number",message:"Please Choose Channel ..."}],children:e.jsx(ue,{size:"large",showSearch:!0,placeholder:"Select a Channel ...",optionFilterProp:"children",onChange:n,onSearch:x,filterOption:(i,c)=>((c==null?void 0:c.label)??"").toLowerCase().includes(i.toLowerCase()),options:o.map(i=>({value:i.id,label:i.name+" --> "+i.code})),dropdownStyle:{zIndex:9999}})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(I,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},ke=r=>{const[o,a]=t.useState([]),[s,m]=t.useState(),[n,x]=t.useState(!1),[i,c]=t.useState(!1),[y,q]=t.useState(20);t.useState(""),se(),u.useForm();const[k]=u.useForm(),[_,K]=t.useState(!1),[H,b]=t.useState(!1),N=async l=>{m(l),K(!0)},S=async l=>{const{data:w}=await v.custom({url:"",method:"post",meta:{operation:"deleteNjiwaChannelMessage",variables:{id:{value:l,type:"Int",required:!0}},fields:["success","message"]}});w.success?(p.success(w.message),a(o.filter(E=>E.id.toString()!==l.toString()))):p.error(w.message)},F=async l=>{const{data:w}=await v.custom({url:"",method:"post",meta:{operation:"dispatchChannelMessage",variables:{channelMessageId:{value:l,type:"Int",required:!0}},fields:["success","message",{channelMessage:["id","message",{channel:["id","name","code"]},{creator:["id","firstName","middleName","lastName","fullName"]},"messageCount","dispatched","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(E=>(p.error(E.message),{data:null})).then(E=>E);w&&(w.success?(a(o.map(E=>E.id===w.channelMessage.id?w.channelMessage:E)),p.success(w.message)):p.error(w.message))},T=l=>{fe.confirm({title:"Deleting Njiwa Channel Message",icon:e.jsx(je,{}),content:"Are you sure ...",okText:"Delete",cancelText:"Cancel",onOk:()=>S(parseInt(l.toString()))})},V=async(l,w,E=20)=>{x(!0);const{data:Z}=await v.custom({url:"",method:"get",meta:{operation:"njiwaChannelsMessages",variables:{page:{value:l,type:"Int",required:!0},key:{value:w,type:"String",required:!1},pageSize:{value:E,type:"Int",required:!0}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","message",{channel:["id","name","code"]},{creator:["id","firstName","middleName","lastName","fullName"]},"messageCount","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(te=>({data:null})).then(te=>te);Z&&a(Z.results),x(!1),c(!1)},R=async l=>{a([l,...o]),b(!1)};return t.useEffect(()=>{V(1,"",20)},[]),e.jsxs(e.Fragment,{children:[e.jsxs(U,{children:[e.jsx(g,{span:14,children:e.jsx(u,{layout:"vertical",form:k,onFinish:l=>{c(!0),V(0,l.key,y)},children:e.jsx(u.Item,{name:"key",children:e.jsx(O,{size:"large",disabled:i,placeholder:"Search Channel Message(s)...",prefix:e.jsx(Q,{}),autoComplete:"off",autoFocus:!0,allowClear:!0})})})}),e.jsx(g,{span:6,style:{display:"flex",justifyContent:"flex-start"},children:e.jsx(I,{size:"large",icon:e.jsx(Q,{}),onClick:()=>{k.submit()},loading:i||n,disabled:i||n})}),e.jsx(g,{span:4,style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(le,{title:"Click to Create Message",placement:"top",color:"green",children:e.jsx(I,{size:"large",icon:e.jsx(Te,{}),onClick:()=>{b(!0)},loading:i||n,disabled:i||n,style:{marginRight:30}})})})]}),e.jsx(pe,{spinning:n,children:e.jsx("div",{style:{maxHeight:r.dash?"69vh":"",overflowY:"auto"},children:e.jsxs(U,{align:"top",children:[o.length===0&&!n&&e.jsx(g,{span:24,style:{display:"flex",justifyContent:"center"},children:e.jsx(he,{image:"/images/nodata.png",imageStyle:{height:160},description:e.jsx("span",{style:{fontSize:16},children:"No Message Found ..."})})}),o.map(l=>{var w;return e.jsx(g,{span:24,children:e.jsxs(P,{hoverable:l.isActive,style:{marginRight:10,marginBottom:3},children:[e.jsxs(ee,{style:{right:0,position:"absolute"},children:[l.dispatched?e.jsx(e.Fragment,{children:e.jsx(le,{title:"Dispatched",placement:"top",color:"green",children:e.jsx(Ae,{style:{color:"green"}})})}):e.jsx(e.Fragment,{children:e.jsx(le,{title:"Not Dispatched",placement:"top",color:"red",children:e.jsx(Le,{style:{color:"red"}})})}),e.jsx(oe,{trigger:["click"],overlay:e.jsxs(L,{children:[e.jsx(L.Item,{icon:e.jsx(de,{}),onClick:()=>{T(l.id)},disabled:!(l!=null&&l.canDelete),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Delete"})}),!l.dispatched&&e.jsx(L.Item,{icon:e.jsx(Se,{}),disabled:!(l!=null&&l.canDelete),children:e.jsx(ge,{title:"Are you sure to Start Sending/Dispatching SMS?",onConfirm:()=>F(l.id),onCancel:()=>{},okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Dispatch"})})}),e.jsx(L.Item,{icon:e.jsx(_e,{}),disabled:!(l!=null&&l.canDelete),onClick:()=>N(l),children:e.jsx("a",{rel:"noopener noreferrer",children:"Dispatch Report"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:E=>E.preventDefault(),children:e.jsx(ce,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})]}),e.jsxs(ee,{direction:"vertical",style:{width:"100%",justifyContent:"center"},onClick:()=>{},children:[e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Created By:"}),e.jsx("span",{style:{marginLeft:5},children:(w=l==null?void 0:l.creator)==null?void 0:w.fullName})]}),e.jsx("span",{children:l.message}),e.jsxs(ee,{direction:"horizontal",children:[e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Created On:"}),e.jsx("span",{style:{marginLeft:5},children:ne(l.created).format("YYYY/MM/DD HH:MM")})]}),e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Channel:"}),e.jsxs("span",{style:{marginLeft:5},children:[l==null?void 0:l.channel.name,e.jsx("span",{style:{marginLeft:10},children:e.jsx(Y,{color:"green",children:l==null?void 0:l.channel.code})})]})]}),e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Message Count:"}),e.jsx("span",{style:{marginLeft:5},children:e.jsx(Y,{color:"green",children:l==null?void 0:l.messageCount})})]})]})]})]})})})]})})}),e.jsx($,{title:"Dispatch Report",width:"50vw",open:_,onClose:l=>K(l),children:e.jsx(Fe,{randKey:Math.random(),channelMessage:s})}),e.jsx($,{title:"Creating Message",open:H,width:"40vw",onClose:l=>b(l),children:e.jsx(Xe,{onFinish:R})})]})},es=r=>{const[o]=u.useForm(),[a,s]=t.useState(1);return t.useEffect(()=>{},[r.randKey]),e.jsxs(e.Fragment,{children:[a===1&&e.jsxs(u,{layout:"vertical",form:o,onFinish:m=>{s(2)},requiredMark:!0,children:[e.jsx(Ye,{message:"Please note that the minimum number of messages is 100",type:"info",showIcon:!0}),e.jsx(He,{style:{display:"flex",justifyContent:"space-between",marginTop:"10px",marginBottom:"10px"},children:e.jsxs("div",{children:[e.jsx("h3",{children:"1. Messages less than 1000 costs 10 Tsh @Message"}),e.jsx("h3",{children:"2. Messages between 1000 and 5000 costs 7 Tsh@Message"}),e.jsx("h3",{children:"3. Messages above 5000 costs 5 Tsh@Message"})]})}),e.jsx(u.Item,{name:"messages",label:"Total Messages (5 Tsh per message)",rules:[{type:"number",min:100,message:"Minimum number of messages is 100"}],children:e.jsx(Ie.InputNumber,{min:100,style:{width:"100%"}})}),e.jsx(u.Item,{name:"phone",label:"Phone Number",rules:[{required:!0,message:"Please Enter Phone Number ..."}],children:e.jsx(O,{placeholder:"Enter Phone Number"})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(I,{type:"primary",size:"large",htmlType:"submit",children:"Purchase"})})]}),a===2&&e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Total Messages: 100"}),e.jsx("h3",{children:"Total Amount: 1000"}),e.jsx("h3",{children:"Phone Number: 0712345678"})]}),e.jsxs("div",{children:[e.jsx(I,{type:"primary",size:"large",style:{float:"left"},onClick:()=>s(1),children:"Back"}),e.jsx(I,{type:"primary",size:"large",style:{float:"right"},onClick:()=>s(3),children:"Pay"})]})]})]})},ss=r=>{const[o,a]=t.useState(!1),[s,m]=t.useState(),{push:n}=se(),[x,i]=t.useState(!1),y=!Ue.useBreakpoint().lg,q=async()=>{a(!0);const{data:k}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolAnalytic",fields:["analytics"]}}).catch(()=>(p.remove(),p.error("Error fetching analytics"),{data:null})).then(_=>_);k&&m(k.analytics),a(!1)};return t.useEffect(()=>{q()},[r.randKey]),e.jsxs(e.Fragment,{children:[e.jsxs(Ie.Skeleton,{loading:o,children:[e.jsxs(U,{style:{display:"flex",justifyContent:"center"},children:[e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>i(!0),children:e.jsx(P,{children:e.jsx(B,{title:"Balances (Units)",value:s==null?void 0:s.balances,precision:0,valueStyle:{color:"#3f8600"}})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>n("/njiwa/channels"),children:e.jsx(P,{children:e.jsx(B,{title:"Channels",value:s==null?void 0:s.channels,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>n("/njiwa/contacts/phonenumbers"),children:e.jsx(P,{children:e.jsx(B,{title:"Phone Numbers",value:s==null?void 0:s.phone_numbers,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>n("/njiwa/contacts/emails"),children:e.jsx(P,{children:e.jsx(B,{title:"Emails",value:s==null?void 0:s.emails,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>n("/njiwa/messages"),children:e.jsx(P,{children:e.jsx(B,{title:"Messages",value:s==null?void 0:s.messages,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>n("/njiwa/messages/sent"),children:e.jsx(P,{children:e.jsx(B,{title:"Pending Messages",value:s==null?void 0:s.sent_messages,precision:0,valueStyle:{color:"#770622"},prefix:e.jsx(ve,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>n("/njiwa/messages/sent"),children:e.jsx(P,{children:e.jsx(B,{title:"Sent Messages",value:s==null?void 0:s.sent_messages,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>n("/njiwa/messages/failed"),children:e.jsx(P,{children:e.jsx(B,{title:"Failed Messages",value:s==null?void 0:s.failed_messages,precision:0,valueStyle:{color:"#861400"},prefix:e.jsx(ve,{})})})})})]}),e.jsxs(U,{children:[e.jsx(g,{span:12,children:e.jsxs("div",{style:{marginTop:20},children:[e.jsx("span",{style:{fontSize:16,fontWeight:"bolder"},children:"Messages"}),e.jsx(ke,{dash:!0})]})}),e.jsx(g,{span:12,children:e.jsx("div",{style:{marginTop:20},children:e.jsx($e,{})})})]})]}),e.jsx($,{title:"Purchase Messages",open:x,onClose:k=>i(k),width:y?"100vw":"30vw",children:e.jsx(es,{onFinish:()=>i(!1)})})]})},ts=()=>(t.useEffect(()=>{document.title=G.system_name+": Njiwa"},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(D,{to:"/njiwa",children:"Home"})}),e.jsx("span",{children:"Channels"})]})}),e.jsx(ss,{})]})),{TextArea:ns}=O,Ee=r=>{const o=async a=>{const{data:s}=await v.custom({url:"",method:"post",meta:{operation:"createNjiwaChannel",variables:{name:{value:a.name,type:"String",required:!0},description:{value:a.description,type:"String",required:!1}},fields:["success","message",{njiwaChannel:["id","name","description","code","icon","created","updated","isActive","canDelete","canEdit","canManage"]}]}}).catch(m=>(p.error("Error creating channel"),{data:null})).then(m=>m);s&&(s.success?(p.success(s.message),r.onFinish(s.njiwaChannel)):p.error(s.message))};return t.useEffect(()=>{},[r.randKey]),e.jsx(e.Fragment,{children:e.jsxs(u,{layout:"vertical",form:r.form,onFinish:a=>{o(a)},requiredMark:!0,children:[e.jsx(u.Item,{name:"name",label:"Name",rules:[{required:!0,type:"string",message:"Please input Channel Name ..."}],children:e.jsx(O,{size:"large",placeholder:"Enter Channel Name ..."})}),e.jsx(u.Item,{name:"description",label:"Description",rules:[{required:!1,type:"string",message:"Please input Description"}],children:e.jsx(ns,{rows:4})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(I,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},{TextArea:as}=O,rs=r=>{const o=async a=>{var m;const{data:s}=await v.custom({url:"",method:"post",meta:{operation:"updateNjiwaChannel",variables:{channelId:{value:(m=r.channel)==null?void 0:m.id,type:"Int",required:!0},name:{value:a.name,type:"String",required:!0},description:{value:a.description,type:"String",required:!1}},fields:["success","message",{njiwaChannel:["id","name","description","code","icon","created","updated","isActive","canDelete","canEdit","canManage"]}]}}).catch(n=>(p.error("Error Updating channel"),{data:null})).then(n=>n);s&&(s.success?(p.success(s.message),r.onFinish(s.njiwaChannel)):p.error(s.message))};return t.useEffect(()=>{var a,s;r.form.setFieldsValue({name:(a=r.channel)==null?void 0:a.name,description:(s=r.channel)==null?void 0:s.description})},[r.randKey]),e.jsx(e.Fragment,{children:e.jsxs(u,{layout:"vertical",form:r.form,onFinish:a=>{o(a)},requiredMark:!0,autoComplete:"off",children:[e.jsx(u.Item,{name:"name",label:"Name",rules:[{required:!0,type:"string",message:"Please input Channel Name"}],children:e.jsx(O,{size:"large",placeholder:"Enter Channel Name ..."})}),e.jsx(u.Item,{name:"description",label:"Description",rules:[{required:!1,type:"string",message:"Please input Description"}],children:e.jsx(as,{rows:4,maxLength:6})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(I,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},is=r=>{const[o,a]=t.useState([]),[s,m]=t.useState(),[n,x]=t.useState(!1),[i,c]=t.useState(!1),[y,q]=t.useState(0),[k,_]=t.useState(1),[K,H]=t.useState(30),[b,N]=t.useState(""),{push:S}=se(),[F,T]=t.useState(!1),[V,R]=t.useState(!1),[l]=u.useForm(),[w]=u.useForm(),[E]=u.useForm(),Z=d=>{_(d),z(d,b,K)},te=d=>{m(d),R(!0)},ae=()=>{T(!0)},ie=async d=>{a([d,...o]),l.resetFields(),T(!1)},re=async d=>{const h=o.findIndex(f=>f.id===d.id);o[h]=d,a([...o]),w.resetFields(),R(!1)},j=async d=>{const{data:h}=await v.custom({url:"",method:"post",meta:{operation:"deleteNjiwaChannel",variables:{channelId:{value:d,type:"Int",required:!0}},fields:["success","message"]}}).catch(f=>(p.error(f.message),{data:null})).then(f=>f);h&&(h.success?(p.success(h.message),a(o.filter(f=>f.id.toString()!==d.toString()))):p.error(h.message))},M=d=>{fe.confirm({title:e.jsxs(e.Fragment,{children:["Deleting ",d.name," Channel"]}),icon:e.jsx(je,{}),content:"Are you sure ...",okText:"Yes",cancelText:"Cancel",onOk:()=>j(parseInt(d.id.toString()))})},z=async(d,h,f=20)=>{x(!0);const{data:A}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannels",variables:{page:{value:d,type:"Int",required:!0},key:{value:h,type:"String",required:!1},pageSize:{value:f,type:"Int",required:!0}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","name","code","description","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(J=>(p.error("Error fetching channels"),{data:null})).then(J=>J);A&&(q(A.total),a(A.results)),x(!1),c(!1)};return t.useEffect(()=>{z(1,b,K)},[r.randKey]),e.jsxs(e.Fragment,{children:[e.jsxs(U,{children:[e.jsx(g,{span:14,children:e.jsx(u,{layout:"vertical",form:E,onFinish:d=>{N(d.key),c(!0),z(0,d.key,K)},children:e.jsx(u.Item,{name:"key",children:e.jsx(O,{size:"large",disabled:i,placeholder:"Search Channel(s)...",prefix:e.jsx(Q,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(g,{span:6,style:{display:"flex",justifyContent:"flex-start"},children:e.jsx(I,{size:"large",icon:e.jsx(Q,{}),onClick:()=>{E.submit()},loading:i||n,disabled:i||n})}),e.jsx(g,{span:4,style:{display:"flex",justifyContent:"flex-end"},children:e.jsxs(I,{size:"large",disabled:n||i,onClick:()=>{l.resetFields(),ae()},children:[e.jsx(me,{}),"Create Channel"]})})]}),e.jsxs(pe,{spinning:n,size:"large",children:[e.jsxs(U,{align:"top",children:[o.length===0&&!n&&e.jsx(g,{span:24,style:{display:"flex",justifyContent:"center"},children:e.jsx(he,{image:"/images/nodata.png",imageStyle:{height:160},description:e.jsx("span",{style:{fontSize:16},children:"No Communication Channel Found ..."}),children:e.jsx(I,{type:"primary",onClick:()=>{l.resetFields(),ae()},children:"Create Channel Now"})})}),o.map(d=>e.jsx(g,{span:4,children:e.jsxs(P,{hoverable:d.isActive,style:{marginRight:10},children:[e.jsx(ee,{style:{right:0,position:"absolute"},children:e.jsx(oe,{trigger:["click"],overlay:e.jsxs(L,{children:[e.jsx(L.Item,{icon:e.jsx(xe,{}),onClick:()=>{te(d)},disabled:!(d!=null&&d.canDelete),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Edit"})}),e.jsx(L.Item,{icon:e.jsx(de,{}),onClick:()=>{M(d)},disabled:!(d!=null&&d.canDelete),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Delete"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:h=>h.preventDefault(),children:e.jsx(ce,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})}),e.jsx("a",{onClick:()=>S("/njiwa/channel/"+d.id+"/"+d.name),children:e.jsxs(ee,{direction:"vertical",align:"center",style:{width:"100%",justifyContent:"center"},onClick:()=>{},children:[e.jsx(Ne,{size:{xs:24,sm:32,md:40,lg:40,xl:40,xxl:80},icon:e.jsx(Ke,{}),src:d.icon}),e.jsx(le,{title:d.name,children:d.name.length>10?d.name.substring(0,10)+"...":d.name}),e.jsx("span",{children:e.jsx(Y,{color:"green",children:d.code})})]})})]})}))]}),o.length>0&&e.jsx(U,{style:{display:"flex",justifyContent:"center"},children:e.jsx("span",{style:{marginTop:20},children:e.jsx(Oe,{showQuickJumper:!0,showTotal:(d,h)=>`Total ${d} Channels`,defaultCurrent:k,total:y,pageSize:K,onChange:Z,showSizeChanger:!0,onShowSizeChange:(d,h)=>{H(h),z(d,b,h)},disabled:n||i})})})]}),e.jsx($,{title:"Create Njiwa Channel",width:"40vw",open:F,onClose:d=>T(d),children:e.jsx(Ee,{form:l,randKey:Math.random(),onFinish:ie})}),e.jsx($,{title:"Edit "+(s==null?void 0:s.name)+" Channel",width:"40vw",open:V,onClose:d=>R(d),children:e.jsx(rs,{form:w,randKey:Math.random(),onFinish:re,channel:s})})]})},ls=()=>(t.useEffect(()=>{document.title=G.system_name+": Channels"},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:5,marginBottom:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(D,{to:"/njiwa",children:"Home"})}),e.jsx("span",{children:"Channels"})]})}),e.jsx(is,{randKey:Math.random()})]})),os=r=>(t.useEffect(()=>{},[r.randKey]),e.jsx(e.Fragment,{children:e.jsx("p",{children:"Channel Emails"})})),ds=r=>{const[o,a]=t.useState(!1),[s,m]=t.useState(),n=X(),x=async()=>{a(!0);const{data:i}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannel",variables:{channelId:{value:parseInt(n.channelId),type:"Int",required:!0}},fields:["id","name","description","code","isActive","created","updated","canEdit","canDelete","canManage"]}}).catch(c=>(p.error("Error fetching channel"),{data:null})).then(c=>c);i&&m(i),a(!1)};return t.useEffect(()=>{document.title=G.system_name+": Channel Emails",x()},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:5,marginBottom:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(D,{to:"/njiwa",children:"Home"})}),e.jsx(C.Item,{children:e.jsx(D,{to:"/njiwa/channels",children:"Channels"})}),e.jsx(C.Item,{children:e.jsxs(D,{to:"/njiwa/channel/"+(s==null?void 0:s.id)+"/"+(s==null?void 0:s.name),children:[s==null?void 0:s.name,e.jsx("span",{style:{marginLeft:10},children:e.jsx(Y,{color:"green",children:s==null?void 0:s.code})})]})}),e.jsx("span",{children:"Emails"})]})}),e.jsx(os,{randKey:Math.random(),channel:s})]})},cs=r=>(t.useEffect(()=>{},[r.randKey]),e.jsx(e.Fragment,{children:e.jsx("p",{children:"Channel Failed Messages"})})),hs=r=>{const[o,a]=t.useState(!1),[s,m]=t.useState(),n=X(),x=async()=>{a(!0);const{data:i}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannel",variables:{channelId:{value:parseInt(n.channelId),type:"Int",required:!0}},fields:["id","name","description","code","isActive","created","updated","canEdit","canDelete","canManage"]}}).catch(c=>(p.error("Error fetching channel"),{data:null})).then(c=>c);i&&m(i),a(!1)};return t.useEffect(()=>{document.title=G.system_name+": Failed Messages",x()},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(D,{to:"/njiwa",children:"Home"})}),e.jsx(C.Item,{children:e.jsx(D,{to:"/njiwa/channels",children:"Channels"})}),e.jsx(C.Item,{children:e.jsxs(D,{to:"/njiwa/channel/"+(s==null?void 0:s.id)+"/"+(s==null?void 0:s.name),children:[s==null?void 0:s.name,e.jsx("span",{style:{marginLeft:10},children:e.jsx(Y,{color:"green",children:s==null?void 0:s.code})})]})}),e.jsx(C.Item,{children:"Messages"}),e.jsx("span",{children:"Failed"})]})}),e.jsx(cs,{randKey:Math.random(),channel:s})]})},{TextArea:us}=O,ms=r=>{const o=X(),a=async s=>{const{data:m}=await v.custom({url:"",method:"post",meta:{operation:"createNjiwaChannelMessage",variables:{channelId:{value:parseInt(o.channelId),type:"Int",required:!0},message:{value:s.message,type:"String",required:!1}},fields:["success","message",{njiwaChannelMessage:["id","message",{channel:["id","name","code"]},{creator:["id","firstName","middleName","lastName","fullName"]},"messageCount","created","updated","isActive","canDelete","canEdit","canManage"]}]}}).catch(n=>(p.error("Error creating channel message"),{data:null})).then(n=>n);m&&(m.success?(p.success(m.message),r.onFinish(m.njiwaChannelMessage)):p.error(m.message))};return t.useEffect(()=>{},[r.randKey]),e.jsx(e.Fragment,{children:e.jsxs(u,{layout:"vertical",form:r.form,onFinish:s=>{a(s)},requiredMark:!0,children:[e.jsx(u.Item,{name:"message",label:"Message",rules:[{required:!0,type:"string",message:"Please input Message"}],children:e.jsx(us,{rows:4})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(I,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},{TextArea:xs}=O,ps=r=>{X();const o=async a=>{const{data:s}=await v.custom({url:"",method:"post",meta:{operation:"updateNjiwaChannelMessage",variables:{channelMessageId:{value:a.channel_message_id,type:"Int",required:!0},message:{value:a.message,type:"String",required:!1}},fields:["success","message",{njiwaChannelMessage:["id","message",{channel:["id","name","code"]},{creator:["id","firstName","middleName","lastName","fullName"]},"created","updated","isActive","canDelete","canEdit","canManage"]}]}}).catch(m=>(p.error("Error creating channel message"),{data:null})).then(m=>m);s&&(s.success?(p.success(s.message),r.onFinish(s.njiwaChannelMessage)):p.error(s.message))};return t.useEffect(()=>{var a;r.form.setFieldsValue({message:(a=r==null?void 0:r.channelMessage)==null?void 0:a.message})},[r.randKey]),e.jsx(e.Fragment,{children:e.jsxs(u,{layout:"vertical",form:r.form,onFinish:a=>{var s;a.channel_message_id=(s=r.channelMessage)==null?void 0:s.id,o(a)},requiredMark:!0,children:[e.jsx(u.Item,{name:"message",label:"Message",rules:[{required:!0,type:"string",message:"Please input Message"}],children:e.jsx(xs,{rows:4})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(I,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},js=r=>{const[o,a]=t.useState([]),[s,m]=t.useState(),[n,x]=t.useState(!1),[i,c]=t.useState(!1),[y,q]=t.useState(20);t.useState(""),se();const[k,_]=t.useState(!1),[K,H]=t.useState(!1),[b,N]=t.useState(!1),[S]=u.useForm(),[F]=u.useForm(),[T]=u.useForm(),V=X(),R=j=>{m(j),N(!0)},l=j=>{m(j),H(!0)},w=()=>{_(!0)},E=async j=>{a([j,...o]),S.resetFields(),_(!1)},Z=async j=>{a(o.map(M=>M.id.toString()===j.id.toString()?j:M)),F.resetFields(),H(!1)},te=async j=>{const{data:M}=await v.custom({url:"",method:"post",meta:{operation:"deleteNjiwaChannelMessage",variables:{channelMessageId:{value:j,type:"Int",required:!0}},fields:["success","message"]}});M.success?(p.success(M.message),a(o.filter(z=>z.id.toString()!==j.toString()))):p.error(M.message)},ae=async j=>{p("dispatching");const{data:M}=await v.custom({url:"",method:"post",meta:{operation:"dispatchChannelMessage",variables:{channelMessageId:{value:j,type:"Int",required:!0}},fields:["success","message"]}}).catch(z=>(p.error(z.message),{data:null})).then(z=>z);M&&(M.success?p.success(M.message):p.error(M.message))},ie=j=>{fe.confirm({title:"Deleting Njiwa Channel Message",icon:e.jsx(je,{}),content:"Are you sure ...",okText:"Delete",cancelText:"Cancel",onOk:()=>te(parseInt(j.toString()))})},re=async(j,M,z=20)=>{const{data:d}=await v.custom({url:"",method:"get",meta:{operation:"njiwaChannelMessages",variables:{page:{value:j,type:"Int",required:!0},key:{value:M,type:"String",required:!1},pageSize:{value:z,type:"Int",required:!1},channelId:{value:parseInt(V.channelId),type:"Int",required:!0}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","message",{channel:["id","name","code"]},{creator:["id","firstName","middleName","lastName","fullName"]},"messageCount","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(h=>(p.error("Failed to fetch Channel Messages"),{data:null})).then(h=>h);d&&a(d.results),x(!1),c(!1)};return t.useEffect(()=>{re(1,"",20)},[r.randKey]),e.jsxs(e.Fragment,{children:[e.jsxs(U,{children:[e.jsx(g,{span:14,children:e.jsx(u,{layout:"vertical",form:T,onFinish:j=>{c(!0),re(0,j.key,y)},children:e.jsx(u.Item,{name:"key",children:e.jsx(O,{size:"large",disabled:i,placeholder:"Search Channel Message(s)...",prefix:e.jsx(Q,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(g,{span:6,style:{display:"flex",justifyContent:"flex-start"},children:e.jsx(I,{size:"large",icon:e.jsx(Q,{}),onClick:()=>{T.submit()},loading:i||n,disabled:i||n})}),e.jsx(g,{span:4,style:{display:"flex",justifyContent:"flex-end"},children:e.jsxs(I,{size:"large",disabled:n||i,onClick:()=>{S.resetFields(),w()},children:[e.jsx(me,{}),"Create Message"]})})]}),e.jsx(pe,{spinning:n,children:e.jsxs(U,{align:"top",children:[o.length===0&&!n&&e.jsx(g,{span:24,style:{display:"flex",justifyContent:"center"},children:e.jsx(he,{image:"/images/nodata.png",imageStyle:{height:160},description:e.jsx("span",{style:{fontSize:16},children:"No Communication Channel Found ..."}),children:e.jsx(I,{type:"primary",onClick:()=>{S.resetFields(),w()},children:"Create Message"})})}),o.map(j=>{var M;return e.jsx(g,{span:24,children:e.jsxs(P,{hoverable:j.isActive,style:{marginRight:10},children:[e.jsx(ee,{style:{right:0,position:"absolute"},children:e.jsx(oe,{trigger:["click"],overlay:e.jsxs(L,{children:[e.jsx(L.Item,{icon:e.jsx(xe,{}),onClick:()=>{l(j)},disabled:!(j!=null&&j.canDelete),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Edit"})}),e.jsx(L.Item,{icon:e.jsx(de,{}),onClick:()=>{ie(j.id)},disabled:!(j!=null&&j.canDelete),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Delete"})}),e.jsx(L.Item,{icon:e.jsx(Se,{}),disabled:!(j!=null&&j.canDelete),children:e.jsx(ge,{title:"Are you sure to Start Sending/Dispatching SMS?",onConfirm:()=>ae(j.id),onCancel:()=>{},okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Dispatch"})})}),e.jsx(L.Item,{icon:e.jsx(Ve,{}),onClick:()=>{R(j)},disabled:!(j!=null&&j.canDelete),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Dispatch Report"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:z=>z.preventDefault(),children:e.jsx(ce,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})}),e.jsxs(ee,{direction:"vertical",style:{width:"100%",justifyContent:"center"},onClick:()=>{},children:[e.jsx("span",{children:j.message}),e.jsxs(ee,{direction:"horizontal",children:[e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Created On:"}),e.jsx("span",{style:{marginLeft:5},children:ne(j.created).format("YYYY/MM/DD HH:MM")})]}),e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Created By:"}),e.jsx("span",{style:{marginLeft:5},children:(M=j==null?void 0:j.creator)==null?void 0:M.fullName})]}),e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Channel:"}),e.jsx("span",{style:{marginLeft:5},children:j==null?void 0:j.channel.name})]}),e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Message Count:"}),e.jsx("span",{style:{marginLeft:5},children:e.jsx(Y,{color:"green",children:j==null?void 0:j.messageCount})})]})]})]})]})})})]})}),e.jsx($,{title:"Create Njiwa Channel Message",width:"40vw",open:k,onClose:j=>_(j),children:e.jsx(ms,{form:S,randKey:Math.random(),onFinish:E})}),e.jsx($,{title:"Edit Njiwa Channel Message",width:"40vw",open:K,onClose:j=>H(j),children:e.jsx(ps,{form:F,randKey:Math.random(),onFinish:Z,channelMessage:s})}),e.jsx($,{title:"Dispatch Report",width:"50vw",open:b,onClose:j=>N(j),children:e.jsx(Fe,{randKey:Math.random(),channelMessage:s})})]})},gs=r=>{const[o,a]=t.useState(!1),[s,m]=t.useState(),n=X(),x=async()=>{a(!0);const{data:i}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannel",variables:{channelId:{value:parseInt(n.channelId),type:"Int",required:!0}},fields:["id","name","description","code","isActive","created","updated","canEdit","canDelete","canManage"]}}).catch(c=>(p.error("Error fetching channel"),{data:null})).then(c=>c);i&&m(i),a(!1)};return t.useEffect(()=>{document.title=G.system_name+": Channel Messages",x()},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(D,{to:"/njiwa",children:"Home"})}),e.jsx(C.Item,{children:e.jsx(D,{to:"/njiwa/channels",children:"Channels"})}),e.jsx(C.Item,{children:e.jsxs(D,{to:"/njiwa/channel/"+(s==null?void 0:s.id)+"/"+(s==null?void 0:s.name),children:[s==null?void 0:s.name,e.jsx("span",{style:{marginLeft:10},children:e.jsx(Y,{color:"green",children:s==null?void 0:s.code})})]})}),e.jsx("span",{children:"Messages"})]})}),e.jsx(js,{randKey:Math.random(),channel:s})]})},fs=r=>{const o=X(),{push:a}=se(),[s,m]=t.useState(!1),[n,x]=t.useState(),i=async()=>{m(!0);const{data:c}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannelAnalytic",variables:{channelId:{value:parseInt(o.channelId),type:"Int",required:!0}},fields:["analytics"]}}).catch(y=>(p.error("Error fetching analytics"),{data:null})).then(y=>y);c&&x(c.analytics),m(!1)};return t.useEffect(()=>{i()},[r.randKey]),e.jsx(e.Fragment,{children:e.jsxs(U,{style:{display:"flex",justifyContent:"center",marginTop:10},children:[e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>{var c,y;return a("/njiwa/channel/"+((c=r.channel)==null?void 0:c.id)+"/"+((y=r.channel)==null?void 0:y.name)+"/phonenumbers")},children:e.jsx(P,{children:e.jsx(B,{title:"Phone Numbers",value:n==null?void 0:n.phone_numbers,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>{},children:e.jsx(P,{children:e.jsx(B,{title:"Emails",value:n==null?void 0:n.emails_addresses,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>{var c,y;return a("/njiwa/channel/"+((c=r.channel)==null?void 0:c.id)+"/"+((y=r.channel)==null?void 0:y.name)+"/messages")},children:e.jsx(P,{children:e.jsx(B,{title:"Messages",value:n==null?void 0:n.messages,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>{},children:e.jsx(P,{children:e.jsx(B,{title:"Pending Messages",value:n==null?void 0:n.pending_messages,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>{},children:e.jsx(P,{children:e.jsx(B,{title:"Sent Messages",value:n==null?void 0:n.sent_messages,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>{},children:e.jsx(P,{children:e.jsx(B,{title:"Failed Messages",value:n==null?void 0:n.failed_messages,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})})]})})},ys=r=>{const[o,a]=t.useState(!1),[s,m]=t.useState(),n=X(),x=async()=>{a(!0);const{data:i}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannel",variables:{channelId:{value:parseInt(n.channelId),type:"Int",required:!0}},fields:["id","name","description","code","isActive","created","updated","canEdit","canDelete","canManage"]}}).catch(c=>(p.error("Error fetching channel"),{data:null})).then(c=>c);i&&m(i),a(!1)};return t.useEffect(()=>{document.title=G.system_name+": Channel",x()},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(D,{to:"/njiwa",children:"Home"})}),e.jsx(C.Item,{children:e.jsx(D,{to:"/njiwa/channels",children:"Channels"})}),e.jsxs("span",{children:[s==null?void 0:s.name,e.jsx("span",{style:{marginLeft:10},children:e.jsx(Y,{color:"green",children:s==null?void 0:s.code})})]})]})}),e.jsx(fs,{randKey:Math.random(),channel:s})]})},{Option:Cs}=ue,Me=r=>{const[o,a]=t.useState([]),s=async n=>{const{data:x}=await v.custom({url:"",method:"post",meta:{operation:"createNjiwaChannelsPhoneNumber",variables:{phoneNumber:{value:n.phoneNumber,type:"String",required:!0},name:{value:n.name,type:"String",required:!1},channels:{value:n.channels,type:"[Int]",required:!0}},fields:["success","message"]}}).catch(i=>(p.error("Error creating channels phone number"),{data:null})).then(i=>i);x&&(x.success?(p.success(x.message),r.onFinish(x.njiwaChannel)):p.error(x.message))},m=async(n,x,i=20)=>{const{data:c}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannels",variables:{page:{value:n,type:"Int",required:!0},key:{value:x,type:"String",required:!1},pageSize:{value:i,type:"Int",required:!0}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","name","code","description","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(y=>(p.error("Error fetching channels"),{data:null})).then(y=>y);c&&a(c.results)};return t.useEffect(()=>{m(1,"",50)},[r.randKey]),e.jsx(e.Fragment,{children:e.jsxs(u,{layout:"vertical",form:r.form,onFinish:n=>{n.channels=n.channels.map(x=>parseInt(x)),s(n)},requiredMark:!0,autoComplete:"off",children:[e.jsx(u.Item,{name:"phoneNumber",label:"Phone Number",rules:[{required:!0,type:"string",message:"Please input Phone Number"}],children:e.jsx(O,{size:"large",placeholder:"Enter Phone Number ..."})}),e.jsx(u.Item,{name:"name",label:"Full Name",rules:[{required:!1,type:"string",message:"Please input Full Name"}],children:e.jsx(O,{size:"large",placeholder:"Enter Full Name ..."})}),e.jsx(u.Item,{name:"channels",label:"Channels",rules:[{required:!0,type:"array",message:"Please select Channel(s)..."}],children:e.jsx(ue,{size:"large",mode:"multiple",allowClear:!0,style:{width:"100%"},placeholder:"Please select",defaultValue:[],dropdownStyle:{zIndex:9999},children:o.map(n=>e.jsxs(Cs,{value:n.id,children:[n.name,e.jsx("span",{style:{marginLeft:5},children:e.jsx(Y,{color:"green",children:n.code})})]},n.id))})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(I,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},Pe=r=>{const o=async a=>{var m;const{data:s}=await v.custom({url:"",method:"post",meta:{operation:"updateNjiwaPhoneNumber",variables:{phoneNumberId:{value:(m=r.phoneNumber)==null?void 0:m.id,type:"Int",required:!0},phoneNumber:{value:a.phoneNumber,type:"String",required:!0},name:{value:a.name,type:"String",required:!1}},fields:["success","message",{phoneNumber:["id","name","phoneNumber","countryCode",{carrier:["id","name"]},{user:["id","fullName","firstName","lastName"]},{owner:["id","fullName","firstName","lastName"]},"isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(n=>(p.error("Error Updating Phone number"),{data:null})).then(n=>n);s&&(s.success?(p.success(s.message),r.onFinish(s.phoneNumber)):p.error(s.message))};return t.useEffect(()=>{var a,s;r.form.setFieldsValue({phoneNumber:(a=r.phoneNumber)==null?void 0:a.phoneNumber,name:(s=r.phoneNumber)==null?void 0:s.name})},[r.randKey]),e.jsx(e.Fragment,{children:e.jsxs(u,{layout:"vertical",form:r.form,onFinish:a=>{o(a)},requiredMark:!0,autoComplete:"off",children:[e.jsx(u.Item,{name:"phoneNumber",label:"Phone Number",rules:[{required:!0,type:"string",message:"Please input Phone Number"}],children:e.jsx(O,{size:"large",placeholder:"Enter Phone Number ..."})}),e.jsx(u.Item,{name:"name",label:"Full Name",rules:[{required:!1,type:"string",message:"Please input Full Name"}],children:e.jsx(O,{size:"large",placeholder:"Enter Full Name ..."})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(I,{type:"primary",size:"large",htmlType:"submit",children:"Update"})})]})})},{Option:bs}=ue,vs=r=>Array.isArray(r)?r:r==null?void 0:r.fileList,De=r=>{const[o,a]=t.useState([]),s=async n=>{const{data:x}=await v.custom({url:"",method:"post",meta:{operation:"uploadNjiwaChannelsPhoneNumbers",variables:{channels:{value:n.channels,type:"[Int]",required:!0},file:{value:n.file,type:"Upload",required:!0}},fields:["success","message"]}}).catch(i=>(p.error("Error creating channels phone number"),{data:null})).then(i=>i);x&&(x.success?(p.success(x.message),r.onFinish(x.njiwaChannel)):p.error(x.message))},m=async(n,x,i=20)=>{const{data:c}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannels",variables:{page:{value:n,type:"Int",required:!0},key:{value:x,type:"String",required:!1},pageSize:{value:i,type:"Int",required:!0}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","name","code","description","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(y=>(p.error("Error fetching channels"),{data:null})).then(y=>y);c&&a(c.results)};return t.useEffect(()=>{m(1,"",50)},[r.randKey]),e.jsxs(e.Fragment,{children:[e.jsx("span",{children:e.jsxs("a",{target:"_blank",href:G.base_url+"/static/templates/njiwa_channels_phone_numbers_template.xlsx",rel:"noreferrer",children:["Download Excel Template ",e.jsx(Re,{})]})}),e.jsxs(u,{layout:"vertical",form:r.form,onFinish:n=>{n.channels=n.channels.map(x=>parseInt(x)),s(n)},requiredMark:!0,autoComplete:"off",children:[e.jsx(u.Item,{label:"Contacts File(Excel)",children:e.jsx(u.Item,{name:"file",valuePropName:"fileList",getValueFromEvent:vs,noStyle:!0,rules:[{required:!0,type:"array",message:"Please upload students excel file"}],children:e.jsxs(We.Dragger,{name:"file",accept:".xls, .xlsx",multiple:!1,beforeUpload:()=>!1,children:[e.jsx("p",{className:"ant-upload-drag-icon",children:e.jsx(Be,{})}),e.jsx("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"}),e.jsx("p",{className:"ant-upload-hint",children:"Support for a single or bulk upload."})]})})}),e.jsx(u.Item,{name:"channels",label:"Channels",rules:[{required:!0,type:"array",message:"Please select Channel(s)..."}],children:e.jsx(ue,{size:"large",mode:"multiple",allowClear:!0,style:{width:"100%"},placeholder:"Please select",defaultValue:[],dropdownStyle:{zIndex:9999},children:o.map(n=>e.jsxs(bs,{value:n.id,children:[n.name,e.jsx("span",{style:{marginLeft:5},children:e.jsx(Y,{color:"green",children:n.code})})]},n.id))})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(I,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})]})},Ss=r=>{const[o,a]=t.useState([]),[s,m]=t.useState(),[n,x]=t.useState(!1),[i,c]=t.useState(!1),[y,q]=t.useState(20),[k,_]=t.useState(0),[K,H]=t.useState("");se();const[b,N]=t.useState(!1),[S,F]=t.useState(!1),[T,V]=t.useState(!1),[R]=u.useForm(),[l]=u.useForm(),[w]=u.useForm(),[E]=u.useForm(),Z=X(),te=h=>{m(h),F(!0)},ae=()=>{N(!0)},ie=async()=>{z(1,"",20),N(!1),R.resetFields()},re=async h=>{a(o.map(f=>f.id.toString()===h.id.toString()?h:f)),l.resetFields(),F(!1)},j=async()=>{z(1,"",20),w.resetFields(),V(!1)},M=async h=>{const{data:f}=await v.custom({url:"",method:"post",meta:{operation:"deleteNjiwaChannel",variables:{id:{value:h,type:"Int",required:!0}},fields:["success","message"]}});f.success?(p.success(f.message),a(o.filter(A=>A.id.toString()!==h.toString()))):p.error(f.message)},z=async(h,f,A=20)=>{x(!0);const{data:J}=await v.custom({url:"",method:"get",meta:{operation:"njiwaChannelPhoneNumbers",variables:{page:{value:h,type:"Int",required:!0},key:{value:f,type:"String",required:!1},pageSize:{value:A,type:"Int",required:!1},channelId:{value:parseInt(Z.channelId),type:"Int",required:!0}},fields:["pages","total","page","hasNext","hasPrev",{results:["id",{phoneContact:["id","name","phoneNumber","countryCode",{carrier:["id","name"]},{user:["id","fullName","firstName","lastName"]},{owner:["id","fullName","firstName","lastName"]}]},"isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(be=>(p.error("Error fetching phone numbers"),{data:null})).then(be=>be);J&&(_(J.total),a(J.results)),x(!1),c(!1)},d=[{title:"Phone Number",dataIndex:"phoneNumber",key:"phoneNumber",render:(h,f,A)=>e.jsx("a",{onClick:()=>{},children:f.phoneContact.phoneNumber})},{title:"Full Name",dataIndex:"fullName",key:"name",render:(h,f,A)=>e.jsx("span",{children:f.phoneContact.name})},{title:"Carrier",dataIndex:"carrier",key:"carrier",render:(h,f,A)=>{var J;return e.jsx(Y,{color:"green",children:(J=f.phoneContact.carrier)==null?void 0:J.name})}},{title:"Created",dataIndex:"created",key:"created",render:(h,f,A)=>e.jsx(le,{title:ne(f.created).format("Y-mm-d hh:mm:ss"),children:e.jsx("span",{children:ne(f.created).format("Y-mm-d hh:mm:ss")})})},{title:"",dataIndex:"Action",key:"action",render:(h,f,A)=>e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(oe,{trigger:["click"],overlay:e.jsxs(L,{children:[e.jsx(L.Item,{disabled:!f.canDelete,icon:e.jsx(de,{}),onClick:()=>{},children:e.jsx(ge,{placement:"topLeft",title:"Deleting Phone Number",onConfirm:()=>M(parseInt(f.id)),okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Delete"})})}),e.jsx(L.Item,{disabled:!f.canEdit,icon:e.jsx(xe,{}),onClick:()=>te(f),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Edit"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:J=>J.preventDefault(),children:e.jsx(ce,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})})}];return t.useEffect(()=>{z(1,"",20)},[]),e.jsxs(e.Fragment,{children:[e.jsxs(U,{children:[e.jsx(g,{span:8,children:e.jsx(u,{layout:"vertical",form:E,onFinish:h=>{c(!0),z(0,h.key,y)},children:e.jsx(u.Item,{name:"key",children:e.jsx(O,{size:"large",disabled:i,placeholder:"Search Phone Number(s)...",prefix:e.jsx(Q,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(g,{span:6,style:{display:"flex",justifyContent:"flex-start"},children:e.jsx(I,{size:"large",icon:e.jsx(Q,{}),onClick:()=>{E.submit()},loading:i||n,disabled:i||n})}),e.jsxs(g,{span:10,style:{display:"flex",justifyContent:"flex-end"},children:[e.jsx(I,{size:"large",disabled:n||i,onClick:()=>{R.resetFields(),ae()},icon:e.jsx(me,{}),children:"Add Phone Number"}),e.jsx(I,{size:"large",disabled:n||i,onClick:()=>V(!0),icon:e.jsx(we,{}),children:"Upload Phone Numbers"})]})]}),e.jsx(Ce,{loading:n,columns:d,dataSource:o,pagination:{onChange:(h,f)=>{q(f),z(h,K,f)},total:k,pageSize:y,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0}}),e.jsx($,{title:"Adding Phone Number",width:"40vw",open:b,onCancel:h=>N(h),children:e.jsx(Me,{form:R,onFinish:ie,randKey:Math.random()})}),e.jsx($,{title:"Editting Phone Number",width:"40vw",open:S,onClose:h=>F(h),children:e.jsx(Pe,{form:l,onFinish:re,randKey:Math.random()})}),e.jsx($,{title:"Uploading Phone Numbers",width:"40vw",open:T,onClose:h=>V(h),children:e.jsx(De,{form:w,onFinish:j,randKey:Math.random()})})]})},ws=r=>{const[o,a]=t.useState(!1),[s,m]=t.useState(),n=X(),x=async()=>{a(!0);const{data:i}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannel",variables:{channelId:{value:parseInt(n.channelId),type:"Int",required:!0}},fields:["id","name","description","code","isActive","created","updated","canEdit","canDelete","canManage"]}}).catch(c=>(p.error("Error fetching channel"),{data:null})).then(c=>c);i&&m(i),a(!1)};return t.useEffect(()=>{document.title=G.system_name+": Phone Numbers",x()},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(D,{to:"/njiwa",children:"Home"})}),e.jsx(C.Item,{children:e.jsx(D,{to:"/njiwa/channels",children:"Channels"})}),e.jsx(C.Item,{children:e.jsxs(D,{to:"/njiwa/channel/"+(s==null?void 0:s.id)+"/"+(s==null?void 0:s.name),children:[s==null?void 0:s.name,e.jsx("span",{style:{marginLeft:10},children:e.jsx(Y,{color:"green",children:s==null?void 0:s.code})})]})}),e.jsx("span",{children:"Phone Numbers"})]})}),e.jsx(Ss,{randKey:Math.random(),channel:s})]})},Ns=r=>(t.useEffect(()=>{},[r.randKey]),e.jsx(e.Fragment,{children:e.jsx("p",{children:"Channel Sent Messages"})})),Is=r=>{const[o,a]=t.useState(!1),[s,m]=t.useState(),n=X(),x=async()=>{a(!0);const{data:i}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannel",variables:{channelId:{value:parseInt(n.channelId),type:"Int",required:!0}},fields:["id","name","description","code","isActive","created","updated","canEdit","canDelete","canManage"]}}).catch(c=>(p.error("Error fetching channel"),{data:null})).then(c=>c);i&&m(i),a(!1)};return t.useEffect(()=>{document.title=G.system_name+": Sent Messages",x()},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(D,{to:"/njiwa",children:"Home"})}),e.jsx(C.Item,{children:e.jsx(D,{to:"/njiwa/channels",children:"Channels"})}),e.jsx(C.Item,{children:e.jsxs(D,{to:"/njiwa/channel/"+(s==null?void 0:s.id)+"/"+(s==null?void 0:s.name),children:[s==null?void 0:s.name,e.jsx("span",{style:{marginLeft:10},children:e.jsx(Y,{color:"green",children:s==null?void 0:s.code})})]})}),e.jsx(C.Item,{children:"Messages"}),e.jsx("span",{children:"Sent"})]})}),e.jsx(Ns,{randKey:Math.random(),channel:s})]})},Fs=r=>{const[o,a]=t.useState([]),[s,m]=t.useState(),[n,x]=t.useState(!1),[i,c]=t.useState(!1),[y,q]=t.useState(20);t.useState(""),se();const[k,_]=t.useState(!1),[K,H]=t.useState(!1),[b]=u.useForm();u.useForm();const[N]=u.useForm(),S=l=>{m(l),H(!0)},F=()=>{_(!0)},T=async l=>{const{data:w}=await v.custom({url:"",method:"post",meta:{operation:"deleteNjiwaChannel",variables:{id:{value:l,type:"Int",required:!0}},fields:["success","message"]}});w.success?(p.success(w.message),a(o.filter(E=>E.id.toString()!==l.toString()))):p.error(w.message)},V=l=>{fe.confirm({title:"Deleting Njiwa Email Address",icon:e.jsx(je,{}),content:"Are you sure ...",okText:"Delete",cancelText:"Cancel",onOk:()=>T(parseInt(l.toString()))})},R=async(l,w,E=20)=>{const{data:Z}=await v.custom({url:"",method:"get",meta:{operation:"njiwaChannels",variables:{control:{value:!0,type:"Boolean",required:!0}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","name","icon","description","isActive","created","updated","canEdit","canDelete","canManage"]}]}});a(Z.results),x(!1),c(!1)};return t.useEffect(()=>{R(1,"",20)},[]),e.jsxs(e.Fragment,{children:[e.jsxs(U,{children:[e.jsx(g,{span:14,children:e.jsx(u,{layout:"vertical",form:N,onFinish:l=>{c(!0),R(0,l.key,y)},children:e.jsx(u.Item,{name:"key",children:e.jsx(O,{size:"large",disabled:i,placeholder:"Search Channel(s)...",prefix:e.jsx(Q,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(g,{span:6,style:{display:"flex",justifyContent:"flex-start"},children:e.jsx(I,{size:"large",icon:e.jsx(Q,{}),onClick:()=>{N.submit()},loading:i||n,disabled:i||n})}),e.jsx(g,{span:4,style:{display:"flex",justifyContent:"flex-end"},children:e.jsxs(I,{size:"large",disabled:n||i,onClick:()=>{},children:[e.jsx(me,{}),"Add Email Address"]})})]}),e.jsxs(U,{align:"top",children:[o.length===0&&e.jsx(g,{span:24,style:{display:"flex",justifyContent:"center"},children:e.jsx(he,{image:"images/nodata.png",imageStyle:{height:160},description:e.jsx("span",{style:{fontSize:16},children:"No Communication Channel Found ..."}),children:e.jsx(I,{type:"primary",onClick:()=>{b.resetFields(),F()},children:"Create Email Address Now"})})}),o.map(l=>e.jsx(g,{span:4,children:e.jsxs(P,{hoverable:l.isActive,style:{marginRight:10},children:[e.jsx(ee,{style:{right:0,position:"absolute"},children:e.jsx(oe,{trigger:["click"],overlay:e.jsxs(L,{children:[e.jsx(L.Item,{icon:e.jsx(xe,{}),onClick:()=>{S(l)},disabled:!(l!=null&&l.canDelete),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Edit"})}),e.jsx(L.Item,{icon:e.jsx(de,{}),onClick:()=>{V(l.id)},disabled:!(l!=null&&l.canDelete),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Delete"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:w=>w.preventDefault(),children:e.jsx(ce,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})}),e.jsx(ee,{direction:"vertical",align:"center",style:{width:"100%",justifyContent:"center"},onClick:()=>{},children:l.emailAddress})]})}))]}),e.jsx($,{title:"Create Njiwa Email Address",width:"40vw",open:k,onClose:l=>_(l),children:e.jsx(Ee,{})})]})},ks=()=>(t.useEffect(()=>{document.title=G.system_name+": Emails"},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(D,{to:"/njiwa",children:"Home"})}),e.jsx("span",{children:"Emails Addresses"})]})}),e.jsx(Fs,{})]})),Es=()=>(t.useEffect(()=>{document.title=G.system_name+": Messages"},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(D,{to:"/njiwa",children:"Home"})}),e.jsx("span",{children:"Messages"})]})}),e.jsx(ke,{})]})),Ms=r=>(t.useEffect(()=>{},[]),e.jsx(e.Fragment,{children:e.jsx("span",{children:"Settings"})})),Ps=()=>(t.useEffect(()=>{document.title=G.system_name+": Settings"},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(D,{to:"/njiwa",children:"Home"})}),e.jsx("span",{children:"Settings"})]})}),e.jsx(Ms,{})]})),Ds=r=>{const[o,a]=t.useState([]),[s,m]=t.useState(),[n,x]=t.useState(!1),[i,c]=t.useState(!1),[y,q]=t.useState(20),[k,_]=t.useState(0),[K,H]=t.useState("");se();const[b,N]=t.useState(!1),[S,F]=t.useState(!1),[T,V]=t.useState(!1),[R]=u.useForm(),[l]=u.useForm(),[w]=u.useForm(),[E]=u.useForm(),Z=d=>{m(d),F(!0)},te=()=>{N(!0)},ae=async()=>{M(1,"",20),N(!1),R.resetFields()},ie=async d=>{a(o.map(h=>h.id.toString()===d.id.toString()?d:h)),l.resetFields(),F(!1)},re=async()=>{M(1,"",20),w.resetFields(),V(!1)},j=async d=>{const{data:h}=await v.custom({url:"",method:"post",meta:{operation:"deleteNjiwaChannel",variables:{id:{value:d,type:"Int",required:!0}},fields:["success","message"]}});h.success?(p.success(h.message),a(o.filter(f=>f.id.toString()!==d.toString()))):p.error(h.message)},M=async(d,h,f=20)=>{x(!0);const{data:A}=await v.custom({url:"",method:"get",meta:{operation:"njiwaChannelsPhoneContacts",variables:{page:{value:d,type:"Int",required:!0},key:{value:h,type:"String",required:!1},pageSize:{value:f,type:"Int",required:!1}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","name","phoneNumber","countryCode",{carrier:["id","name"]},{user:["id","fullName","firstName","lastName"]},{owner:["id","fullName","firstName","lastName"]},"isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(J=>(p.error("Error fetching phone numbers"),{data:null})).then(J=>J);A&&(_(A.total),a(A.results)),x(!1),c(!1)},z=[{title:"Phone Number",dataIndex:"phoneNumber",key:"phoneNumber",render:(d,h,f)=>e.jsx("a",{onClick:()=>{},children:h.phoneNumber})},{title:"Full Name",dataIndex:"fullName",key:"name",render:(d,h,f)=>e.jsx("span",{children:h.name})},{title:"Carrier",dataIndex:"carrier",key:"carrier",render:(d,h,f)=>{var A;return e.jsx(Y,{color:"green",children:(A=h.carrier)==null?void 0:A.name})}},{title:"Created",dataIndex:"created",key:"created",render:(d,h,f)=>e.jsx(le,{title:ne(h.created).format("Y-mm-d hh:mm:ss"),children:e.jsx("span",{children:ne(h.created).format("Y-mm-d hh:mm:ss")})})},{title:"",dataIndex:"Action",key:"action",render:(d,h,f)=>e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(oe,{trigger:["click"],overlay:e.jsxs(L,{children:[e.jsx(L.Item,{disabled:!h.canDelete,icon:e.jsx(de,{}),onClick:()=>{},children:e.jsx(ge,{placement:"topLeft",title:"Deleting Phone Number",onConfirm:()=>j(parseInt(h.id)),okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Delete"})})}),e.jsx(L.Item,{disabled:!h.canEdit,icon:e.jsx(xe,{}),onClick:()=>Z(h),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Edit"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:A=>A.preventDefault(),children:e.jsx(ce,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})})}];return t.useEffect(()=>{M(1,"",20)},[]),e.jsxs(e.Fragment,{children:[e.jsxs(U,{children:[e.jsx(g,{span:8,children:e.jsx(u,{layout:"vertical",form:E,onFinish:d=>{c(!0),M(0,d.key,y)},children:e.jsx(u.Item,{name:"key",children:e.jsx(O,{size:"large",disabled:i,placeholder:"Search Phone Number(s)...",prefix:e.jsx(Q,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(g,{span:6,style:{display:"flex",justifyContent:"flex-start"},children:e.jsx(I,{size:"large",icon:e.jsx(Q,{}),onClick:()=>{E.submit()},loading:i||n,disabled:i||n})}),e.jsxs(g,{span:10,style:{display:"flex",justifyContent:"flex-end"},children:[e.jsx(I,{size:"large",disabled:n||i,onClick:()=>{R.resetFields(),te()},icon:e.jsx(me,{}),children:"Add Phone Number"}),e.jsx(I,{size:"large",disabled:n||i,onClick:()=>V(!0),icon:e.jsx(we,{}),children:"Upload Phone Numbers"})]})]}),e.jsx(Ce,{loading:n,columns:z,dataSource:o,pagination:{onChange:(d,h)=>{q(h),M(d,K,h)},total:k,pageSize:y,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0}}),e.jsx($,{title:"Adding Phone Number",width:"40vw",open:b,onClose:d=>N(d),children:e.jsx(Me,{form:R,onFinish:ae,randKey:Math.random()})}),e.jsx($,{title:"Editting Phone Number",width:"40vw",open:S,onClose:d=>F(d),children:e.jsx(Pe,{phoneNumber:s,form:l,onFinish:ie,randKey:Math.random()})}),e.jsx($,{title:"Uploading Phone Numbers",width:"40vw",open:T,onClose:d=>V(d),children:e.jsx(De,{form:w,onFinish:re,randKey:Math.random()})})]})},qs=()=>(t.useEffect(()=>{document.title=G.system_name+": Phone Numbers"},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(D,{to:"/njiwa",children:"Home"})}),e.jsx("span",{children:"Phone Numbers"})]})}),e.jsx(Ds,{})]})),ht=r=>{const{page:o}=r;return o==="PhoneNumbersPage"?e.jsx(qs,{}):o==="NjiwaSettingsPage"?e.jsx(Ps,{}):o==="MessagesPage"?e.jsx(Es,{}):o==="EmailsPage"?e.jsx(ks,{}):o==="ChannelSentMessagesPage"?e.jsx(Is,{}):o==="ChannelPhoneNumbersPage"?e.jsx(ws,{}):o==="ChannelPage"?e.jsx(ys,{}):o==="ChannelMessagesPage"?e.jsx(gs,{}):o==="ChannelFailedMessagesPage"?e.jsx(hs,{}):o==="ChannelEmailsPage"?e.jsx(ds,{}):o==="ChannelsPage"?e.jsx(ls,{}):o==="NjiwaDashboardPage"?e.jsx(ts,{}):e.jsx("div",{children:"Page not found ..."})};export{ht as NjiwaPages};
