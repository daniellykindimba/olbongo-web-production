import{j as e,c,I as v,B as L,r as i,R as A,d as f,e as _,gs as k,a as N,L as g,Y as B,Z as u,W as P,a5 as U,$ as V,_ as l,a0 as W,a7 as H,M as J,g as m,gJ as y,ai as Y,aj as Z}from"./index-c92f9f6b.js";const $=r=>e.jsx(e.Fragment,{children:e.jsxs(c,{layout:"vertical",form:r.form,onFinish:o=>{r.onFinish(o)},requiredMark:!1,children:[e.jsx(c.Item,{name:"link",label:"Link",rules:[{required:!0,type:"url"}],children:e.jsx(v,{size:"large",placeholder:"Enter Url Address ..."})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(L,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})}),X=r=>{const[o,d]=i.useState([]),[R,S]=i.useState(!0),[j,I]=i.useState(1),[C]=c.useForm(),[G,b]=i.useState(0),[K,D]=i.useState(0),[F,w]=i.useState(!0),[M,h]=i.useState(!1),[p]=c.useForm(),q=()=>{h(!0)},O=async s=>{const{data:t}=await m.custom({url:"",method:"post",meta:{operation:"createDarasaResourceLink",variables:{id:{value:parseInt(r.id===void 0?"0":r.id.toString()),type:"Int",required:!0},link:{value:s.link,type:"String",required:!0}},fields:["success","message",{resource:y}]}}).catch(()=>(l.error("Error creating resource link"),{data:null})).then(n=>n);t&&(t.success?(l(t.message),d([t.resource,...o]),p.resetFields(),h(!1)):l.error(t.message))},x=async(s,t="",n=!1)=>{const{data:a}=await m.custom({url:"",method:"get",meta:{operation:"darasaResources",variables:{page:{value:s,type:"Int",required:!0},key:{value:t,type:"String",required:!1},id:{value:parseInt(r.id===void 0?"0":r.id.toString()),type:"Int",required:!0}},fields:["total","page","pages","hasNext","hasPrev",{results:y}]}}).catch(()=>(l.error("Error fetching resources links"),{data:null})).then(T=>T);a&&(D(a.total),b(a.pages),I(a.page),w(a.hasNext),(t.length>0||t.length===0&&n)&&d(a.results),a.results.length>0&&!n&&d(o.concat(a.results))),S(!1)},E=async s=>{const{data:t}=await m.custom({url:"",method:"post",meta:{operation:"deleteDarasaResourceLink",variables:{id:{value:parseInt(s.toString()),type:"Int",required:!0}},fields:["success","message"]}}).catch(()=>(l.error("Error deleting resource link"),{data:null})).then(n=>n);t&&(t.success?(l.success(t.message),d(o.filter(n=>n.id!==s))):l.error(t.message))},z=s=>{Y.confirm({title:"Deleting Resource Link",icon:e.jsx(Z,{}),content:"Are you sure ...",okText:"Delete",cancelText:"Cancel",onOk:()=>E(s)})};return i.useEffect(()=>{x(j)},[]),e.jsxs(e.Fragment,{children:[e.jsxs(A,{children:[e.jsx(f,{span:20,children:e.jsx(c,{layout:"vertical",form:C,onFinish:s=>x(0,s.key,!0),children:e.jsx(c.Item,{name:"key",children:e.jsx(v,{size:"large",placeholder:"Search Resources Links...",prefix:e.jsx(_,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(f,{span:4,style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(L,{icon:e.jsx(k,{}),onClick:q,disabled:!r.canManage,size:"large",children:"Add Resource"})})]}),e.jsx("div",{id:"scrollableDiv",style:{height:"74vh",overflow:"auto"},children:e.jsxs(N,{spinning:R,children:[e.jsx(g,{itemLayout:"horizontal",dataSource:o,renderItem:s=>e.jsx("div",{style:{background:"white",marginBottom:5,paddingLeft:10,paddingTop:10},children:e.jsx(g.Item,{style:{margin:0,padding:0},actions:[e.jsx(B,{trigger:["click"],overlay:e.jsxs(u,{children:[e.jsx(u.Item,{icon:e.jsx(P,{}),children:e.jsx("a",{target:"_blank",href:s.link,rel:"noopener noreferrer",children:"Open"})}),e.jsx(u.Item,{icon:e.jsx(U,{}),disabled:!s.canDelete,onClick:()=>z(s.id),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Delete"})}),e.jsx(u.Item,{icon:e.jsx(V,{}),onClick:()=>l("Under construction"),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Report"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:t=>t.preventDefault(),children:e.jsx(W,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})],children:e.jsx(g.Item.Meta,{style:{borderBottom:"1px solid #e8e8e8"},avatar:e.jsx(k,{}),title:e.jsx("a",{href:s.link,target:"_blank",rel:"noreferrer",children:s.link}),description:e.jsxs(e.Fragment,{children:[e.jsx("p",{}),e.jsx("p",{children:e.jsx(H,{date:new Date(s.created),locale:"en-US"})})]})})},"class-resource-link-"+s.id)},"class-resource-link-item-container-"+s.id)}),F&&e.jsx("div",{style:{textAlign:"center",marginTop:12},children:e.jsx("button",{onClick:()=>{x(j+1)},children:"Load More"})})]})}),e.jsx(J,{title:"Adding Resource Link",open:M,onClose:s=>h(s),width:"50vw",children:e.jsx($,{form:p,onFinish:O})})]})};export{X as ClassResurcesLinks};
