import{r,aU as m,c as B,j as e,G as n,$ as E,c$ as L,ar as M,B as p,aZ as v,aS as T,aV as g,d0 as _,cS as H,ac as G,ct as y,d1 as W,aW as $,d2 as U,g as j,_ as h,ca as V,aO as u}from"./index-351477c3.js";import{d as Z}from"./data_objects-f008dc0a.js";import{C as J}from"./index-e245930b.js";import{A as K}from"./index-6af680ed.js";import{A as Q}from"./Alert-a3483804.js";import{M as f}from"./index-8b72edfc.js";import"./Skeleton-8f0e80db.js";import"./index-d9a31a18.js";import"./index-cbd0288c.js";import"./InfoCircleFilled-9eecc8d9.js";import"./ActionButton-40b0160f.js";import"./DialogWrap-e5db41da.js";import"./index-20e3f79b.js";import"./fade-8ee215b5.js";const X=Y=>{const[o,x]=r.useState([]),[a,S]=r.useState(!0),[A,l]=r.useState(1),[C,b]=r.useState(0),[ee,k]=r.useState(0),[F,D]=r.useState(24),[I,P]=r.useState(!0),[w,O]=r.useState(!1),[z]=m.useForm();B();const R=async t=>{const{data:s}=await j.custom({url:"",method:"post",meta:{operation:"removeDriveArchive",variables:{id:{value:t,type:"Int",required:!0}},fields:["success","message"]}});s.success?(h.success(s.message),x(o.filter(d=>d.id!==t))):h.error(s.message),f.destroyAll()},N=t=>{f.confirm({title:"Confirm",icon:e.jsx(U,{}),content:"Removing Drive From Archive ....",okText:"Add",cancelText:"Cancel",onOk:()=>R(t)})},c=async(t,s=24,d="")=>{const{data:i}=await j.custom({url:"",method:"get",meta:{operation:"drivesArchives",variables:{page:{value:t,type:"Int",required:!0},key:{value:d,type:"String",required:!1},pageSize:{value:s,type:"Int",required:!0}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{drive:Z}]}]}}).catch(()=>(h.error("Failed to load archives"),{data:null})).then(q=>q);i&&(b(i.total),l(i.page),k(i.pages),P(i.hasNext),O(i.hasPrev),x(i.results)),S(!1)};return r.useEffect(()=>{c(1)},[]),e.jsxs(e.Fragment,{children:[e.jsx(n,{container:!0,children:e.jsx(n,{item:!0,xs:12,sm:6,children:e.jsx(m,{layout:"vertical",form:z,onFinish:t=>{l(1),c(1,F,t.key)},children:e.jsx(m.Item,{name:"key",children:e.jsx(E,{size:"large",placeholder:"Search Drive(s)...",prefix:e.jsx(L,{}),autoComplete:"off",allowClear:!0,disabled:a})})})})}),e.jsx(M,{spinning:a,children:e.jsx(p,{children:o.length>0?e.jsx(n,{container:!0,children:o.map(t=>e.jsx(n,{item:!0,xs:12,sm:6,md:4,lg:4,xl:4,children:e.jsxs(J,{hoverable:t.isActive,style:{marginRight:10},children:[e.jsx(v,{style:{right:0,position:"absolute"},children:e.jsx(T,{trigger:["click"],overlay:e.jsx(g,{children:e.jsx(g.Item,{icon:e.jsx(_,{}),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",onClick:()=>N(t.id),children:"Restore"})})}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:s=>s.preventDefault(),children:e.jsx(H,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})}),e.jsx(G.Ribbon,{text:t.drive.code,placement:"start",color:"orange",children:e.jsx(y,{to:"/odrive/drive/"+t.drive.id+"/"+t.drive.code+"/files",children:e.jsxs(v,{direction:"vertical",align:"center",style:{width:"100%",justifyContent:"center"},children:[e.jsx(K,{size:{xs:24,sm:32,md:40,lg:40,xl:40,xxl:80},icon:e.jsx(W,{}),src:t.drive.icon}),e.jsx("span",{style:{fontSize:20},children:t.drive.name})]})})})]})}))}):e.jsx(Q,{severity:"info",children:a?e.jsx("b",{children:"Loading..."}):e.jsx("b",{children:"No Archives Found"})})})}),(I||w)&&!a&&e.jsx(p,{sx:{display:"flex",justifyContent:"center"},children:e.jsx($,{showSizeChanger:!0,onShowSizeChange:(t,s)=>{l(t),D(s),c(t,s)},defaultCurrent:A,total:C})})]})},pe=()=>(r.useEffect(()=>{document.title=V.system_name+": Archives"},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10,marginBottom:10},children:e.jsxs(u,{children:[e.jsx(u.Item,{children:e.jsx(y,{to:"/odrive",children:"Home"})}),e.jsx(u.Item,{children:"Archives"})]})}),e.jsx(X,{})]}));export{pe as DrivesArchivesPage};
