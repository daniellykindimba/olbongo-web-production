import{r as s,F as p,q as G,j as e,u as l,G as c,I as V,S as _,s as J,C as T,v as D,Z as W,$ as b,ao as k,a1 as Z,an as $,A as Q,x as U,ap as X,H as Y,B as ee,J as F,K as d,as as te}from"./index-31db8264.js";import{D as se}from"./drive_info-a031f7df.js";import{l as ne}from"./index-743768ef.js";import{B as j}from"./Breadcrumb-ccef1239.js";import"./Tree-723158fa.js";import"./index-c5c5a476.js";import"./index-6c8d25b9.js";const re=ie=>{const[u,f]=s.useState([]),[r,h]=s.useState(),[o,v]=s.useState(!0),[I,w]=s.useState(""),[y,B]=s.useState(24),[P,x]=s.useState(0),[A,q]=s.useState(0),[oe,z]=s.useState(0),[M,N]=s.useState(!0),[E,H]=s.useState(!1),[L]=p.useForm();G();const[O,m]=s.useState(!1),C=t=>{h(t),m(!0)},K=t=>{m(t),h(null)},R=async t=>{const{data:n}=await F.custom({url:"",method:"post",meta:{operation:"connectDrive",variables:{id:{value:t,type:"Int",required:!0}},fields:["success","message"]}}).catch(i=>(d.error("Drive connection failed"),{data:null})).then(i=>i);n&&(n.success?(m(!1),h(null),d(n.message),f(u.filter(i=>i.id!==t))):d.error(n.message))},g=async(t,n=10,i="")=>{v(!0);const{data:a}=await F.custom({url:"",method:"get",meta:{operation:"drivesToConnect",variables:{page:{value:t,type:"Int",required:!0},key:{value:i,type:"String",required:!1},pageSize:{value:n,type:"Int",required:!0}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","code","created","canEdit","canDelete","updated","isActive","isAuthor"]}]}}).catch(S=>(d.error("Failed to load drives"),{data:null})).then(S=>S);a&&(q(a.total),x(a.page),z(a.pages),N(a.hasNext),H(a.hasPrev),f(a.results)),v(!1)};return s.useEffect(()=>{g(1)},[]),e.jsxs(e.Fragment,{children:[e.jsx(l,{children:e.jsx(c,{container:!0,children:e.jsx(c,{item:!0,xs:12,sm:6,md:4,lg:4,xl:4,children:e.jsx(p,{layout:"vertical",form:L,onFinish:t=>{w(t.key),x(1),g(1,y,t.key)},children:e.jsx(p.Item,{name:"key",children:e.jsx(V,{size:"large",placeholder:"Search Drive(s)...",prefix:e.jsx(_,{}),autoComplete:"off",allowClear:!0,disabled:o})})})})})}),e.jsx(J,{spinning:o,children:e.jsx(l,{children:u.length>0?e.jsx(c,{container:!0,children:u.map(t=>e.jsx(c,{item:!0,xs:12,sm:6,md:4,lg:4,xl:4,children:e.jsxs(T,{hoverable:t.isActive,style:{marginRight:10,marginBottom:5},children:[e.jsx(D,{style:{right:0,position:"absolute"},children:e.jsx(W,{trigger:["click"],overlay:e.jsx(b,{children:e.jsx(b.Item,{icon:e.jsx(k,{}),disabled:!t.isActive,children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",onClick:()=>C(t),children:"Connect"})})}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:n=>n.preventDefault(),children:e.jsx(Z,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})}),e.jsx($.Ribbon,{text:t.code,placement:"start",color:"orange",children:e.jsx("a",{onClick:()=>{C(t)},children:e.jsxs(D,{direction:"vertical",align:"center",style:{width:"100%",justifyContent:"center"},children:[e.jsx(Q,{size:{xs:24,sm:32,md:40,lg:40,xl:40,xxl:80},icon:e.jsx(k,{}),src:t.icon}),e.jsx("span",{style:{fontSize:20},children:e.jsx(U,{title:t.name,children:t.name.length>20?t.name.substring(0,40)+"...":t.name})})]})})})]})},t.id))}):e.jsx(X,{severity:"info",children:o?e.jsx(e.Fragment,{children:"Loading"}):e.jsx(e.Fragment,{children:"No drives found"})})})}),(M||E)&&!o&&e.jsx(l,{sx:{display:"flex",justifyContent:"center",marginTop:3},children:e.jsx(ne.Pagination,{defaultCurrent:P,total:A,showSizeChanger:!0,onChange:(t,n)=>{x(t),B(n||y),g(t,n,I)}})}),e.jsx(Y,{title:"Connecting "+(r==null?void 0:r.name),open:O,width:"30vw",onClose:t=>K(t),children:e.jsxs(e.Fragment,{children:[e.jsx(se,{id:r==null?void 0:r.id}),e.jsx(l,{sx:{marginBottom:3},children:e.jsx(ee,{onClick:()=>R(r==null?void 0:r.id),style:{position:"absolute",float:"right",right:"10px"},children:"Connect"})})]})})]})},ae=()=>e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10,marginBottom:10},children:e.jsxs(j,{children:[e.jsx(j.Item,{children:e.jsx(te,{to:"/odrive",children:"Home"})}),e.jsx(j.Item,{children:"Drives Connect"})]})}),e.jsx(re,{})]}),ge=()=>e.jsx(ae,{});export{ge as DrivesConnectPage};
