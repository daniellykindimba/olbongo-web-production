import{r,F as h,q as B,j as e,G as n,I as E,S as L,s as T,u as v,C as H,v as g,Z as M,$ as j,am as G,a1 as _,an as J,as as y,A as K,ao as W,ap as Z,D as $,aq as p,ar as Q,J as f,K as u}from"./index-e4267a92.js";import{B as x}from"./Breadcrumb-ac8e1230.js";const U=X=>{const[o,m]=r.useState([]),[i,S]=r.useState(!0),[A,l]=r.useState(1),[C,b]=r.useState(0),[Y,F]=r.useState(0),[k,D]=r.useState(24),[I,P]=r.useState(!0),[w,q]=r.useState(!1),[z]=h.useForm();B();const O=async s=>{const{data:t}=await f.custom({url:"",method:"post",meta:{operation:"removeDriveArchive",variables:{id:{value:s,type:"Int",required:!0}},fields:["success","message"]}});t.success?(u.success(t.message),m(o.filter(d=>d.id!==s))):u.error(t.message),p.destroyAll()},R=s=>{p.confirm({title:"Confirm",icon:e.jsx(Q,{}),content:"Removing Drive From Archive ....",okText:"Add",cancelText:"Cancel",onOk:()=>O(s)})},c=async(s,t=24,d="")=>{const{data:a}=await f.custom({url:"",method:"get",meta:{operation:"drivesArchives",variables:{page:{value:s,type:"Int",required:!0},key:{value:d,type:"String",required:!1},pageSize:{value:t,type:"Int",required:!0}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{drive:["id","name","code","created","canEdit","canDelete","updated","isActive","isAuthor"]}]}]}}).catch(()=>(u.error("Failed to load archives"),{data:null})).then(N=>N);a&&(b(a.total),l(a.page),F(a.pages),P(a.hasNext),q(a.hasPrev),m(a.results)),S(!1)};return r.useEffect(()=>{c(1)},[]),e.jsxs(e.Fragment,{children:[e.jsx(n,{container:!0,children:e.jsx(n,{item:!0,xs:12,sm:6,children:e.jsx(h,{layout:"vertical",form:z,onFinish:s=>{l(1),c(1,k,s.key)},children:e.jsx(h.Item,{name:"key",children:e.jsx(E,{size:"large",placeholder:"Search Drive(s)...",prefix:e.jsx(L,{}),autoComplete:"off",allowClear:!0,disabled:i})})})})}),e.jsx(T,{spinning:i,children:e.jsx(v,{children:o.length>0?e.jsx(n,{container:!0,children:o.map(s=>e.jsx(n,{item:!0,xs:12,sm:6,md:4,lg:4,xl:4,children:e.jsxs(H,{hoverable:s.isActive,style:{marginRight:10},children:[e.jsx(g,{style:{right:0,position:"absolute"},children:e.jsx(M,{trigger:["click"],overlay:e.jsx(j,{children:e.jsx(j.Item,{icon:e.jsx(G,{}),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",onClick:()=>R(s.id),children:"Restore"})})}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:t=>t.preventDefault(),children:e.jsx(_,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})}),e.jsx(J.Ribbon,{text:s.drive.code,placement:"start",color:"orange",children:e.jsx(y,{to:"/odrive/drive/"+s.drive.id+"/"+s.drive.code+"/files",children:e.jsxs(g,{direction:"vertical",align:"center",style:{width:"100%",justifyContent:"center"},children:[e.jsx(K,{size:{xs:24,sm:32,md:40,lg:40,xl:40,xxl:80},icon:e.jsx(W,{}),src:s.drive.icon}),e.jsx("span",{style:{fontSize:20},children:s.drive.name})]})})})]})}))}):e.jsx(Z,{severity:"info",children:i?e.jsx("b",{children:"Loading..."}):e.jsx("b",{children:"No Archives Found"})})})}),(I||w)&&!i&&e.jsx(v,{sx:{display:"flex",justifyContent:"center"},children:e.jsx($,{showSizeChanger:!0,onShowSizeChange:(s,t)=>{l(s),D(t),c(s,t)},defaultCurrent:A,total:C})})]})},V=()=>e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10,marginBottom:10},children:e.jsxs(x,{children:[e.jsx(x.Item,{children:e.jsx(y,{to:"/odrive",children:"Home"})}),e.jsx(x.Item,{children:"Archives"})]})}),e.jsx(U,{})]}),te=()=>e.jsx(V,{});export{te as DrivesArchivesPage};
