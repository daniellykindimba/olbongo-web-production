import{r as s,aT as h,c as E,j as e,G as o,a1 as M,a8 as q,B as v,aX as g,aR as T,aU as j,ae as L,cA as u,P as _,g as f,_ as x,co as H,cM as G,aN as n}from"./index-e44e1a6d.js";import{d as W}from"./data_objects-d2efaecb.js";import{C as U}from"./index-2a6e4015.js";import{A as X}from"./index-85059cf6.js";import{A as J}from"./Alert-9c453017.js";import{M as y}from"./index-dc3323d2.js";import{S as K}from"./SearchOutlined-b1a83866.js";import{R as Q}from"./RollbackOutlined-29a9de0f.js";import{M as V}from"./MoreOutlined-f640145b.js";import{F as Y}from"./FolderOpenOutlined-99f3eeb9.js";import{E as Z}from"./ExclamationCircleOutlined-503ce594.js";import"./Skeleton-4fee345f.js";import"./DotChartOutlined-f39c986e.js";import"./index-24834ec9.js";import"./index-7a457e26.js";import"./InfoCircleFilled-6c32ebc6.js";import"./InfoCircleFilled-baaa675e.js";import"./ActionButton-330c6123.js";import"./DialogWrap-f973f288.js";import"./index-406e87b5.js";import"./fade-c9034687.js";const $=ee=>{const[l,p]=s.useState([]),[a,S]=s.useState(!0),[A,c]=s.useState(1),[C,b]=s.useState(0),[re,F]=s.useState(0),[k,I]=s.useState(24),[P,D]=s.useState(!0),[R,w]=s.useState(!1),[O]=h.useForm();E();const z=async r=>{const{data:t}=await f.custom({url:"",method:"post",meta:{operation:"removeDriveArchive",variables:{id:{value:r,type:"Int",required:!0}},fields:["success","message"]}});t.success?(x.success(t.message),p(l.filter(m=>m.id!==r))):x.error(t.message),y.destroyAll()},N=r=>{y.confirm({title:"Confirm",icon:e.jsx(Z,{}),content:"Removing Drive From Archive ....",okText:"Add",cancelText:"Cancel",onOk:()=>z(r)})},d=async(r,t=24,m="")=>{const{data:i}=await f.custom({url:"",method:"get",meta:{operation:"drivesArchives",variables:{page:{value:r,type:"Int",required:!0},key:{value:m,type:"String",required:!1},pageSize:{value:t,type:"Int",required:!0}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{drive:W}]}]}}).catch(()=>(x.error("Failed to load archives"),{data:null})).then(B=>B);i&&(b(i.total),c(i.page),F(i.pages),D(i.hasNext),w(i.hasPrev),p(i.results)),S(!1)};return s.useEffect(()=>{d(1)},[]),e.jsxs(e.Fragment,{children:[e.jsx(o,{container:!0,children:e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(h,{layout:"vertical",form:O,onFinish:r=>{c(1),d(1,k,r.key)},children:e.jsx(h.Item,{name:"key",children:e.jsx(M,{size:"large",placeholder:"Search Drive(s)...",prefix:e.jsx(K,{}),autoComplete:"off",allowClear:!0,disabled:a})})})})}),e.jsx(q,{spinning:a,children:e.jsx(v,{children:l.length>0?e.jsx(o,{container:!0,children:l.map(r=>e.jsx(o,{item:!0,xs:12,sm:6,md:4,lg:4,xl:4,children:e.jsxs(U,{hoverable:r.isActive,style:{marginRight:10},children:[e.jsx(g,{style:{right:0,position:"absolute"},children:e.jsx(T,{trigger:["click"],overlay:e.jsx(j,{children:e.jsx(j.Item,{icon:e.jsx(Q,{}),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",onClick:()=>N(r.id),children:"Restore"})})}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:t=>t.preventDefault(),children:e.jsx(V,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})}),e.jsx(L.Ribbon,{text:r.drive.code,placement:"start",color:"orange",children:e.jsx(u,{to:"/odrive/drive/"+r.drive.id+"/"+r.drive.code+"/files",children:e.jsxs(g,{direction:"vertical",align:"center",style:{width:"100%",justifyContent:"center"},children:[e.jsx(X,{size:{xs:24,sm:32,md:40,lg:40,xl:40,xxl:80},icon:e.jsx(Y,{}),src:r.drive.icon}),e.jsx("span",{style:{fontSize:20},children:r.drive.name})]})})})]})}))}):e.jsx(J,{severity:"info",children:a?e.jsx("b",{children:"Loading..."}):e.jsx("b",{children:"No Archives Found"})})})}),(P||R)&&!a&&e.jsx(v,{sx:{display:"flex",justifyContent:"center"},children:e.jsx(_,{showSizeChanger:!0,onShowSizeChange:(r,t)=>{c(r),I(t),d(r,t)},defaultCurrent:A,total:C})})]})},Ce=()=>(s.useEffect(()=>{document.title=H.system_name+": Archives"},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10,marginBottom:10},children:e.jsx(G,{children:e.jsxs(n,{children:[e.jsx(n.Item,{children:e.jsx(u,{to:"/",children:"Home"})}),e.jsx(n.Item,{children:e.jsx(u,{to:"/odrive",children:"Odrive"})}),e.jsx(n.Item,{children:"Archives"})]})})}),e.jsx($,{})]}));export{Ce as DrivesArchivesPage};
