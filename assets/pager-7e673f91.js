import{r as t,q as z,u as O,v as s,w as Ue,c as N,l as Y,j as e,G as F,a as Ke,E as We,C as Pe,B as _,P as Be,b as ge,x as Pt,y as ne,S as me,T as le,A as Ne,R as X,d as U,z as Ie,M as Oe,I as se,g as J,_ as V,H as de,J as M,K as Fe,N as dt,O as kt,Q as rn,U as sn,V as an,W as ft,X as Et,Y as ke,Z as on,$ as Ct,D as $e,a0 as ln,a1 as cn,L as Qe,a2 as Je,f as dn,a3 as un,a4 as ut,a5 as te,a6 as hn,a7 as fn,a8 as nt,a9 as rt,aa as st,ab as at,o as ot,m as it,n as lt,ac as Le,ad as qe,ae as pt}from"./index-0106a5d3.js";import{B as ht}from"./book_payment_form-add8d9d2.js";import{i as Ee,p as ae,a as gt,d as mt,b as pn,c as gn,e as mn,l as xn,f as ce,w as re,g as yn,m as He,h as Tt,j as pe}from"./index-31681144.js";var H=globalThis&&globalThis.__spreadArray||function(n,r,a){if(a||arguments.length===2)for(var i=0,o=r.length,l;i<o;i++)(l||!(i in r))&&(l||(l=Array.prototype.slice.call(r,0,i)),l[i]=r[i]);return n.concat(l||Array.prototype.slice.call(r))},jn=["onCopy","onCut","onPaste"],bn=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],vn=["onFocus","onBlur"],Sn=["onInput","onInvalid","onReset","onSubmit"],Pn=["onLoad","onError"],kn=["onKeyDown","onKeyPress","onKeyUp"],En=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],Cn=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],Tn=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],Rn=["onSelect"],wn=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],An=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],Dn=["onScroll"],Ln=["onWheel"],Bn=["onAnimationStart","onAnimationEnd","onAnimationIteration"],Nn=["onTransitionEnd"],In=["onToggle"],On=["onChange"],Rt=H(H(H(H(H(H(H(H(H(H(H(H(H(H(H(H(H(H([],jn,!0),bn,!0),vn,!0),Sn,!0),Pn,!0),kn,!0),En,!0),Cn,!0),Tn,!0),Rn,!0),wn,!0),An,!0),Dn,!0),Ln,!0),Bn,!0),Nn,!0),On,!0),In,!0);function wt(n,r){var a={};return Rt.forEach(function(i){var o=n[i];o&&(r?a[i]=function(l){return o(l,r(i))}:a[i]=o)}),a}function Te(n){var r=!1,a=new Promise(function(i,o){n.then(function(l){return!r&&i(l)}).catch(function(l){return!r&&o(l)})});return{promise:a,cancel:function(){r=!0}}}const At=t.createContext(null);function Ce({children:n,type:r}){return z.createElement("div",{className:`react-pdf__message react-pdf__message--${r}`},n)}const Fn="noopener noreferrer nofollow";class Dt{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(r){this.pdfDocument=r}setViewer(r){this.pdfViewer=r}setExternalLinkRel(r){this.externalLinkRel=r}setExternalLinkTarget(r){this.externalLinkTarget=r}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return O(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber||0}set page(r){O(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber=r}get rotation(){return 0}set rotation(r){}goToDestination(r){return new Promise(a=>{O(this.pdfDocument,"PDF document not loaded."),O(r,"Destination is not specified."),typeof r=="string"?this.pdfDocument.getDestination(r).then(a):Array.isArray(r)?a(r):r.then(a)}).then(a=>{O(Array.isArray(a),`"${a}" is not a valid destination array.`);const i=a[0];new Promise(o=>{O(this.pdfDocument,"PDF document not loaded."),i instanceof Object?this.pdfDocument.getPageIndex(i).then(l=>{o(l)}).catch(()=>{O(!1,`"${i}" is not a valid page reference.`)}):typeof i=="number"?o(i):O(!1,`"${i}" is not a valid destination reference.`)}).then(o=>{const l=o+1;O(this.pdfViewer,"PDF viewer is not initialized."),O(l>=1&&l<=this.pagesCount,`"${l}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({dest:a,pageIndex:o,pageNumber:l})})})}navigateTo(r){this.goToDestination(r)}goToPage(r){const a=r-1;O(this.pdfViewer,"PDF viewer is not initialized."),O(r>=1&&r<=this.pagesCount,`"${r}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({pageIndex:a,pageNumber:r})}addLinkAttributes(r,a,i){r.href=a,r.rel=this.externalLinkRel||Fn,r.target=i?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const Mn={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},xt=Mn;function _n(n,r){switch(r.type){case"RESOLVE":return{value:r.value,error:void 0};case"REJECT":return{value:!1,error:r.error};case"RESET":return{value:void 0,error:void 0};default:return n}}function xe(){return t.useReducer(_n,{value:void 0,error:void 0})}const{PDFDataRangeTransport:Vn}=ae,Lt=(()=>{const n={};return Rt.forEach(r=>{n[r]=s.func}),n})(),zn=s.oneOfType([s.instanceOf(Int8Array),s.instanceOf(Uint8Array),s.instanceOf(Uint8ClampedArray),s.instanceOf(Int16Array),s.instanceOf(Uint16Array),s.instanceOf(Int32Array),s.instanceOf(Uint32Array),s.instanceOf(Float32Array),s.instanceOf(Float64Array)]),Bt=[s.string,s.instanceOf(ArrayBuffer),s.shape({data:s.oneOfType([s.string,s.instanceOf(ArrayBuffer),s.arrayOf(s.number.isRequired),zn]).isRequired}),s.shape({range:s.instanceOf(Vn).isRequired}),s.shape({url:s.string.isRequired})];typeof Blob<"u"&&Bt.push(s.instanceOf(Blob));const Nt=s.oneOfType([s.string,s.arrayOf(s.string)]),qn=s.oneOfType(Bt);s.instanceOf(Dt);s.oneOf(["_self","_blank","_parent","_top"]);s.shape({commonObjs:s.shape({}).isRequired,getAnnotations:s.func.isRequired,getTextContent:s.func.isRequired,getViewport:s.func.isRequired,render:s.func.isRequired});const Gn=function(r,a,i){const{[a]:o,pageNumber:l,pdf:m}=r;if(!Ee(m))return null;if(Ee(o)){if(typeof o!="number")return new Error(`\`${a}\` of type \`${typeof o}\` supplied to \`${i}\`, expected \`number\`.`);if(o<0)return new Error(`Expected \`${a}\` to be greater or equal to 0.`);const{numPages:R}=m;if(o+1>R)return new Error(`Expected \`${a}\` to be less or equal to ${R-1}.`)}else if(!Ee(l))return new Error(`\`${a}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${i}\`.`);return null},$n=function(r,a,i){const{[a]:o,pageIndex:l,pdf:m}=r;if(!Ee(m))return null;if(Ee(o)){if(typeof o!="number")return new Error(`\`${a}\` of type \`${typeof o}\` supplied to \`${i}\`, expected \`number\`.`);if(o<1)return new Error(`Expected \`${a}\` to be greater or equal to 1.`);const{numPages:R}=m;if(o>R)return new Error(`Expected \`${a}\` to be less or equal to ${R}.`)}else if(!Ee(l))return new Error(`\`${a}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${i}\`.`);return null},Hn=s.oneOfType([s.any,s.oneOf([!1])]),ct=s.oneOfType([s.func,s.exact({current:s.any})]),Un=s.oneOf(["canvas","custom","none","svg"]),Kn=s.oneOf([0,90,180,270]);var Wn=globalThis&&globalThis.__awaiter||function(n,r,a,i){function o(l){return l instanceof a?l:new a(function(m){m(l)})}return new(a||(a=Promise))(function(l,m){function R(T){try{b(i.next(T))}catch(k){m(k)}}function f(T){try{b(i.throw(T))}catch(k){m(k)}}function b(T){T.done?l(T.value):o(T.value).then(R,f)}b((i=i.apply(n,r||[])).next())})},yt=globalThis&&globalThis.__rest||function(n,r){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&r.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(n);o<i.length;o++)r.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(n,i[o])&&(a[i[o]]=n[i[o]]);return a};const{PDFDataRangeTransport:Jn}=ae,Yn=(n,r)=>{switch(r){case xt.NEED_PASSWORD:{const a=prompt("Enter the password to open this PDF file.");n(a);break}case xt.INCORRECT_PASSWORD:{const a=prompt("Invalid password. Please try again.");n(a);break}}},It=t.forwardRef(function(r,a){var{children:i,className:o,error:l="Failed to load PDF file.",externalLinkRel:m,externalLinkTarget:R,file:f,inputRef:b,imageResourcesPath:T,loading:k="Loading PDFâ€¦",noData:w="No PDF file specified.",onItemClick:S,onLoadError:A,onLoadProgress:c,onLoadSuccess:C,onPassword:v=Yn,onSourceError:x,onSourceSuccess:P,options:j,renderMode:y,rotate:u}=r,g=yt(r,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[p,h]=xe(),{value:D,error:E}=p,[d,L]=xe(),{value:B,error:Z}=d,K=t.useRef(new Dt),ee=t.useRef([]),Q=t.useRef({scrollPageIntoView:I=>{const{dest:G,pageNumber:W,pageIndex:$=W-1}=I;if(S){S({dest:G,pageIndex:$,pageNumber:W});return}const Ve=ee.current[$];if(Ve){Ve.scrollIntoView();return}}});t.useImperativeHandle(a,()=>({linkService:K,pages:ee,viewer:Q}),[]);function oe(){P&&P()}function ie(){E&&(re(!1,E.toString()),x&&x(E))}function ye(){h({type:"RESET"})}t.useEffect(ye,[f,h]);const ue=t.useCallback(()=>Wn(this,void 0,void 0,function*(){if(!f)return null;if(typeof f=="string")return gt(f)?{data:mt(f)}:{url:f};if(f instanceof Jn)return{range:f};if(pn(f))return{data:f};if(gn&&mn(f))return{data:yield xn(f)};if(O(typeof f=="object","Invalid parameter in file, need either Uint8Array, string or a parameter object"),O("data"in f||"range"in f||"url"in f,"Invalid parameter object: need either .data, .range or .url"),"url"in f&&typeof f.url=="string"&&gt(f.url)){const{url:I}=f,G=yt(f,["url"]),W=mt(I);return Object.assign({data:W},G)}return f}),[f]);t.useEffect(()=>{const I=Te(ue());return I.promise.then(G=>{h({type:"RESOLVE",value:G})}).catch(G=>{h({type:"REJECT",error:G})}),()=>{ce(I)}},[ue,h]),t.useEffect(()=>{if(!(typeof D>"u")){if(D===!1){ie();return}oe()}},[D]);function he(){B&&(C&&C(B),ee.current=new Array(B.numPages),K.current.setDocument(B))}function Re(){Z&&(re(!1,Z.toString()),A&&A(Z))}function je(){L({type:"RESET"})}t.useEffect(je,[L,D]);function we(){if(!D)return;const I=j?Object.assign(Object.assign({},D),j):D,G=ae.getDocument(I);c&&(G.onProgress=c),v&&(G.onPassword=v);const W=G;return W.promise.then($=>{L({type:"RESOLVE",value:$})}).catch($=>{W.destroyed||L({type:"REJECT",error:$})}),()=>{W.destroy()}}t.useEffect(we,[j,L,D]),t.useEffect(()=>{if(!(typeof B>"u")){if(B===!1){Re();return}he()}},[B]);function be(){K.current.setViewer(Q.current),K.current.setExternalLinkRel(m),K.current.setExternalLinkTarget(R)}t.useEffect(be,[m,R]);function _e(I,G){ee.current[I]=G}function Ze(I){delete ee.current[I]}const fe=t.useMemo(()=>({imageResourcesPath:T,linkService:K.current,onItemClick:S,pdf:B,registerPage:_e,renderMode:y,rotate:u,unregisterPage:Ze}),[T,S,B,y,u]),q=t.useMemo(()=>wt(g,()=>B),[g,B]);function Ae(){return z.createElement(At.Provider,{value:fe},i)}function De(){return f?B==null?z.createElement(Ce,{type:"loading"},typeof k=="function"?k():k):B===!1?z.createElement(Ce,{type:"error"},typeof l=="function"?l():l):Ae():z.createElement(Ce,{type:"no-data"},typeof w=="function"?w():w)}return z.createElement("div",Object.assign({className:Ue("react-pdf__Document",o),ref:b,style:{"--scale-factor":"1"}},q),De())}),et=s.oneOfType([s.func,s.node]);It.propTypes=Object.assign(Object.assign({},Lt),{children:s.node,className:Nt,error:et,externalLinkRel:s.string,externalLinkTarget:s.oneOf(["_self","_blank","_parent","_top"]),file:qn,imageResourcesPath:s.string,inputRef:ct,loading:et,noData:et,onItemClick:s.func,onLoadError:s.func,onLoadProgress:s.func,onLoadSuccess:s.func,onPassword:s.func,onSourceError:s.func,onSourceSuccess:s.func,options:s.shape({canvasFactory:s.any,canvasMaxAreaInBytes:s.number,cMapPacked:s.bool,CMapReaderFactory:s.any,cMapUrl:s.string,disableAutoFetch:s.bool,disableFontFace:s.bool,disableRange:s.bool,disableStream:s.bool,docBaseUrl:s.string,enableXfa:s.bool,filterFactory:s.any,fontExtraProperties:s.bool,httpHeaders:s.object,isEvalSupported:s.bool,isOffscreenCanvasSupported:s.bool,length:s.number,maxImageSize:s.number,ownerDocument:s.any,password:s.string,pdfBug:s.bool,rangeChunkSize:s.number,StandardFontDataFactory:s.any,standardFontDataUrl:s.string,stopAtErrors:s.bool,useSystemFonts:s.bool,useWorkerFetch:s.bool,verbosity:s.number,withCredentials:s.bool,worker:s.any}),rotate:s.number});const Zn=It;function Ot(){return t.useContext(At)}function Ft(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var a=n.filter(Boolean);if(a.length<=1){var i=a[0];return i||null}return function(l){a.forEach(function(m){typeof m=="function"?m(l):m&&(m.current=l)})}}const Mt=t.createContext(null),_t={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},Xn=/^H(\d+)$/;function Qn(n){return n in _t}function Ye(n){return"children"in n}function Vt(n){return Ye(n)?n.children.length===1&&0 in n.children&&"id"in n.children[0]:!1}function er(n){const r={};if(Ye(n)){const{role:a}=n,i=a.match(Xn);if(i)r.role="heading",r["aria-level"]=Number(i[1]);else if(Qn(a)){const o=_t[a];o&&(r.role=o)}}return r}function zt(n){const r={};if(Ye(n)){if(n.alt!==void 0&&(r["aria-label"]=n.alt),n.lang!==void 0&&(r.lang=n.lang),Vt(n)){const[a]=n.children;if(a){const i=zt(a);return Object.assign(Object.assign({},r),i)}}}else"id"in n&&(r["aria-owns"]=n.id);return r}function tr(n){return n?Object.assign(Object.assign({},er(n)),zt(n)):null}function qt({className:n,node:r}){const a=t.useMemo(()=>tr(r),[r]),i=t.useMemo(()=>!Ye(r)||Vt(r)?null:r.children.map((o,l)=>z.createElement(qt,{key:l,node:o})),[r]);return z.createElement("span",Object.assign({className:n},a),i)}function Me(){return t.useContext(Mt)}function nr(){const n=Me();O(n,"Unable to find Page context.");const{onGetStructTreeError:r,onGetStructTreeSuccess:a}=n,[i,o]=xe(),{value:l,error:m}=i,{customTextRenderer:R,page:f}=n;function b(){l&&a&&a(l)}function T(){m&&(re(!1,m.toString()),r&&r(m))}function k(){o({type:"RESET"})}t.useEffect(k,[o,f]);function w(){if(R||!f)return;const S=Te(f.getStructTree()),A=S;return S.promise.then(c=>{o({type:"RESOLVE",value:c})}).catch(c=>{o({type:"REJECT",error:c})}),()=>ce(A)}return t.useEffect(w,[R,f,o]),t.useEffect(()=>{if(l!==void 0){if(l===!1){T();return}b()}},[l]),l?z.createElement(qt,{className:"react-pdf__Page__structTree structTree",node:l}):null}const jt=ae.AnnotationMode;function rr(n){const r=Me();O(r,"Unable to find Page context.");const a=Object.assign(Object.assign({},r),n),{_className:i,canvasBackground:o,devicePixelRatio:l=yn(),onRenderError:m,onRenderSuccess:R,page:f,renderForms:b,renderTextLayer:T,rotate:k,scale:w}=a,{canvasRef:S}=n;O(f,"Attempted to render page canvas, but no page was specified.");const A=t.useRef(null);function c(){f&&R&&R(He(f,w))}function C(y){Tt(y)||(re(!1,y.toString()),m&&m(y))}const v=t.useMemo(()=>f.getViewport({scale:w*l,rotation:k}),[l,f,k,w]),x=t.useMemo(()=>f.getViewport({scale:w,rotation:k}),[f,k,w]);function P(){if(!f)return;f.cleanup();const{current:y}=A;if(!y)return;y.width=v.width,y.height=v.height,y.style.width=`${Math.floor(x.width)}px`,y.style.height=`${Math.floor(x.height)}px`,y.style.visibility="hidden";const u={annotationMode:b?jt.ENABLE_FORMS:jt.ENABLE,canvasContext:y.getContext("2d",{alpha:!1}),viewport:v};o&&(u.background=o);const g=f.render(u),p=g;return g.promise.then(()=>{y.style.visibility="",c()}).catch(C),()=>ce(p)}t.useEffect(P,[o,A,l,f,b,v,x]);const j=t.useCallback(()=>{const{current:y}=A;y&&(y.width=0,y.height=0)},[A]);return t.useEffect(()=>j,[j]),z.createElement("canvas",{className:`${i}__canvas`,dir:"ltr",ref:Ft(S,A),style:{display:"block",userSelect:"none"}},T?z.createElement(nr,null):null)}function sr(){const n=Me();O(n,"Unable to find Page context.");const{_className:r,onRenderSuccess:a,onRenderError:i,page:o,rotate:l,scale:m}=n;O(o,"Attempted to render page SVG, but no page was specified.");const[R,f]=xe(),{value:b,error:T}=R;function k(){o&&a&&a(He(o,m))}function w(){T&&(Tt(T)||(re(!1,T.toString()),i&&i(T)))}const S=t.useMemo(()=>o.getViewport({scale:m,rotation:l}),[o,l,m]);function A(){f({type:"RESET"})}t.useEffect(A,[o,f,S]);function c(){if(!o)return;const P=Te(o.getOperatorList());return P.promise.then(j=>{new ae.SVGGraphics(o.commonObjs,o.objs).getSVG(j,S).then(u=>{f({type:"RESOLVE",value:u})}).catch(u=>{f({type:"REJECT",error:u})})}).catch(j=>{f({type:"REJECT",error:j})}),()=>ce(P)}t.useEffect(c,[o,f,S]),t.useEffect(()=>{if(b!==void 0){if(b===!1){w();return}k()}},[b]);function C(P){if(!P||!b)return;P.firstElementChild||P.appendChild(b);const{width:j,height:y}=S;b.setAttribute("width",`${j}`),b.setAttribute("height",`${y}`)}const{width:v,height:x}=S;return z.createElement("div",{className:`${r}__svg`,ref:P=>C(P),style:{display:"block",backgroundColor:"white",overflow:"hidden",width:v,height:x,userSelect:"none"}})}function ar(n){return"str"in n}function or(){const n=Me();O(n,"Unable to find Page context.");const{customTextRenderer:r,onGetTextError:a,onGetTextSuccess:i,onRenderTextLayerError:o,onRenderTextLayerSuccess:l,page:m,pageIndex:R,pageNumber:f,rotate:b,scale:T}=n;O(m,"Attempted to load page text content, but no page was specified.");const[k,w]=xe(),{value:S,error:A}=k,c=t.useRef(null),C=t.useRef();re(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1);function v(){S&&i&&i(S)}function x(){A&&(re(!1,A.toString()),a&&a(A))}function P(){w({type:"RESET"})}t.useEffect(P,[m,w]);function j(){if(!m)return;const E=Te(m.getTextContent()),d=E;return E.promise.then(L=>{w({type:"RESOLVE",value:L})}).catch(L=>{w({type:"REJECT",error:L})}),()=>ce(d)}t.useEffect(j,[m,w]),t.useEffect(()=>{if(S!==void 0){if(S===!1){x();return}v()}},[S]);const y=t.useCallback(()=>{l&&l()},[l]),u=t.useCallback(E=>{re(!1,E.toString()),o&&o(E)},[o]);function g(){const E=C.current;E&&E.classList.add("active")}function p(){const E=C.current;E&&E.classList.remove("active")}const h=t.useMemo(()=>m.getViewport({scale:T,rotation:b}),[m,b,T]);function D(){if(!m||!S)return;const{current:E}=c;if(!E)return;E.innerHTML="";const d=m.streamTextContent({includeMarkedContent:!0}),L={container:E,textContentSource:d,viewport:h},B=ae.renderTextLayer(L),Z=B;return B.promise.then(()=>{const K=document.createElement("div");K.className="endOfContent",E.append(K),C.current=K;const Q=!!E.querySelector(".markedContent")?E.querySelectorAll(".markedContent > *:not(.markedContent"):E.children;if(r){let oe=0;S.items.forEach((ie,ye)=>{if(!ar(ie))return;const ue=Q[oe];if(!ue)return;const he=r(Object.assign({pageIndex:R,pageNumber:f,itemIndex:ye},ie));ue.innerHTML=he,oe+=ie.str&&ie.hasEOL?2:1})}y()}).catch(u),()=>ce(Z)}return t.useLayoutEffect(D,[r,u,y,m,R,f,S,h]),z.createElement("div",{className:Ue("react-pdf__Page__textContent","textLayer"),onMouseUp:p,onMouseDown:g,ref:c})}function ir(){const n=Ot();O(n,"Unable to find Document context. Did you wrap <Page /> in <Document />?");const r=Me();O(r,"Unable to find Page context.");const a=Object.assign(Object.assign({},n),r),{imageResourcesPath:i,linkService:o,onGetAnnotationsError:l,onGetAnnotationsSuccess:m,onRenderAnnotationLayerError:R,onRenderAnnotationLayerSuccess:f,page:b,pdf:T,renderForms:k,rotate:w,scale:S=1}=a;O(b,"Attempted to load page annotations, but no page was specified.");const[A,c]=xe(),{value:C,error:v}=A,x=t.useRef(null);re(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1);function P(){C&&m&&m(C)}function j(){v&&(re(!1,v.toString()),l&&l(v))}function y(){c({type:"RESET"})}t.useEffect(y,[c,b]);function u(){if(!b)return;const E=Te(b.getAnnotations()),d=E;return E.promise.then(L=>{c({type:"RESOLVE",value:L})}).catch(L=>{c({type:"REJECT",error:L})}),()=>{ce(d)}}t.useEffect(u,[c,b,k]),t.useEffect(()=>{if(C!==void 0){if(C===!1){j();return}P()}},[C]);function g(){f&&f()}function p(E){R&&R(E)}const h=t.useMemo(()=>b.getViewport({scale:S,rotation:w}),[b,w,S]);function D(){if(!T||!b||!C)return;const{current:E}=x;if(!E)return;const d=h.clone({dontFlip:!0}),L={annotations:C,annotationStorage:T.annotationStorage,div:E,downloadManager:null,imageResourcesPath:i,linkService:o,page:b,renderForms:k,viewport:d};E.innerHTML="";try{ae.AnnotationLayer.render(L),g()}catch(B){p(B)}return()=>{}}return t.useEffect(D,[C,i,o,b,k,h]),z.createElement("div",{className:Ue("react-pdf__Page__annotations","annotationLayer"),ref:x})}var lr=globalThis&&globalThis.__rest||function(n,r){var a={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&r.indexOf(i)<0&&(a[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(n);o<i.length;o++)r.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(n,i[o])&&(a[i[o]]=n[i[o]]);return a};const bt=1,Gt=function(r){const a=Ot();O(a,"Unable to find Document context. Did you wrap <Page /> in <Document />?");const i=Object.assign(Object.assign({},a),r),{_className:o="react-pdf__Page",_enableRegisterUnregisterPage:l=!0,canvasBackground:m,canvasRef:R,children:f,className:b,customRenderer:T,customTextRenderer:k,devicePixelRatio:w,error:S="Failed to load the page.",height:A,inputRef:c,loading:C="Loading pageâ€¦",noData:v="No page specified.",onGetAnnotationsError:x,onGetAnnotationsSuccess:P,onGetStructTreeError:j,onGetStructTreeSuccess:y,onGetTextError:u,onGetTextSuccess:g,onLoadError:p,onLoadSuccess:h,onRenderAnnotationLayerError:D,onRenderAnnotationLayerSuccess:E,onRenderError:d,onRenderSuccess:L,onRenderTextLayerError:B,onRenderTextLayerSuccess:Z,pageIndex:K,pageNumber:ee,pdf:Q,registerPage:oe,renderAnnotationLayer:ie=!0,renderForms:ye=!1,renderMode:ue="canvas",renderTextLayer:he=!0,rotate:Re,scale:je=bt,unregisterPage:we,width:be}=i,_e=lr(i,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[Ze,fe]=xe(),{value:q,error:Ae}=Ze,De=t.useRef(null);O(Q,"Attempted to load a page, but no document was specified.");const I=pe(ee)?ee-1:K??null,G=ee??(pe(K)?K+1:null),W=Re??(q?q.rotate:null),$=t.useMemo(()=>{if(!q)return null;let ve=1;const Xe=je??bt;if(be||A){const Se=q.getViewport({scale:1,rotation:W});be?ve=be/Se.width:A&&(ve=A/Se.height)}return Xe*ve},[A,q,W,je,be]);function Ve(){return()=>{pe(I)&&l&&we&&we(I)}}t.useEffect(Ve,[l,Q,I,we]);function Ht(){if(h){if(!q||!$)return;h(He(q,$))}if(l&&oe){if(!pe(I)||!De.current)return;oe(I,De.current)}}function Ut(){Ae&&(re(!1,Ae.toString()),p&&p(Ae))}function Kt(){fe({type:"RESET"})}t.useEffect(Kt,[fe,Q,I]);function Wt(){if(!Q||!G)return;const ve=Te(Q.getPage(G)),Xe=ve;return ve.promise.then(Se=>{fe({type:"RESOLVE",value:Se})}).catch(Se=>{fe({type:"REJECT",error:Se})}),()=>ce(Xe)}t.useEffect(Wt,[fe,Q,I,G,oe]),t.useEffect(()=>{if(q!==void 0){if(q===!1){Ut();return}Ht()}},[q,$]);const Jt=t.useMemo(()=>q&&pe(I)&&G&&pe(W)&&pe($)?{_className:o,canvasBackground:m,customTextRenderer:k,devicePixelRatio:w,onGetAnnotationsError:x,onGetAnnotationsSuccess:P,onGetStructTreeError:j,onGetStructTreeSuccess:y,onGetTextError:u,onGetTextSuccess:g,onRenderAnnotationLayerError:D,onRenderAnnotationLayerSuccess:E,onRenderError:d,onRenderSuccess:L,onRenderTextLayerError:B,onRenderTextLayerSuccess:Z,page:q,pageIndex:I,pageNumber:G,renderForms:ye,renderTextLayer:he,rotate:W,scale:$}:null,[o,m,k,w,x,P,j,y,u,g,D,E,d,L,B,Z,q,I,G,ye,he,W,$]),Yt=t.useMemo(()=>wt(_e,()=>q&&($?He(q,$):void 0)),[_e,q,$]),ze=`${I}@${$}/${W}`,Zt=`${I}/${W}`;function Xt(){switch(ue){case"custom":return O(T,'renderMode was set to "custom", but no customRenderer was passed.'),z.createElement(T,{key:`${ze}_custom`});case"none":return null;case"svg":return z.createElement(sr,{key:`${Zt}_svg`});case"canvas":default:return z.createElement(rr,{key:`${ze}_canvas`,canvasRef:R})}}function Qt(){return he?z.createElement(or,{key:`${ze}_text`}):null}function en(){return ie?z.createElement(ir,{key:`${ze}_annotations`}):null}function tn(){return z.createElement(Mt.Provider,{value:Jt},Xt(),Qt(),en(),f)}function nn(){return G?Q===null||q===void 0||q===null?z.createElement(Ce,{type:"loading"},typeof C=="function"?C():C):Q===!1||q===!1?z.createElement(Ce,{type:"error"},typeof S=="function"?S():S):tn():z.createElement(Ce,{type:"no-data"},typeof v=="function"?v():v)}return z.createElement("div",Object.assign({className:Ue(o,b),"data-page-number":G,ref:Ft(c,De),style:{"--scale-factor":`${$}`,backgroundColor:m||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},Yt),nn())},tt=s.oneOfType([s.func,s.node]);Gt.propTypes=Object.assign(Object.assign({},Lt),{canvasBackground:s.string,canvasRef:ct,children:s.node,className:Nt,customRenderer:s.func,customTextRenderer:s.func,devicePixelRatio:s.number,error:tt,height:s.number,imageResourcesPath:s.string,inputRef:ct,loading:tt,noData:tt,onGetTextError:s.func,onGetTextSuccess:s.func,onLoadError:s.func,onLoadSuccess:s.func,onRenderError:s.func,onRenderSuccess:s.func,onRenderTextLayerError:s.func,onRenderTextLayerSuccess:s.func,pageIndex:Gn,pageNumber:$n,pdf:Hn,renderAnnotationLayer:s.bool,renderForms:s.bool,renderMode:Un,renderTextLayer:s.bool,rotate:Kn,scale:s.number,width:s.number});const cr=Gt,{Search:dr}=se,$t=n=>{const[r,a]=t.useState(!1),[i,o]=t.useState(0),[l,m]=t.useState(0),[R,f]=t.useState(1),[b,T]=t.useState([]),[k,w]=t.useState(),[S,A]=t.useState(!1);N.useForm(),Y();const c=x=>{w(x),A(!0)},C=async x=>{const{data:P}=await J.custom({url:"",method:"post",meta:{operation:"addBookToReadings",variables:{bookId:{value:x,type:"Int",required:!0}},fields:["success","message",{book:["id","title","description","file","cover","price","downloadable","publisherCanAddToReadings","created","updated","isActive","isPublic","canEdit","canDelete","canManage",{author:["id","firstName","lastName","middleName","fullName","email","pic"]}]}]}}).catch(j=>(V.error("Error deleting book"),{data:null})).then(j=>j);P&&(P.success?(V.success(P.message),T(b.map(j=>j.id===x?P.book:j))):V.error(P.message))},v=async(x,P="")=>{a(!0);const{data:j}=await J.custom({url:"",method:"get",meta:{operation:"marketplaceBooks",variables:{page:{value:x,type:"Int",required:!0},key:{value:P,type:"String",required:!1},public:{value:n.public,type:"Boolean",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","title","description","file","cover","price","created","updated","isActive","isPublic","hasPurchaseOrder","orderPaid","canEdit","canDelete","canManage",{author:["id","firstName","lastName","middleName","fullName","email","pic"]}]}]}}).catch(y=>(V.error("Error getting Books"),{data:null})).then(y=>y);j&&(o(j.total),m(j.pages),f(j.page),T(j.results)),a(!1)};return t.useEffect(()=>{v(R,"")},[n.randKey]),e.jsxs(e.Fragment,{children:[e.jsx(F,{container:!0,spacing:0,sx:{display:"flex",justifyContent:"flex-start"},children:e.jsx(F,{item:!0,xs:12,sm:12,md:4,lg:4,xl:4,children:e.jsx(dr,{size:"large",placeholder:"Search Book(s) ...",onSearch:x=>v(1,x),style:{width:"100%"}})})}),e.jsx(Ke,{spinning:r,children:e.jsxs(F,{container:!0,spacing:0,children:[b.length===0&&e.jsx(e.Fragment,{children:e.jsx(F,{item:!0,xs:12,sm:12,md:12,lg:12,xl:12,children:e.jsx(We,{description:"No Book Published"})})}),b.map(x=>e.jsx(F,{item:!0,xs:12,sm:12,md:6,lg:6,xl:6,children:e.jsx(Pe,{hoverable:!0,bordered:!0,style:{margin:"2px"},type:"inner",actions:[e.jsxs("span",{style:{fontSize:"18px",display:x.price>0?"block":"none"},children:[x.price," Tsh"]}),e.jsx("span",{style:{float:"right",marginRight:"10px",display:"flex"},children:x.isPublic?e.jsx(_,{size:"large",icon:e.jsx(Be,{}),onClick:()=>C(x.id),children:"Add to Readings"}):e.jsxs(e.Fragment,{children:[x.orderPaid&&e.jsx(e.Fragment,{children:e.jsx(ge,{color:"green",children:"Already Purchased"})}),!x.orderPaid&&e.jsx(_,{size:"large",icon:e.jsx(Pt,{}),onClick:()=>c(x),children:"Buy"})]})})],children:e.jsxs(F,{container:!0,spacing:0,children:[e.jsx(F,{item:!0,xs:12,sm:12,md:4,sx:{backgroundSize:"cover",backgroundPosition:"center",backgroundImage:"url("+x.cover+")"},children:e.jsx(ne,{sx:{display:{xs:"block",md:"none"},height:100,width:"100%",backgroundSize:"cover",backgroundPosition:"center",backgroundImage:"url("+x.cover+")"}})}),e.jsx(F,{item:!0,xs:12,sm:12,md:8,children:e.jsx(ne,{style:{padding:"10px"},children:e.jsxs(me,{direction:"vertical",children:[e.jsx("a",{children:e.jsx("h3",{children:x.title.length>50?x.title.substring(0,50)+"...":x.title})}),e.jsx("p",{children:x.description.replace(/(<([^>]+)>)/gi,"").length>100?x.description.replace(/(<([^>]+)>)/gi,"").substring(0,100)+"...":x.description.replace(/(<([^>]+)>)/gi,"")}),e.jsx("div",{children:e.jsx(me,{children:e.jsx(le,{title:"Click to View Author Profile",children:e.jsxs("a",{children:[e.jsx(Ne,{size:"small",src:x.author.pic}),e.jsx("span",{style:{marginLeft:"10px"},children:x.author.fullName})]})})})})]})})})]})})}))]})}),e.jsx(X,{children:e.jsx(U,{span:24,style:{display:"flex",justifyContent:"center",marginTop:"10px",marginBottom:"20px"},children:e.jsx(Ie,{defaultCurrent:R,total:i})})}),e.jsx(Oe,{title:"Purchase Book",open:S,onClose:x=>A(x),width:"40vw",children:e.jsx(ht,{book:k,randKey:Math.random()})})]})},ur=()=>{const{push:n}=Y();return t.useEffect(()=>{document.title=de.system_name+": Books MarketPlace"},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10},children:e.jsxs(M,{children:[e.jsx(M.Item,{children:e.jsx("a",{onClick:()=>n("/olib"),children:"Home"})}),e.jsx(M.Item,{children:"Books MarketPlace"})]})}),e.jsx($t,{public:!1,randKey:Math.random()})]})},hr=()=>{const{push:n}=Y();return t.useEffect(()=>{document.title=de.system_name+": Public Books"},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10},children:e.jsxs(M,{children:[e.jsx(M.Item,{children:e.jsx("a",{onClick:()=>n("/olib"),children:"Home"})}),e.jsx(M.Item,{children:"Public Books"})]})}),e.jsx($t,{public:!0,randKey:Math.random()})]})},{Search:fr}=se,pr=n=>{const[r,a]=t.useState(!1),[i,o]=t.useState(0),[l,m]=t.useState(0),[R,f]=t.useState(1),[b,T]=t.useState(25),[k,w]=t.useState(""),[S,A]=t.useState([]);t.useState(),N.useForm(),t.useState(!1);const[c,C]=t.useState(!1);Y();const v=async(P,j="",y=25)=>{a(!0);const{data:u}=await J.custom({url:"",method:"get",meta:{operation:"authorBooksPurchases",variables:{page:{value:P,type:"Int",required:!0},key:{value:j,type:"String",required:!1},pageSize:{value:y,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","price","paymentDate","receiptNumber","isPaid",{book:["id","title","description","file","cover","price","created","updated","isActive","isPublic","hasPurchaseOrder","canEdit","canDelete","canManage",{author:["id","firstName","lastName","middleName","fullName","email","pic"]}]},{user:["id","firstName","middleName","lastName"]},{bill:["id","billNumber"]},"isActive","created","updated","canDelete","canManage"]}]}}).catch(g=>(V.error("Error getting Bills"),{data:null})).then(g=>g);u&&(o(u.total),m(u.pages),f(u.page),A(u.results)),a(!1)},x=[{title:"Bill#",dataIndex:"billNumber",fixed:!0,render:(P,j,y)=>{var u;return e.jsx("span",{children:e.jsx("a",{children:(u=j==null?void 0:j.bill)==null?void 0:u.billNumber})})}},{title:"Book Title",dataIndex:"bookTitle",fixed:!0,render:(P,j,y)=>{var u;return e.jsx("span",{children:e.jsx("a",{children:(u=j==null?void 0:j.book)==null?void 0:u.title})})}},{title:"Amount",dataIndex:"billAmount",fixed:!0,render:(P,j,y)=>e.jsxs("span",{children:[j.price," Tsh"]})}];return t.useEffect(()=>{v(R,"",25)},[n.randKey]),e.jsxs(e.Fragment,{children:[e.jsx(Fe,{offsetTop:75,children:e.jsxs(X,{style:{display:"flex",justifyContent:"flex-start",marginTop:20},children:[e.jsx(U,{span:10,children:e.jsx(fr,{size:"large",placeholder:"Search Disbursement(s) ...",onSearch:P=>v(1,P,25),style:{width:"100%"}})}),e.jsx(U,{span:14,style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(_,{icon:e.jsx(Be,{}),size:"large",onClick:()=>C(!0),children:"Create Disbursement"})})]})}),e.jsx(X,{children:e.jsx(U,{span:24,children:e.jsx(dt,{loading:r,columns:x,dataSource:S,pagination:{onChange:(P,j)=>{T(j),v(P,k,j)},total:i,pageSize:b,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0}})})}),e.jsx(Oe,{title:"Creating Dibursement",width:"35vw",open:c,onClose:P=>C(P),children:e.jsx("p",{children:"Creating Dibursement"})})]})},gr=()=>{const{push:n}=Y();return t.useEffect(()=>{document.title=de.system_name+": Books Purchases Disbursement"},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10},children:e.jsxs(M,{children:[e.jsx(M.Item,{children:e.jsx("a",{onClick:()=>n("/olib"),children:"Home"})}),e.jsx(M.Item,{children:e.jsx("a",{onClick:()=>n("/olib/publish/books"),children:"Published Books"})}),e.jsx(M.Item,{children:e.jsx("a",{onClick:()=>n("/olib/books/purchases"),children:"Books Purchases"})}),e.jsx(M.Item,{children:"Books Purchases Disbursement"})]})}),e.jsx(pr,{})]})},{Search:mr}=se,xr=n=>{const[r,a]=t.useState(!1),[i,o]=t.useState(0),[l,m]=t.useState(0),[R,f]=t.useState(1),[b,T]=t.useState(25),[k,w]=t.useState(""),[S,A]=t.useState([]),[c,C]=t.useState();N.useForm();const[v,x]=t.useState(!1),{push:P}=Y(),j=async(u,g="",p=25)=>{a(!0);const{data:h}=await J.custom({url:"",method:"get",meta:{operation:"authorBooksPurchases",variables:{page:{value:u,type:"Int",required:!0},key:{value:g,type:"String",required:!1},pageSize:{value:p,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","price","paymentDate","receiptNumber","isPaid",{book:["id","title","description","file","cover","price","created","updated","isActive","isPublic","hasPurchaseOrder","canEdit","canDelete","canManage",{author:["id","firstName","lastName","middleName","fullName","email","pic"]}]},{user:["id","firstName","middleName","lastName"]},{bill:["id","billNumber"]},"isActive","created","updated","canDelete","canManage"]}]}}).catch(D=>(V.error("Error getting Bills"),{data:null})).then(D=>D);h&&(o(h.total),m(h.pages),f(h.page),A(h.results)),a(!1)},y=[{title:"Bill#",dataIndex:"billNumber",fixed:!0,render:(u,g,p)=>{var h;return e.jsx("span",{children:e.jsx("a",{children:(h=g==null?void 0:g.bill)==null?void 0:h.billNumber})})}},{title:"Book Title",dataIndex:"bookTitle",fixed:!0,render:(u,g,p)=>{var h;return e.jsx("span",{children:e.jsx("a",{children:(h=g==null?void 0:g.book)==null?void 0:h.title})})}},{title:"Amount",dataIndex:"billAmount",fixed:!0,render:(u,g,p)=>e.jsxs("span",{children:[g.price," Tsh"]})}];return t.useEffect(()=>{j(R,"",25)},[n.randKey]),e.jsxs(e.Fragment,{children:[e.jsx(Fe,{offsetTop:75,children:e.jsxs(X,{style:{display:"flex",justifyContent:"flex-start",marginTop:20},children:[e.jsx(U,{span:10,children:e.jsx(mr,{size:"large",placeholder:"Search Purchase(s) ...",onSearch:u=>j(1,u,25),style:{width:"100%"}})}),e.jsx(U,{span:14,style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(_,{icon:e.jsx(kt,{}),size:"large",onClick:()=>P("/olib/books/purchases/disbursements"),children:"Disbursement"})})]})}),e.jsx(X,{children:e.jsx(U,{span:24,children:e.jsx(dt,{loading:r,columns:y,dataSource:S,pagination:{onChange:(u,g)=>{T(g),j(u,k,g)},total:i,pageSize:b,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0}})})}),e.jsx(Oe,{title:"Order Details & Payment",open:v,width:"50vw",onClose:u=>x(u),children:e.jsx(ht,{book:c==null?void 0:c.book})})]})},yr=()=>{const{push:n}=Y();return t.useEffect(()=>{document.title=de.system_name+": Books Purchases"},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10},children:e.jsxs(M,{children:[e.jsx(M.Item,{children:e.jsx("a",{onClick:()=>n("/olib"),children:"Home"})}),e.jsx(M.Item,{children:e.jsx("a",{onClick:()=>n("/olib/publish/books"),children:"Published Books"})}),e.jsx(M.Item,{children:"Books Purchases"})]})}),e.jsx(xr,{})]})};ae.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${ae.version}/pdf.worker.js`;const jr=n=>{const[r,a]=t.useState(900),[i,o]=t.useState(),[l,m]=t.useState(1),[R,f]=t.useState(!1),b=w=>{m(S=>S+w)},T=()=>{b(-1)},k=()=>{b(1)};return t.useEffect(()=>{a(window.innerWidth)},[n.randKey]),e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx("div",{style:{maxHeight:"85vh",minHeight:"85vh",overflowY:"auto",overflowX:"hidden"},onContextMenu:w=>{},children:e.jsx(Zn,{file:n.book.file,onLoadSuccess:({numPages:w})=>{o(w),f(!0)},children:e.jsx(cr,{pageNumber:l,width:r/1.3})})}),R&&e.jsxs("div",{style:{display:"flex",justifyContent:"center",paddingTop:"10px"},children:[e.jsxs(_,{disabled:l<=1,onClick:T,children:[e.jsx(rn,{}),"Previous Page (",l," of ",i,")"]}),"  ",e.jsxs(_,{disabled:l===i,onClick:k,children:["Next Page (",l," of ",i,")",e.jsx(sn,{})]})]})]})})},{Search:br}=se,vr=n=>{const[r,a]=t.useState(!1),[i,o]=t.useState(!1),[l,m]=t.useState(),[R,f]=t.useState(0),[b,T]=t.useState(0),[k,w]=t.useState(1),[S,A]=t.useState([]),[c,C]=t.useState(),[v,x]=t.useState(!1);N.useForm();const{push:P}=Y(),j=h=>{C(h),x(!0)},y=async(h,D="")=>{a(!0);const{data:E}=await J.custom({url:"",method:"get",meta:{operation:"userBooks",variables:{page:{value:h,type:"Int",required:!0},key:{value:D,type:"String",required:!1},pageSize:{value:20,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{book:["id","title","description","file","cover","price","created","updated","isActive","isPublic","averageRating","downloadable","canEdit","canDelete","canManage",{author:["id","firstName","lastName","middleName","fullName","email","pic"]}]}]}]}}).catch(d=>(V.error("Error getting Books"),{data:null})).then(d=>d);E&&(f(E.total),T(E.pages),w(E.page),A(E.results)),a(!1)},u=async()=>{o(!0);const{data:h}=await J.custom({url:"",method:"get",meta:{operation:"olibDashboardAnalytics",fields:["analytics"]}}).catch(D=>(V.error("Error fetching analytics"),{data:null})).then(D=>D);h&&m(h.analytics),o(!1)},g=async(h,D)=>{const{data:E}=await J.custom({url:"",method:"post",meta:{operation:"createBookRating",variables:{bookId:{value:D,type:"Int",required:!0},rating:{value:h,type:"Int",required:!0}},fields:["success","message",{userBook:["id",{book:["id","title","description","file","cover","price","created","updated","isActive","isPublic","averageRating","downloadable","canEdit","canDelete","canManage",{author:["id","firstName","lastName","middleName","fullName","email","pic"]}]}]}]}}).catch(d=>(console.log(d),{data:null})).then(d=>d);if(E){const d=S.map(L=>L.id===E.userBook.id?E.userBook:L);A(d)}},p=(h,D)=>e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Rated: "}),e.jsxs("span",{children:[[1,2,3,4,5].map(E=>e.jsx("span",{style:{marginRight:5},children:E<=h?e.jsx(le,{title:E,children:e.jsx("a",{onClick:()=>{g(E,D)},style:{display:"inline"},children:e.jsx(ln,{style:{color:"orange"}})})}):e.jsx(le,{title:E,children:e.jsx("a",{onClick:()=>{g(E,D)},style:{display:"inline"},children:e.jsx(cn,{})})})})),e.jsx(ge,{color:"green",children:h})]})]});return t.useEffect(()=>{u(),y(k,"")},[n.randKey]),e.jsxs(e.Fragment,{children:[e.jsx(ne,{children:e.jsxs(F,{container:!0,spacing:0,children:[e.jsx(F,{item:!0,xs:6,sm:6,md:2,children:e.jsx("a",{onClick:()=>P("/olib"),children:e.jsxs(Pe,{children:[e.jsx(ge,{children:l==null?void 0:l.my_books})," Books To Read"]})})}),e.jsx(F,{item:!0,xs:6,sm:6,md:2,children:e.jsx("a",{onClick:()=>P("/olib/books/public"),children:e.jsxs(Pe,{style:{cursor:"pointer"},children:[e.jsx(ge,{children:l==null?void 0:l.public_books})," Public Books"]})})})]})}),e.jsx(Fe,{offsetTop:75,children:e.jsx(ne,{sx:{display:"flex",justifyContent:"center",mt:1,mb:1},children:e.jsx(F,{container:!0,spacing:0,sx:{display:"flex",justifyContent:"flex-start"},children:e.jsx(F,{item:!0,xs:12,sm:4,md:6,children:e.jsx(br,{size:"large",placeholder:"Enter Book Title, Description to search ...",onSearch:h=>y(1,h),style:{width:"100%"}})})})})}),e.jsxs(Ke,{spinning:r,children:[e.jsxs(F,{container:!0,spacing:0,children:[S.length===0&&!r&&e.jsx(e.Fragment,{children:e.jsx(F,{item:!0,xs:12,sm:12,md:12,children:e.jsx(We,{description:"No Book Published"})})}),S.map(h=>e.jsx(F,{item:!0,xs:12,sm:12,md:6,children:e.jsx(Pe,{hoverable:!0,bordered:!0,style:{margin:"2px"},type:"inner",actions:[e.jsx("span",{children:p(h.book.averageRating,h.book.id)}),e.jsxs("span",{style:{float:"right",marginRight:"10px",display:"flex"},children:[h.book.downloadable&&e.jsx(_,{icon:e.jsx(an,{}),children:e.jsx("a",{href:h.book.file,target:"_blank",download:!0,children:"Download"})}),e.jsx(_,{style:{marginRight:"10px"},icon:e.jsx(ft,{}),onClick:()=>j(h),children:"Read"}),e.jsx(Et,{trigger:["click"],overlay:e.jsxs(ke,{children:[e.jsx(ke.Item,{icon:e.jsx(ft,{}),onClick:()=>j(h),children:e.jsx("a",{rel:"noopener noreferrer",children:"Read"})}),e.jsx(ke.Item,{icon:e.jsx(on,{}),onClick:()=>V("Under construction"),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Report"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:D=>D.preventDefault(),children:e.jsx(Ct,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})]})],children:e.jsxs(F,{container:!0,spacing:0,children:[e.jsx(F,{item:!0,xs:12,sm:12,md:4,sx:{backgroundSize:"cover",backgroundPosition:"center",backgroundImage:"url("+h.book.cover+")"},children:e.jsx(ne,{sx:{display:{xs:"block",md:"none"},height:100,width:"100%",backgroundSize:"cover",backgroundPosition:"center",backgroundImage:"url("+h.book.cover+")"}})}),e.jsx(F,{item:!0,xs:12,sm:12,md:8,children:e.jsx(ne,{style:{padding:"10px"},children:e.jsxs(me,{direction:"vertical",children:[e.jsx("a",{children:e.jsx("h3",{children:h.book.title.length>50?h.book.title.substring(0,50)+"...":h.book.title})}),e.jsx("p",{children:h.book.description.replace(/(<([^>]+)>)/gi,"").length>100?h.book.description.replace(/(<([^>]+)>)/gi,"").substring(0,100)+"...":h.book.description.replace(/(<([^>]+)>)/gi,"")}),e.jsx("div",{children:e.jsx(me,{children:e.jsx(le,{title:"Click to View Author Profile",children:e.jsxs("a",{children:[e.jsx(Ne,{size:"small",src:h.book.author.pic}),e.jsx("span",{style:{marginLeft:"10px"},children:h.book.author.fullName})]})})})})]})})})]})})}))]}),e.jsx(X,{children:e.jsx(U,{span:24,style:{display:"flex",justifyContent:"center",marginTop:"10px",marginBottom:"20px"},children:e.jsx(Ie,{defaultCurrent:k,total:R,defaultPageSize:20,onChange:h=>{w(h),y(h,"")}})})})]}),e.jsx($e,{title:c==null?void 0:c.book.title,anchor:"right",width:"80vw",onClose:h=>x(h),open:v,children:e.jsx(jr,{book:c==null?void 0:c.book,randKey:Math.random()})})]})},Sr=()=>{const{push:n}=Y();return t.useEffect(()=>{document.title=de.system_name+": Dashboard"},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10},children:e.jsxs(M,{children:[e.jsx(M.Item,{children:e.jsx("a",{onClick:()=>n("/olib"),children:"Home"})}),e.jsx(M.Item,{children:"Dashboard"})]})}),e.jsx(vr,{})]})},{Search:Pr}=se,kr=n=>{const[r,a]=t.useState(!0),[i,o]=t.useState(!1),[l,m]=t.useState(0),[R,f]=t.useState(0),[b,T]=t.useState(1),[k,w]=t.useState(25),[S,A]=t.useState(""),[c,C]=t.useState(!1),[v,x]=t.useState([]);Y();const P=async(y,u="",g=25)=>{o(!0);const{data:p}=await J.custom({url:"",method:"get",meta:{operation:"booksAuthorsToAdd",variables:{page:{value:y,type:"Int",required:!0},key:{value:u,type:"String",required:!1},pageSize:{value:g,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","firstName","middleName","lastName","fullName","email","pic","isActive","created","updated","canDelete","canManage"]}]}}).catch(()=>(V.error("Error getting authors"),{data:null})).then(h=>h);p&&(m(p.total),f(p.pages),T(p.page),C(p.hasNext),x([...p.results])),o(!1)},j=async y=>{const{data:u}=await J.custom({url:"",method:"post",meta:{operation:"addBooksAuthor",variables:{authorId:{value:y,type:"Int",required:!0}},fields:["success","message",{bookAuthor:["id",{user:["id","firstName","middleName","lastName","fullName","email","pic","isActive","created","updated","canDelete","canManage"]},"isActive","created","updated","canDelete","canManage"]}]}}).catch(()=>(V.error("Error Adding Author"),{data:null})).then(g=>g);u&&(u.success?(V.success(u.message),x(v.filter(g=>parseInt(g.id.toString())!==y)),n.onAdd(u.bookAuthor)):V.error(u.message)),o(!1)};return t.useEffect(()=>{P(b,S,k),a(!1)},[n.randKey]),e.jsxs(e.Fragment,{children:[e.jsx(Fe,{offsetTop:90,children:e.jsx(X,{style:{display:"flex",justifyContent:"flex-start"},children:e.jsx(U,{span:10,children:e.jsx(Pr,{size:"large",placeholder:"Search Purchase(s) ...",onSearch:y=>{A(y),P(1,y,k)},style:{width:"100%"}})})})}),e.jsx("div",{style:{maxHeight:"80vh",minHeight:"80vh",overflowY:"auto",overflowX:"hidden",marginTop:"10px"},children:e.jsx(Qe,{itemLayout:"horizontal",dataSource:v,renderItem:y=>e.jsx(Qe.Item,{actions:[e.jsx(Je,{title:"Adding Books Author??",onConfirm:()=>j(parseInt(y.id.toString())),okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx(_,{icon:e.jsx(Be,{}),size:"large"})})],children:e.jsx(dn,{avatar:!0,title:!1,loading:i,active:!0,children:e.jsx(Qe.Item.Meta,{avatar:e.jsx(Ne,{src:y.pic}),title:e.jsx("a",{children:y.fullName}),description:e.jsx(e.Fragment,{children:e.jsx(ge,{color:"green",children:y.email})})})})})})}),e.jsx("div",{style:{display:"flex",justifyContent:"center"},children:e.jsx(Ie,{defaultCurrent:b,total:l,pageSize:25,onChange:(y,u)=>{w(u),T(y),P(y,S,u)}})})]})},{Search:Er}=se,Cr=n=>{const[r,a]=t.useState(!1),[i,o]=t.useState(0),[l,m]=t.useState(0),[R,f]=t.useState(1),[b,T]=t.useState([]);t.useState(),t.useState(!1);const[k,w]=t.useState(!1),[S,A]=t.useState(!1);N.useForm(),Y();const c=async(v,x="")=>{a(!0);const{data:P}=await J.custom({url:"",method:"get",meta:{operation:"vertedBooksPublishers",variables:{page:{value:v,type:"Int",required:!0},key:{value:x,type:"String",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{user:["id","firstName","lastName","middleName","fullName","email","pic"]},"canEdit","canDelete","canManage"]}]}}).catch(j=>(V.error("Error getting Books"),{data:null})).then(j=>j);P&&(o(P.total),m(P.pages),f(P.page),T(P.results)),a(!1)},C=async v=>{T([v,...b])};return t.useEffect(()=>{c(R,"")},[n.randKey]),e.jsxs(e.Fragment,{children:[e.jsxs(X,{style:{display:"flex",justifyContent:"flex-start",marginTop:20},children:[e.jsx(U,{span:10,children:e.jsx(Er,{size:"large",placeholder:"Search Purchase(s) ...",onSearch:v=>c(1,v),style:{width:"100%"}})}),e.jsx(U,{span:14,style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(_,{icon:e.jsx(Be,{}),size:"large",onClick:()=>w(!0),children:"Add Authors"})})]}),e.jsx(Ke,{spinning:r,children:e.jsxs(X,{children:[b.length===0&&e.jsx(e.Fragment,{children:e.jsx(U,{span:24,children:e.jsx(We,{description:"No Book Published"})})}),b.map(v=>e.jsx(U,{span:6,children:e.jsx(Pe,{hoverable:!0,bordered:!0,style:{margin:"2px"},bodyStyle:{minHeight:100,maxHeight:100},actions:[e.jsx(_,{disabled:!0,size:"large",children:"100 Books"}),e.jsx(le,{title:"View Authors Details",color:"green",children:e.jsx(_,{icon:e.jsx(un,{}),size:"large",onClick:()=>A(!0)})}),e.jsx("span",{style:{background:"red"},children:v.canDelete&&e.jsx(Je,{title:"Delete the Author",okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx(_,{size:"large",icon:e.jsx(ut,{})})})})],children:e.jsx(X,{children:e.jsx(U,{span:24,style:{padding:"10px"},children:e.jsx(me,{direction:"horizontal",children:e.jsxs("a",{children:[e.jsx(Ne,{src:v.user.pic,size:"large"}),e.jsx("span",{style:{marginLeft:10},children:v.user.fullName})]})})})})})},v.id))]})}),e.jsx(X,{children:e.jsx(U,{span:24,style:{display:"flex",justifyContent:"center",marginTop:"10px",marginBottom:"20px"},children:e.jsx(Ie,{defaultCurrent:R,total:i})})}),e.jsx($e,{title:"Adding Authors",anchor:"right",width:"50vw",onClose:v=>w(v),open:k,children:e.jsx(kr,{randKey:Math.random(),onAdd:C})}),e.jsx($e,{title:"Author Details",width:"50vw",anchor:"right",onClose:v=>A(v),open:S,children:e.jsxs(e.Fragment,{children:[e.jsxs(te,{title:"Author Info",children:[e.jsx(te.Item,{label:"UserName",children:"Zhou Maomao"}),e.jsx(te.Item,{label:"Telephone",children:"1810000000"}),e.jsx(te.Item,{label:"Live",children:"Hangzhou, Zhejiang"}),e.jsx(te.Item,{label:"Remark",children:"empty"}),e.jsx(te.Item,{label:"Address",children:"No. 18, Wantang Road, Xihu District, Hangzhou, Zhejiang, China"})]}),e.jsxs(te,{title:"Author Company Info",children:[e.jsx(te.Item,{label:"UserName",children:"Zhou Maomao"}),e.jsx(te.Item,{label:"Telephone",children:"1810000000"}),e.jsx(te.Item,{label:"Live",children:"Hangzhou, Zhejiang"}),e.jsx(te.Item,{label:"Remark",children:"empty"}),e.jsx(te.Item,{label:"Address",children:"No. 18, Wantang Road, Xihu District, Hangzhou, Zhejiang, China"})]})]})})]})},Tr=()=>{const{push:n}=Y();return t.useEffect(()=>{document.title=de.system_name+": Books Authors"},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10},children:e.jsxs(M,{children:[e.jsx(M.Item,{children:e.jsx("a",{onClick:()=>n("/olib"),children:"Home"})}),e.jsx(M.Item,{children:"Books Authors"})]})}),e.jsx(Cr,{randKey:Math.random()})]})},{Search:Rr}=se,wr=n=>{const[r,a]=t.useState(!1),[i,o]=t.useState(0),[l,m]=t.useState(0),[R,f]=t.useState(1),[b,T]=t.useState(25),[k,w]=t.useState(""),[S,A]=t.useState([]),[c,C]=t.useState();N.useForm();const[v,x]=t.useState(!1);Y();const P=async g=>{C(g),x(!0)},j=async(g,p="",h=25)=>{a(!0);const{data:D}=await J.custom({url:"",method:"get",meta:{operation:"myBooksOrders",variables:{page:{value:g,type:"Int",required:!0},key:{value:p,type:"String",required:!1},pageSize:{value:h,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","price","paymentDate","receiptNumber","isPaid",{book:["id","title","description","file","cover","price","created","updated","isActive","isPublic","hasPurchaseOrder","canEdit","canDelete","canManage",{author:["id","firstName","lastName","middleName","fullName","email","pic"]}]},{user:["id","firstName","middleName","lastName"]},{bill:["id","billNumber"]},"isActive","created","updated","canDelete","canManage"]}]}}).catch(E=>(V.error("Error getting Bills"),{data:null})).then(E=>E);D&&(o(D.total),m(D.pages),f(D.page),A(D.results)),a(!1)},y=async g=>{const{data:p}=await J.custom({url:"",method:"post",meta:{operation:"deleteBookOrder",variables:{id:{value:g,type:"Int",required:!0}},fields:["success","message"]}}).catch(h=>(V.error("Error deleting Order"),{data:null})).then(h=>h);p&&A(S.filter(h=>h.id!==g))},u=[{title:"Bill#",dataIndex:"billNumber",fixed:!0,render:(g,p,h)=>{var D;return e.jsx("span",{children:e.jsx("a",{children:(D=p==null?void 0:p.bill)==null?void 0:D.billNumber})})}},{title:"Book Title",dataIndex:"bookTitle",fixed:!0,render:(g,p,h)=>{var D;return e.jsx("span",{children:e.jsx("a",{children:(D=p==null?void 0:p.book)==null?void 0:D.title})})}},{title:"Bill Amount",dataIndex:"billAmount",fixed:!0,render:(g,p,h)=>e.jsxs("span",{children:[p.price," Tsh"]})},{title:"Paid",dataIndex:"isPaid",fixed:!0,render:(g,p,h)=>e.jsx("span",{children:p.isPaid?e.jsx(ge,{color:"green",children:"Yes"}):e.jsx(ge,{color:"red",children:"No"})})},{title:"Created",dataIndex:"created",render:(g,p,h)=>e.jsx(e.Fragment,{children:e.jsx("span",{children:e.jsx(hn,{date:new Date(p.created)})})})},{title:"Status",dataIndex:"isActive",render:(g,p,h)=>e.jsx("a",{children:p!=null&&p.isActive?e.jsx("span",{style:{color:"green"},children:"Active"}):e.jsx("span",{style:{color:"red"},children:"Inactive"})})},{title:"",dataIndex:"action",render:(g,p,h)=>e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end"},children:[!p.isPaid&&e.jsx(Je,{title:"Are you sure to delete this Order?",onConfirm:()=>y(p.id),okText:"Yes",cancelText:"No",disabled:!(p!=null&&p.canDelete),overlayStyle:{zIndex:9999},children:e.jsx(_,{icon:e.jsx(ut,{}),disabled:!(p!=null&&p.canDelete),size:"large"})}),p.isPaid&&e.jsx(le,{title:"Print Receipt",children:e.jsx(_,{icon:e.jsx(fn,{}),size:"large"})}),!p.isPaid&&e.jsx(le,{title:"View Order Details",placement:"topLeft",children:e.jsx(_,{icon:e.jsx(kt,{}),size:"large",onClick:()=>P(p)})})]})}];return t.useEffect(()=>{j(R,"",25)},[n.randKey]),e.jsxs(e.Fragment,{children:[e.jsx(Fe,{offsetTop:75,children:e.jsx(X,{style:{display:"flex",justifyContent:"flex-start",marginTop:20},children:e.jsx(U,{span:10,children:e.jsx(Rr,{size:"large",placeholder:"Search Bill(s) ...",onSearch:g=>j(1,g,25),style:{width:"100%"}})})})}),e.jsx(X,{children:e.jsx(U,{span:24,children:e.jsx(dt,{loading:r,columns:u,dataSource:S,pagination:{onChange:(g,p)=>{T(p),j(g,k,p)},total:i,pageSize:b,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0}})})}),e.jsx(Oe,{title:"Order Details & Payment",open:v,width:"50vw",onClose:g=>x(g),children:e.jsx(ht,{book:c==null?void 0:c.book})})]})},Ar=()=>{const{push:n}=Y();return t.useEffect(()=>{document.title=de.system_name+": Books Orders"},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10},children:e.jsxs(M,{children:[e.jsx(M.Item,{children:e.jsx("a",{onClick:()=>n("/olib"),children:"Home"})}),e.jsx(M.Item,{children:"Books Orders"})]})}),e.jsx(wr,{})]})},vt=[".pdf"],Dr=n=>Array.isArray(n)?n:n==null?void 0:n.fileList,Lr=n=>{const[r,a]=t.useState(""),[i,o]=t.useState(!1),[l,m]=t.useState(!1),[R,f]=t.useState(!1),[b,T]=t.useState(""),[k]=N.useForm(),w=[{label:"Public (Free)",value:!0},{label:"Private (Payable or Rentable)",value:!1}],S=async c=>{o(!0);const{data:C}=await J.custom({url:"",method:"post",meta:{operation:"publishBook",variables:{file:{value:c.file,type:"Upload",required:!0},title:{value:c.title,type:"String",required:!0},description:{value:c.description,type:"String",required:!0},price:{value:c.price,type:"Float",required:!1},isPublic:{value:c.is_public,type:"Boolean",required:!0},downloadable:{value:c.downloadable,type:"Boolean",required:!1}},fields:["success","message"]}}).catch(v=>(V.error("Error creating publishing book"),{data:null})).then(v=>v);C&&(C.success?(V.success(C.message),n.onFinish()):V.error(C.message)),o(!1)},A=c=>(c=c.replace(/[-_]/g," "),c=c.replace(/.pdf/g,""),c=c.replace(/[.]/g," "),c=c.replace(/\s+/g," "),c=c.trim(),c);return e.jsx(e.Fragment,{children:e.jsx(Ke,{spinning:i,children:e.jsxs(N,{layout:"vertical",form:k,onFinish:c=>{c.price=c.price??0,c.downloadable=R,c.description=b,S(c)},requiredMark:!0,children:[e.jsx(N.Item,{label:"Pick a Book ("+vt.join()+")",children:e.jsx(N.Item,{name:"file",valuePropName:"fileList",getValueFromEvent:c=>{var v,x;a((v=c==null?void 0:c.file)==null?void 0:v.name);const C=(x=c==null?void 0:c.file)==null?void 0:x.name.split(".");return C.pop(),k.setFieldsValue({title:A(C.join("."))}),Dr(c)},noStyle:!0,rules:[{required:!0,type:"array",message:"Please upload Book file"}],children:e.jsxs(nt.Dragger,{name:"file",accept:vt.join(),multiple:!1,maxCount:1,beforeUpload:()=>!1,onRemove:()=>{a(""),k.setFieldsValue({title:""})},children:[e.jsx("p",{className:"ant-upload-drag-icon",children:e.jsx(rt,{})}),e.jsx("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"})]})})}),e.jsx(N.Item,{name:"title",label:"Book Title",initialValue:r,rules:[{required:!0,type:"string"}],children:e.jsx(se,{size:"large",placeholder:"Enter Book Title ..."})}),e.jsx(N.Item,{name:"is_public",label:"Availability",initialValue:!0,children:e.jsx(st.Group,{options:w,onChange:c=>{m(!c.target.value)},value:!0})}),l&&e.jsx(N.Item,{label:"Book Cost (Tsh)",name:"price",rules:[{required:l,type:"number",min:1e3,message:"Price must be greater than 1000"}],children:e.jsx(at,{style:{width:"50%"},size:"large"})}),e.jsx(N.Item,{name:"downloadable",valuePropName:"checked",children:e.jsx(ot,{onChange:c=>{f(c.target.checked)},children:"Downloadable"})}),e.jsxs("div",{style:{marginBottom:20},children:[e.jsx("h3",{children:"Description"}),e.jsx(it.CKEditor,{disabled:i,editor:lt,data:b,onReady:c=>{c.editing.view.change(C=>{C.setStyle("min-height","100px",c.editing.view.document.getRoot())})},onChange:(c,C)=>{const v=C.getData();T(v)},config:{toolbar:{items:["bold","italic","strikethrough","underline","code","subscript","superscript","removeFormat","|","bulletedList","numberedList","todoList","|","outdent","indent","|","-","fontSize","fontFamily","fontColor","fontBackgroundColor","highlight","|","alignment","|","EmojiPanel"],shouldNotGroupWhenFull:!0},fontFamily:{options:["default","Arial, Helvetica, sans-serif","Courier New, Courier, monospace","Georgia, serif","Lucida Sans Unicode, Lucida Grande, sans-serif","Tahoma, Geneva, sans-serif","Times New Roman, Times, serif","Trebuchet MS, Helvetica, sans-serif","Verdana, Geneva, sans-serif"],supportAllValues:!0},fontSize:{options:[10,12,14,"default",18,20,22],supportAllValues:!0}}})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(_,{type:"primary",size:"large",htmlType:"submit",loading:i,children:"Publish"})})]})})})},Ge=[".pdf"],St=n=>Array.isArray(n)?n:n==null?void 0:n.fileList,Br=n=>{var x,P,j,y,u,g,p,h,D,E;const[r,a]=t.useState(0),[i,o]=t.useState(""),[l,m]=t.useState(!1),[R,f]=t.useState(!1),[b,T]=t.useState(!1),[k,w]=t.useState(""),[S]=N.useForm(),[A]=N.useForm(),c=[{label:"Public (Free)",value:!0},{label:"Private (Payable or Rentable)",value:!1}],C=async d=>{m(!0);const{data:L}=await J.custom({url:"",method:"post",meta:{operation:"publishBook",variables:{file:{value:d.file,type:"Upload",required:!0},title:{value:d.title,type:"String",required:!0},description:{value:d.description,type:"String",required:!0},price:{value:d.price,type:"Float",required:!1},isPublic:{value:d.is_public,type:"Boolean",required:!0},downloadable:{value:d.downloadable,type:"Boolean",required:!1}},fields:["success","message"]}}).catch(B=>(V.error("Error creating publishing book"),{data:null})).then(B=>B);L&&(L.success?(V.success(L.message),n.onFinish()):V.error(L.message)),m(!1)},v=d=>(d=d.replace(/[-_]/g," "),d=d.replace(/.pdf/g,""),d=d.replace(/[.]/g," "),d=d.replace(/\s+/g," "),d=d.trim(),d);return e.jsxs(e.Fragment,{children:[e.jsxs(ne,{sx:{display:"flex",justifyContent:"flex-end"},children:[e.jsx(_,{onClick:()=>a(0),children:"Book Info"}),e.jsx(_,{onClick:()=>a(1),children:"Edit Book Basic Info"}),e.jsx(_,{onClick:()=>a(2),children:"Edit Book Cover Image"}),e.jsx(_,{onClick:()=>a(3),children:"Edit Book Descriptions"})]}),r===0&&e.jsx(e.Fragment,{children:e.jsxs(ne,{sx:{width:"100%"},children:[e.jsxs(Le,{variant:"h4",gutterBottom:!0,children:[e.jsx("b",{children:"Title"}),": ",(x=n.book)==null?void 0:x.title,e.jsx(qe,{})]}),e.jsxs(Le,{variant:"h5",gutterBottom:!0,children:[e.jsx("b",{children:"Availability"}),": ",(P=n.book)!=null&&P.isPublic?"Public":"Private",e.jsx(qe,{})]}),e.jsxs(Le,{variant:"h5",gutterBottom:!0,children:[e.jsx("b",{children:"Downloadable"}),": ",(j=n.book)!=null&&j.downloadable?"Yes":"No",e.jsx(qe,{})]}),e.jsxs(Le,{variant:"h5",gutterBottom:!0,children:[e.jsx("b",{children:"Price"}),": ",(y=n.book)==null?void 0:y.price," Tsh",e.jsx(qe,{})]}),e.jsxs(Le,{variant:"subtitle1",gutterBottom:!0,children:[e.jsx("b",{children:"Description"}),": ",(u=n.book)==null?void 0:u.description]})]})}),r===1&&e.jsxs(N,{layout:"vertical",form:A,onFinish:d=>{d.price=d.price??0,d.downloadable=b,d.description=k,C(d)},requiredMark:!0,initialValues:{title:(g=n.book)==null?void 0:g.title,is_public:(p=n.book)==null?void 0:p.isPublic,price:(h=n.book)==null?void 0:h.price,downloadable:(D=n.book)==null?void 0:D.downloadable},children:[e.jsx(N.Item,{name:"title",label:"Book Title",initialValue:i,rules:[{required:!0,type:"string"}],children:e.jsx(se,{size:"large",placeholder:"Enter Book Title ..."})}),e.jsx(N.Item,{name:"is_public",label:"Availability",initialValue:!0,children:e.jsx(st.Group,{options:c,onChange:d=>{f(!d.target.value)},value:!0})}),!((E=n.book)!=null&&E.isPublic)&&e.jsx(N.Item,{label:"Book Cost (Tsh)",name:"price",rules:[{required:R,type:"number",min:0}],children:e.jsx(at,{style:{width:"50%"},size:"large"})}),e.jsx(N.Item,{name:"downloadable",valuePropName:"checked",children:e.jsx(ot,{onChange:d=>{T(d.target.checked)},children:"Downloadable"})}),e.jsxs("div",{style:{marginBottom:20},children:[e.jsx("h3",{children:"Description"}),e.jsx(it.CKEditor,{disabled:l,editor:lt,data:k,onReady:d=>{d.editing.view.change(L=>{L.setStyle("min-height","100px",d.editing.view.document.getRoot())})},onChange:(d,L)=>{const B=L.getData();w(B)},config:{toolbar:{items:["bold","italic","strikethrough","underline","code","subscript","superscript","removeFormat","|","bulletedList","numberedList","todoList","|","outdent","indent","|","-","fontSize","fontFamily","fontColor","fontBackgroundColor","highlight","|","alignment","|","EmojiPanel"],shouldNotGroupWhenFull:!0},fontFamily:{options:["default","Arial, Helvetica, sans-serif","Courier New, Courier, monospace","Georgia, serif","Lucida Sans Unicode, Lucida Grande, sans-serif","Tahoma, Geneva, sans-serif","Times New Roman, Times, serif","Trebuchet MS, Helvetica, sans-serif","Verdana, Geneva, sans-serif"],supportAllValues:!0},fontSize:{options:[10,12,14,"default",18,20,22],supportAllValues:!0}}})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(_,{type:"primary",size:"large",htmlType:"submit",loading:l,children:"Publish"})})]}),r===2&&e.jsx(N,{layout:"vertical",form:S,onFinish:d=>{d.price=d.price??0,d.downloadable=b,d.description=k,C(d)},requiredMark:!0,children:e.jsx(N.Item,{label:"Pick a Book ("+Ge.join()+")",children:e.jsx(N.Item,{name:"file",valuePropName:"fileList",getValueFromEvent:d=>{var B,Z;o((B=d==null?void 0:d.file)==null?void 0:B.name);const L=(Z=d==null?void 0:d.file)==null?void 0:Z.name.split(".");return L.pop(),S.setFieldsValue({title:v(L.join("."))}),St(d)},noStyle:!0,rules:[{required:!0,type:"array",message:"Please upload Book file"}],children:e.jsxs(nt.Dragger,{name:"file",accept:Ge.join(),multiple:!1,maxCount:1,beforeUpload:()=>!1,onRemove:()=>{o(""),S.setFieldsValue({title:""})},children:[e.jsx("p",{className:"ant-upload-drag-icon",children:e.jsx(rt,{})}),e.jsx("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"})]})})})}),r===3&&e.jsxs(N,{layout:"vertical",form:S,onFinish:d=>{d.price=d.price??0,d.downloadable=b,d.description=k,C(d)},requiredMark:!0,children:[e.jsx(N.Item,{label:"Pick a Book ("+Ge.join()+")",children:e.jsx(N.Item,{name:"file",valuePropName:"fileList",getValueFromEvent:d=>{var B,Z;o((B=d==null?void 0:d.file)==null?void 0:B.name);const L=(Z=d==null?void 0:d.file)==null?void 0:Z.name.split(".");return L.pop(),S.setFieldsValue({title:v(L.join("."))}),St(d)},noStyle:!0,rules:[{required:!0,type:"array",message:"Please upload Book file"}],children:e.jsxs(nt.Dragger,{name:"file",accept:Ge.join(),multiple:!1,maxCount:1,beforeUpload:()=>!1,onRemove:()=>{o(""),S.setFieldsValue({title:""})},children:[e.jsx("p",{className:"ant-upload-drag-icon",children:e.jsx(rt,{})}),e.jsx("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"})]})})}),e.jsx(N.Item,{name:"title",label:"Book Title",initialValue:i,rules:[{required:!0,type:"string"}],children:e.jsx(se,{size:"large",placeholder:"Enter Book Title ..."})}),e.jsx(N.Item,{name:"is_public",label:"Availability",initialValue:!0,children:e.jsx(st.Group,{options:c,onChange:d=>{f(!d.target.value)},value:!0})}),R&&e.jsx(N.Item,{label:"Book Cost (Tsh)",name:"price",rules:[{required:R,type:"number",min:0}],children:e.jsx(at,{style:{width:"50%"},size:"large"})}),e.jsx(N.Item,{name:"downloadable",valuePropName:"checked",children:e.jsx(ot,{onChange:d=>{T(d.target.checked)},children:"Downloadable"})}),e.jsxs("div",{style:{marginBottom:20},children:[e.jsx("h3",{children:"Description"}),e.jsx(it.CKEditor,{disabled:l,editor:lt,data:k,onReady:d=>{d.editing.view.change(L=>{L.setStyle("min-height","100px",d.editing.view.document.getRoot())})},onChange:(d,L)=>{const B=L.getData();w(B)},config:{toolbar:{items:["bold","italic","strikethrough","underline","code","subscript","superscript","removeFormat","|","bulletedList","numberedList","todoList","|","outdent","indent","|","-","fontSize","fontFamily","fontColor","fontBackgroundColor","highlight","|","alignment","|","EmojiPanel"],shouldNotGroupWhenFull:!0},fontFamily:{options:["default","Arial, Helvetica, sans-serif","Courier New, Courier, monospace","Georgia, serif","Lucida Sans Unicode, Lucida Grande, sans-serif","Tahoma, Geneva, sans-serif","Times New Roman, Times, serif","Trebuchet MS, Helvetica, sans-serif","Verdana, Geneva, sans-serif"],supportAllValues:!0},fontSize:{options:[10,12,14,"default",18,20,22],supportAllValues:!0}}})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(_,{type:"primary",size:"large",htmlType:"submit",loading:l,children:"Publish"})})]})]})},{Search:Nr}=se,Ir=n=>{const[r,a]=t.useState(!1),[i,o]=t.useState(0),[l,m]=t.useState(0),[R,f]=t.useState(1),[b,T]=t.useState([]),[k,w]=t.useState();N.useForm();const[S,A]=t.useState(!1),[c,C]=t.useState(!1),{push:v}=Y(),x=async u=>{w(u),C(!0)},P=async()=>{y(1,""),A(!1)},j=async u=>{const{data:g}=await J.custom({url:"",method:"post",meta:{operation:"deleteBook",variables:{bookId:{value:u,type:"Int",required:!0}},fields:["success","message"]}}).catch(()=>(V.error("Error deleting book"),{data:null})).then(p=>p);g&&(g.success?(V.success(g.message),T(b.filter(p=>p.id!==u))):V.error(g.message))},y=async(u,g="")=>{a(!0);const{data:p}=await J.custom({url:"",method:"get",meta:{operation:"publisherBooks",variables:{page:{value:u,type:"Int",required:!0},key:{value:g,type:"String",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","title","description","file","cover","price","downloadable","publisherCanAddToReadings","created","updated","isActive","isPublic","canEdit","canDelete","canManage",{author:["id","firstName","lastName","middleName","fullName","email","pic"]}]}]}}).catch(()=>(V.error("Error getting Books"),{data:null})).then(h=>h);p&&(o(p.total),m(p.pages),f(p.page),T(p.results)),a(!1)};return t.useEffect(()=>{y(R,"")},[]),e.jsxs(e.Fragment,{children:[e.jsxs(ne,{children:[e.jsx(_,{size:"large",style:{float:"right"},icon:e.jsx(Pt,{}),onClick:()=>v("/olib/books/purchases"),children:"Purchases"}),e.jsx(_,{size:"large",style:{float:"right"},icon:e.jsx(Be,{}),onClick:()=>A(!0),children:"Publish"})]}),e.jsx(F,{container:!0,spacing:0,sx:{display:"flex",justifyContent:"flex-start"},children:e.jsx(F,{item:!0,xs:12,sm:12,md:4,lg:4,xl:4,children:e.jsx(Nr,{size:"large",placeholder:"Enter Book Title, Description to search ...",onSearch:u=>y(1,u),style:{width:"100%"}})})}),e.jsxs(F,{container:!0,spacing:0,children:[b.length===0&&e.jsx(e.Fragment,{children:e.jsx(F,{item:!0,xs:12,sm:12,md:12,lg:12,xl:12,children:e.jsx(We,{description:"No Book Published"})})}),b.map(u=>e.jsx(F,{item:!0,xs:12,sm:12,md:6,lg:6,xl:6,children:e.jsx(Pe,{hoverable:!0,bordered:!0,style:{margin:"2px"},bodyStyle:{minHeight:190,maxHeight:190},type:"inner",actions:[e.jsxs("span",{style:{fontSize:"18px"},children:[u.price," Tsh"]}),e.jsxs("span",{style:{float:"right",marginRight:"10px",display:"flex"},children:[e.jsx(_,{style:{marginRight:"10px"},icon:e.jsx(pt,{}),onClick:()=>x(u),children:"View"}),e.jsx(Et,{trigger:["click"],overlay:e.jsxs(ke,{children:[e.jsx(ke.Item,{icon:e.jsx(pt,{}),onClick:()=>x(u),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"View"})}),e.jsx(ke.Item,{icon:e.jsx(ut,{}),children:e.jsx(Je,{title:"Are you sure to delete this Book?",onConfirm:()=>j(u.id),okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx("a",{rel:"noopener noreferrer",children:"Delete"})})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:g=>g.preventDefault(),children:e.jsx(Ct,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})]})],children:e.jsxs(F,{container:!0,spacing:0,children:[e.jsx(F,{item:!0,xs:12,sm:12,md:4,sx:{backgroundSize:"cover",backgroundPosition:"center",backgroundImage:"url("+u.cover+")"},children:e.jsx(ne,{sx:{display:{xs:"block",md:"none"},height:100,width:"100%",backgroundSize:"cover",backgroundPosition:"center",backgroundImage:"url("+u.cover+")"}})}),e.jsx(F,{item:!0,xs:12,sm:12,md:8,children:e.jsx(ne,{style:{padding:"10px"},children:e.jsxs(me,{direction:"vertical",children:[e.jsx("a",{children:e.jsx("h3",{children:u.title.length>50?u.title.substring(0,50)+"...":u.title})}),e.jsx("p",{children:u.description.replace(/(<([^>]+)>)/gi,"").length>100?u.description.replace(/(<([^>]+)>)/gi,"").substring(0,100)+"...":u.description.replace(/(<([^>]+)>)/gi,"")}),e.jsx("div",{children:e.jsx(me,{children:e.jsx(le,{title:"Click to View Author Profile",children:e.jsxs("a",{children:[e.jsx(Ne,{size:"small",src:u.author.pic}),e.jsx("span",{style:{marginLeft:"10px"},children:u.author.fullName})]})})})})]})})})]})})}))]}),e.jsx(X,{children:e.jsx(U,{span:24,style:{display:"flex",justifyContent:"center",marginTop:"10px",marginBottom:"20px"},children:e.jsx(Ie,{defaultCurrent:R,total:l})})}),e.jsx(Oe,{title:"Publishing Book",open:S,width:"60vw",onClose:u=>A(u),children:e.jsx(Lr,{randKey:Math.random(),onFinish:P})}),e.jsx($e,{title:k==null?void 0:k.title,width:"80vw",anchor:"right",onClose:u=>C(u),open:c,children:e.jsx(Br,{book:k})})]})},Or=()=>{const{push:n}=Y();return t.useEffect(()=>{document.title=de.system_name+": Publish Books"},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10},children:e.jsxs(M,{children:[e.jsx(M.Item,{children:e.jsx("a",{onClick:()=>n("/olib"),children:"Home"})}),e.jsx(M.Item,{children:"Publish Books"})]})}),e.jsx(Ir,{})]})},Vr=n=>{const{page:r}=n;return r==="PublishBooksPage"?e.jsx(Or,{}):r==="OlibOrdersPage"?e.jsx(Ar,{}):r==="OlibBooksAuthorsPage"?e.jsx(Tr,{}):r==="OlibDashboardPage"?e.jsx(Sr,{}):r==="BooksPurchasesPage"?e.jsx(yr,{}):r==="BooksPurchasesDisbursementsPage"?e.jsx(gr,{}):r==="BooksPublicPage"?e.jsx(hr,{}):r==="BooksMarketPlacePage"?e.jsx(ur,{}):e.jsx("div",{children:"Page not found ..."})};export{Vr as OlibPages};
