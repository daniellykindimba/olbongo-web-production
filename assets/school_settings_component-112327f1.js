import{r as n,aJ as ie,c9 as De,ca as Ne,cb as lt,cc as ot,o as Ae,cd as it,z as rt,I as ge,ce as ct,cf as dt,q as E,W as mt,cg as ut,ch as gt,B as J,ci as Me,cj as Pe,aN as ht,aO as ft,aP as pt,ck as we,cl as yt,aI as St,cm as vt,cn as Ct,aK as me,co as xt,cp as bt,j as l,g as Y,_ as R,c as V,l as jt,aB as $t,R as ze,d as Ee,e as It,T as Fe,aU as Et,M as Tt,a5 as At,a1 as kt,a3 as Ot,ap as Rt,f as Mt,C as Pt}from"./index-0218b022.js";import{T as wt}from"./Table-7715ed79.js";import{ab as Ft,ac as Kt,ad as Lt,ae as Dt}from"./schoolmanager_api-1af5c5d1.js";import{S as Nt}from"./index-b15d290d.js";const ue=e=>{const t=new Map;return e.forEach((a,s)=>{t.set(a,s)}),t},zt=e=>{const t=new Map;return e.forEach((a,s)=>{let{disabled:o,key:d}=a;o&&t.set(d,s)}),t};function Ht(e,t,a){const s=n.useMemo(()=>(e||[]).map(r=>(t&&(r=Object.assign(Object.assign({},r),{key:t(r)})),r)),[e,t]),[o,d]=n.useMemo(()=>{const r=[],m=new Array((a||[]).length),S=ue(a||[]);return s.forEach(f=>{S.has(f.key)?m[S.get(f.key)]=f:r.push(f)}),[r,m]},[s,a,t]);return[s,o,d]}const Bt=[];function ee(e,t){const a=e.filter(s=>t.has(s));return e.length===a.length?e:a}function Ke(e){return Array.from(e).join(";")}function qt(e,t){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Bt;const[s,o]=n.useMemo(()=>[new Set(e.map(f=>f.key)),new Set(t.map(f=>f.key))],[e,t]),[d,r]=n.useState(()=>ee(a,s)),[m,S]=n.useState(()=>ee(a,o));return n.useEffect(()=>{r(ee(a,s)),S(ee(a,o))},[a]),n.useEffect(()=>{r(ee(d,s)),S(ee(m,o))},[Ke(s),Ke(o)]),[d,m,r,S]}const Vt=e=>{const{renderedText:t,renderedEl:a,item:s,checked:o,disabled:d,prefixCls:r,onClick:m,onRemove:S,showRemove:f}=e,x=ie(`${r}-content-item`,{[`${r}-content-item-disabled`]:d||s.disabled,[`${r}-content-item-checked`]:o});let $;(typeof t=="string"||typeof t=="number")&&($=String(t));const[p]=De("Transfer",Ne.Transfer),i={className:x,title:$},y=n.createElement("span",{className:`${r}-content-item-text`},a);return f?n.createElement("li",Object.assign({},i),y,n.createElement(lt,{disabled:d||s.disabled,className:`${r}-content-item-remove`,"aria-label":p==null?void 0:p.remove,onClick:()=>{S==null||S(s)}},n.createElement(ot,null))):(i.onClick=d||s.disabled?void 0:()=>m(s),n.createElement("li",Object.assign({},i),n.createElement(Ae,{className:`${r}-checkbox`,checked:o,disabled:d||s.disabled}),y))},Wt=n.memo(Vt),Ut=["handleFilter","handleClear","checkedKeys"],Gt=e=>Object.assign(Object.assign({},{simple:!0,showSizeChanger:!1,showLessItems:!1}),e),Xt=(e,t)=>{const{prefixCls:a,filteredRenderItems:s,selectedKeys:o,disabled:d,showRemove:r,pagination:m,onScroll:S,onItemSelect:f,onItemRemove:x}=e,[$,p]=n.useState(1),i=n.useMemo(()=>m?Gt(typeof m=="object"?m:{}):null,[m]),[y,A]=it(10,{value:i==null?void 0:i.pageSize});n.useEffect(()=>{if(i){const b=Math.ceil(s.length/y);p(Math.min($,b))}},[s,i,y]);const M=b=>{f==null||f(b.key,!o.includes(b.key))},k=b=>{x==null||x([b.key])},P=b=>{p(b)},X=(b,w)=>{p(b),A(w)},K=n.useMemo(()=>i?s.slice(($-1)*y,$*y):s,[$,s,i,y]);n.useImperativeHandle(t,()=>({items:K}));const F=i?n.createElement(rt,{size:"small",disabled:d,simple:i.simple,pageSize:y,showLessItems:i.showLessItems,showSizeChanger:i.showSizeChanger,className:`${a}-pagination`,total:s.length,current:$,onChange:P,onShowSizeChange:X}):null,L=ie(`${a}-content`,{[`${a}-content-show-remove`]:r});return n.createElement(n.Fragment,null,n.createElement("ul",{className:L,onScroll:S},(K||[]).map(b=>{let{renderedEl:w,renderedText:I,item:u}=b;return n.createElement(Wt,{key:u.key,item:u,renderedText:I,renderedEl:w,prefixCls:a,showRemove:r,onClick:M,onRemove:k,checked:o.includes(u.key),disabled:d||u.disabled})})),F)},_t=n.forwardRef(Xt),Yt=e=>{const{placeholder:t="",value:a,prefixCls:s,disabled:o,onChange:d,handleClear:r}=e,m=n.useCallback(S=>{d==null||d(S),S.target.value===""&&(r==null||r())},[d]);return n.createElement(ge,{placeholder:t,className:s,value:a,onChange:m,disabled:o,allowClear:!0,prefix:n.createElement(ct,null)})},He=Yt,Jt=()=>null;function Qt(e){return!!(e&&!gt(e)&&Object.prototype.toString.call(e)==="[object Object]")}function oe(e){return e.filter(t=>!t.disabled).map(t=>t.key)}const Zt=e=>e!==void 0,es=e=>{const{prefixCls:t,dataSource:a=[],titleText:s="",checkedKeys:o,disabled:d,showSearch:r=!1,style:m,searchPlaceholder:S,notFoundContent:f,selectAll:x,selectCurrent:$,selectInvert:p,removeAll:i,removeCurrent:y,showSelectAll:A=!0,showRemove:M,pagination:k,direction:P,itemsUnit:X,itemUnit:K,selectAllLabel:F,selectionsIcon:L,footer:b,renderList:w,onItemSelectAll:I,onItemRemove:u,handleFilter:c,handleClear:j,filterOption:D,render:fe=Jt}=e,[W,_]=n.useState(""),z=n.useRef({}),H=g=>{_(g.target.value),c(g)},pe=()=>{_(""),j()},ye=(g,v)=>D?D(W,v):g.includes(W),Se=g=>{let v=w?w(g):null;const T=!!v;return T||(v=E.createElement(_t,Object.assign({ref:z},g))),{customize:T,bodyContent:v}},re=g=>{const v=fe(g),T=Qt(v);return{item:g,renderedEl:T?v.label:v,renderedText:T?v.value:v}},te=n.useMemo(()=>Array.isArray(f)?f[P==="left"?0:1]:f,[f,P]),[O,B]=n.useMemo(()=>{const g=[],v=[];return a.forEach(T=>{const q=re(T);W&&!ye(q.renderedText,T)||(g.push(T),v.push(q))}),[g,v]},[a,W]),se=n.useMemo(()=>{if(o.length===0)return"none";const g=ue(o);return O.every(v=>g.has(v.key)||!!v.disabled)?"all":"part"},[o,O]),ve=n.useMemo(()=>{const g=r?E.createElement("div",{className:`${t}-body-search-wrapper`},E.createElement(He,{prefixCls:`${t}-search`,onChange:H,handleClear:pe,placeholder:S,value:W,disabled:d})):null,{customize:v,bodyContent:T}=Se(Object.assign(Object.assign({},dt(e,Ut)),{filteredItems:O,filteredRenderItems:B,selectedKeys:o}));let q;return v?q=E.createElement("div",{className:`${t}-body-customize-wrapper`},T):q=O.length?T:E.createElement("div",{className:`${t}-body-not-found`},te),E.createElement("div",{className:ie(r?`${t}-body ${t}-body-with-search`:`${t}-body`)},g,q)},[r,t,S,W,d,o,O,B,te]),Q=E.createElement(Ae,{disabled:a.length===0||d,checked:se==="all",indeterminate:se==="part",className:`${t}-checkbox`,onChange:()=>{I==null||I(O.filter(g=>!g.disabled).map(g=>{let{key:v}=g;return v}),se!=="all")}}),ne=(g,v)=>{if(F)return typeof F=="function"?F({selectedCount:g,totalCount:v}):F;const T=v>1?X:K;return E.createElement(E.Fragment,null,(g>0?`${g}/`:"")+v," ",T)},ae=b&&(b.length<2?b(e):b(e,{direction:P})),Ce=ie(t,{[`${t}-with-pagination`]:!!k,[`${t}-with-footer`]:!!ae}),xe=ae?E.createElement("div",{className:`${t}-footer`},ae):null,ce=!M&&!k&&Q;let le;M?le=[k?{key:"removeCurrent",label:y,onClick(){var g;const v=oe((((g=z.current)===null||g===void 0?void 0:g.items)||[]).map(T=>T.item));u==null||u(v)}}:null,{key:"removeAll",label:i,onClick(){u==null||u(oe(O))}}].filter(Boolean):le=[{key:"selectAll",label:x,onClick(){const g=oe(O);I==null||I(g,g.length!==o.length)}},k?{key:"selectCurrent",label:$,onClick(){var g;const v=((g=z.current)===null||g===void 0?void 0:g.items)||[];I==null||I(oe(v.map(T=>T.item)),!0)}}:null,{key:"selectInvert",label:p,onClick(){var g;const v=oe(k?(((g=z.current)===null||g===void 0?void 0:g.items)||[]).map(Z=>Z.item):O),T=new Set(o),q=[];v.forEach(Z=>{T.has(Z)||q.push(Z)}),I==null||I(q,"replace")}}];const be=E.createElement(mt,{className:`${t}-header-dropdown`,menu:{items:le},disabled:d},Zt(L)?L:E.createElement(ut,null));return E.createElement("div",{className:Ce,style:m},E.createElement("div",{className:`${t}-header`},A?E.createElement(E.Fragment,null,ce,be):null,E.createElement("span",{className:`${t}-header-selected`},ne(o.length,O.length)),E.createElement("span",{className:`${t}-header-title`},s)),ve,xe)},Te=es,ts=e=>{const{disabled:t,moveToLeft:a,moveToRight:s,leftArrowText:o="",rightArrowText:d="",leftActive:r,rightActive:m,className:S,style:f,direction:x,oneWay:$}=e;return n.createElement("div",{className:S,style:f},n.createElement(J,{type:"primary",size:"small",disabled:t||!m,onClick:s,icon:x!=="rtl"?n.createElement(Me,null):n.createElement(Pe,null)},d),!$&&n.createElement(J,{type:"primary",size:"small",disabled:t||!r,onClick:a,icon:x!=="rtl"?n.createElement(Pe,null):n.createElement(Me,null)},o))},Be=ts,ss=e=>{const{antCls:t,componentCls:a,listHeight:s,controlHeightLG:o,marginXXS:d,margin:r}=e,m=`${t}-table`,S=`${t}-input`;return{[`${a}-customize-list`]:{[`${a}-list`]:{flex:"1 1 50%",width:"auto",height:"auto",minHeight:s},[`${m}-wrapper`]:{[`${m}-small`]:{border:0,borderRadius:0,[`${m}-selection-column`]:{width:o,minWidth:o}},[`${m}-pagination${m}-pagination`]:{margin:`${r}px 0 ${d}px`}},[`${S}[disabled]`]:{backgroundColor:"transparent"}}}},Le=(e,t)=>{const{componentCls:a,colorBorder:s}=e;return{[`${a}-list`]:{borderColor:t,"&-search:not([disabled])":{borderColor:s}}}},ns=e=>{const{componentCls:t}=e;return{[`${t}-status-error`]:Object.assign({},Le(e,e.colorError)),[`${t}-status-warning`]:Object.assign({},Le(e,e.colorWarning))}},as=e=>{const{componentCls:t,colorBorder:a,colorSplit:s,lineWidth:o,itemHeight:d,headerHeight:r,transferHeaderVerticalPadding:m,itemPaddingBlock:S,controlItemBgActive:f,colorTextDisabled:x,listHeight:$,listWidth:p,listWidthLG:i,fontSizeIcon:y,marginXS:A,paddingSM:M,lineType:k,antCls:P,iconCls:X,motionDurationSlow:K,controlItemBgHover:F,borderRadiusLG:L,colorBgContainer:b,colorText:w,controlItemBgActiveHover:I}=e;return{display:"flex",flexDirection:"column",width:p,height:$,border:`${o}px ${k} ${a}`,borderRadius:e.borderRadiusLG,"&-with-pagination":{width:i,height:"auto"},"&-search":{[`${X}-search`]:{color:x}},"&-header":{display:"flex",flex:"none",alignItems:"center",height:r,padding:`${m-o}px ${M}px ${m}px`,color:w,background:b,borderBottom:`${o}px ${k} ${s}`,borderRadius:`${L}px ${L}px 0 0`,"> *:not(:last-child)":{marginInlineEnd:4},"> *":{flex:"none"},"&-title":Object.assign(Object.assign({},we),{flex:"auto",textAlign:"end"}),"&-dropdown":Object.assign(Object.assign({},yt()),{fontSize:y,transform:"translateY(10%)",cursor:"pointer","&[disabled]":{cursor:"not-allowed"}})},"&-body":{display:"flex",flex:"auto",flexDirection:"column",fontSize:e.fontSize,minHeight:0,"&-search-wrapper":{position:"relative",flex:"none",padding:M}},"&-content":{flex:"auto",margin:0,padding:0,overflow:"auto",listStyle:"none","&-item":{display:"flex",alignItems:"center",minHeight:d,padding:`${S}px ${M}px`,transition:`all ${K}`,"> *:not(:last-child)":{marginInlineEnd:A},"> *":{flex:"none"},"&-text":Object.assign(Object.assign({},we),{flex:"auto"}),"&-remove":{position:"relative",color:a,cursor:"pointer",transition:`all ${K}`,"&:hover":{color:e.colorLinkHover},"&::after":{position:"absolute",inset:`-${S}px -50%`,content:'""'}},[`&:not(${t}-list-content-item-disabled)`]:{"&:hover":{backgroundColor:F,cursor:"pointer"},[`&${t}-list-content-item-checked:hover`]:{backgroundColor:I}},"&-checked":{backgroundColor:f},"&-disabled":{color:x,cursor:"not-allowed"}},[`&-show-remove ${t}-list-content-item:not(${t}-list-content-item-disabled):hover`]:{background:"transparent",cursor:"default"}},"&-pagination":{padding:`${e.paddingXS}px 0`,textAlign:"end",borderTop:`${o}px ${k} ${s}`,[`${P}-pagination-options`]:{paddingInlineEnd:e.paddingXS}},"&-body-not-found":{flex:"none",width:"100%",margin:"auto 0",color:x,textAlign:"center"},"&-footer":{borderTop:`${o}px ${k} ${s}`}}},ls=e=>{const{antCls:t,iconCls:a,componentCls:s,headerHeight:o,marginXS:d,marginXXS:r,fontSizeIcon:m,fontSize:S,lineHeight:f,colorBgContainerDisabled:x}=e;return{[s]:Object.assign(Object.assign({},pt(e)),{position:"relative",display:"flex",alignItems:"stretch",[`${s}-disabled`]:{[`${s}-list`]:{background:x}},[`${s}-list`]:as(e),[`${s}-operation`]:{display:"flex",flex:"none",flexDirection:"column",alignSelf:"center",margin:`0 ${d}px`,verticalAlign:"middle",[`${t}-btn`]:{display:"block","&:first-child":{marginBottom:r},[a]:{fontSize:m}}},[`${t}-empty-image`]:{maxHeight:o/2-Math.round(S*f)}})}},os=e=>{const{componentCls:t}=e;return{[`${t}-rtl`]:{direction:"rtl"}}},is=ht("Transfer",e=>{const{fontSize:t,lineHeight:a,lineWidth:s,controlHeightLG:o}=e,d=Math.round(t*a),r=ft(e,{transferHeaderVerticalPadding:Math.ceil((o-s-d)/2)});return[ls(r),ss(r),ns(r),os(r)]},e=>{const{fontSize:t,lineHeight:a,controlHeight:s,controlHeightLG:o}=e,d=Math.round(t*a);return{listWidth:180,listHeight:200,listWidthLG:250,headerHeight:o,itemHeight:s,itemPaddingBlock:(s-d)/2}}),he=e=>{const{dataSource:t,targetKeys:a=[],selectedKeys:s,selectAllLabels:o=[],operations:d=[],style:r={},listStyle:m={},locale:S={},titles:f,disabled:x,showSearch:$=!1,operationStyle:p,showSelectAll:i,oneWay:y,pagination:A,status:M,prefixCls:k,className:P,rootClassName:X,selectionsIcon:K,filterOption:F,render:L,footer:b,children:w,rowKey:I,onScroll:u,onChange:c,onSearch:j,onSelectChange:D}=e,{getPrefixCls:fe,renderEmpty:W,direction:_,transfer:z}=n.useContext(St),H=fe("transfer",k),[pe,ye]=is(H),[Se,re,te]=Ht(t,I,a),[O,B,se,ve]=qt(re,te,s),Q=n.useCallback((h,C)=>{if(h==="left"){const U=typeof C=="function"?C(O||[]):C;se(U)}else{const U=typeof C=="function"?C(B||[]):C;ve(U)}},[O,B]),ne=n.useCallback((h,C)=>{h==="left"?D==null||D(C,B):D==null||D(O,C)},[O,B]),ae=h=>{var C;return(C=f??h.titles)!==null&&C!==void 0?C:[]},Ce=h=>{u==null||u("left",h)},xe=h=>{u==null||u("right",h)},ce=h=>{const C=h==="right"?O:B,U=zt(Se),N=C.filter(Ie=>!U.has(Ie)),G=ue(N),$e=h==="right"?N.concat(a):a.filter(Ie=>!G.has(Ie)),de=h==="right"?"left":"right";Q(de,[]),ne(de,[]),c==null||c($e,h,N)},le=()=>{ce("left")},be=()=>{ce("right")},g=(h,C,U)=>{Q(h,N=>{let G=[];if(U==="replace")G=C;else if(U)G=Array.from(new Set([].concat(me(N),me(C))));else{const $e=ue(C);G=N.filter(de=>!$e.has(de))}return ne(h,G),G})},v=(h,C)=>{g("left",h,C)},T=(h,C)=>{g("right",h,C)},q=h=>j==null?void 0:j("left",h.target.value),Z=h=>j==null?void 0:j("right",h.target.value),qe=()=>j==null?void 0:j("left",""),Ve=()=>j==null?void 0:j("right",""),ke=(h,C,U)=>{const N=me(h==="left"?O:B),G=N.indexOf(C);G>-1&&N.splice(G,1),U&&N.push(C),ne(h,N),e.selectedKeys||Q(h,N)},We=(h,C)=>{ke("left",h,C)},Ue=(h,C)=>{ke("right",h,C)},Ge=h=>{Q("right",[]),c==null||c(a.filter(C=>!h.includes(C)),"left",me(h))},Oe=h=>typeof m=="function"?m({direction:h}):m||{},Xe=n.useContext(vt),{hasFeedback:_e,status:Ye}=Xe,Je=h=>Object.assign(Object.assign(Object.assign({},h),{notFoundContent:(W==null?void 0:W("Transfer"))||E.createElement(xt,{componentName:"Transfer"})}),S),Qe=bt(Ye,M),Re=!w&&A,Ze=B.length>0,et=O.length>0,tt=ie(H,{[`${H}-disabled`]:x,[`${H}-customize-list`]:!!w,[`${H}-rtl`]:_==="rtl"},Ct(H,Qe,_e),z==null?void 0:z.className,P,X,ye),[st]=De("Transfer",Ne.Transfer),je=Je(st),[nt,at]=ae(je);return pe(E.createElement("div",{className:tt,style:Object.assign(Object.assign({},z==null?void 0:z.style),r)},E.createElement(Te,Object.assign({prefixCls:`${H}-list`,titleText:nt,dataSource:re,filterOption:F,style:Oe("left"),checkedKeys:O,handleFilter:q,handleClear:qe,onItemSelect:We,onItemSelectAll:v,render:L,showSearch:$,renderList:w,footer:b,onScroll:Ce,disabled:x,direction:_==="rtl"?"right":"left",showSelectAll:i,selectAllLabel:o[0],pagination:Re,selectionsIcon:K},je)),E.createElement(Be,{className:`${H}-operation`,rightActive:et,rightArrowText:d[0],moveToRight:be,leftActive:Ze,leftArrowText:d[1],moveToLeft:le,style:p,disabled:x,direction:_,oneWay:y}),E.createElement(Te,Object.assign({prefixCls:`${H}-list`,titleText:at,dataSource:te,filterOption:F,style:Oe("right"),checkedKeys:B,handleFilter:Z,handleClear:Ve,onItemSelect:Ue,onItemSelectAll:T,onItemRemove:Ge,render:L,showSearch:$,renderList:w,footer:b,onScroll:xe,disabled:x,direction:_==="rtl"?"left":"right",showSelectAll:i,selectAllLabel:o[1],showRemove:y,pagination:Re,selectionsIcon:K},je))))};he.List=Te;he.Search=He;he.Operation=Be;const rs=he,fs=e=>{const[t,a]=n.useState([]),[s,o]=n.useState([]),[d,r]=n.useState([]),[m,S]=n.useState([]),f=async(y,A="")=>{const{data:M}=await Y.custom({url:"",method:"get",meta:{operation:"systemRolePermissionsRecords",variables:{page:{value:y,type:"Int",required:!0},key:{value:A,type:"String",required:!1},roleId:{value:e.role.id,type:"Int",required:!0}},fields:["total","page","pages","hasNext","hasPrev",{results:["key","title","description","chosen"]}]}}),k=[];M.results.forEach(P=>{P.chosen&&k.push(P.key)}),a([...M.results]),o(k)},x=async y=>{const{data:A}=await Y.custom({url:"",method:"post",meta:{operation:"addRolePermissions",variables:{roleId:{value:parseInt(e.role.id),type:"Int",required:!0},permissions:{value:y,type:"[Int]",required:!0}},fields:["success","message"]}});A.success?R.success(A.message):R.error(A.message)},$=async y=>{const{data:A}=await Y.custom({url:"",method:"post",meta:{operation:"removeRolePermissions",variables:{roleId:{value:parseInt(e.role.id),type:"Int",required:!0},permissions:{value:y,type:"[Int]",required:!0}},fields:["success","message"]}});A.success?R.success(A.message):R.error(A.message)},p=y=>{o(y),m.length>0&&x(m),d.length>0&&$(d)},i=(y,A)=>{S(y),r(A)};return n.useEffect(()=>{f(1)},[e.randKey,e.role]),l.jsx(l.Fragment,{children:l.jsx(rs,{titles:["Not Assigned Permissions","Assigned Permissions"],dataSource:t,showSearch:!0,listStyle:{width:"100vw",height:"65vh"},operations:["Add","Remove"],targetKeys:s,onChange:p,onSelectChange:i,onSearch:(y,A)=>{},render:y=>y.title})})},{TextArea:cs}=ge,ds=e=>{const[t,a]=n.useState(e.programme.isActive);return n.useEffect(()=>{e.form.setFieldsValue({name:e.programme.name,description:e.programme.description,isActive:e.programme.isActive})},[e.form,e.programme]),l.jsx(l.Fragment,{children:l.jsxs(V,{layout:"vertical",form:e.form,onFinish:s=>{s.isActive=t,s.id=parseInt(e.programme.id),e.onFinish(s)},requiredMark:!1,children:[l.jsx(V.Item,{name:"name",label:"Name",rules:[{required:!0,type:"string",message:"Please input Name"}],children:l.jsx(ge,{size:"large",placeholder:"Enter Name ..."})}),l.jsx(V.Item,{name:"description",label:"Description",rules:[{required:!1,type:"string",message:"Please input Description"}],children:l.jsx(cs,{rows:4})}),l.jsx(V.Item,{name:"isActive",children:l.jsx(Ae,{checked:t,onChange:()=>a(!t),children:"Active"})}),l.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:l.jsx(J,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},ps=e=>{const[t,a]=n.useState(),[s,o]=n.useState([]),[d,r]=n.useState(0),[m,S]=n.useState(20),[f,x]=n.useState(""),[$,p]=n.useState(!0);jt();const[i]=V.useForm(),[y]=V.useForm(),M=!$t.useBreakpoint().lg,[k,P]=n.useState(!1),X=u=>{a(u),P(!0)},K=async u=>{const{data:c}=await Y.custom({url:"",method:"post",meta:{operation:"updateProgramme",variables:{id:{value:u.id,type:"Int",required:!0},name:{value:u.name,type:"String",required:!0},description:{value:u.description,type:"String",required:!1},isActive:{value:u.isActive,type:"Boolean",required:!0}},fields:["success","message",{programme:["id","name","description","created","updated","isActive","canDelete","canEdit","canManage"]}]}});c.success?(R.success(c.message),y.resetFields(),P(!1),o(s.map(j=>j.id===c.programme.id?c.programme:j))):R.error(c.message)},F=async()=>{const{data:u}=await Y.custom({url:"",method:"post",meta:{operation:"syncSystemProgrammes",variables:{},fields:["success","message"]}});u.success?(R.success(u.message),s.length=0,o([]),I(1)):R.error(u.message)},L=async u=>{const{data:c}=await Y.custom({url:"",method:"post",meta:{operation:"deleteProgramme",variables:{id:{value:parseInt(u.toString()),type:"Int",required:!0}},fields:["success","message"]}});c.success?(R.success(c.message),o(s.filter(j=>j.id!==u))):R.error(c.message)},b=()=>{R("Canceled")},w=[{title:"Name",dataIndex:"name",fixed:!0,render:(u,c,j)=>l.jsx("span",{children:l.jsx("a",{children:c.name})})},{title:"Created",dataIndex:"created",render:(u,c,j)=>l.jsx(l.Fragment,{children:l.jsx("span",{children:l.jsx(At,{date:new Date(c.created)})})})},{title:"Status",dataIndex:"isActive",render:(u,c,j)=>l.jsx("a",{children:c!=null&&c.isActive?l.jsx("span",{style:{color:"green"},children:"Active"}):l.jsx("span",{style:{color:"red"},children:"Inactive"})})},{title:"",dataIndex:"action",render:(u,c,j)=>l.jsxs("div",{style:{display:"flex",justifyContent:"flex-end"},children:[e.control&&l.jsx(kt,{title:"Are you sure to delete this Programme?",onConfirm:()=>L(c==null?void 0:c.id),onCancel:()=>b,okText:"Yes",cancelText:"No",disabled:!(c!=null&&c.canDelete),overlayStyle:{zIndex:9999},children:l.jsx(J,{icon:l.jsx(Ot,{}),disabled:!(c!=null&&c.canDelete)})}),e.control&&l.jsx(Fe,{title:"Edit "+(c==null?void 0:c.name)+" Programme",color:"green",children:l.jsx(J,{icon:l.jsx(Rt,{}),disabled:!(c!=null&&c.canEdit),onClick:()=>X(c)})})]})}],I=async(u,c="",j=20)=>{const{data:D}=await Y.custom({url:"",method:"get",meta:{operation:"systemProgrammes",variables:{page:{value:u,type:"Int",required:!0},key:{value:c,type:"String",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","description","isActive","created","updated","canEdit","canDelete","canManage"]}]}});r(D.total),o([...D.results]),p(!1)};return n.useEffect(()=>{I(1,"",20)},[]),l.jsxs(l.Fragment,{children:[l.jsxs(ze,{style:{marginTop:10},children:[l.jsx(Ee,{span:M?24:20,children:l.jsx(V,{layout:"vertical",form:i,onFinish:u=>{x(u.key),s.length=0,I(1,u.key)},children:l.jsx(V.Item,{name:"key",children:l.jsx(ge,{size:"large",placeholder:"Search ...",prefix:l.jsx(It,{}),autoComplete:"off",allowClear:!0})})})}),(e==null?void 0:e.control)&&l.jsx(Ee,{span:M?24:4,style:{display:"flex",justifyContent:"flex-end"},children:l.jsx(Fe,{title:"Synchronize Default System Programmes",children:l.jsx(J,{icon:l.jsx(Et,{}),size:"large",onClick:()=>F(),children:"Sync Programmes"})})})]}),l.jsx(wt,{loading:$,columns:w,dataSource:s,pagination:{onChange:(u,c)=>{S(c),I(u,f,c)},total:d,pageSize:m,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0}}),l.jsx(Tt,{title:"Edit "+(t==null?void 0:t.name)+" Informations",width:"40vw",open:k,onClose:u=>P(u),children:l.jsx(ds,{form:y,programme:t,onFinish:K})})]})},ys=e=>{const[t,a]=n.useState(!1),[s,o]=n.useState(!1),[d,r]=n.useState(),[m]=V.useForm(),S=async()=>{Ft().then(p=>{p&&(p.success?(R.success(p.message),f()):R.error(p.message))})},f=async()=>{var p;o(!0),Kt(e.school,((p=e.school)==null?void 0:p.id)??0).then(i=>{i?(a(!0),r(i),m.setFieldsValue({teachersCanCreateClasses:i.teachersCanCreateClasses,teachersCanCreateDrives:i.teachersCanCreateDrives,teachersCanCreatePublicVirtualClassSessions:i.teachersCanCreatePublicVirtualClassSessions,dispatchMessagesOnClassVirtualSessionCreation:i.dispatchMessagesOnClassVirtualSessionCreation,dispatchMessagesOnFilesUpload:i.dispatchMessagesOnFilesUpload,dispatchMessagesOnAssignmentsCreation:i.dispatchMessagesOnAssignmentsCreation,dispatchMessagesOnAnnouncementsCreation:i.dispatchMessagesOnAnnouncementsCreation,dispatchMessagesOnTimetableSessionsCreation:i.dispatchMessagesOnTimetableSessionsCreation,dispatchMessagesOnTimetableSessionCancellation:i.dispatchMessagesOnTimetableSessionCancellation,dispatchMessagesOnTimetableSessionRescheduling:i.dispatchMessagesOnTimetableSessionRescheduling,studentsCanCreateClassVirtualSessions:i.studentsCanCreateClassVirtualSessions,studentsCanCreateDrives:i.studentsCanCreateDrives,studentsCanCreateClasses:i.studentsCanCreateClasses,studentsCanUploadFiles:i.studentsCanUploadFiles,teachersCanUploadFiles:i.teachersCanUploadFiles})):a(!1)}),o(!1)},x=async p=>{Lt(p,e.school.id).then(i=>{i&&(i.success?R.success(i.message):R.error(i.message))})},$=async p=>{Dt(p).then(i=>{i&&(i.success?R.success(i.message):R.error(i.message))})};return n.useEffect(()=>{f()},[e.randKey,e.school]),l.jsx(l.Fragment,{children:l.jsx(Mt,{loading:s,active:!0,children:t?l.jsx("div",{style:{marginTop:10,marginLeft:20,maxHeight:e.full?"70vh":"100vh",overflowY:"auto"},children:l.jsx(V,{layout:"horizontal",form:m,onFinish:p=>{e.school?x(p):$(p)},onChange:()=>{m.submit()},children:l.jsx(ze,{style:{display:"flex",justifyContent:"flex-start"},children:l.jsx(Ee,{span:e.full?24:12,children:l.jsx(Pt,{children:Object.entries(d??{}).map(([p,i])=>l.jsx(V.Item,{label:p.split(/(?=[A-Z])/).map(y=>y.charAt(0).toUpperCase()+y.slice(1)).join(" "),name:p,initialValue:i,children:l.jsx(Nt,{checked:m.getFieldValue(p),onChange:y=>{m.submit(),r(m.getFieldsValue())}})}))})})})})}):l.jsx(l.Fragment,{children:l.jsx("div",{style:{display:"flex",justifyContent:"center"},children:l.jsx(J,{onClick:()=>S(),children:"Auto Create Settings"})})})})})};export{ps as P,fs as R,ys as S,rs as T};
