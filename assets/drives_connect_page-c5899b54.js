import{r as s,F as g,m as G,j as e,B as l,G as c,I as K,aN as V,S as Q,k as T,aj as C,av as W,aw as D,aQ as b,ax as J,aP as U,ak as X,e as Y,M as Z,a as $,g as k,_ as d,d as ee,am as j,aS as te}from"./index-d9f4923f.js";import{D as se}from"./drive_info-8da38912.js";import{l as ae}from"./index-ffc760b5.js";import{d as ne}from"./data_objects-f63e1ada.js";import{A as re}from"./Alert-c87fb5a2.js";import"./objectWithoutProperties-bd653c34.js";import"./DialogWrap-994988aa.js";import"./useNotification-a43f2219.js";import"./PickerPanel-adf5703b.js";import"./localeData-7e1ac95b.js";import"./RangePicker-ba6ee425.js";import"./index-55cc05ca.js";import"./InputNumber-218fc870.js";import"./index-4ee75d01.js";const ie=oe=>{const[m,f]=s.useState([]),[n,u]=s.useState(),[o,y]=s.useState(!0),[F,I]=s.useState(""),[v,w]=s.useState(24),[P,h]=s.useState(0),[B,M]=s.useState(0),[le,N]=s.useState(0),[z,q]=s.useState(!0),[A,E]=s.useState(!1),[L]=g.useForm();G();const[O,x]=s.useState(!1),S=t=>{u(t),x(!0)},_=t=>{x(t),u(null)},H=async t=>{const{data:a}=await k.custom({url:"",method:"post",meta:{operation:"connectDrive",variables:{id:{value:t,type:"Int",required:!0}},fields:["success","message"]}}).catch(()=>(d.error("Drive connection failed"),{data:null})).then(i=>i);a&&(a.success?(x(!1),u(null),d(a.message),f(m.filter(i=>i.id!==t))):d.error(a.message))},p=async(t,a=10,i="")=>{y(!0);const{data:r}=await k.custom({url:"",method:"get",meta:{operation:"drivesToConnect",variables:{page:{value:t,type:"Int",required:!0},key:{value:i,type:"String",required:!1},pageSize:{value:a,type:"Int",required:!0}},fields:["total","page","pages","hasNext","hasPrev",{results:ne}]}}).catch(()=>(d.error("Failed to load drives"),{data:null})).then(R=>R);r&&(M(r.total),h(r.page),N(r.pages),q(r.hasNext),E(r.hasPrev),f(r.results)),y(!1)};return s.useEffect(()=>{p(1)},[]),e.jsxs(e.Fragment,{children:[e.jsx(l,{children:e.jsx(c,{container:!0,children:e.jsx(c,{item:!0,xs:12,sm:6,md:4,lg:4,xl:4,children:e.jsx(g,{layout:"vertical",form:L,onFinish:t=>{I(t.key),h(1),p(1,v,t.key)},children:e.jsx(g.Item,{name:"key",children:e.jsx(K,{size:"large",placeholder:"Search Drive(s)...",prefix:e.jsx(V,{}),autoComplete:"off",allowClear:!0,disabled:o})})})})})}),e.jsx(Q,{spinning:o,children:e.jsx(l,{children:m.length>0?e.jsx(c,{container:!0,children:m.map(t=>e.jsx(c,{item:!0,xs:12,sm:6,md:4,lg:4,xl:4,children:e.jsxs(T,{hoverable:t.isActive,style:{marginRight:10,marginBottom:5},children:[e.jsx(C,{style:{right:0,position:"absolute"},children:e.jsx(W,{trigger:["click"],overlay:e.jsx(D,{children:e.jsx(D.Item,{icon:e.jsx(b,{}),disabled:!t.isActive,children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",onClick:()=>S(t),children:"Connect"})})}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:a=>a.preventDefault(),children:e.jsx(J,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})}),e.jsx(U.Ribbon,{text:t.code,placement:"start",color:"orange",children:e.jsx("a",{onClick:()=>{S(t)},children:e.jsxs(C,{direction:"vertical",align:"center",style:{width:"100%",justifyContent:"center"},children:[e.jsx(X,{size:{xs:24,sm:32,md:40,lg:40,xl:40,xxl:80},icon:e.jsx(b,{}),src:t.icon}),e.jsx("span",{style:{fontSize:20},children:e.jsx(Y,{title:t.name,children:t.name.length>20?t.name.substring(0,40)+"...":t.name})})]})})})]})},t.id))}):e.jsx(re,{severity:"info",children:o?e.jsx(e.Fragment,{children:"Loading"}):e.jsx(e.Fragment,{children:"No drives found"})})})}),(z||A)&&!o&&e.jsx(l,{sx:{display:"flex",justifyContent:"center",marginTop:3},children:e.jsx(ae.Pagination,{defaultCurrent:P,total:B,showSizeChanger:!0,onChange:(t,a)=>{h(t),w(a||v),p(t,a,F)}})}),e.jsx(Z,{title:"Connecting "+(n==null?void 0:n.name),open:O,width:"30vw",onClose:t=>_(t),children:e.jsxs(e.Fragment,{children:[e.jsx(se,{id:n==null?void 0:n.id}),e.jsx(l,{sx:{marginBottom:3},children:e.jsx($,{onClick:()=>H(n==null?void 0:n.id),style:{position:"absolute",float:"right",right:"10px"},children:"Connect"})})]})})]})},De=()=>(s.useEffect(()=>{document.title=ee.system_name+": Drives Connect"},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10,marginBottom:10},children:e.jsxs(j,{children:[e.jsx(j.Item,{children:e.jsx(te,{to:"/odrive",children:"Home"})}),e.jsx(j.Item,{children:"Drives Connect"})]})}),e.jsx(ie,{})]}));export{De as DrivesConnectPage};
