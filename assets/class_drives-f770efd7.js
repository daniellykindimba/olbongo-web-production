import{r as s,c as x,l as R,j as e,f as V,R as E,d as w,I as z,e as L,L as M,a1 as W,B as D,ao as Y,aw as U,aj as X,g as S,dq as Z,_ as i,fG as P,fH as J,G as q,C as K,S as N,W as Q,X as y,F as O,Y as $,ay as ee,Z as te,i as re,A as se,T as ae,ae as ie,a as ne,M as le,af as oe,ag as de}from"./index-0218b022.js";const ce=a=>{const[o,u]=s.useState([]),[f,C]=s.useState(!0),[h,g]=s.useState(1),[T,k]=s.useState(0),[F,I]=s.useState(!0),[b]=x.useForm();R();const m=async(r,n="",d=!1)=>{const{data:c}=await S.custom({url:"",method:"get",meta:{operation:"darasaDrivesToConnect",variables:{page:{value:r,type:"Int",required:!0},key:{value:n,type:"String",required:!1},id:{value:parseInt(a.id===void 0?"0":a.id.toString()),type:"Int",required:!0}},fields:["total","page","pages","hasNext","hasPrev",{results:Z}]}}).catch(()=>(i.error("Error loading drives"),{data:null})).then(j=>j);c&&(k(c.total),g(c.page),I(c.hasNext),u(c.results)),C(!1)},A=async r=>{const{data:n}=await S.custom({url:"",method:"post",meta:{operation:"addDarasaDrive",variables:{drive:{value:r,type:"Int",required:!0},darasa:{value:parseInt(a.id===void 0?"0":a.id.toString()),type:"Int",required:!0}},fields:["success","message",{darasaDrive:P}]}}).catch(()=>(i.error("Error adding drive"),{data:null})).then(d=>d);n&&(n.success?(i.success(n.message),u(o.filter(d=>parseInt(d.id.toString())!==r)),a.handleAddingDrive(n.darasaDrive)):i.error(n.message))};return s.useEffect(()=>{m(h)},[a.random]),f?e.jsx(e.Fragment,{children:e.jsx(V,{loading:f,active:!0})}):e.jsxs(e.Fragment,{children:[e.jsx(E,{children:e.jsx(w,{span:24,children:e.jsx(x,{layout:"vertical",form:b,onFinish:r=>{g(0),m(0,r.key,!0)},children:e.jsx(x.Item,{name:"key",children:e.jsx(z,{size:"large",placeholder:"Search Drive(s)...",prefix:e.jsx(L,{}),autoComplete:"off",allowClear:!0})})})})}),e.jsxs("div",{id:"scrollableDrivesToAdd",style:{height:"65vh",overflow:"auto"},children:[e.jsx(M,{bordered:!0,dataSource:o,renderItem:r=>e.jsxs(M.Item,{actions:[e.jsx(W,{title:"Are you sure to Add this Drive -"+r.name+" ?",onConfirm:()=>A(parseInt(r.id.toString())),okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx(D,{icon:e.jsx(Y,{}),children:"Add"})})],children:[r.name,e.jsx(U,{}),e.jsx(X.Text,{mark:!0,children:r.code})]})}),F&&e.jsx("div",{style:{textAlign:"center",marginTop:12,height:32,lineHeight:"32px"},children:e.jsx(D,{type:"primary",onClick:()=>{m(h+1)},children:"Load More"})})]})]})},he=a=>{const[o,u]=s.useState([]),[f,C]=s.useState(!0),[h,g]=s.useState(1),[T,k]=s.useState(0),[F,I]=s.useState(0),[b,m]=s.useState(!0),[A]=x.useForm(),{push:r}=R(),[n,d]=s.useState(!1),c=()=>{d(!0)},j=async(t,l="",p=!1)=>{const{data:v}=await S.custom({url:"",method:"get",meta:{operation:"darasaDrives",variables:{page:{value:t,type:"Int",required:!0},key:{value:l,type:"String",required:!1},id:{value:parseInt(a.id===void 0?"0":a.id.toString()),type:"Int",required:!0}},fields:["total","page","pages","hasNext","hasPrev",{results:P}]}}).catch(()=>(i.error("Error fetching drives"),{data:null})).then(G=>G);v&&(I(v.total),k(v.pages),g(v.page),m(v.hasNext),u(v.results)),C(!1)},B=async t=>{u([t,...o])},H=async t=>{const{data:l}=await S.custom({url:"",method:"post",meta:{operation:"deleteDarasaDrive",variables:{id:{value:t,type:"Int",required:!0}},fields:["success","message"]}}).catch(()=>(i.error("Error removing drive"),{data:null})).then(p=>p);l&&(l.success?(i.success(l.message),u(o.filter(p=>p.id!==t))):i.error(l.message))},_=t=>{oe.confirm({title:"Removing Drive",icon:e.jsx(de,{}),content:"Are you sure ...",okText:"Remove",cancelText:"Cancel",onOk:()=>H(t)})};return s.useEffect(()=>{j(h)},[]),e.jsxs(e.Fragment,{children:[e.jsxs(E,{children:[e.jsx(w,{span:20,children:e.jsx(x,{layout:"vertical",form:A,onFinish:t=>{g(0),j(0,t.key,!0)},children:e.jsx(x.Item,{name:"key",children:e.jsx(z,{size:"large",placeholder:"Search Drive(s)...",prefix:e.jsx(L,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(w,{span:4,style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(D,{icon:e.jsx(J,{}),onClick:c,disabled:!a.canManage,children:"Add Drive"})})]}),e.jsxs("div",{id:"scrollableDiv",style:{height:"74vh",overflow:"auto"},children:[o.length>0?e.jsx(q,{container:!0,children:o.map(t=>e.jsx(q,{item:!0,xs:12,sm:6,md:4,lg:3,children:e.jsxs(K,{hoverable:t.drive.isActive,style:{marginRight:10},children:[e.jsx(N,{style:{right:0,position:"absolute"},children:e.jsx(Q,{trigger:["click"],overlay:e.jsxs(y,{children:[e.jsx(y.Item,{icon:e.jsx(O,{}),disabled:!t.drive.isActive,children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",onClick:()=>{t.drive.isActive?r("/odrive/drive/"+t.drive.id+"/"+t.drive.code+"/files"):i("Drive is Blocked")},children:"View"})}),e.jsx(y.Item,{icon:e.jsx($,{}),onClick:()=>i("Under construction"),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Report"})}),e.jsx(y.Item,{icon:e.jsx(ee,{}),onClick:()=>_(t.id),disabled:!a.canManage,children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Remove"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:l=>l.preventDefault(),children:e.jsx(te,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})}),e.jsx(re.Ribbon,{text:t.drive.code,placement:"start",color:"orange",children:e.jsx("a",{onClick:()=>{t.drive.isActive?r("/odrive/drive/"+t.drive.id+"/"+t.drive.code+"/files"):i("Drive is Blocked")},children:e.jsxs(N,{direction:"vertical",align:"center",style:{width:"100%",justifyContent:"center"},children:[e.jsx(se,{size:{xs:24,sm:32,md:40,lg:40,xl:40,xxl:80},icon:e.jsx(O,{}),src:t.drive.icon}),e.jsx(ae,{title:t.drive.name,children:e.jsx("span",{style:{fontSize:20},children:t.drive.name.length>15?t.drive.name.substring(0,15)+"...":t.drive.name})})]})})})]})},t.id))}):e.jsxs(ie,{severity:"info",children:["No drives found. Click on the ",e.jsx("b",{children:"Add Drive"})," button to add a drive"]}),b&&e.jsx("div",{style:{textAlign:"center",marginTop:12,height:32,lineHeight:"32px"},children:e.jsx(D,{type:"primary",onClick:()=>{j(h+1)},children:f?e.jsx(ne,{}):e.jsxs("span",{children:["Load More",e.jsxs("span",{style:{marginLeft:8},children:[h,"/",T]})]})})})]}),e.jsx(le,{title:"Adding Drives",open:n,onClose:t=>d(t),width:"50vw",children:e.jsx(ce,{id:a.id,random:Math.random(),handleAddingDrive:B})})]})};export{he as ClassDrives};
