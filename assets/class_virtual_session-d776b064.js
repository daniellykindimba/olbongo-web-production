import{r as n,j as e,aU as o,$ as k,c6 as w,aY as E,aQ as g,S as q,av as F,c as K,c$ as X,k1 as Z,ar as ee,aS as te,aV as p,cQ as re,cc as ae,cb as se,cS as ie,_ as i,a$ as S,c2 as I,g as h,d2 as ne}from"./index-351477c3.js";import{d as oe,C as le}from"./ckeditor-84fadb55.js";import{D as de}from"./index-5cad5ca6.js";import{I as ue}from"./index-7b6ba676.js";import{E as ce}from"./edit_class_virtual_form-930c2574.js";import{c as D}from"./data_objects-84b5f664.js";import{L as v}from"./index-a79ac33a.js";import{C as me}from"./index-e245930b.js";import{S as pe}from"./Skeleton-8f0e80db.js";import{A as he}from"./index-6af680ed.js";import{f as V}from"./pager-ef424314.js";import{M as ge}from"./index-8b72edfc.js";import"./index-b71cc5cf.js";import"./index-7b9f9af3.js";import"./localeData-365ad521.js";import"./SinglePicker-279a4acc.js";import"./InputNumber-e7f57cfa.js";import"./ckeditor-3f4550d1.js";import"./data_objects-f008dc0a.js";import"./index-d9a31a18.js";import"./index-cbd0288c.js";import"./index-6b812589.js";import"./defineProperty-cad3b133.js";import"./useNotification-c56c34f9.js";import"./DialogWrap-e5db41da.js";import"./useMutateObserver-a2c9d48f.js";import"./index-9b61db8d.js";import"./Image-0a920d6e.js";import"./Upload-9b869cab.js";import"./Rate-6e1c6086.js";import"./index-88abecb7.js";import"./index-f080e680.js";import"./Alert-a3483804.js";import"./index-fe5f5443.js";import"./transButton-b6535c48.js";import"./index-1cc45ed0.js";import"./index-a5d8814c.js";import"./fade-8ee215b5.js";import"./index-70dcd1db.js";import"./index-20e3f79b.js";import"./darasa_card-418a58bf.js";import"./remove_html_tags-be9c976e.js";import"./index-81b1f6d5.js";import"./ActionButton-40b0160f.js";import"./index-4e600c89.js";import"./index-45b375c6.js";import"./text_truncate-315d9efa.js";import"./index-ba2e3766.js";import"./book_payment_form-1ebdca27.js";import"./index-204a1fd3.js";import"./InfoCircleFilled-9eecc8d9.js";import"./index-3779f7bb.js";import"./index.es-cd6a888d.js";const{Option:xe}=q,M=[{value:"",label:"Select Duration Type"},{value:"minutes",label:"Minutes"},{value:"hours",label:"Hours"},{value:"days",label:"Days"}],fe=l=>{const[d,u]=n.useState("");return e.jsx(e.Fragment,{children:e.jsxs(o,{layout:"vertical",form:l.form,onFinish:a=>{a.description=d,l.onFinish(a),u("")},requiredMark:!1,children:[e.jsx(o.Item,{name:"name",label:"Name",rules:[{required:!0,type:"string",message:"Please input name"}],children:e.jsx(k,{size:"large",placeholder:"Enter Name ..."})}),e.jsx(o.Item,{name:"startDate",label:"start Date",rules:[{required:!0,type:"date",message:"Please select date"}],children:e.jsx(de,{showTime:{format:"HH:mm"},disabledDate:a=>{const c=w().format("YYYY-MM-DD");return a&&a<w(c,"YYYY-MM-DD")},style:{width:"100%"},popupStyle:{zIndex:9999}})}),e.jsxs(E,{children:[e.jsx(g,{span:12,children:e.jsx(o.Item,{name:"duration",label:"Duration",style:{width:"100%"},rules:[{required:!0,type:"integer",message:"Enter Duration"}],children:e.jsx(ue,{min:1,defaultValue:1,style:{width:"100%"},size:"large"})})}),e.jsx(g,{span:12,children:e.jsx(o.Item,{name:"durationType",label:"Duration Type",style:{width:"100%"},rules:[{required:!0,type:"string",message:"Please select duration type"}],children:e.jsx(q,{defaultValue:M[0].value,size:"large",style:{width:"100%"},dropdownStyle:{zIndex:9999},children:M.map(a=>e.jsx(xe,{children:a.label},a.value))})})})]}),e.jsx("h3",{children:"Description"}),e.jsx(oe.CKEditor,{editor:le,data:d,onReady:a=>{a.editing.view.change(c=>{c.setStyle("min-height","100px",a.editing.view.document.getRoot())})},onChange:(a,c)=>{const x=c.getData();u(x)},config:{toolbar:{items:["bold","italic","strikethrough","underline","code","subscript","superscript","removeFormat","|","bulletedList","numberedList","todoList","|","outdent","indent","|","-","fontSize","fontFamily","fontColor","fontBackgroundColor","highlight","|","alignment","|","EmojiPanel"],shouldNotGroupWhenFull:!0},fontFamily:{options:["default","Arial, Helvetica, sans-serif","Courier New, Courier, monospace","Georgia, serif","Lucida Sans Unicode, Lucida Grande, sans-serif","Tahoma, Geneva, sans-serif","Times New Roman, Times, serif","Trebuchet MS, Helvetica, sans-serif","Verdana, Geneva, sans-serif"],supportAllValues:!0},fontSize:{options:[10,12,14,"default",18,20,22],supportAllValues:!0}}}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(F,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},jt=l=>{const[d,u]=n.useState([]),[a,c]=n.useState(),[x,T]=n.useState(!0),[b,z]=n.useState(1),[L]=o.useForm(),[ye,N]=n.useState(0),[je,P]=n.useState(0),[Y,H]=n.useState(!0),{push:C}=K(),[O,f]=n.useState(!1),[A]=o.useForm(),[R,y]=n.useState(!1),[B]=o.useForm(),G=t=>{c(t),y(!0)},J=()=>{f(!0)},_=async t=>{const{data:r}=await h.custom({url:"",method:"post",meta:{operation:"editVirtualClass",variables:{id:{value:t.id,type:"Int",required:!0},name:{value:t.name,type:"String",required:!0},description:{value:t.description,type:"String",required:!0},duration:{value:t.duration,type:"Int",required:!0},durationType:{value:t.durationType.toUpperCase(),type:"String",required:!0},startDate:{value:t.startDate,type:"DateTime",required:!0},isPublic:{value:!0,type:"Boolean",required:!0}},fields:["success","message",{virtual:D}]}}).catch(()=>(i.error("Error editing class"),{data:null})).then(s=>s);r&&(r.success?(i.success(r.message),u(d.map(s=>s.id===r.virtual.id?r.virtual:s)),y(!1)):i.error(r.message))},U=async t=>{const{data:r}=await h.custom({url:"",method:"post",meta:{operation:"createVirtualClass",variables:{darasaId:{value:parseInt(l.id?l.id.toString():"0"),type:"Int",required:!1},name:{value:t.name,type:"String",required:!0},description:{value:t.description,type:"String",required:!0},duration:{value:t.duration,type:"Int",required:!0},durationType:{value:t.durationType.toUpperCase(),type:"String",required:!0},startDate:{value:t.startDate,type:"DateTime",required:!0},isPublic:{value:!0,type:"Boolean",required:!0}},fields:["success","message",{virtual:D}]}}).catch(()=>(i.error("Error creating virtual class"),{data:null})).then(s=>s);r&&(r.success?(i.success(r.message),f(!1),u([r.virtual,...d])):i.error(r.message))},j=async(t,r="",s=!1)=>{const{data:m}=await h.custom({url:"",method:"get",meta:{operation:"darasaVirtuals",variables:{page:{value:t,type:"Int",required:!0},key:{value:r,type:"String",required:!1},id:{value:parseInt(l.id===void 0?"0":l.id.toString()),type:"Int",required:!0}},fields:["total","page","pages","hasNext","hasPrev",{results:D}]}}).catch(()=>(i.error("Error fetching virtual classes"),{data:null})).then(W=>W);m&&(P(m.total),N(m.pages),z(m.page),H(m.hasNext),u(s?m.results:[...d,...m.results])),T(!1)},$=async t=>{const{data:r}=await h.custom({url:"",method:"post",meta:{operation:"deleteVirtualClass",variables:{id:{value:t,type:"Int",required:!0}},fields:["success","message"]}}).catch(()=>(i.error("Error deleting virtual class"),{data:null})).then(s=>s);r&&(r.success?(i.success(r.message),u(d.filter(s=>s.id!==t))):i.error(r.message))},Q=t=>{ge.confirm({title:"Deleting Virtual Class Session",icon:e.jsx(ne,{}),content:"Are you sure ...",okText:"Delete",cancelText:"Cancel",onOk:()=>$(t)})};return n.useEffect(()=>{j(b)},[]),e.jsxs(e.Fragment,{children:[e.jsxs(E,{children:[e.jsx(g,{span:12,children:e.jsx(o,{layout:"vertical",form:L,onFinish:t=>j(0,t.key,!0),children:e.jsx(o.Item,{name:"key",children:e.jsx(k,{size:"large",placeholder:"Search Virtual Sessions...",prefix:e.jsx(X,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(g,{span:12,style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(F,{icon:e.jsx(Z,{}),onClick:J,disabled:!l.canManage,size:"large",children:"Create Virtual Session"})})]}),e.jsx("div",{id:"scrollableDiv",style:{height:"74vh",overflow:"auto"},children:e.jsxs(ee,{spinning:x,children:[e.jsx(v,{itemLayout:"horizontal",dataSource:d,renderItem:t=>e.jsx("div",{style:{background:"white",marginBottom:5,paddingLeft:10,paddingTop:10},children:e.jsx(me,{children:e.jsx(v.Item,{actions:[e.jsx(te,{trigger:["click"],overlay:e.jsxs(p,{children:[e.jsx(p.Item,{icon:e.jsx(re,{}),disabled:!t.canJoin,onClick:()=>C("/oclass/virtual/class/session/"+t.id+"/"+t.token),children:e.jsx("a",{children:"Join"})}),t.canDelete?e.jsx(p.Item,{disabled:!t.canDelete,icon:e.jsx(ae,{}),onClick:()=>Q(t.id),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Delete"})}):e.jsx(e.Fragment,{}),t.canEdit&&e.jsx(p.Item,{icon:e.jsx(se,{}),disabled:!t.canEdit,onClick:()=>G(t),children:e.jsx("a",{children:"Edit"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:r=>r.preventDefault(),children:e.jsx(ie,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})],children:e.jsx(pe,{avatar:!0,title:!1,loading:!1,active:!0,children:e.jsx(v.Item.Meta,{avatar:e.jsx(he,{}),title:e.jsx("a",{onClick:()=>t.canJoin?C("/oclass/virtual/class/session/"+t.id+"/"+t.token):i("You can't join this session"),children:t.name}),description:e.jsxs(e.Fragment,{children:[e.jsx("div",{dangerouslySetInnerHTML:{__html:t.description}}),e.jsxs("p",{children:[e.jsxs(S,{color:"green",children:["Start At:"," ",V(new Date(t.startDate),"MMMM do, yyyy H:mma")]}),e.jsxs(S,{color:"green",children:["End In:"," ",V(new Date(t.endDate),"MMMM do, yyyy H:mma")]}),t.canJoin?e.jsx(e.Fragment,{}):e.jsx(e.Fragment,{children:e.jsx(S,{color:"red",children:"Not Joinable"})})]})]})})})})})},"class-virtual-session-item-container-"+t.id)}),Y&&e.jsx("div",{style:{textAlign:"center",marginTop:12},children:e.jsx("button",{onClick:()=>{j(b+1)},children:"Load More"})})]})}),e.jsx(I,{title:"Creating Class Virtual Session",open:O,onClose:t=>f(t),width:"50vw",children:e.jsx(fe,{form:A,onFinish:U})}),e.jsx(I,{title:"Editting "+(a==null?void 0:a.name),width:"40vw",open:R,onClose:t=>y(t),children:e.jsx(ce,{form:B,darasa:a,onFinish:_})})]})};export{jt as ClassVirtualSessions};
