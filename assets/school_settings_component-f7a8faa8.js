import{bE as D,aM as t,br as X,bq as Z,aR as W,eU as ae,h as C,bo as q,bs as ne,be as B,r as p,bn as w,bm as ie,bA as V,bC as T,bB as ee,bJ as L,bK as x,aC as k,M as G,ax as oe,ae as E,bL as re,aG as se,ay as K,cF as le,$ as _,cY as ce,aI as de,bI as ue,bV as pe,bU as ge,eV as me,eW as xe,eX as ve,eY as fe}from"./index-2fc17c3b.js";import{T as he}from"./index-df7607b8.js";import{G as ye}from"./index-7067581d.js";import{P as be}from"./index-9c7bc008.js";import{S as Ce}from"./Skeleton-94302138.js";import{C as Pe}from"./index-f023b25a.js";import{S as Se}from"./index-5b522715.js";const Y=D(t.jsx("path",{d:"M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"}),"LastPage"),H=D(t.jsx("path",{d:"M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"}),"FirstPage");function je(e){return X("MuiPagination",e)}Z("MuiPagination",["root","ul","outlined","text"]);const Ie=["boundaryCount","componentName","count","defaultPage","disabled","hideNextButton","hidePrevButton","onChange","page","showFirstButton","showLastButton","siblingCount"];function Me(e={}){const{boundaryCount:s=1,componentName:i="usePagination",count:o=1,defaultPage:g=1,disabled:f=!1,hideNextButton:h=!1,hidePrevButton:d=!1,onChange:v,page:y,showFirstButton:S=!1,showLastButton:$=!1,siblingCount:c=1}=e,a=W(e,Ie),[r,m]=ae({controlled:y,default:g,name:i,state:"page"}),j=(u,l)=>{y||m(l),v&&v(u,l)},b=(u,l)=>{const n=l-u+1;return Array.from({length:n},(z,U)=>u+U)},P=b(1,Math.min(s,o)),I=b(Math.max(o-s+1,s+1),o),F=Math.max(Math.min(r-c,o-s-c*2-1),s+2),R=Math.min(Math.max(r+c,s+c*2+2),I.length>0?I[0]-2:o-1),A=[...S?["first"]:[],...d?[]:["previous"],...P,...F>s+2?["start-ellipsis"]:s+1<o-s?[s+1]:[],...b(F,R),...R<o-s-1?["end-ellipsis"]:o-s>s?[o-s]:[],...I,...h?[]:["next"],...$?["last"]:[]],N=u=>{switch(u){case"first":return 1;case"previous":return r-1;case"next":return r+1;case"last":return o;default:return null}},O=A.map(u=>typeof u=="number"?{onClick:l=>{j(l,u)},type:"page",page:u,selected:u===r,disabled:f,"aria-current":u===r?"true":void 0}:{onClick:l=>{j(l,N(u))},type:u,page:N(u),selected:!1,disabled:f||u.indexOf("ellipsis")===-1&&(u==="next"||u==="last"?r>=o:r<=1)});return C({items:O},a)}function $e(e){return X("MuiPaginationItem",e)}const ke=Z("MuiPaginationItem",["root","page","sizeSmall","sizeLarge","text","textPrimary","textSecondary","outlined","outlinedPrimary","outlinedSecondary","rounded","ellipsis","firstLast","previousNext","focusVisible","disabled","selected","icon"]),M=ke,J=D(t.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"NavigateBefore"),Q=D(t.jsx("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"NavigateNext"),Oe=["className","color","component","components","disabled","page","selected","shape","size","slots","type","variant"],te=(e,s)=>{const{ownerState:i}=e;return[s.root,s[i.variant],s[`size${T(i.size)}`],i.variant==="text"&&s[`text${T(i.color)}`],i.variant==="outlined"&&s[`outlined${T(i.color)}`],i.shape==="rounded"&&s.rounded,i.type==="page"&&s.page,(i.type==="start-ellipsis"||i.type==="end-ellipsis")&&s.ellipsis,(i.type==="previous"||i.type==="next")&&s.previousNext,(i.type==="first"||i.type==="last")&&s.firstLast]},ze=e=>{const{classes:s,color:i,disabled:o,selected:g,size:f,shape:h,type:d,variant:v}=e,y={root:["root",`size${T(f)}`,v,h,i!=="standard"&&`${v}${T(i)}`,o&&"disabled",g&&"selected",{page:"page",first:"firstLast",last:"firstLast","start-ellipsis":"ellipsis","end-ellipsis":"ellipsis",previous:"previousNext",next:"previousNext"}[d]],icon:["icon"]};return ee(y,$e,s)},Re=q("div",{name:"MuiPaginationItem",slot:"Root",overridesResolver:te})(({theme:e,ownerState:s})=>C({},e.typography.body2,{borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,padding:"0 6px",margin:"0 3px",color:(e.vars||e).palette.text.primary,height:"auto",[`&.${M.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity}},s.size==="small"&&{minWidth:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px"},s.size==="large"&&{minWidth:40,borderRadius:40/2,padding:"0 10px",fontSize:e.typography.pxToRem(15)})),Fe=q(ne,{name:"MuiPaginationItem",slot:"Root",overridesResolver:te})(({theme:e,ownerState:s})=>C({},e.typography.body2,{borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,height:32,padding:"0 6px",margin:"0 3px",color:(e.vars||e).palette.text.primary,[`&.${M.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${M.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},transition:e.transitions.create(["color","background-color"],{duration:e.transitions.duration.short}),"&:hover":{backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${M.selected}`]:{backgroundColor:(e.vars||e).palette.action.selected,"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selected} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:B(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(e.vars||e).palette.action.selected}},[`&.${M.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selected} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:B(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)},[`&.${M.disabled}`]:{opacity:1,color:(e.vars||e).palette.action.disabled,backgroundColor:(e.vars||e).palette.action.selected}}},s.size==="small"&&{minWidth:26,height:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px"},s.size==="large"&&{minWidth:40,height:40,borderRadius:40/2,padding:"0 10px",fontSize:e.typography.pxToRem(15)},s.shape==="rounded"&&{borderRadius:(e.vars||e).shape.borderRadius}),({theme:e,ownerState:s})=>C({},s.variant==="text"&&{[`&.${M.selected}`]:C({},s.color!=="standard"&&{color:(e.vars||e).palette[s.color].contrastText,backgroundColor:(e.vars||e).palette[s.color].main,"&:hover":{backgroundColor:(e.vars||e).palette[s.color].dark,"@media (hover: none)":{backgroundColor:(e.vars||e).palette[s.color].main}},[`&.${M.focusVisible}`]:{backgroundColor:(e.vars||e).palette[s.color].dark}},{[`&.${M.disabled}`]:{color:(e.vars||e).palette.action.disabled}})},s.variant==="outlined"&&{border:e.vars?`1px solid rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${M.selected}`]:C({},s.color!=="standard"&&{color:(e.vars||e).palette[s.color].main,border:`1px solid ${e.vars?`rgba(${e.vars.palette[s.color].mainChannel} / 0.5)`:B(e.palette[s.color].main,.5)}`,backgroundColor:e.vars?`rgba(${e.vars.palette[s.color].mainChannel} / ${e.vars.palette.action.activatedOpacity})`:B(e.palette[s.color].main,e.palette.action.activatedOpacity),"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette[s.color].mainChannel} / calc(${e.vars.palette.action.activatedOpacity} + ${e.vars.palette.action.focusOpacity}))`:B(e.palette[s.color].main,e.palette.action.activatedOpacity+e.palette.action.focusOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${M.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette[s.color].mainChannel} / calc(${e.vars.palette.action.activatedOpacity} + ${e.vars.palette.action.focusOpacity}))`:B(e.palette[s.color].main,e.palette.action.activatedOpacity+e.palette.action.focusOpacity)}},{[`&.${M.disabled}`]:{borderColor:(e.vars||e).palette.action.disabledBackground,color:(e.vars||e).palette.action.disabled}})})),Ae=q("div",{name:"MuiPaginationItem",slot:"Icon",overridesResolver:(e,s)=>s.icon})(({theme:e,ownerState:s})=>C({fontSize:e.typography.pxToRem(20),margin:"0 -8px"},s.size==="small"&&{fontSize:e.typography.pxToRem(18)},s.size==="large"&&{fontSize:e.typography.pxToRem(22)})),Ne=p.forwardRef(function(s,i){const o=w({props:s,name:"MuiPaginationItem"}),{className:g,color:f="standard",component:h,components:d={},disabled:v=!1,page:y,selected:S=!1,shape:$="circular",size:c="medium",slots:a={},type:r="page",variant:m="text"}=o,j=W(o,Oe),b=C({},o,{color:f,disabled:v,selected:S,shape:$,size:c,type:r,variant:m}),P=ie(),I=ze(b),R=(P.direction==="rtl"?{previous:a.next||d.next||Q,next:a.previous||d.previous||J,last:a.first||d.first||H,first:a.last||d.last||Y}:{previous:a.previous||d.previous||J,next:a.next||d.next||Q,first:a.first||d.first||H,last:a.last||d.last||Y})[r];return r==="start-ellipsis"||r==="end-ellipsis"?t.jsx(Re,{ref:i,ownerState:b,className:V(I.root,g),children:"â€¦"}):t.jsxs(Fe,C({ref:i,ownerState:b,component:h,disabled:v,className:V(I.root,g)},j,{children:[r==="page"&&y,R?t.jsx(Ae,{as:R,ownerState:b,className:I.icon}):null]}))}),Le=Ne,Be=["boundaryCount","className","color","count","defaultPage","disabled","getItemAriaLabel","hideNextButton","hidePrevButton","onChange","page","renderItem","shape","showFirstButton","showLastButton","siblingCount","size","variant"],Te=e=>{const{classes:s,variant:i}=e;return ee({root:["root",i],ul:["ul"]},je,s)},Ee=q("nav",{name:"MuiPagination",slot:"Root",overridesResolver:(e,s)=>{const{ownerState:i}=e;return[s.root,s[i.variant]]}})({}),qe=q("ul",{name:"MuiPagination",slot:"Ul",overridesResolver:(e,s)=>s.ul})({display:"flex",flexWrap:"wrap",alignItems:"center",padding:0,margin:0,listStyle:"none"});function Ue(e,s,i){return e==="page"?`${i?"":"Go to "}page ${s}`:`Go to ${e} page`}const De=p.forwardRef(function(s,i){const o=w({props:s,name:"MuiPagination"}),{boundaryCount:g=1,className:f,color:h="standard",count:d=1,defaultPage:v=1,disabled:y=!1,getItemAriaLabel:S=Ue,hideNextButton:$=!1,hidePrevButton:c=!1,renderItem:a=O=>t.jsx(Le,C({},O)),shape:r="circular",showFirstButton:m=!1,showLastButton:j=!1,siblingCount:b=1,size:P="medium",variant:I="text"}=o,F=W(o,Be),{items:R}=Me(C({},o,{componentName:"Pagination"})),A=C({},o,{boundaryCount:g,color:h,count:d,defaultPage:v,disabled:y,getItemAriaLabel:S,hideNextButton:$,hidePrevButton:c,renderItem:a,shape:r,showFirstButton:m,showLastButton:j,siblingCount:b,size:P,variant:I}),N=Te(A);return t.jsx(Ee,C({"aria-label":"pagination navigation",className:V(N.root,f),ownerState:A,ref:i},F,{children:t.jsx(qe,{className:N.ul,ownerState:A,children:R.map((O,u)=>t.jsx("li",{children:a(C({},O,{color:h,"aria-label":S(O.type,O.page,O.selected),shape:r,size:P,variant:I}))},u))})}))}),Xe=De,Ze=e=>{const[s,i]=p.useState([]),[o,g]=p.useState([]),[f,h]=p.useState([]),[d,v]=p.useState([]),y=async(r,m="")=>{const{data:j}=await L.custom({url:"",method:"get",meta:{operation:"systemRolePermissionsRecords",variables:{page:{value:r,type:"Int",required:!0},key:{value:m,type:"String",required:!1},roleId:{value:e.role.id,type:"Int",required:!0}},fields:["total","page","pages","hasNext","hasPrev",{results:["key","title","description","chosen"]}]}}),b=[];j.results.forEach(P=>{P.chosen&&b.push(P.key)}),i([...j.results]),g(b)},S=async r=>{const{data:m}=await L.custom({url:"",method:"post",meta:{operation:"addRolePermissions",variables:{roleId:{value:parseInt(e.role.id),type:"Int",required:!0},permissions:{value:r,type:"[Int]",required:!0}},fields:["success","message"]}});m.success?x.success(m.message):x.error(m.message)},$=async r=>{const{data:m}=await L.custom({url:"",method:"post",meta:{operation:"removeRolePermissions",variables:{roleId:{value:parseInt(e.role.id),type:"Int",required:!0},permissions:{value:r,type:"[Int]",required:!0}},fields:["success","message"]}});m.success?x.success(m.message):x.error(m.message)},c=r=>{g(r),d.length>0&&S(d),f.length>0&&$(f)},a=(r,m)=>{v(r),h(m)};return p.useEffect(()=>{y(1)},[e.randKey,e.role]),t.jsx(t.Fragment,{children:t.jsx(he,{titles:["Not Assigned Permissions","Assigned Permissions"],dataSource:s,showSearch:!0,listStyle:{width:"100vw",height:"65vh"},operations:["Add","Remove"],targetKeys:o,onChange:c,onSelectChange:a,onSearch:(r,m)=>{},render:r=>r.title})})},{TextArea:Ve}=G,Ke=e=>{const[s,i]=p.useState(e.programme.isActive);return p.useEffect(()=>{e.form.setFieldsValue({name:e.programme.name,description:e.programme.description,isActive:e.programme.isActive})},[e.form,e.programme]),t.jsx(t.Fragment,{children:t.jsxs(k,{layout:"vertical",form:e.form,onFinish:o=>{o.isActive=s,o.id=parseInt(e.programme.id),e.onFinish(o)},requiredMark:!1,children:[t.jsx(k.Item,{name:"name",label:"Name",rules:[{required:!0,type:"string",message:"Please input Name"}],children:t.jsx(G,{size:"large",placeholder:"Enter Name ..."})}),t.jsx(k.Item,{name:"description",label:"Description",rules:[{required:!1,type:"string",message:"Please input Description"}],children:t.jsx(Ve,{rows:4})}),t.jsx(k.Item,{name:"isActive",children:t.jsx(oe,{checked:s,onChange:()=>i(!s),children:"Active"})}),t.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:t.jsx(E,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},we=e=>{const[s,i]=p.useState(),[o,g]=p.useState([]),[f,h]=p.useState(0),[d,v]=p.useState(20),[y,S]=p.useState(""),[$,c]=p.useState(!0);re();const[a]=k.useForm(),[r]=k.useForm(),j=!ye.useBreakpoint().lg,[b,P]=p.useState(!1),I=l=>{i(l),P(!0)},F=async l=>{const{data:n}=await L.custom({url:"",method:"post",meta:{operation:"updateProgramme",variables:{id:{value:l.id,type:"Int",required:!0},name:{value:l.name,type:"String",required:!0},description:{value:l.description,type:"String",required:!1},isActive:{value:l.isActive,type:"Boolean",required:!0}},fields:["success","message",{programme:["id","name","description","created","updated","isActive","canDelete","canEdit","canManage"]}]}});n.success?(x.success(n.message),r.resetFields(),P(!1),g(o.map(z=>z.id===n.programme.id?n.programme:z))):x.error(n.message)},R=async()=>{const{data:l}=await L.custom({url:"",method:"post",meta:{operation:"syncSystemProgrammes",variables:{},fields:["success","message"]}});l.success?(x.success(l.message),o.length=0,g([]),u(1)):x.error(l.message)},A=async l=>{const{data:n}=await L.custom({url:"",method:"post",meta:{operation:"deleteProgramme",variables:{id:{value:parseInt(l.toString()),type:"Int",required:!0}},fields:["success","message"]}});n.success?(x.success(n.message),g(o.filter(z=>z.id!==l))):x.error(n.message)},N=()=>{x("Canceled")},O=[{title:"Name",dataIndex:"name",fixed:!0,render:(l,n,z)=>t.jsx("span",{children:t.jsx("a",{children:n.name})})},{title:"Created",dataIndex:"created",render:(l,n,z)=>t.jsx(t.Fragment,{children:t.jsx("span",{children:new Date(n.created).toLocaleString()})})},{title:"Status",dataIndex:"isActive",render:(l,n,z)=>t.jsx("a",{children:n!=null&&n.isActive?t.jsx("span",{style:{color:"green"},children:"Active"}):t.jsx("span",{style:{color:"red"},children:"Inactive"})})},{title:"",dataIndex:"action",render:(l,n,z)=>t.jsxs("div",{style:{display:"flex",justifyContent:"flex-end"},children:[e.control&&t.jsx(be,{title:"Are you sure to delete this Programme?",onConfirm:()=>A(n==null?void 0:n.id),onCancel:()=>N,okText:"Yes",cancelText:"No",disabled:!(n!=null&&n.canDelete),overlayStyle:{zIndex:9999},children:t.jsx(E,{icon:t.jsx(pe,{}),disabled:!(n!=null&&n.canDelete)})}),e.control&&t.jsx(_,{title:"Edit "+(n==null?void 0:n.name)+" Programme",color:"green",children:t.jsx(E,{icon:t.jsx(ge,{}),disabled:!(n!=null&&n.canEdit),onClick:()=>I(n)})})]})}],u=async(l,n="",z=20)=>{const{data:U}=await L.custom({url:"",method:"get",meta:{operation:"systemProgrammes",variables:{page:{value:l,type:"Int",required:!0},key:{value:n,type:"String",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","description","isActive","created","updated","canEdit","canDelete","canManage"]}]}});h(U.total),g([...U.results]),c(!1)};return p.useEffect(()=>{u(1,"",20)},[]),t.jsxs(t.Fragment,{children:[t.jsxs(se,{style:{marginTop:10},children:[t.jsx(K,{span:j?24:20,children:t.jsx(k,{layout:"vertical",form:a,onFinish:l=>{S(l.key),o.length=0,u(1,l.key)},children:t.jsx(k.Item,{name:"key",children:t.jsx(G,{size:"large",placeholder:"Search ...",prefix:t.jsx(le,{}),autoComplete:"off",allowClear:!0})})})}),(e==null?void 0:e.control)&&t.jsx(K,{span:j?24:4,style:{display:"flex",justifyContent:"flex-end"},children:t.jsx(_,{title:"Synchronize Default System Programmes",children:t.jsx(E,{icon:t.jsx(ce,{}),size:"large",onClick:()=>R(),children:"Sync Programmes"})})})]}),t.jsx(de,{loading:$,columns:O,dataSource:o,pagination:{onChange:(l,n)=>{v(n),u(l,y,n)},total:f,pageSize:d,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0}}),t.jsx(ue,{title:"Edit "+(s==null?void 0:s.name)+" Informations",width:"40vw",open:b,onClose:l=>P(l),children:t.jsx(Ke,{form:r,programme:s,onFinish:F})})]})},es=e=>{const[s,i]=p.useState(!1),[o,g]=p.useState(!1),[f,h]=p.useState(),[d]=k.useForm(),v=async()=>{me().then(c=>{c&&(c.success?(x.success(c.message),y()):x.error(c.message))})},y=async()=>{var c;g(!0),xe(e.school,((c=e.school)==null?void 0:c.id)??0).then(a=>{a?(i(!0),h(a),d.setFieldsValue({teachersCanCreateClasses:a.teachersCanCreateClasses,teachersCanCreateDrives:a.teachersCanCreateDrives,teachersCanCreatePublicVirtualClassSessions:a.teachersCanCreatePublicVirtualClassSessions,dispatchMessagesOnClassVirtualSessionCreation:a.dispatchMessagesOnClassVirtualSessionCreation,dispatchMessagesOnFilesUpload:a.dispatchMessagesOnFilesUpload,dispatchMessagesOnAssignmentsCreation:a.dispatchMessagesOnAssignmentsCreation,dispatchMessagesOnAnnouncementsCreation:a.dispatchMessagesOnAnnouncementsCreation,dispatchMessagesOnTimetableSessionsCreation:a.dispatchMessagesOnTimetableSessionsCreation,dispatchMessagesOnTimetableSessionCancellation:a.dispatchMessagesOnTimetableSessionCancellation,dispatchMessagesOnTimetableSessionRescheduling:a.dispatchMessagesOnTimetableSessionRescheduling,studentsCanCreateClassVirtualSessions:a.studentsCanCreateClassVirtualSessions,studentsCanCreateDrives:a.studentsCanCreateDrives,studentsCanCreateClasses:a.studentsCanCreateClasses,studentsCanUploadFiles:a.studentsCanUploadFiles,teachersCanUploadFiles:a.teachersCanUploadFiles})):i(!1)}),g(!1)},S=async c=>{ve(c,e.school.id).then(a=>{a&&(a.success?x.success(a.message):x.error(a.message))})},$=async c=>{fe(c).then(a=>{a&&(a.success?x.success(a.message):x.error(a.message))})};return p.useEffect(()=>{y()},[e.randKey,e.school]),t.jsx(t.Fragment,{children:t.jsx(Ce,{loading:o,active:!0,children:s?t.jsx("div",{style:{marginTop:10,marginLeft:20,maxHeight:e.full?"70vh":"100vh",overflowY:"auto"},children:t.jsx(k,{layout:"horizontal",form:d,onFinish:c=>{e.school?S(c):$(c)},onChange:()=>{d.submit()},children:t.jsx(se,{style:{display:"flex",justifyContent:"flex-start"},children:t.jsx(K,{span:e.full?24:12,children:t.jsx(Pe,{children:Object.entries(f??{}).map(([c,a])=>t.jsx(k.Item,{label:c.split(/(?=[A-Z])/).map(r=>r.charAt(0).toUpperCase()+r.slice(1)).join(" "),name:c,initialValue:a,children:t.jsx(Se,{checked:d.getFieldValue(c),onChange:r=>{d.submit(),h(d.getFieldsValue())}})}))})})})})}):t.jsx(t.Fragment,{children:t.jsx("div",{style:{display:"flex",justifyContent:"center"},children:t.jsx(E,{onClick:()=>v(),children:"Auto Create Settings"})})})})})};export{we as P,Ze as R,es as S,Xe as a};
