import{r as s,aT as h,c as E,j as e,G as o,a1 as q,a8 as L,B as v,aX as g,aR as M,aU as j,ae as T,cz as u,P as _,g as f,_ as x,cn as H,cL as G,aN as n}from"./index-7df9ee76.js";import{d as W}from"./data_objects-327f1d7c.js";import{C as U}from"./index-746394d2.js";import{A as X}from"./index-efa01bbc.js";import{A as J}from"./Alert-89af5dce.js";import{M as y}from"./index-c15cc96b.js";import{S as K}from"./SearchOutlined-dcd1f7fa.js";import{R as Q}from"./RollbackOutlined-ef20cc0a.js";import{M as V}from"./MoreOutlined-8471c15a.js";import{F as Y}from"./FolderOpenOutlined-76d52b2b.js";import{E as Z}from"./ExclamationCircleOutlined-854fb9e1.js";import"./Skeleton-494b0004.js";import"./DotChartOutlined-f39c986e.js";import"./index-fdfe4d32.js";import"./index-d353142b.js";import"./InfoCircleFilled-60705b95.js";import"./InfoCircleFilled-baaa675e.js";import"./ActionButton-8146ab60.js";import"./DialogWrap-f6cebbde.js";import"./index-6d39d6f0.js";import"./fade-faabdb66.js";const $=ee=>{const[l,p]=s.useState([]),[a,S]=s.useState(!0),[A,c]=s.useState(1),[C,b]=s.useState(0),[re,F]=s.useState(0),[k,I]=s.useState(24),[P,D]=s.useState(!0),[R,w]=s.useState(!1),[z]=h.useForm();E();const O=async r=>{const{data:t}=await f.custom({url:"",method:"post",meta:{operation:"removeDriveArchive",variables:{id:{value:r,type:"Int",required:!0}},fields:["success","message"]}});t.success?(x.success(t.message),p(l.filter(m=>m.id!==r))):x.error(t.message),y.destroyAll()},N=r=>{y.confirm({title:"Confirm",icon:e.jsx(Z,{}),content:"Removing Drive From Archive ....",okText:"Add",cancelText:"Cancel",onOk:()=>O(r)})},d=async(r,t=24,m="")=>{const{data:i}=await f.custom({url:"",method:"get",meta:{operation:"drivesArchives",variables:{page:{value:r,type:"Int",required:!0},key:{value:m,type:"String",required:!1},pageSize:{value:t,type:"Int",required:!0}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{drive:W}]}]}}).catch(()=>(x.error("Failed to load archives"),{data:null})).then(B=>B);i&&(b(i.total),c(i.page),F(i.pages),D(i.hasNext),w(i.hasPrev),p(i.results)),S(!1)};return s.useEffect(()=>{d(1)},[]),e.jsxs(e.Fragment,{children:[e.jsx(o,{container:!0,children:e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(h,{layout:"vertical",form:z,onFinish:r=>{c(1),d(1,k,r.key)},children:e.jsx(h.Item,{name:"key",children:e.jsx(q,{size:"large",placeholder:"Search Drive(s)...",prefix:e.jsx(K,{}),autoComplete:"off",allowClear:!0,disabled:a})})})})}),e.jsx(L,{spinning:a,children:e.jsx(v,{children:l.length>0?e.jsx(o,{container:!0,children:l.map(r=>e.jsx(o,{item:!0,xs:12,sm:6,md:4,lg:4,xl:4,children:e.jsxs(U,{hoverable:r.isActive,style:{marginRight:10},children:[e.jsx(g,{style:{right:0,position:"absolute"},children:e.jsx(M,{trigger:["click"],overlay:e.jsx(j,{children:e.jsx(j.Item,{icon:e.jsx(Q,{}),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",onClick:()=>N(r.id),children:"Restore"})})}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:t=>t.preventDefault(),children:e.jsx(V,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})}),e.jsx(T.Ribbon,{text:r.drive.code,placement:"start",color:"orange",children:e.jsx(u,{to:"/odrive/drive/"+r.drive.id+"/"+r.drive.code+"/files",children:e.jsxs(g,{direction:"vertical",align:"center",style:{width:"100%",justifyContent:"center"},children:[e.jsx(X,{size:{xs:24,sm:32,md:40,lg:40,xl:40,xxl:80},icon:e.jsx(Y,{}),src:r.drive.icon}),e.jsx("span",{style:{fontSize:20},children:r.drive.name})]})})})]})}))}):e.jsx(J,{severity:"info",children:a?e.jsx("b",{children:"Loading..."}):e.jsx("b",{children:"No Archives Found"})})})}),(P||R)&&!a&&e.jsx(v,{sx:{display:"flex",justifyContent:"center"},children:e.jsx(_,{showSizeChanger:!0,onShowSizeChange:(r,t)=>{c(r),I(t),d(r,t)},defaultCurrent:A,total:C})})]})},Ce=()=>(s.useEffect(()=>{document.title=H.system_name+": Archives"},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10,marginBottom:10},children:e.jsx(G,{children:e.jsxs(n,{children:[e.jsx(n.Item,{children:e.jsx(u,{to:"/",children:"Home"})}),e.jsx(n.Item,{children:e.jsx(u,{to:"/odrive",children:"Odrive"})}),e.jsx(n.Item,{children:"Archives"})]})})}),e.jsx($,{})]}));export{Ce as DrivesArchivesPage};
