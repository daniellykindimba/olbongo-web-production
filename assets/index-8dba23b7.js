var is=Object.defineProperty;var rs=(Q,m,Y)=>m in Q?is(Q,m,{enumerable:!0,configurable:!0,writable:!0,value:Y}):Q[m]=Y;var Dt=(Q,m,Y)=>(rs(Q,typeof m!="symbol"?m+"":m,Y),Y),de=(Q,m,Y)=>{if(!m.has(Q))throw TypeError("Cannot "+Y)};var u=(Q,m,Y)=>(de(Q,m,"read from private field"),Y?Y.call(Q):m.get(Q)),K=(Q,m,Y)=>{if(m.has(Q))throw TypeError("Cannot add the same private member more than once");m instanceof WeakSet?m.add(Q):m.set(Q,Y)},pt=(Q,m,Y,b)=>(de(Q,m,"write to private field"),b?b.call(Q,Y):m.set(Q,Y),Y);var ie=(Q,m,Y,b)=>({set _(k){pt(Q,m,k,Y)},get _(){return u(Q,m,b)}}),tt=(Q,m,Y)=>(de(Q,m,"access private method"),Y);import{bD as getDefaultExportFromCjs,gH as commonjsRequire,gI as require$$5,u as invariant}from"./index-c92f9f6b.js";function _mergeNamespaces(Q,m){for(var Y=0;Y<m.length;Y++){const b=m[Y];if(typeof b!="string"&&!Array.isArray(b)){for(const k in b)if(k!=="default"&&!(k in Q)){const X=Object.getOwnPropertyDescriptor(b,k);X&&Object.defineProperty(Q,k,X.get?X:{enumerable:!0,get:()=>b[k]})}}}return Object.freeze(Object.defineProperty(Q,Symbol.toStringTag,{value:"Module"}))}var pdf$1={exports:{}};(function(module,exports){(function(m,Y){module.exports=Y()})(globalThis,()=>(()=>{var __webpack_modules__=[,(Q,m)=>{var Rt;Object.defineProperty(m,"__esModule",{value:!0}),m.VerbosityLevel=m.Util=m.UnknownErrorException=m.UnexpectedResponseException=m.TextRenderingMode=m.RenderingIntentFlag=m.PromiseCapability=m.PermissionFlag=m.PasswordResponses=m.PasswordException=m.PageActionEventType=m.OPS=m.MissingPDFException=m.MAX_IMAGE_SIZE_TO_CACHE=m.LINE_FACTOR=m.LINE_DESCENT_FACTOR=m.InvalidPDFException=m.ImageKind=m.IDENTITY_MATRIX=m.FormatError=m.FeatureTest=m.FONT_IDENTITY_MATRIX=m.DocumentActionEventType=m.CMapCompressionType=m.BaseException=m.BASELINE_FACTOR=m.AnnotationType=m.AnnotationStateModelType=m.AnnotationReviewState=m.AnnotationReplyType=m.AnnotationMode=m.AnnotationMarkedState=m.AnnotationFlag=m.AnnotationFieldFlag=m.AnnotationEditorType=m.AnnotationEditorPrefix=m.AnnotationEditorParamsType=m.AnnotationBorderStyleType=m.AnnotationActionEventType=m.AbortException=void 0,m.assert=vt,m.bytesToString=M,m.createValidAbsoluteUrl=At,m.getModificationDate=_t,m.getVerbosityLevel=dt,m.info=lt,m.isArrayBuffer=ft,m.isArrayEqual=Et,m.normalizeUnicode=yt,m.objectFromMap=_,m.objectSize=f,m.setVerbosityLevel=st,m.shadow=U,m.string32=n,m.stringToBytes=e,m.stringToPDFString=Z,m.stringToUTF8String=it,m.unreachable=mt,m.utf8StringToString=ut,m.warn=ht;const Y=[1,0,0,1,0,0];m.IDENTITY_MATRIX=Y;const b=[.001,0,0,.001,0,0];m.FONT_IDENTITY_MATRIX=b;const k=1e7;m.MAX_IMAGE_SIZE_TO_CACHE=k;const X=1.35;m.LINE_FACTOR=X;const z=.35;m.LINE_DESCENT_FACTOR=z;const ot=z/X;m.BASELINE_FACTOR=ot;const W={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};m.RenderingIntentFlag=W;const L={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};m.AnnotationMode=L;const v="pdfjs_internal_editor_";m.AnnotationEditorPrefix=v;const N={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};m.AnnotationEditorType=N;const w={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};m.AnnotationEditorParamsType=w;const x={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};m.PermissionFlag=x;const p={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};m.TextRenderingMode=p;const d={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};m.ImageKind=d;const r={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};m.AnnotationType=r;const A={MARKED:"Marked",REVIEW:"Review"};m.AnnotationStateModelType=A;const y={MARKED:"Marked",UNMARKED:"Unmarked"};m.AnnotationMarkedState=y;const T={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};m.AnnotationReviewState=T;const g={GROUP:"Group",REPLY:"R"};m.AnnotationReplyType=g;const t={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};m.AnnotationFlag=t;const a={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};m.AnnotationFieldFlag=a;const o={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};m.AnnotationBorderStyleType=o;const s={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};m.AnnotationActionEventType=s;const c={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};m.DocumentActionEventType=c;const P={O:"PageOpen",C:"PageClose"};m.PageActionEventType=P;const i={ERRORS:0,WARNINGS:1,INFOS:5};m.VerbosityLevel=i;const I={NONE:0,BINARY:1};m.CMapCompressionType=I;const q={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};m.OPS=q;const $={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};m.PasswordResponses=$;let J=i.WARNINGS;function st(ct){Number.isInteger(ct)&&(J=ct)}function dt(){return J}function lt(ct){J>=i.INFOS&&console.log(`Info: ${ct}`)}function ht(ct){J>=i.WARNINGS&&console.log(`Warning: ${ct}`)}function mt(ct){throw new Error(ct)}function vt(ct,C){ct||mt(C)}function St(ct){switch(ct==null?void 0:ct.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function At(ct,C=null,F=null){if(!ct)return null;try{if(F&&typeof ct=="string"){if(F.addDefaultProtocol&&ct.startsWith("www.")){const gt=ct.match(/\./g);(gt==null?void 0:gt.length)>=2&&(ct=`http://${ct}`)}if(F.tryConvertEncoding)try{ct=it(ct)}catch{}}const at=C?new URL(ct,C):new URL(ct);if(St(at))return at}catch{}return null}function U(ct,C,F,at=!1){return Object.defineProperty(ct,C,{value:F,enumerable:!at,configurable:!0,writable:!1}),F}const l=function(){function C(F,at){this.constructor===C&&mt("Cannot initialize BaseException."),this.message=F,this.name=at}return C.prototype=new Error,C.constructor=C,C}();m.BaseException=l;class h extends l{constructor(C,F){super(C,"PasswordException"),this.code=F}}m.PasswordException=h;class S extends l{constructor(C,F){super(C,"UnknownErrorException"),this.details=F}}m.UnknownErrorException=S;class j extends l{constructor(C){super(C,"InvalidPDFException")}}m.InvalidPDFException=j;class D extends l{constructor(C){super(C,"MissingPDFException")}}m.MissingPDFException=D;class H extends l{constructor(C,F){super(C,"UnexpectedResponseException"),this.status=F}}m.UnexpectedResponseException=H;class O extends l{constructor(C){super(C,"FormatError")}}m.FormatError=O;class R extends l{constructor(C){super(C,"AbortException")}}m.AbortException=R;function M(ct){(typeof ct!="object"||(ct==null?void 0:ct.length)===void 0)&&mt("Invalid argument for bytesToString");const C=ct.length,F=8192;if(C<F)return String.fromCharCode.apply(null,ct);const at=[];for(let gt=0;gt<C;gt+=F){const Tt=Math.min(gt+F,C),xt=ct.subarray(gt,Tt);at.push(String.fromCharCode.apply(null,xt))}return at.join("")}function e(ct){typeof ct!="string"&&mt("Invalid argument for stringToBytes");const C=ct.length,F=new Uint8Array(C);for(let at=0;at<C;++at)F[at]=ct.charCodeAt(at)&255;return F}function n(ct){return String.fromCharCode(ct>>24&255,ct>>16&255,ct>>8&255,ct&255)}function f(ct){return Object.keys(ct).length}function _(ct){const C=Object.create(null);for(const[F,at]of ct)C[F]=at;return C}function E(){const ct=new Uint8Array(4);return ct[0]=1,new Uint32Array(ct.buffer,0,1)[0]===1}function B(){try{return new Function(""),!0}catch{return!1}}class et{static get isLittleEndian(){return U(this,"isLittleEndian",E())}static get isEvalSupported(){return U(this,"isEvalSupported",B())}static get isOffscreenCanvasSupported(){return U(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?U(this,"platform",{isWin:!1,isMac:!1}):U(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}}m.FeatureTest=et;const V=[...Array(256).keys()].map(ct=>ct.toString(16).padStart(2,"0"));class nt{static makeHexColor(C,F,at){return`#${V[C]}${V[F]}${V[at]}`}static scaleMinMax(C,F){let at;C[0]?(C[0]<0&&(at=F[0],F[0]=F[1],F[1]=at),F[0]*=C[0],F[1]*=C[0],C[3]<0&&(at=F[2],F[2]=F[3],F[3]=at),F[2]*=C[3],F[3]*=C[3]):(at=F[0],F[0]=F[2],F[2]=at,at=F[1],F[1]=F[3],F[3]=at,C[1]<0&&(at=F[2],F[2]=F[3],F[3]=at),F[2]*=C[1],F[3]*=C[1],C[2]<0&&(at=F[0],F[0]=F[1],F[1]=at),F[0]*=C[2],F[1]*=C[2]),F[0]+=C[4],F[1]+=C[4],F[2]+=C[5],F[3]+=C[5]}static transform(C,F){return[C[0]*F[0]+C[2]*F[1],C[1]*F[0]+C[3]*F[1],C[0]*F[2]+C[2]*F[3],C[1]*F[2]+C[3]*F[3],C[0]*F[4]+C[2]*F[5]+C[4],C[1]*F[4]+C[3]*F[5]+C[5]]}static applyTransform(C,F){const at=C[0]*F[0]+C[1]*F[2]+F[4],gt=C[0]*F[1]+C[1]*F[3]+F[5];return[at,gt]}static applyInverseTransform(C,F){const at=F[0]*F[3]-F[1]*F[2],gt=(C[0]*F[3]-C[1]*F[2]+F[2]*F[5]-F[4]*F[3])/at,Tt=(-C[0]*F[1]+C[1]*F[0]+F[4]*F[1]-F[5]*F[0])/at;return[gt,Tt]}static getAxialAlignedBoundingBox(C,F){const at=nt.applyTransform(C,F),gt=nt.applyTransform(C.slice(2,4),F),Tt=nt.applyTransform([C[0],C[3]],F),xt=nt.applyTransform([C[2],C[1]],F);return[Math.min(at[0],gt[0],Tt[0],xt[0]),Math.min(at[1],gt[1],Tt[1],xt[1]),Math.max(at[0],gt[0],Tt[0],xt[0]),Math.max(at[1],gt[1],Tt[1],xt[1])]}static inverseTransform(C){const F=C[0]*C[3]-C[1]*C[2];return[C[3]/F,-C[1]/F,-C[2]/F,C[0]/F,(C[2]*C[5]-C[4]*C[3])/F,(C[4]*C[1]-C[5]*C[0])/F]}static singularValueDecompose2dScale(C){const F=[C[0],C[2],C[1],C[3]],at=C[0]*F[0]+C[1]*F[2],gt=C[0]*F[1]+C[1]*F[3],Tt=C[2]*F[0]+C[3]*F[2],xt=C[2]*F[1]+C[3]*F[3],kt=(at+xt)/2,Pt=Math.sqrt((at+xt)**2-4*(at*xt-Tt*gt))/2,Mt=kt+Pt||1,wt=kt-Pt||1;return[Math.sqrt(Mt),Math.sqrt(wt)]}static normalizeRect(C){const F=C.slice(0);return C[0]>C[2]&&(F[0]=C[2],F[2]=C[0]),C[1]>C[3]&&(F[1]=C[3],F[3]=C[1]),F}static intersect(C,F){const at=Math.max(Math.min(C[0],C[2]),Math.min(F[0],F[2])),gt=Math.min(Math.max(C[0],C[2]),Math.max(F[0],F[2]));if(at>gt)return null;const Tt=Math.max(Math.min(C[1],C[3]),Math.min(F[1],F[3])),xt=Math.min(Math.max(C[1],C[3]),Math.max(F[1],F[3]));return Tt>xt?null:[at,Tt,gt,xt]}static bezierBoundingBox(C,F,at,gt,Tt,xt,kt,Pt){const Mt=[],wt=[[],[]];let Lt,Ot,It,Ft,Bt,Ut,Wt,qt;for(let zt=0;zt<2;++zt){if(zt===0?(Ot=6*C-12*at+6*Tt,Lt=-3*C+9*at-9*Tt+3*kt,It=3*at-3*C):(Ot=6*F-12*gt+6*xt,Lt=-3*F+9*gt-9*xt+3*Pt,It=3*gt-3*F),Math.abs(Lt)<1e-12){if(Math.abs(Ot)<1e-12)continue;Ft=-It/Ot,0<Ft&&Ft<1&&Mt.push(Ft);continue}Wt=Ot*Ot-4*It*Lt,qt=Math.sqrt(Wt),!(Wt<0)&&(Bt=(-Ot+qt)/(2*Lt),0<Bt&&Bt<1&&Mt.push(Bt),Ut=(-Ot-qt)/(2*Lt),0<Ut&&Ut<1&&Mt.push(Ut))}let Nt=Mt.length,jt;const Gt=Nt;for(;Nt--;)Ft=Mt[Nt],jt=1-Ft,wt[0][Nt]=jt*jt*jt*C+3*jt*jt*Ft*at+3*jt*Ft*Ft*Tt+Ft*Ft*Ft*kt,wt[1][Nt]=jt*jt*jt*F+3*jt*jt*Ft*gt+3*jt*Ft*Ft*xt+Ft*Ft*Ft*Pt;return wt[0][Gt]=C,wt[1][Gt]=F,wt[0][Gt+1]=kt,wt[1][Gt+1]=Pt,wt[0].length=wt[1].length=Gt+2,[Math.min(...wt[0]),Math.min(...wt[1]),Math.max(...wt[0]),Math.max(...wt[1])]}}m.Util=nt;const rt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Z(ct){if(ct[0]>="ï"){let F;if(ct[0]==="þ"&&ct[1]==="ÿ"?F="utf-16be":ct[0]==="ÿ"&&ct[1]==="þ"?F="utf-16le":ct[0]==="ï"&&ct[1]==="»"&&ct[2]==="¿"&&(F="utf-8"),F)try{const at=new TextDecoder(F,{fatal:!0}),gt=e(ct);return at.decode(gt)}catch(at){ht(`stringToPDFString: "${at}".`)}}const C=[];for(let F=0,at=ct.length;F<at;F++){const gt=rt[ct.charCodeAt(F)];C.push(gt?String.fromCharCode(gt):ct.charAt(F))}return C.join("")}function it(ct){return decodeURIComponent(escape(ct))}function ut(ct){return unescape(encodeURIComponent(ct))}function ft(ct){return typeof ct=="object"&&(ct==null?void 0:ct.byteLength)!==void 0}function Et(ct,C){if(ct.length!==C.length)return!1;for(let F=0,at=ct.length;F<at;F++)if(ct[F]!==C[F])return!1;return!0}function _t(ct=new Date){return[ct.getUTCFullYear().toString(),(ct.getUTCMonth()+1).toString().padStart(2,"0"),ct.getUTCDate().toString().padStart(2,"0"),ct.getUTCHours().toString().padStart(2,"0"),ct.getUTCMinutes().toString().padStart(2,"0"),ct.getUTCSeconds().toString().padStart(2,"0")].join("")}class Ct{constructor(){K(this,Rt,!1);this.promise=new Promise((C,F)=>{this.resolve=at=>{pt(this,Rt,!0),C(at)},this.reject=at=>{pt(this,Rt,!0),F(at)}})}get settled(){return u(this,Rt)}}Rt=new WeakMap,m.PromiseCapability=Ct;let G=null,bt=null;function yt(ct){return G||(G=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,bt=new Map([["ﬅ","ſt"]])),ct.replaceAll(G,(C,F,at)=>F?F.normalize("NFKC"):bt.get(at))}},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var Q,Y,b,k,Kt,z,re,W,L,v,N,w,x,p,d,ue,A,y,fe,g,t;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_is_node=__w_pdfjs_require__(10),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_xfa_text=__w_pdfjs_require__(19);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultFilterFactory=_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:o,NodeCMapReaderFactory:s,NodeFilterFactory:c,NodeStandardFontDataFactory:P}=__w_pdfjs_require__(20);exports.DefaultCanvasFactory=DefaultCanvasFactory=o,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=s,exports.DefaultFilterFactory=DefaultFilterFactory=c,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=P}let createPDFNetworkStream;if(_is_node.isNodeJS){const{PDFNodeStream:o}=__w_pdfjs_require__(21);createPDFNetworkStream=s=>new o(s)}else{const{PDFNetworkStream:o}=__w_pdfjs_require__(24),{PDFFetchStream:s}=__w_pdfjs_require__(25);createPDFNetworkStream=c=>(0,_display_utils.isValidFetchUrl)(c.url)?new s(c):new o(c)}function getDocument(o){if(typeof o=="string"||o instanceof URL?o={url:o}:(0,_util.isArrayBuffer)(o)&&(o={data:o}),typeof o!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!o.url&&!o.data&&!o.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const s=new PDFDocumentLoadingTask,{docId:c}=s,P=o.url?getUrlProp(o.url):null,i=o.data?getDataProp(o.data):null,I=o.httpHeaders||null,q=o.withCredentials===!0,$=o.password??null,J=o.range instanceof PDFDataRangeTransport?o.range:null,st=Number.isInteger(o.rangeChunkSize)&&o.rangeChunkSize>0?o.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let dt=o.worker instanceof PDFWorker?o.worker:null;const lt=o.verbosity,ht=typeof o.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(o.docBaseUrl)?o.docBaseUrl:null,mt=typeof o.cMapUrl=="string"?o.cMapUrl:null,vt=o.cMapPacked!==!1,St=o.CMapReaderFactory||DefaultCMapReaderFactory,At=typeof o.standardFontDataUrl=="string"?o.standardFontDataUrl:null,U=o.StandardFontDataFactory||DefaultStandardFontDataFactory,l=o.stopAtErrors!==!0,h=Number.isInteger(o.maxImageSize)&&o.maxImageSize>-1?o.maxImageSize:-1,S=o.isEvalSupported!==!1,j=typeof o.isOffscreenCanvasSupported=="boolean"?o.isOffscreenCanvasSupported:!_is_node.isNodeJS,D=Number.isInteger(o.canvasMaxAreaInBytes)?o.canvasMaxAreaInBytes:-1,H=typeof o.disableFontFace=="boolean"?o.disableFontFace:_is_node.isNodeJS,O=o.fontExtraProperties===!0,R=o.enableXfa===!0,M=o.ownerDocument||globalThis.document,e=o.disableRange===!0,n=o.disableStream===!0,f=o.disableAutoFetch===!0,_=o.pdfBug===!0,E=J?J.length:o.length??NaN,B=typeof o.useSystemFonts=="boolean"?o.useSystemFonts:!_is_node.isNodeJS&&!H,et=typeof o.useWorkerFetch=="boolean"?o.useWorkerFetch:St===_display_utils.DOMCMapReaderFactory&&U===_display_utils.DOMStandardFontDataFactory&&(0,_display_utils.isValidFetchUrl)(mt,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(At,document.baseURI),V=o.canvasFactory||new DefaultCanvasFactory({ownerDocument:M}),nt=o.filterFactory||new DefaultFilterFactory({docId:c,ownerDocument:M}),rt=null;(0,_util.setVerbosityLevel)(lt);const Z={canvasFactory:V,filterFactory:nt};if(et||(Z.cMapReaderFactory=new St({baseUrl:mt,isCompressed:vt}),Z.standardFontDataFactory=new U({baseUrl:At})),!dt){const ft={verbosity:lt,port:_worker_options.GlobalWorkerOptions.workerPort};dt=ft.port?PDFWorker.fromPort(ft):new PDFWorker(ft),s._worker=dt}const it={docId:c,apiVersion:"3.6.172",data:i,password:$,disableAutoFetch:f,rangeChunkSize:st,length:E,docBaseUrl:ht,enableXfa:R,evaluatorOptions:{maxImageSize:h,disableFontFace:H,ignoreErrors:l,isEvalSupported:S,isOffscreenCanvasSupported:j,canvasMaxAreaInBytes:D,fontExtraProperties:O,useSystemFonts:B,cMapUrl:et?mt:null,standardFontDataUrl:et?At:null}},ut={ignoreErrors:l,isEvalSupported:S,disableFontFace:H,fontExtraProperties:O,enableXfa:R,ownerDocument:M,disableAutoFetch:f,pdfBug:_,styleElement:rt};return dt.promise.then(function(){if(s.destroyed)throw new Error("Loading aborted");const ft=_fetchDocument(dt,it),Et=new Promise(function(_t){let Ct;J?Ct=new _transport_stream.PDFDataTransportStream({length:E,initialData:J.initialData,progressiveDone:J.progressiveDone,contentDispositionFilename:J.contentDispositionFilename,disableRange:e,disableStream:n},J):i||(Ct=createPDFNetworkStream({url:P,length:E,httpHeaders:I,withCredentials:q,rangeChunkSize:st,disableRange:e,disableStream:n})),_t(Ct)});return Promise.all([ft,Et]).then(function([_t,Ct]){if(s.destroyed)throw new Error("Loading aborted");const G=new _message_handler.MessageHandler(c,_t,dt.port),bt=new WorkerTransport(G,s,Ct,ut,Z);s._transport=bt,G.send("Ready",null)})}).catch(s._capability.reject),s}async function _fetchDocument(o,s){if(o.destroyed)throw new Error("Worker was destroyed");const c=await o.messageHandler.sendWithPromise("GetDocRequest",s,s.data?[s.data.buffer]:null);if(o.destroyed)throw new Error("Worker was destroyed");return c}function getUrlProp(o){if(o instanceof URL)return o.href;try{return new URL(o,window.location).href}catch{if(_is_node.isNodeJS&&typeof o=="string")return o}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(o){if(_is_node.isNodeJS&&typeof Buffer<"u"&&o instanceof Buffer)return(0,_display_utils.deprecated)("Please provide binary data as `Uint8Array`, rather than `Buffer`."),new Uint8Array(o);if(o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength)return o;if(typeof o=="string")return(0,_util.stringToBytes)(o);if(typeof o=="object"&&!isNaN(o==null?void 0:o.length)||(0,_util.isArrayBuffer)(o))return new Uint8Array(o);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const m=class m{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${ie(m,Q)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var s;this.destroyed=!0,await((s=this._transport)==null?void 0:s.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};Q=new WeakMap,K(m,Q,0);let PDFDocumentLoadingTask=m;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(s,c,P=!1,i=null){this.length=s,this.initialData=c,this.progressiveDone=P,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(s){this._rangeListeners.push(s)}addProgressListener(s){this._progressListeners.push(s)}addProgressiveReadListener(s){this._progressiveReadListeners.push(s)}addProgressiveDoneListener(s){this._progressiveDoneListeners.push(s)}onDataRange(s,c){for(const P of this._rangeListeners)P(s,c)}onDataProgress(s,c){this._readyCapability.promise.then(()=>{for(const P of this._progressListeners)P(s,c)})}onDataProgressiveRead(s){this._readyCapability.promise.then(()=>{for(const c of this._progressiveReadListeners)c(s)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const s of this._progressiveDoneListeners)s()})}transportReady(){this._readyCapability.resolve()}requestDataRange(s,c){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(s,c){this._pdfInfo=s,this._transport=c}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(s){return this._transport.getPage(s)}getPageIndex(s){return this._transport.getPageIndex(s)}getDestinations(){return this._transport.getDestinations()}getDestination(s){return this._transport.getDestination(s)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(s=!1){return this._transport.startCleanup(s||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(s,c,P,i=!1){K(this,k);K(this,z);K(this,Y,null);K(this,b,!1);this._pageIndex=s,this._pageInfo=c,this._transport=P,this._stats=i?new _display_utils.StatTimer:null,this._pdfBug=i,this.commonObjs=P.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:s,rotation:c=this.rotate,offsetX:P=0,offsetY:i=0,dontFlip:I=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:s,rotation:c,offsetX:P,offsetY:i,dontFlip:I})}getAnnotations({intent:s="display"}={}){const c=this._transport.getRenderingIntent(s);return this._transport.getAnnotations(this._pageIndex,c.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var s;return((s=this._transport._htmlForXfa)==null?void 0:s.children[this._pageIndex])||null}render({canvasContext:s,viewport:c,intent:P="display",annotationMode:i=_util.AnnotationMode.ENABLE,transform:I=null,background:q=null,optionalContentConfigPromise:$=null,annotationCanvasMap:J=null,pageColors:st=null,printAnnotationStorage:dt=null}){var U,l,h;if((U=arguments[0])!=null&&U.canvasFactory)throw new Error("render no longer accepts the `canvasFactory`-option, please pass it to the `getDocument`-function instead.");(l=this._stats)==null||l.time("Overall");const lt=this._transport.getRenderingIntent(P,i,dt);pt(this,b,!1),tt(this,z,re).call(this),$||($=this._transport.getOptionalContentConfig());let ht=this._intentStates.get(lt.cacheKey);ht||(ht=Object.create(null),this._intentStates.set(lt.cacheKey,ht)),ht.streamReaderCancelTimeout&&(clearTimeout(ht.streamReaderCancelTimeout),ht.streamReaderCancelTimeout=null);const mt=!!(lt.renderingIntent&_util.RenderingIntentFlag.PRINT);ht.displayReadyCapability||(ht.displayReadyCapability=new _util.PromiseCapability,ht.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(h=this._stats)==null||h.time("Page Request"),this._pumpOperatorList(lt));const vt=S=>{var j,D;ht.renderTasks.delete(St),(this._maybeCleanupAfterRender||mt)&&pt(this,b,!0),tt(this,k,Kt).call(this,!mt),S?(St.capability.reject(S),this._abortOperatorList({intentState:ht,reason:S instanceof Error?S:new Error(S)})):St.capability.resolve(),(j=this._stats)==null||j.timeEnd("Rendering"),(D=this._stats)==null||D.timeEnd("Overall")},St=new InternalRenderTask({callback:vt,params:{canvasContext:s,viewport:c,transform:I,background:q},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:J,operatorList:ht.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!mt,pdfBug:this._pdfBug,pageColors:st});(ht.renderTasks||(ht.renderTasks=new Set)).add(St);const At=St.task;return Promise.all([ht.displayReadyCapability.promise,$]).then(([S,j])=>{var D;if(u(this,b)){vt();return}(D=this._stats)==null||D.time("Rendering"),St.initializeGraphics({transparency:S,optionalContentConfig:j}),St.operatorListChanged()}).catch(vt),At}getOperatorList({intent:s="display",annotationMode:c=_util.AnnotationMode.ENABLE,printAnnotationStorage:P=null}={}){var J;function i(){q.operatorList.lastChunk&&(q.opListReadCapability.resolve(q.operatorList),q.renderTasks.delete($))}const I=this._transport.getRenderingIntent(s,c,P,!0);let q=this._intentStates.get(I.cacheKey);q||(q=Object.create(null),this._intentStates.set(I.cacheKey,q));let $;return q.opListReadCapability||($=Object.create(null),$.operatorListChanged=i,q.opListReadCapability=new _util.PromiseCapability,(q.renderTasks||(q.renderTasks=new Set)).add($),q.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(J=this._stats)==null||J.time("Page Request"),this._pumpOperatorList(I)),q.opListReadCapability.promise}streamTextContent({includeMarkedContent:s=!1,disableNormalization:c=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:s===!0,disableNormalization:c===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(s={}){if(this._transport._htmlForXfa)return this.getXfa().then(P=>_xfa_text.XfaText.textContent(P));const c=this.streamTextContent(s);return new Promise(function(P,i){function I(){q.read().then(function({value:J,done:st}){if(st){P($);return}Object.assign($.styles,J.styles),$.items.push(...J.items),I()},i)}const q=c.getReader(),$={items:[],styles:Object.create(null)};I()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const s=[];for(const c of this._intentStates.values())if(this._abortOperatorList({intentState:c,reason:new Error("Page was destroyed."),force:!0}),!c.opListReadCapability)for(const P of c.renderTasks)s.push(P.completed),P.cancel();return this.objs.clear(),pt(this,b,!1),tt(this,z,re).call(this),Promise.all(s)}cleanup(s=!1){pt(this,b,!0);const c=tt(this,k,Kt).call(this,!1);return s&&c&&this._stats&&(this._stats=new _display_utils.StatTimer),c}_startRenderPage(s,c){var i,I;const P=this._intentStates.get(c);P&&((i=this._stats)==null||i.timeEnd("Page Request"),(I=P.displayReadyCapability)==null||I.resolve(s))}_renderPageChunk(s,c){for(let P=0,i=s.length;P<i;P++)c.operatorList.fnArray.push(s.fnArray[P]),c.operatorList.argsArray.push(s.argsArray[P]);c.operatorList.lastChunk=s.lastChunk,c.operatorList.separateAnnots=s.separateAnnots;for(const P of c.renderTasks)P.operatorListChanged();s.lastChunk&&tt(this,k,Kt).call(this,!0)}_pumpOperatorList({renderingIntent:s,cacheKey:c,annotationStorageMap:P}){const I=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:s,cacheKey:c,annotationStorage:P}).getReader(),q=this._intentStates.get(c);q.streamReader=I;const $=()=>{I.read().then(({value:J,done:st})=>{if(st){q.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(J,q),$())},J=>{if(q.streamReader=null,!this._transport.destroyed){if(q.operatorList){q.operatorList.lastChunk=!0;for(const st of q.renderTasks)st.operatorListChanged();tt(this,k,Kt).call(this,!0)}if(q.displayReadyCapability)q.displayReadyCapability.reject(J);else if(q.opListReadCapability)q.opListReadCapability.reject(J);else throw J}})};$()}_abortOperatorList({intentState:s,reason:c,force:P=!1}){if(s.streamReader){if(s.streamReaderCancelTimeout&&(clearTimeout(s.streamReaderCancelTimeout),s.streamReaderCancelTimeout=null),!P){if(s.renderTasks.size>0)return;if(c instanceof _display_utils.RenderingCancelledException){let i=RENDERING_CANCELLED_TIMEOUT;c.extraDelay>0&&c.extraDelay<1e3&&(i+=c.extraDelay),s.streamReaderCancelTimeout=setTimeout(()=>{s.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:s,reason:c,force:!0})},i);return}}if(s.streamReader.cancel(new _util.AbortException(c.message)).catch(()=>{}),s.streamReader=null,!this._transport.destroyed){for(const[i,I]of this._intentStates)if(I===s){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}Y=new WeakMap,b=new WeakMap,k=new WeakSet,Kt=function(s=!1){if(tt(this,z,re).call(this),!u(this,b))return!1;if(s)return pt(this,Y,setTimeout(()=>{pt(this,Y,null),tt(this,k,Kt).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:c,operatorList:P}of this._intentStates.values())if(c.size>0||!P.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),pt(this,b,!1),!0},z=new WeakSet,re=function(){u(this,Y)&&(clearTimeout(u(this,Y)),pt(this,Y,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){K(this,W,new Set);K(this,L,Promise.resolve())}postMessage(s,c){const P={data:structuredClone(s,c?{transfer:c}:null)};u(this,L).then(()=>{for(const i of u(this,W))i.call(this,P)})}addEventListener(s,c){u(this,W).add(c)}removeEventListener(s,c){u(this,W).delete(c)}terminate(){u(this,W).clear()}}W=new WeakMap,L=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const o=(v=document==null?void 0:document.currentScript)==null?void 0:v.src;o&&(PDFWorkerUtil.fallbackWorkerSrc=o.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(o,s){let c;try{if(c=new URL(o),!c.origin||c.origin==="null")return!1}catch{return!1}const P=new URL(s,c);return c.origin===P.origin},PDFWorkerUtil.createCDNWrapper=function(o){const s=`importScripts("${o}");`;return URL.createObjectURL(new Blob([s]))}}const _PDFWorker=class _PDFWorker{constructor({name:o=null,port:s=null,verbosity:c=(0,_util.getVerbosityLevel)()}={}){if(s&&u(_PDFWorker,N).has(s))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=o,this.destroyed=!1,this.verbosity=c,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,s){u(_PDFWorker,N).set(s,this),this._initializeFromPort(s);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(o){this._port=o,this._messageHandler=new _message_handler.MessageHandler("main","worker",o),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:o}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,o)||(o=PDFWorkerUtil.createCDNWrapper(new URL(o,window.location).href));const s=new Worker(o),c=new _message_handler.MessageHandler("main","worker",s),P=()=>{s.removeEventListener("error",i),c.destroy(),s.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},i=()=>{this._webWorker||P()};s.addEventListener("error",i),c.on("test",q=>{if(s.removeEventListener("error",i),this.destroyed){P();return}q?(this._messageHandler=c,this._port=s,this._webWorker=s,this._readyCapability.resolve(),c.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),c.destroy(),s.terminate())}),c.on("ready",q=>{if(s.removeEventListener("error",i),this.destroyed){P();return}try{I()}catch{this._setupFakeWorker()}});const I=()=>{const q=new Uint8Array;c.send("test",q,[q.buffer])};I();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(o=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const s=new LoopbackPort;this._port=s;const c=`fake${PDFWorkerUtil.fakeWorkerId++}`,P=new _message_handler.MessageHandler(c+"_worker",c,s);o.setup(P,s);const i=new _message_handler.MessageHandler(c,c+"_worker",s);this._messageHandler=i,this._readyCapability.resolve(),i.send("configure",{verbosity:this.verbosity})}).catch(o=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${o.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),u(_PDFWorker,N).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(o){if(!(o!=null&&o.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return u(this,N).has(o.port)?u(this,N).get(o.port):new _PDFWorker(o)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var o;try{return((o=globalThis.pdfjsWorker)==null?void 0:o.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};N=new WeakMap,K(_PDFWorker,N,new WeakMap);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(s,c,P,i,I){K(this,d);K(this,w,new Map);K(this,x,new Map);K(this,p,new Map);this.messageHandler=s,this.loadingTask=c,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this._params=i,this.canvasFactory=I.canvasFactory,this.filterFactory=I.filterFactory,this.cMapReaderFactory=I.cMapReaderFactory,this.standardFontDataFactory=I.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=P,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(s,c=_util.AnnotationMode.ENABLE,P=null,i=!1){let I=_util.RenderingIntentFlag.DISPLAY,q=null;switch(s){case"any":I=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":I=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${s}`)}switch(c){case _util.AnnotationMode.DISABLE:I+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:I+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:I+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,q=(I&_util.RenderingIntentFlag.PRINT&&P instanceof _annotation_storage.PrintAnnotationStorage?P:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${c}`)}return i&&(I+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:I,cacheKey:`${I}_${_annotation_storage.AnnotationStorage.getHash(q)}`,annotationStorageMap:q}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const s=[];for(const P of u(this,x).values())s.push(P._destroy());u(this,x).clear(),u(this,p).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const c=this.messageHandler.sendWithPromise("Terminate",null);return s.push(c),Promise.all(s).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),u(this,w).clear(),this.filterFactory.destroy(),this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:s,loadingTask:c}=this;s.on("GetReader",(P,i)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=I=>{this._lastProgress={loaded:I.loaded,total:I.total}},i.onPull=()=>{this._fullReader.read().then(function({value:I,done:q}){if(q){i.close();return}(0,_util.assert)(I instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(I),1,[I])}).catch(I=>{i.error(I)})},i.onCancel=I=>{this._fullReader.cancel(I),i.ready.catch(q=>{if(!this.destroyed)throw q})}}),s.on("ReaderHeadersReady",P=>{const i=new _util.PromiseCapability,I=this._fullReader;return I.headersReady.then(()=>{var q;(!I.isStreamingSupported||!I.isRangeSupported)&&(this._lastProgress&&((q=c.onProgress)==null||q.call(c,this._lastProgress)),I.onProgress=$=>{var J;(J=c.onProgress)==null||J.call(c,{loaded:$.loaded,total:$.total})}),i.resolve({isStreamingSupported:I.isStreamingSupported,isRangeSupported:I.isRangeSupported,contentLength:I.contentLength})},i.reject),i.promise}),s.on("GetRangeReader",(P,i)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const I=this._networkStream.getRangeReader(P.begin,P.end);if(!I){i.close();return}i.onPull=()=>{I.read().then(function({value:q,done:$}){if($){i.close();return}(0,_util.assert)(q instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(q),1,[q])}).catch(q=>{i.error(q)})},i.onCancel=q=>{I.cancel(q),i.ready.catch($=>{if(!this.destroyed)throw $})}}),s.on("GetDoc",({pdfInfo:P})=>{this._numPages=P.numPages,this._htmlForXfa=P.htmlForXfa,delete P.htmlForXfa,c._capability.resolve(new PDFDocumentProxy(P,this))}),s.on("DocException",function(P){let i;switch(P.name){case"PasswordException":i=new _util.PasswordException(P.message,P.code);break;case"InvalidPDFException":i=new _util.InvalidPDFException(P.message);break;case"MissingPDFException":i=new _util.MissingPDFException(P.message);break;case"UnexpectedResponseException":i=new _util.UnexpectedResponseException(P.message,P.status);break;case"UnknownErrorException":i=new _util.UnknownErrorException(P.message,P.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}c._capability.reject(i)}),s.on("PasswordRequest",P=>{if(this._passwordCapability=new _util.PromiseCapability,c.onPassword){const i=I=>{I instanceof Error?this._passwordCapability.reject(I):this._passwordCapability.resolve({password:I})};try{c.onPassword(i,P.code)}catch(I){this._passwordCapability.reject(I)}}else this._passwordCapability.reject(new _util.PasswordException(P.message,P.code));return this._passwordCapability.promise}),s.on("DataLoaded",P=>{var i;(i=c.onProgress)==null||i.call(c,{loaded:P.length,total:P.length}),this.downloadInfoCapability.resolve(P)}),s.on("StartRenderPage",P=>{if(this.destroyed)return;u(this,x).get(P.pageIndex)._startRenderPage(P.transparency,P.cacheKey)}),s.on("commonobj",([P,i,I])=>{var q;if(!this.destroyed&&!this.commonObjs.has(P))switch(i){case"Font":const $=this._params;if("error"in I){const dt=I.error;(0,_util.warn)(`Error during font loading: ${dt}`),this.commonObjs.resolve(P,dt);break}const J=$.pdfBug&&((q=globalThis.FontInspector)!=null&&q.enabled)?(dt,lt)=>globalThis.FontInspector.fontAdded(dt,lt):null,st=new _font_loader.FontFaceObject(I,{isEvalSupported:$.isEvalSupported,disableFontFace:$.disableFontFace,ignoreErrors:$.ignoreErrors,inspectFont:J});this.fontLoader.bind(st).catch(dt=>s.sendWithPromise("FontFallback",{id:P})).finally(()=>{!$.fontExtraProperties&&st.data&&(st.data=null),this.commonObjs.resolve(P,st)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(P,I);break;default:throw new Error(`Got unknown common object type ${i}`)}}),s.on("obj",([P,i,I,q])=>{var J;if(this.destroyed)return;const $=u(this,x).get(i);if(!$.objs.has(P))switch(I){case"Image":if($.objs.resolve(P,q),q){let st;if(q.bitmap){const{width:dt,height:lt}=q;st=dt*lt*4}else st=((J=q.data)==null?void 0:J.length)||0;st>_util.MAX_IMAGE_SIZE_TO_CACHE&&($._maybeCleanupAfterRender=!0)}break;case"Pattern":$.objs.resolve(P,q);break;default:throw new Error(`Got unknown object type ${I}`)}}),s.on("DocProgress",P=>{var i;this.destroyed||(i=c.onProgress)==null||i.call(c,{loaded:P.loaded,total:P.total})}),s.on("FetchBuiltInCMap",P=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(P):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),s.on("FetchStandardFontData",P=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(P):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var s;return this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:((s=this._fullReader)==null?void 0:s.filename)??null}).finally(()=>{this.annotationStorage.resetModified()})}getPage(s){if(!Number.isInteger(s)||s<=0||s>this._numPages)return Promise.reject(new Error("Invalid page request."));const c=s-1,P=u(this,p).get(c);if(P)return P;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:c}).then(I=>{if(this.destroyed)throw new Error("Transport destroyed");const q=new PDFPageProxy(c,I,this,this._params.pdfBug);return u(this,x).set(c,q),q});return u(this,p).set(c,i),i}getPageIndex(s){return typeof s!="object"||s===null||!Number.isInteger(s.num)||s.num<0||!Number.isInteger(s.gen)||s.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:s.num,gen:s.gen})}getAnnotations(s,c){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:s,intent:c})}getFieldObjects(){return tt(this,d,ue).call(this,"GetFieldObjects")}hasJSActions(){return tt(this,d,ue).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(s){return typeof s!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:s})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(s){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:s})}getStructTree(s){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:s})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(s=>new _optional_content_config.OptionalContentConfig(s))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const s="GetMetadata",c=u(this,w).get(s);if(c)return c;const P=this.messageHandler.sendWithPromise(s,null).then(i=>{var I,q;return{info:i[0],metadata:i[1]?new _metadata.Metadata(i[1]):null,contentDispositionFilename:((I=this._fullReader)==null?void 0:I.filename)??null,contentLength:((q=this._fullReader)==null?void 0:q.contentLength)??null}});return u(this,w).set(s,P),P}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(s=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const c of u(this,x).values())if(!c.cleanup())throw new Error(`startCleanup: Page ${c.pageNumber} is currently rendering.`);this.commonObjs.clear(),s||this.fontLoader.clear(),u(this,w).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:s,enableXfa:c}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:s,enableXfa:c})}}w=new WeakMap,x=new WeakMap,p=new WeakMap,d=new WeakSet,ue=function(s,c=null){const P=u(this,w).get(s);if(P)return P;const i=this.messageHandler.sendWithPromise(s,c);return u(this,w).set(s,i),i};class PDFObjects{constructor(){K(this,y);K(this,A,Object.create(null))}get(s,c=null){if(c){const i=tt(this,y,fe).call(this,s);return i.capability.promise.then(()=>c(i.data)),null}const P=u(this,A)[s];if(!(P!=null&&P.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${s}.`);return P.data}has(s){const c=u(this,A)[s];return(c==null?void 0:c.capability.settled)||!1}resolve(s,c=null){const P=tt(this,y,fe).call(this,s);P.data=c,P.capability.resolve()}clear(){var s;for(const c in u(this,A)){const{data:P}=u(this,A)[c];(s=P==null?void 0:P.bitmap)==null||s.close()}pt(this,A,Object.create(null))}}A=new WeakMap,y=new WeakSet,fe=function(s){const c=u(this,A)[s];return c||(u(this,A)[s]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(s){K(this,g,null);pt(this,g,s),this.onContinue=null}get promise(){return u(this,g).capability.promise}cancel(s=0){u(this,g).cancel(null,s)}get separateAnnots(){const{separateAnnots:s}=u(this,g).operatorList;if(!s)return!1;const{annotationCanvasMap:c}=u(this,g);return s.form||s.canvas&&(c==null?void 0:c.size)>0}}g=new WeakMap,exports.RenderTask=RenderTask;const a=class a{constructor({callback:s,params:c,objs:P,commonObjs:i,annotationCanvasMap:I,operatorList:q,pageIndex:$,canvasFactory:J,filterFactory:st,useRequestAnimationFrame:dt=!1,pdfBug:lt=!1,pageColors:ht=null}){this.callback=s,this.params=c,this.objs=P,this.commonObjs=i,this.annotationCanvasMap=I,this.operatorListIdx=null,this.operatorList=q,this._pageIndex=$,this.canvasFactory=J,this.filterFactory=st,this._pdfBug=lt,this.pageColors=ht,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=dt===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=c.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:s=!1,optionalContentConfig:c}){var $,J;if(this.cancelled)return;if(this._canvas){if(u(a,t).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");u(a,t).add(this._canvas)}this._pdfBug&&(($=globalThis.StepperManager)!=null&&$.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:P,viewport:i,transform:I,background:q}=this.params;this.gfx=new _canvas.CanvasGraphics(P,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:c},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:I,viewport:i,transparency:s,background:q}),this.operatorListIdx=0,this.graphicsReady=!0,(J=this.graphicsReadyCallback)==null||J.call(this)}cancel(s=null,c=0){var P;this.running=!1,this.cancelled=!0,(P=this.gfx)==null||P.endDrawing(),this._canvas&&u(a,t).delete(this._canvas),this.callback(s||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas",c))}operatorListChanged(){var s;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(s=this.stepper)==null||s.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(this.pageColors),this._canvas&&u(a,t).delete(this._canvas),this.callback())))}};t=new WeakMap,K(a,t,new WeakSet);let InternalRenderTask=a;const version="3.6.172";exports.version=version;const build="4d3dfe254";exports.build=build},(Q,m,Y)=>{var W,L,v,De,w;Object.defineProperty(m,"__esModule",{value:!0}),m.PrintAnnotationStorage=m.AnnotationStorage=void 0;var b=Y(1),k=Y(4),X=Y(8);class z{constructor(){K(this,v);K(this,W,!1);K(this,L,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(p,d){const r=u(this,L).get(p);return r===void 0?d:Object.assign(d,r)}getRawValue(p){return u(this,L).get(p)}remove(p){if(u(this,L).delete(p),u(this,L).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const d of u(this,L).values())if(d instanceof k.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(p,d){const r=u(this,L).get(p);let A=!1;if(r!==void 0)for(const[y,T]of Object.entries(d))r[y]!==T&&(A=!0,r[y]=T);else A=!0,u(this,L).set(p,d);A&&tt(this,v,De).call(this),d instanceof k.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(d.constructor._type)}has(p){return u(this,L).has(p)}getAll(){return u(this,L).size>0?(0,b.objectFromMap)(u(this,L)):null}setAll(p){for(const[d,r]of Object.entries(p))this.setValue(d,r)}get size(){return u(this,L).size}resetModified(){u(this,W)&&(pt(this,W,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new ot(this)}get serializable(){if(u(this,L).size===0)return null;const p=new Map;for(const[d,r]of u(this,L)){const A=r instanceof k.AnnotationEditor?r.serialize():r;A&&p.set(d,A)}return p}static getHash(p){if(!p)return"";const d=new X.MurmurHash3_64;for(const[r,A]of p)d.update(`${r}:${JSON.stringify(A)}`);return d.hexdigest()}}W=new WeakMap,L=new WeakMap,v=new WeakSet,De=function(){u(this,W)||(pt(this,W,!0),typeof this.onSetModified=="function"&&this.onSetModified())},m.AnnotationStorage=z;class ot extends z{constructor(d){super();K(this,w,null);pt(this,w,structuredClone(d.serializable))}get print(){(0,b.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return u(this,w)}}w=new WeakMap,m.PrintAnnotationStorage=ot},(Q,m,Y)=>{var z,ot,W,L,v,N;Object.defineProperty(m,"__esModule",{value:!0}),m.AnnotationEditor=void 0;var b=Y(5),k=Y(1);const w=class w{constructor(p){K(this,z,this.focusin.bind(this));K(this,ot,this.focusout.bind(this));K(this,W,!1);K(this,L,!1);K(this,v,!1);Dt(this,"_uiManager",null);K(this,N,w._zIndex++);this.constructor===w&&(0,k.unreachable)("Cannot initialize AnnotationEditor."),this.parent=p.parent,this.id=p.id,this.width=this.height=null,this.pageIndex=p.parent.pageIndex,this.name=p.name,this.div=null,this._uiManager=p.uiManager;const{rotation:d,rawDims:{pageWidth:r,pageHeight:A,pageX:y,pageY:T}}=this.parent.viewport;this.rotation=d,this.pageRotation=(360+d-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[r,A],this.pageTranslation=[y,T];const[g,t]=this.parentDimensions;this.x=p.x/g,this.y=p.y/t,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,k.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}addCommands(p){this._uiManager.addCommands(p)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=u(this,N)}setParent(p){p!==null&&(this.pageIndex=p.pageIndex,this.pageDimensions=p.pageDimensions),this.parent=p}focusin(p){u(this,W)?pt(this,W,!1):this.parent.setSelected(this)}focusout(p){var r;if(!this.isAttachedToDOM)return;const d=p.relatedTarget;d!=null&&d.closest(`#${this.id}`)||(p.preventDefault(),(r=this.parent)!=null&&r.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}dragstart(p){const d=this.parent.div.getBoundingClientRect();this.startX=p.clientX-d.x,this.startY=p.clientY-d.y,p.dataTransfer.setData("text/plain",this.id),p.dataTransfer.effectAllowed="move"}setAt(p,d,r,A){const[y,T]=this.parentDimensions;[r,A]=this.screenToPageTranslation(r,A),this.x=(p+r)/y,this.y=(d+A)/T,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(p,d){const[r,A]=this.parentDimensions;[p,d]=this.screenToPageTranslation(p,d),this.x+=p/r,this.y+=d/A,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(p,d){switch(this.parentRotation){case 90:return[d,-p];case 180:return[-p,-d];case 270:return[-d,p];default:return[p,d]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{realScale:p}=this._uiManager.viewParameters,[d,r]=this.pageDimensions;return[d*p,r*p]}setDims(p,d){const[r,A]=this.parentDimensions;this.div.style.width=`${100*p/r}%`,this.div.style.height=`${100*d/A}%`}fixDims(){const{style:p}=this.div,{height:d,width:r}=p,A=r.endsWith("%"),y=d.endsWith("%");if(A&&y)return;const[T,g]=this.parentDimensions;A||(p.width=`${100*parseFloat(r)/T}%`),y||(p.height=`${100*parseFloat(d)/g}%`)}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",u(this,z)),this.div.addEventListener("focusout",u(this,ot));const[p,d]=this.getInitialTranslation();return this.translate(p,d),(0,b.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(p){const{isMac:d}=k.FeatureTest.platform;if(p.button!==0||p.ctrlKey&&d){p.preventDefault();return}p.ctrlKey&&!d||p.shiftKey||p.metaKey&&d?this.parent.toggleSelected(this):this.parent.setSelected(this),pt(this,W,!0)}getRect(p,d){const r=this.parentScale,[A,y]=this.pageDimensions,[T,g]=this.pageTranslation,t=p/r,a=d/r,o=this.x*A,s=this.y*y,c=this.width*A,P=this.height*y;switch(this.rotation){case 0:return[o+t+T,y-s-a-P+g,o+t+c+T,y-s-a+g];case 90:return[o+a+T,y-s+t+g,o+a+P+T,y-s+t+c+g];case 180:return[o-t-c+T,y-s+a+g,o-t+T,y-s+a+P+g];case 270:return[o-a-P+T,y-s-t-c+g,o-a+T,y-s-t+g];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(p,d){const[r,A,y,T]=p,g=y-r,t=T-A;switch(this.rotation){case 0:return[r,d-T,g,t];case 90:return[r,d-A,t,g];case 180:return[y,d-A,g,t];case 270:return[y,d-T,t,g];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){pt(this,v,!0)}disableEditMode(){pt(this,v,!1)}isInEditMode(){return u(this,v)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var p;(p=this.div)==null||p.addEventListener("focusin",u(this,z))}serialize(){(0,k.unreachable)("An editor must be serializable")}static deserialize(p,d,r){const A=new this.prototype.constructor({parent:d,id:d.getNextId(),uiManager:r});A.rotation=p.rotation;const[y,T]=A.pageDimensions,[g,t,a,o]=A.getRectInCurrentCoords(p.rect,T);return A.x=g/y,A.y=t/T,A.width=a/y,A.height=o/T,A}remove(){this.div.removeEventListener("focusin",u(this,z)),this.div.removeEventListener("focusout",u(this,ot)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var p;(p=this.div)==null||p.classList.add("selectedEditor")}unselect(){var p;(p=this.div)==null||p.classList.remove("selectedEditor")}updateParams(p,d){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return u(this,L)}set isEditing(p){pt(this,L,p),p?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};z=new WeakMap,ot=new WeakMap,W=new WeakMap,L=new WeakMap,v=new WeakMap,N=new WeakMap,Dt(w,"_colorManager",new b.ColorManager),Dt(w,"_zIndex",1);let X=w;m.AnnotationEditor=X},(Q,m,Y)=>{var w,x,p,d,r,A,Ie,g,t,a,o,s,c,P,i,I,q,$,J,st,dt,lt,ht,mt,vt,St,At,U,l,h,S,Le,D,pe,O,Ne,M,je,n,Ht,_,te,B,Be,V,Ue,rt,ge,it,ee,ft,me;Object.defineProperty(m,"__esModule",{value:!0}),m.KeyboardManager=m.CommandManager=m.ColorManager=m.AnnotationEditorUIManager=void 0,m.bindEvents=X,m.opacityToHex=z;var b=Y(1),k=Y(6);function X(Ct,G,bt){for(const yt of bt)G.addEventListener(yt,Ct[yt].bind(Ct))}function z(Ct){return Math.round(Math.min(255,Math.max(1,255*Ct))).toString(16).padStart(2,"0")}class ot{constructor(){K(this,w,0)}getId(){return`${b.AnnotationEditorPrefix}${ie(this,w)._++}`}}w=new WeakMap;class W{constructor(G=128){K(this,x,[]);K(this,p,!1);K(this,d,void 0);K(this,r,-1);pt(this,d,G)}add({cmd:G,undo:bt,mustExec:yt,type:Rt=NaN,overwriteIfSameType:ct=!1,keepUndo:C=!1}){if(yt&&G(),u(this,p))return;const F={cmd:G,undo:bt,type:Rt};if(u(this,r)===-1){u(this,x).length>0&&(u(this,x).length=0),pt(this,r,0),u(this,x).push(F);return}if(ct&&u(this,x)[u(this,r)].type===Rt){C&&(F.undo=u(this,x)[u(this,r)].undo),u(this,x)[u(this,r)]=F;return}const at=u(this,r)+1;at===u(this,d)?u(this,x).splice(0,1):(pt(this,r,at),at<u(this,x).length&&u(this,x).splice(at)),u(this,x).push(F)}undo(){u(this,r)!==-1&&(pt(this,p,!0),u(this,x)[u(this,r)].undo(),pt(this,p,!1),pt(this,r,u(this,r)-1))}redo(){u(this,r)<u(this,x).length-1&&(pt(this,r,u(this,r)+1),pt(this,p,!0),u(this,x)[u(this,r)].cmd(),pt(this,p,!1))}hasSomethingToUndo(){return u(this,r)!==-1}hasSomethingToRedo(){return u(this,r)<u(this,x).length-1}destroy(){pt(this,x,null)}}x=new WeakMap,p=new WeakMap,d=new WeakMap,r=new WeakMap,m.CommandManager=W;class L{constructor(G){K(this,A);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:bt}=b.FeatureTest.platform;for(const[yt,Rt]of G)for(const ct of yt){const C=ct.startsWith("mac+");bt&&C?(this.callbacks.set(ct.slice(4),Rt),this.allKeys.add(ct.split("+").at(-1))):!bt&&!C&&(this.callbacks.set(ct,Rt),this.allKeys.add(ct.split("+").at(-1)))}}exec(G,bt){if(!this.allKeys.has(bt.key))return;const yt=this.callbacks.get(tt(this,A,Ie).call(this,bt));yt&&(yt.bind(G)(),bt.stopPropagation(),bt.preventDefault())}}A=new WeakSet,Ie=function(G){G.altKey&&this.buffer.push("alt"),G.ctrlKey&&this.buffer.push("ctrl"),G.metaKey&&this.buffer.push("meta"),G.shiftKey&&this.buffer.push("shift"),this.buffer.push(G.key);const bt=this.buffer.join("+");return this.buffer.length=0,bt},m.KeyboardManager=L;const T=class T{get _colors(){const G=new Map([["CanvasText",null],["Canvas",null]]);return(0,k.getColorValues)(G),(0,b.shadow)(this,"_colors",G)}convert(G){const bt=(0,k.getRGB)(G);if(!window.matchMedia("(forced-colors: active)").matches)return bt;for(const[yt,Rt]of this._colors)if(Rt.every((ct,C)=>ct===bt[C]))return T._colorsMapping.get(yt);return bt}getHexCode(G){const bt=this._colors.get(G);return bt?b.Util.makeHexColor(...bt):G}};Dt(T,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let v=T;m.ColorManager=v;const _t=class _t{constructor(G,bt,yt){K(this,S);K(this,D);K(this,O);K(this,M);K(this,n);K(this,_);K(this,B);K(this,V);K(this,rt);K(this,it);K(this,ft);K(this,g,null);K(this,t,new Map);K(this,a,new Map);K(this,o,null);K(this,s,new W);K(this,c,0);K(this,P,null);K(this,i,new Set);K(this,I,null);K(this,q,new ot);K(this,$,!1);K(this,J,b.AnnotationEditorType.NONE);K(this,st,new Set);K(this,dt,this.copy.bind(this));K(this,lt,this.cut.bind(this));K(this,ht,this.paste.bind(this));K(this,mt,this.keydown.bind(this));K(this,vt,this.onEditingAction.bind(this));K(this,St,this.onPageChanging.bind(this));K(this,At,this.onScaleChanging.bind(this));K(this,U,this.onRotationChanging.bind(this));K(this,l,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});K(this,h,null);pt(this,h,G),pt(this,I,bt),u(this,I)._on("editingaction",u(this,vt)),u(this,I)._on("pagechanging",u(this,St)),u(this,I)._on("scalechanging",u(this,At)),u(this,I)._on("rotationchanging",u(this,U)),pt(this,o,yt),this.viewParameters={realScale:k.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){tt(this,D,pe).call(this),u(this,I)._off("editingaction",u(this,vt)),u(this,I)._off("pagechanging",u(this,St)),u(this,I)._off("scalechanging",u(this,At)),u(this,I)._off("rotationchanging",u(this,U));for(const G of u(this,a).values())G.destroy();u(this,a).clear(),u(this,t).clear(),u(this,i).clear(),pt(this,g,null),u(this,st).clear(),u(this,s).destroy()}onPageChanging({pageNumber:G}){pt(this,c,G-1)}focusMainContainer(){u(this,h).focus()}addShouldRescale(G){u(this,i).add(G)}removeShouldRescale(G){u(this,i).delete(G)}onScaleChanging({scale:G}){this.commitOrRemove(),this.viewParameters.realScale=G*k.PixelsPerInch.PDF_TO_CSS_UNITS;for(const bt of u(this,i))bt.onScaleChanging()}onRotationChanging({pagesRotation:G}){this.commitOrRemove(),this.viewParameters.rotation=G}addToAnnotationStorage(G){!G.isEmpty()&&u(this,o)&&!u(this,o).has(G.id)&&u(this,o).setValue(G.id,G)}copy(G){if(G.preventDefault(),u(this,g)&&u(this,g).commitOrRemove(),!this.hasSelection)return;const bt=[];for(const yt of u(this,st))yt.isEmpty()||bt.push(yt.serialize());bt.length!==0&&G.clipboardData.setData("application/pdfjs",JSON.stringify(bt))}cut(G){this.copy(G),this.delete()}paste(G){G.preventDefault();let bt=G.clipboardData.getData("application/pdfjs");if(!bt)return;try{bt=JSON.parse(bt)}catch(Rt){(0,b.warn)(`paste: "${Rt.message}".`);return}if(!Array.isArray(bt))return;this.unselectAll();const yt=u(this,a).get(u(this,c));try{const Rt=[];for(const F of bt){const at=yt.deserialize(F);if(!at)return;Rt.push(at)}const ct=()=>{for(const F of Rt)tt(this,rt,ge).call(this,F);tt(this,ft,me).call(this,Rt)},C=()=>{for(const F of Rt)F.remove()};this.addCommands({cmd:ct,undo:C,mustExec:!0})}catch(Rt){(0,b.warn)(`paste: "${Rt.message}".`)}}keydown(G){var bt;(bt=this.getActive())!=null&&bt.shouldGetKeyboardEvents()||_t._keyboardManager.exec(this,G)}onEditingAction(G){["undo","redo","delete","selectAll"].includes(G.name)&&this[G.name]()}setEditingState(G){G?(tt(this,S,Le).call(this),tt(this,O,Ne).call(this),tt(this,n,Ht).call(this,{isEditing:u(this,J)!==b.AnnotationEditorType.NONE,isEmpty:tt(this,it,ee).call(this),hasSomethingToUndo:u(this,s).hasSomethingToUndo(),hasSomethingToRedo:u(this,s).hasSomethingToRedo(),hasSelectedEditor:!1})):(tt(this,D,pe).call(this),tt(this,M,je).call(this),tt(this,n,Ht).call(this,{isEditing:!1}))}registerEditorTypes(G){if(!u(this,P)){pt(this,P,G);for(const bt of u(this,P))tt(this,_,te).call(this,bt.defaultPropertiesToUpdate)}}getId(){return u(this,q).getId()}get currentLayer(){return u(this,a).get(u(this,c))}get currentPageIndex(){return u(this,c)}addLayer(G){u(this,a).set(G.pageIndex,G),u(this,$)?G.enable():G.disable()}removeLayer(G){u(this,a).delete(G.pageIndex)}updateMode(G){if(pt(this,J,G),G===b.AnnotationEditorType.NONE)this.setEditingState(!1),tt(this,V,Ue).call(this);else{this.setEditingState(!0),tt(this,B,Be).call(this);for(const bt of u(this,a).values())bt.updateMode(G)}}updateToolbar(G){G!==u(this,J)&&u(this,I).dispatch("switchannotationeditormode",{source:this,mode:G})}updateParams(G,bt){if(u(this,P)){for(const yt of u(this,st))yt.updateParams(G,bt);for(const yt of u(this,P))yt.updateDefaultParams(G,bt)}}getEditors(G){const bt=[];for(const yt of u(this,t).values())yt.pageIndex===G&&bt.push(yt);return bt}getEditor(G){return u(this,t).get(G)}addEditor(G){u(this,t).set(G.id,G)}removeEditor(G){var bt;u(this,t).delete(G.id),this.unselect(G),(bt=u(this,o))==null||bt.remove(G.id)}setActiveEditor(G){u(this,g)!==G&&(pt(this,g,G),G&&tt(this,_,te).call(this,G.propertiesToUpdate))}toggleSelected(G){if(u(this,st).has(G)){u(this,st).delete(G),G.unselect(),tt(this,n,Ht).call(this,{hasSelectedEditor:this.hasSelection});return}u(this,st).add(G),G.select(),tt(this,_,te).call(this,G.propertiesToUpdate),tt(this,n,Ht).call(this,{hasSelectedEditor:!0})}setSelected(G){for(const bt of u(this,st))bt!==G&&bt.unselect();u(this,st).clear(),u(this,st).add(G),G.select(),tt(this,_,te).call(this,G.propertiesToUpdate),tt(this,n,Ht).call(this,{hasSelectedEditor:!0})}isSelected(G){return u(this,st).has(G)}unselect(G){G.unselect(),u(this,st).delete(G),tt(this,n,Ht).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return u(this,st).size!==0}undo(){u(this,s).undo(),tt(this,n,Ht).call(this,{hasSomethingToUndo:u(this,s).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:tt(this,it,ee).call(this)})}redo(){u(this,s).redo(),tt(this,n,Ht).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:u(this,s).hasSomethingToRedo(),isEmpty:tt(this,it,ee).call(this)})}addCommands(G){u(this,s).add(G),tt(this,n,Ht).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:tt(this,it,ee).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const G=[...u(this,st)],bt=()=>{for(const Rt of G)Rt.remove()},yt=()=>{for(const Rt of G)tt(this,rt,ge).call(this,Rt)};this.addCommands({cmd:bt,undo:yt,mustExec:!0})}commitOrRemove(){var G;(G=u(this,g))==null||G.commitOrRemove()}selectAll(){for(const G of u(this,st))G.commit();tt(this,ft,me).call(this,u(this,t).values())}unselectAll(){if(u(this,g)){u(this,g).commitOrRemove();return}if(u(this,st).size!==0){for(const G of u(this,st))G.unselect();u(this,st).clear(),tt(this,n,Ht).call(this,{hasSelectedEditor:!1})}}isActive(G){return u(this,g)===G}getActive(){return u(this,g)}getMode(){return u(this,J)}};g=new WeakMap,t=new WeakMap,a=new WeakMap,o=new WeakMap,s=new WeakMap,c=new WeakMap,P=new WeakMap,i=new WeakMap,I=new WeakMap,q=new WeakMap,$=new WeakMap,J=new WeakMap,st=new WeakMap,dt=new WeakMap,lt=new WeakMap,ht=new WeakMap,mt=new WeakMap,vt=new WeakMap,St=new WeakMap,At=new WeakMap,U=new WeakMap,l=new WeakMap,h=new WeakMap,S=new WeakSet,Le=function(){u(this,h).addEventListener("keydown",u(this,mt))},D=new WeakSet,pe=function(){u(this,h).removeEventListener("keydown",u(this,mt))},O=new WeakSet,Ne=function(){document.addEventListener("copy",u(this,dt)),document.addEventListener("cut",u(this,lt)),document.addEventListener("paste",u(this,ht))},M=new WeakSet,je=function(){document.removeEventListener("copy",u(this,dt)),document.removeEventListener("cut",u(this,lt)),document.removeEventListener("paste",u(this,ht))},n=new WeakSet,Ht=function(G){Object.entries(G).some(([yt,Rt])=>u(this,l)[yt]!==Rt)&&u(this,I).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(u(this,l),G)})},_=new WeakSet,te=function(G){u(this,I).dispatch("annotationeditorparamschanged",{source:this,details:G})},B=new WeakSet,Be=function(){if(!u(this,$)){pt(this,$,!0);for(const G of u(this,a).values())G.enable()}},V=new WeakSet,Ue=function(){if(this.unselectAll(),u(this,$)){pt(this,$,!1);for(const G of u(this,a).values())G.disable()}},rt=new WeakSet,ge=function(G){const bt=u(this,a).get(G.pageIndex);bt?bt.addOrRebuild(G):this.addEditor(G)},it=new WeakSet,ee=function(){if(u(this,t).size===0)return!0;if(u(this,t).size===1)for(const G of u(this,t).values())return G.isEmpty();return!1},ft=new WeakSet,me=function(G){u(this,st).clear();for(const bt of G)bt.isEmpty()||(u(this,st).add(bt),bt.select());tt(this,n,Ht).call(this,{hasSelectedEditor:!0})},Dt(_t,"_keyboardManager",new L([[["ctrl+a","mac+meta+a"],_t.prototype.selectAll],[["ctrl+z","mac+meta+z"],_t.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],_t.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],_t.prototype.delete],[["Escape","mac+Escape"],_t.prototype.unselectAll]]));let N=_t;m.AnnotationEditorUIManager=N},(Q,m,Y)=>{var dt,lt,ht,mt,vt,St,At,U,l,Jt,S,$t,D,Xt;Object.defineProperty(m,"__esModule",{value:!0}),m.StatTimer=m.RenderingCancelledException=m.PixelsPerInch=m.PageViewport=m.PDFDateString=m.DOMStandardFontDataFactory=m.DOMSVGFactory=m.DOMFilterFactory=m.DOMCanvasFactory=m.DOMCMapReaderFactory=m.AnnotationPrefix=void 0,m.deprecated=o,m.getColorValues=I,m.getCurrentTransform=q,m.getCurrentTransformInverse=$,m.getFilenameFromUrl=y,m.getPdfFilenameFromUrl=T,m.getRGB=i,m.getXfaPageViewport=P,m.isDataScheme=r,m.isPdfFile=A,m.isValidFetchUrl=t,m.loadScript=a,m.setLayerDimensions=J;var b=Y(7),k=Y(1);const X="http://www.w3.org/2000/svg",z="pdfjs_internal_id_";m.AnnotationPrefix=z;const st=class st{};Dt(st,"CSS",96),Dt(st,"PDF",72),Dt(st,"PDF_TO_CSS_UNITS",st.CSS/st.PDF);let ot=st;m.PixelsPerInch=ot;class W extends b.BaseFilterFactory{constructor({docId:M,ownerDocument:e=globalThis.document}={}){super();K(this,l);K(this,S);K(this,D);K(this,dt,void 0);K(this,lt,void 0);K(this,ht,void 0);K(this,mt,void 0);K(this,vt,void 0);K(this,St,void 0);K(this,At,void 0);K(this,U,0);pt(this,ht,M),pt(this,mt,e)}addFilter(M){if(!M)return"none";let e=u(this,l,Jt).get(M);if(e)return e;let n,f,_,E;if(M.length===1){const rt=M[0],Z=new Array(256);for(let it=0;it<256;it++)Z[it]=rt[it]/255;E=n=f=_=Z.join(",")}else{const[rt,Z,it]=M,ut=new Array(256),ft=new Array(256),Et=new Array(256);for(let _t=0;_t<256;_t++)ut[_t]=rt[_t]/255,ft[_t]=Z[_t]/255,Et[_t]=it[_t]/255;n=ut.join(","),f=ft.join(","),_=Et.join(","),E=`${n}${f}${_}`}if(e=u(this,l,Jt).get(E),e)return u(this,l,Jt).set(M,e),e;const B=`g_${u(this,ht)}_transfer_map_${ie(this,U)._++}`,et=`url(#${B})`;u(this,l,Jt).set(M,et),u(this,l,Jt).set(E,et);const V=u(this,mt).createElementNS(X,"filter",X);V.setAttribute("id",B),V.setAttribute("color-interpolation-filters","sRGB");const nt=u(this,mt).createElementNS(X,"feComponentTransfer");return V.append(nt),tt(this,D,Xt).call(this,nt,"feFuncR",n),tt(this,D,Xt).call(this,nt,"feFuncG",f),tt(this,D,Xt).call(this,nt,"feFuncB",_),u(this,S,$t).append(V),et}addHCMFilter(M,e){var it;const n=`${M}-${e}`;if(u(this,St)===n)return u(this,At);if(pt(this,St,n),pt(this,At,"none"),(it=u(this,vt))==null||it.remove(),!M||!e)return u(this,At);u(this,S,$t).style.color=M,M=getComputedStyle(u(this,S,$t)).getPropertyValue("color");const f=i(M);M=k.Util.makeHexColor(...f),u(this,S,$t).style.color=e,e=getComputedStyle(u(this,S,$t)).getPropertyValue("color");const _=i(e);if(e=k.Util.makeHexColor(..._),u(this,S,$t).style.color="",M==="#000000"&&e==="#ffffff"||M===e)return u(this,At);const E=new Array(256);for(let ut=0;ut<=255;ut++){const ft=ut/255;E[ut]=ft<=.03928?ft/12.92:((ft+.055)/1.055)**2.4}const B=E.join(","),et=`g_${u(this,ht)}_hcm_filter`,V=pt(this,vt,u(this,mt).createElementNS(X,"filter",X));V.setAttribute("id",et),V.setAttribute("color-interpolation-filters","sRGB");let nt=u(this,mt).createElementNS(X,"feComponentTransfer");V.append(nt),tt(this,D,Xt).call(this,nt,"feFuncR",B),tt(this,D,Xt).call(this,nt,"feFuncG",B),tt(this,D,Xt).call(this,nt,"feFuncB",B);const rt=u(this,mt).createElementNS(X,"feColorMatrix");rt.setAttribute("type","matrix"),rt.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),V.append(rt),nt=u(this,mt).createElementNS(X,"feComponentTransfer"),V.append(nt);const Z=(ut,ft)=>{const Et=f[ut]/255,_t=_[ut]/255,Ct=new Array(ft+1);for(let G=0;G<=ft;G++)Ct[G]=Et+G/ft*(_t-Et);return Ct.join(",")};return tt(this,D,Xt).call(this,nt,"feFuncR",Z(0,5)),tt(this,D,Xt).call(this,nt,"feFuncG",Z(1,5)),tt(this,D,Xt).call(this,nt,"feFuncB",Z(2,5)),u(this,S,$t).append(V),pt(this,At,`url(#${et})`),u(this,At)}destroy(M=!1){M&&u(this,At)||(u(this,lt)&&(u(this,lt).parentNode.parentNode.remove(),pt(this,lt,null)),u(this,dt)&&(u(this,dt).clear(),pt(this,dt,null)),pt(this,U,0))}}dt=new WeakMap,lt=new WeakMap,ht=new WeakMap,mt=new WeakMap,vt=new WeakMap,St=new WeakMap,At=new WeakMap,U=new WeakMap,l=new WeakSet,Jt=function(){return u(this,dt)||pt(this,dt,new Map)},S=new WeakSet,$t=function(){if(!u(this,lt)){const M=u(this,mt).createElement("div"),{style:e}=M;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const n=u(this,mt).createElementNS(X,"svg");n.setAttribute("width",0),n.setAttribute("height",0),pt(this,lt,u(this,mt).createElementNS(X,"defs")),M.append(n),n.append(u(this,lt)),u(this,mt).body.append(M)}return u(this,lt)},D=new WeakSet,Xt=function(M,e,n){const f=u(this,mt).createElementNS(X,e);f.setAttribute("type","discrete"),f.setAttribute("tableValues",n),M.append(f)},m.DOMFilterFactory=W;class L extends b.BaseCanvasFactory{constructor({ownerDocument:R=globalThis.document}={}){super(),this._document=R}_createCanvas(R,M){const e=this._document.createElement("canvas");return e.width=R,e.height=M,e}}m.DOMCanvasFactory=L;async function v(O,R=!1){if(t(O,document.baseURI)){const M=await fetch(O);if(!M.ok)throw new Error(M.statusText);return R?new Uint8Array(await M.arrayBuffer()):(0,k.stringToBytes)(await M.text())}return new Promise((M,e)=>{const n=new XMLHttpRequest;n.open("GET",O,!0),R&&(n.responseType="arraybuffer"),n.onreadystatechange=()=>{if(n.readyState===XMLHttpRequest.DONE){if(n.status===200||n.status===0){let f;if(R&&n.response?f=new Uint8Array(n.response):!R&&n.responseText&&(f=(0,k.stringToBytes)(n.responseText)),f){M(f);return}}e(new Error(n.statusText))}},n.send(null)})}class N extends b.BaseCMapReaderFactory{_fetchData(R,M){return v(R,this.isCompressed).then(e=>({cMapData:e,compressionType:M}))}}m.DOMCMapReaderFactory=N;class w extends b.BaseStandardFontDataFactory{_fetchData(R){return v(R,!0)}}m.DOMStandardFontDataFactory=w;class x extends b.BaseSVGFactory{_createSVG(R){return document.createElementNS(X,R)}}m.DOMSVGFactory=x;class p{constructor({viewBox:R,scale:M,rotation:e,offsetX:n=0,offsetY:f=0,dontFlip:_=!1}){this.viewBox=R,this.scale=M,this.rotation=e,this.offsetX=n,this.offsetY=f;const E=(R[2]+R[0])/2,B=(R[3]+R[1])/2;let et,V,nt,rt;switch(e%=360,e<0&&(e+=360),e){case 180:et=-1,V=0,nt=0,rt=1;break;case 90:et=0,V=1,nt=1,rt=0;break;case 270:et=0,V=-1,nt=-1,rt=0;break;case 0:et=1,V=0,nt=0,rt=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}_&&(nt=-nt,rt=-rt);let Z,it,ut,ft;et===0?(Z=Math.abs(B-R[1])*M+n,it=Math.abs(E-R[0])*M+f,ut=(R[3]-R[1])*M,ft=(R[2]-R[0])*M):(Z=Math.abs(E-R[0])*M+n,it=Math.abs(B-R[1])*M+f,ut=(R[2]-R[0])*M,ft=(R[3]-R[1])*M),this.transform=[et*M,V*M,nt*M,rt*M,Z-et*M*E-nt*M*B,it-V*M*E-rt*M*B],this.width=ut,this.height=ft}get rawDims(){const{viewBox:R}=this;return(0,k.shadow)(this,"rawDims",{pageWidth:R[2]-R[0],pageHeight:R[3]-R[1],pageX:R[0],pageY:R[1]})}clone({scale:R=this.scale,rotation:M=this.rotation,offsetX:e=this.offsetX,offsetY:n=this.offsetY,dontFlip:f=!1}={}){return new p({viewBox:this.viewBox.slice(),scale:R,rotation:M,offsetX:e,offsetY:n,dontFlip:f})}convertToViewportPoint(R,M){return k.Util.applyTransform([R,M],this.transform)}convertToViewportRectangle(R){const M=k.Util.applyTransform([R[0],R[1]],this.transform),e=k.Util.applyTransform([R[2],R[3]],this.transform);return[M[0],M[1],e[0],e[1]]}convertToPdfPoint(R,M){return k.Util.applyInverseTransform([R,M],this.transform)}}m.PageViewport=p;class d extends k.BaseException{constructor(R,M,e=0){super(R,"RenderingCancelledException"),this.type=M,this.extraDelay=e}}m.RenderingCancelledException=d;function r(O){const R=O.length;let M=0;for(;M<R&&O[M].trim()==="";)M++;return O.substring(M,M+5).toLowerCase()==="data:"}function A(O){return typeof O=="string"&&/\.pdf$/i.test(O)}function y(O,R=!1){return R||([O]=O.split(/[#?]/,1)),O.substring(O.lastIndexOf("/")+1)}function T(O,R="document.pdf"){if(typeof O!="string")return R;if(r(O))return(0,k.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),R;const M=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,e=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,n=M.exec(O);let f=e.exec(n[1])||e.exec(n[2])||e.exec(n[3]);if(f&&(f=f[0],f.includes("%")))try{f=e.exec(decodeURIComponent(f))[0]}catch{}return f||R}class g{constructor(){Dt(this,"started",Object.create(null));Dt(this,"times",[])}time(R){R in this.started&&(0,k.warn)(`Timer is already running for ${R}`),this.started[R]=Date.now()}timeEnd(R){R in this.started||(0,k.warn)(`Timer has not been started for ${R}`),this.times.push({name:R,start:this.started[R],end:Date.now()}),delete this.started[R]}toString(){const R=[];let M=0;for(const{name:e}of this.times)M=Math.max(e.length,M);for(const{name:e,start:n,end:f}of this.times)R.push(`${e.padEnd(M)} ${f-n}ms
`);return R.join("")}}m.StatTimer=g;function t(O,R){try{const{protocol:M}=R?new URL(O,R):new URL(O);return M==="http:"||M==="https:"}catch{return!1}}function a(O,R=!1){return new Promise((M,e)=>{const n=document.createElement("script");n.src=O,n.onload=function(f){R&&n.remove(),M(f)},n.onerror=function(){e(new Error(`Cannot load script at: ${n.src}`))},(document.head||document.documentElement).append(n)})}function o(O){console.log("Deprecated API usage: "+O)}let s;class c{static toDateObject(R){if(!R||typeof R!="string")return null;s||(s=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const M=s.exec(R);if(!M)return null;const e=parseInt(M[1],10);let n=parseInt(M[2],10);n=n>=1&&n<=12?n-1:0;let f=parseInt(M[3],10);f=f>=1&&f<=31?f:1;let _=parseInt(M[4],10);_=_>=0&&_<=23?_:0;let E=parseInt(M[5],10);E=E>=0&&E<=59?E:0;let B=parseInt(M[6],10);B=B>=0&&B<=59?B:0;const et=M[7]||"Z";let V=parseInt(M[8],10);V=V>=0&&V<=23?V:0;let nt=parseInt(M[9],10)||0;return nt=nt>=0&&nt<=59?nt:0,et==="-"?(_+=V,E+=nt):et==="+"&&(_-=V,E-=nt),new Date(Date.UTC(e,n,f,_,E,B))}}m.PDFDateString=c;function P(O,{scale:R=1,rotation:M=0}){const{width:e,height:n}=O.attributes.style,f=[0,0,parseInt(e),parseInt(n)];return new p({viewBox:f,scale:R,rotation:M})}function i(O){if(O.startsWith("#")){const R=parseInt(O.slice(1),16);return[(R&16711680)>>16,(R&65280)>>8,R&255]}return O.startsWith("rgb(")?O.slice(4,-1).split(",").map(R=>parseInt(R)):O.startsWith("rgba(")?O.slice(5,-1).split(",").map(R=>parseInt(R)).slice(0,3):((0,k.warn)(`Not a valid color format: "${O}"`),[0,0,0])}function I(O){const R=document.createElement("span");R.style.visibility="hidden",document.body.append(R);for(const M of O.keys()){R.style.color=M;const e=window.getComputedStyle(R).color;O.set(M,i(e))}R.remove()}function q(O){const{a:R,b:M,c:e,d:n,e:f,f:_}=O.getTransform();return[R,M,e,n,f,_]}function $(O){const{a:R,b:M,c:e,d:n,e:f,f:_}=O.getTransform().invertSelf();return[R,M,e,n,f,_]}function J(O,R,M=!1,e=!0){if(R instanceof p){const{pageWidth:n,pageHeight:f}=R.rawDims,{style:_}=O,E=`calc(var(--scale-factor) * ${n}px)`,B=`calc(var(--scale-factor) * ${f}px)`;!M||R.rotation%180===0?(_.width=E,_.height=B):(_.width=B,_.height=E)}e&&O.setAttribute("data-main-rotation",R.rotation)}},(Q,m,Y)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.BaseStandardFontDataFactory=m.BaseSVGFactory=m.BaseFilterFactory=m.BaseCanvasFactory=m.BaseCMapReaderFactory=void 0;var b=Y(1);class k{constructor(){this.constructor===k&&(0,b.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(v){return"none"}addHCMFilter(v,N){return"none"}destroy(v=!1){}}m.BaseFilterFactory=k;class X{constructor(){this.constructor===X&&(0,b.unreachable)("Cannot initialize BaseCanvasFactory.")}create(v,N){if(v<=0||N<=0)throw new Error("Invalid canvas size");const w=this._createCanvas(v,N);return{canvas:w,context:w.getContext("2d")}}reset(v,N,w){if(!v.canvas)throw new Error("Canvas is not specified");if(N<=0||w<=0)throw new Error("Invalid canvas size");v.canvas.width=N,v.canvas.height=w}destroy(v){if(!v.canvas)throw new Error("Canvas is not specified");v.canvas.width=0,v.canvas.height=0,v.canvas=null,v.context=null}_createCanvas(v,N){(0,b.unreachable)("Abstract method `_createCanvas` called.")}}m.BaseCanvasFactory=X;class z{constructor({baseUrl:v=null,isCompressed:N=!0}){this.constructor===z&&(0,b.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=v,this.isCompressed=N}async fetch({name:v}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!v)throw new Error("CMap name must be specified.");const N=this.baseUrl+v+(this.isCompressed?".bcmap":""),w=this.isCompressed?b.CMapCompressionType.BINARY:b.CMapCompressionType.NONE;return this._fetchData(N,w).catch(x=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${N}`)})}_fetchData(v,N){(0,b.unreachable)("Abstract method `_fetchData` called.")}}m.BaseCMapReaderFactory=z;class ot{constructor({baseUrl:v=null}){this.constructor===ot&&(0,b.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=v}async fetch({filename:v}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!v)throw new Error("Font filename must be specified.");const N=`${this.baseUrl}${v}`;return this._fetchData(N).catch(w=>{throw new Error(`Unable to load font data at: ${N}`)})}_fetchData(v){(0,b.unreachable)("Abstract method `_fetchData` called.")}}m.BaseStandardFontDataFactory=ot;class W{constructor(){this.constructor===W&&(0,b.unreachable)("Cannot initialize BaseSVGFactory.")}create(v,N,w=!1){if(v<=0||N<=0)throw new Error("Invalid SVG dimensions");const x=this._createSVG("svg:svg");return x.setAttribute("version","1.1"),w||(x.setAttribute("width",`${v}px`),x.setAttribute("height",`${N}px`)),x.setAttribute("preserveAspectRatio","none"),x.setAttribute("viewBox",`0 0 ${v} ${N}`),x}createElement(v){if(typeof v!="string")throw new Error("Invalid SVG element type");return this._createSVG(v)}_createSVG(v){(0,b.unreachable)("Abstract method `_createSVG` called.")}}m.BaseSVGFactory=W},(Q,m,Y)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.MurmurHash3_64=void 0;var b=Y(1);const k=3285377520,X=4294901760,z=65535;class ot{constructor(L){this.h1=L?L&4294967295:k,this.h2=L?L&4294967295:k}update(L){let v,N;if(typeof L=="string"){v=new Uint8Array(L.length*2),N=0;for(let o=0,s=L.length;o<s;o++){const c=L.charCodeAt(o);c<=255?v[N++]=c:(v[N++]=c>>>8,v[N++]=c&255)}}else if((0,b.isArrayBuffer)(L))v=L.slice(),N=v.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const w=N>>2,x=N-w*4,p=new Uint32Array(v.buffer,0,w);let d=0,r=0,A=this.h1,y=this.h2;const T=3432918353,g=461845907,t=T&z,a=g&z;for(let o=0;o<w;o++)o&1?(d=p[o],d=d*T&X|d*t&z,d=d<<15|d>>>17,d=d*g&X|d*a&z,A^=d,A=A<<13|A>>>19,A=A*5+3864292196):(r=p[o],r=r*T&X|r*t&z,r=r<<15|r>>>17,r=r*g&X|r*a&z,y^=r,y=y<<13|y>>>19,y=y*5+3864292196);switch(d=0,x){case 3:d^=v[w*4+2]<<16;case 2:d^=v[w*4+1]<<8;case 1:d^=v[w*4],d=d*T&X|d*t&z,d=d<<15|d>>>17,d=d*g&X|d*a&z,w&1?A^=d:y^=d}this.h1=A,this.h2=y}hexdigest(){let L=this.h1,v=this.h2;return L^=v>>>1,L=L*3981806797&X|L*36045&z,v=v*4283543511&X|((v<<16|L>>>16)*2950163797&X)>>>16,L^=v>>>1,L=L*444984403&X|L*60499&z,v=v*3301882366&X|((v<<16|L>>>16)*3120437893&X)>>>16,L^=v>>>1,(L>>>0).toString(16).padStart(8,"0")+(v>>>0).toString(16).padStart(8,"0")}}m.MurmurHash3_64=ot},(Q,m,Y)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.FontLoader=m.FontFaceObject=void 0;var b=Y(1),k=Y(10);class X{constructor({ownerDocument:W=globalThis.document,styleElement:L=null}){this._document=W,this.nativeFontFaces=[],this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(W){this.nativeFontFaces.push(W),this._document.fonts.add(W)}insertRule(W){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const L=this.styleElement.sheet;L.insertRule(W,L.cssRules.length)}clear(){for(const W of this.nativeFontFaces)this._document.fonts.delete(W);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(W){if(W.attached||W.missingFile)return;if(W.attached=!0,this.isFontLoadingAPISupported){const v=W.createNativeFontFace();if(v){this.addNativeFontFace(v);try{await v.loaded}catch(N){throw(0,b.warn)(`Failed to load font '${v.family}': '${N}'.`),W.disableFontFace=!0,N}}return}const L=W.createFontFaceRule();if(L){if(this.insertRule(L),this.isSyncFontLoadingSupported)return;await new Promise(v=>{const N=this._queueLoadingCallback(v);this._prepareFontLoadEvent(W,N)})}}get isFontLoadingAPISupported(){var L;const W=!!((L=this._document)!=null&&L.fonts);return(0,b.shadow)(this,"isFontLoadingAPISupported",W)}get isSyncFontLoadingSupported(){let W=!1;return(k.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(W=!0),(0,b.shadow)(this,"isSyncFontLoadingSupported",W)}_queueLoadingCallback(W){function L(){for((0,b.assert)(!N.done,"completeRequest() cannot be called twice."),N.done=!0;v.length>0&&v[0].done;){const w=v.shift();setTimeout(w.callback,0)}}const{loadingRequests:v}=this,N={done:!1,complete:L,callback:W};return v.push(N),N}get _loadTestFont(){const W=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,b.shadow)(this,"_loadTestFont",W)}_prepareFontLoadEvent(W,L){function v(i,I){return i.charCodeAt(I)<<24|i.charCodeAt(I+1)<<16|i.charCodeAt(I+2)<<8|i.charCodeAt(I+3)&255}function N(i,I,q,$){const J=i.substring(0,I),st=i.substring(I+q);return J+$+st}let w,x;const p=this._document.createElement("canvas");p.width=1,p.height=1;const d=p.getContext("2d");let r=0;function A(i,I){if(++r>30){(0,b.warn)("Load test font never loaded."),I();return}if(d.font="30px "+i,d.fillText(".",0,20),d.getImageData(0,0,1,1).data[3]>0){I();return}setTimeout(A.bind(null,i,I))}const y=`lt${Date.now()}${this.loadTestFontId++}`;let T=this._loadTestFont;T=N(T,976,y.length,y);const t=16,a=1482184792;let o=v(T,t);for(w=0,x=y.length-3;w<x;w+=4)o=o-a+v(y,w)|0;w<y.length&&(o=o-a+v(y+"XXX",w)|0),T=N(T,t,4,(0,b.string32)(o));const s=`url(data:font/opentype;base64,${btoa(T)});`,c=`@font-face {font-family:"${y}";src:${s}}`;this.insertRule(c);const P=this._document.createElement("div");P.style.visibility="hidden",P.style.width=P.style.height="10px",P.style.position="absolute",P.style.top=P.style.left="0px";for(const i of[W.loadedName,y]){const I=this._document.createElement("span");I.textContent="Hi",I.style.fontFamily=i,P.append(I)}this._document.body.append(P),A(y,()=>{P.remove(),L.complete()})}}m.FontLoader=X;class z{constructor(W,{isEvalSupported:L=!0,disableFontFace:v=!1,ignoreErrors:N=!1,inspectFont:w=null}){this.compiledGlyphs=Object.create(null);for(const x in W)this[x]=W[x];this.isEvalSupported=L!==!1,this.disableFontFace=v===!0,this.ignoreErrors=N===!0,this._inspectFont=w}createNativeFontFace(){var L;if(!this.data||this.disableFontFace)return null;let W;if(!this.cssFontInfo)W=new FontFace(this.loadedName,this.data,{});else{const v={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(v.style=`oblique ${this.cssFontInfo.italicAngle}deg`),W=new FontFace(this.cssFontInfo.fontFamily,this.data,v)}return(L=this._inspectFont)==null||L.call(this,this),W}createFontFaceRule(){var N;if(!this.data||this.disableFontFace)return null;const W=(0,b.bytesToString)(this.data),L=`url(data:${this.mimetype};base64,${btoa(W)});`;let v;if(!this.cssFontInfo)v=`@font-face {font-family:"${this.loadedName}";src:${L}}`;else{let w=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(w+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),v=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${w}src:${L}}`}return(N=this._inspectFont)==null||N.call(this,this,L),v}getPathGenerator(W,L){if(this.compiledGlyphs[L]!==void 0)return this.compiledGlyphs[L];let v;try{v=W.get(this.loadedName+"_path_"+L)}catch(N){if(!this.ignoreErrors)throw N;return(0,b.warn)(`getPathGenerator - ignoring character: "${N}".`),this.compiledGlyphs[L]=function(w,x){}}if(this.isEvalSupported&&b.FeatureTest.isEvalSupported){const N=[];for(const w of v){const x=w.args!==void 0?w.args.join(","):"";N.push("c.",w.cmd,"(",x,`);
`)}return this.compiledGlyphs[L]=new Function("c","size",N.join(""))}return this.compiledGlyphs[L]=function(N,w){for(const x of v)x.cmd==="scale"&&(x.args=[w,-w]),N[x.cmd].apply(N,x.args)}}}m.FontFaceObject=z},(Q,m)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.isNodeJS=void 0;const Y=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");m.isNodeJS=Y},(Q,m,Y)=>{var ht,be,vt,Ae;Object.defineProperty(m,"__esModule",{value:!0}),m.CanvasGraphics=void 0;var b=Y(1),k=Y(6),X=Y(12),z=Y(13),ot=Y(10);const W=16,L=100,v=4096,N=15,w=10,x=1e3,p=16;function d(U,l){if(U._removeMirroring)throw new Error("Context is already forwarding operations.");U.__originalSave=U.save,U.__originalRestore=U.restore,U.__originalRotate=U.rotate,U.__originalScale=U.scale,U.__originalTranslate=U.translate,U.__originalTransform=U.transform,U.__originalSetTransform=U.setTransform,U.__originalResetTransform=U.resetTransform,U.__originalClip=U.clip,U.__originalMoveTo=U.moveTo,U.__originalLineTo=U.lineTo,U.__originalBezierCurveTo=U.bezierCurveTo,U.__originalRect=U.rect,U.__originalClosePath=U.closePath,U.__originalBeginPath=U.beginPath,U._removeMirroring=()=>{U.save=U.__originalSave,U.restore=U.__originalRestore,U.rotate=U.__originalRotate,U.scale=U.__originalScale,U.translate=U.__originalTranslate,U.transform=U.__originalTransform,U.setTransform=U.__originalSetTransform,U.resetTransform=U.__originalResetTransform,U.clip=U.__originalClip,U.moveTo=U.__originalMoveTo,U.lineTo=U.__originalLineTo,U.bezierCurveTo=U.__originalBezierCurveTo,U.rect=U.__originalRect,U.closePath=U.__originalClosePath,U.beginPath=U.__originalBeginPath,delete U._removeMirroring},U.save=function(){l.save(),this.__originalSave()},U.restore=function(){l.restore(),this.__originalRestore()},U.translate=function(S,j){l.translate(S,j),this.__originalTranslate(S,j)},U.scale=function(S,j){l.scale(S,j),this.__originalScale(S,j)},U.transform=function(S,j,D,H,O,R){l.transform(S,j,D,H,O,R),this.__originalTransform(S,j,D,H,O,R)},U.setTransform=function(S,j,D,H,O,R){l.setTransform(S,j,D,H,O,R),this.__originalSetTransform(S,j,D,H,O,R)},U.resetTransform=function(){l.resetTransform(),this.__originalResetTransform()},U.rotate=function(S){l.rotate(S),this.__originalRotate(S)},U.clip=function(S){l.clip(S),this.__originalClip(S)},U.moveTo=function(h,S){l.moveTo(h,S),this.__originalMoveTo(h,S)},U.lineTo=function(h,S){l.lineTo(h,S),this.__originalLineTo(h,S)},U.bezierCurveTo=function(h,S,j,D,H,O){l.bezierCurveTo(h,S,j,D,H,O),this.__originalBezierCurveTo(h,S,j,D,H,O)},U.rect=function(h,S,j,D){l.rect(h,S,j,D),this.__originalRect(h,S,j,D)},U.closePath=function(){l.closePath(),this.__originalClosePath()},U.beginPath=function(){l.beginPath(),this.__originalBeginPath()}}class r{constructor(l){this.canvasFactory=l,this.cache=Object.create(null)}getCanvas(l,h,S){let j;return this.cache[l]!==void 0?(j=this.cache[l],this.canvasFactory.reset(j,h,S)):(j=this.canvasFactory.create(h,S),this.cache[l]=j),j}delete(l){delete this.cache[l]}clear(){for(const l in this.cache){const h=this.cache[l];this.canvasFactory.destroy(h),delete this.cache[l]}}}function A(U,l,h,S,j,D,H,O,R,M){const[e,n,f,_,E,B]=(0,k.getCurrentTransform)(U);if(n===0&&f===0){const nt=H*e+E,rt=Math.round(nt),Z=O*_+B,it=Math.round(Z),ut=(H+R)*e+E,ft=Math.abs(Math.round(ut)-rt)||1,Et=(O+M)*_+B,_t=Math.abs(Math.round(Et)-it)||1;return U.setTransform(Math.sign(e),0,0,Math.sign(_),rt,it),U.drawImage(l,h,S,j,D,0,0,ft,_t),U.setTransform(e,n,f,_,E,B),[ft,_t]}if(e===0&&_===0){const nt=O*f+E,rt=Math.round(nt),Z=H*n+B,it=Math.round(Z),ut=(O+M)*f+E,ft=Math.abs(Math.round(ut)-rt)||1,Et=(H+R)*n+B,_t=Math.abs(Math.round(Et)-it)||1;return U.setTransform(0,Math.sign(n),Math.sign(f),0,rt,it),U.drawImage(l,h,S,j,D,0,0,_t,ft),U.setTransform(e,n,f,_,E,B),[_t,ft]}U.drawImage(l,h,S,j,D,H,O,R,M);const et=Math.hypot(e,n),V=Math.hypot(f,_);return[et*R,V*M]}function y(U){const{width:l,height:h}=U;if(l>x||h>x)return null;const S=1e3,j=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),D=l+1;let H=new Uint8Array(D*(h+1)),O,R,M;const e=l+7&-8;let n=new Uint8Array(e*h),f=0;for(const V of U.data){let nt=128;for(;nt>0;)n[f++]=V&nt?0:255,nt>>=1}let _=0;for(f=0,n[f]!==0&&(H[0]=1,++_),R=1;R<l;R++)n[f]!==n[f+1]&&(H[R]=n[f]?2:1,++_),f++;for(n[f]!==0&&(H[R]=2,++_),O=1;O<h;O++){f=O*e,M=O*D,n[f-e]!==n[f]&&(H[M]=n[f]?1:8,++_);let V=(n[f]?4:0)+(n[f-e]?8:0);for(R=1;R<l;R++)V=(V>>2)+(n[f+1]?4:0)+(n[f-e+1]?8:0),j[V]&&(H[M+R]=j[V],++_),f++;if(n[f-e]!==n[f]&&(H[M+R]=n[f]?2:4,++_),_>S)return null}for(f=e*(h-1),M=O*D,n[f]!==0&&(H[M]=8,++_),R=1;R<l;R++)n[f]!==n[f+1]&&(H[M+R]=n[f]?4:8,++_),f++;if(n[f]!==0&&(H[M+R]=4,++_),_>S)return null;const E=new Int32Array([0,D,-1,0,-D,0,0,0,1]),B=new Path2D;for(O=0;_&&O<=h;O++){let V=O*D;const nt=V+l;for(;V<nt&&!H[V];)V++;if(V===nt)continue;B.moveTo(V%D,O);const rt=V;let Z=H[V];do{const it=E[Z];do V+=it;while(!H[V]);const ut=H[V];ut!==5&&ut!==10?(Z=ut,H[V]=0):(Z=ut&51*Z>>4,H[V]&=Z>>2|Z<<2),B.lineTo(V%D,V/D|0),H[V]||--_}while(rt!==V);--O}return n=null,H=null,function(V){V.save(),V.scale(1/l,-1/h),V.translate(0,-h),V.fill(B),V.beginPath(),V.restore()}}class T{constructor(l,h){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=b.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=b.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=b.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,l,h])}clone(){const l=Object.create(this);return l.clipBox=this.clipBox.slice(),l}setCurrentPoint(l,h){this.x=l,this.y=h}updatePathMinMax(l,h,S){[h,S]=b.Util.applyTransform([h,S],l),this.minX=Math.min(this.minX,h),this.minY=Math.min(this.minY,S),this.maxX=Math.max(this.maxX,h),this.maxY=Math.max(this.maxY,S)}updateRectMinMax(l,h){const S=b.Util.applyTransform(h,l),j=b.Util.applyTransform(h.slice(2),l);this.minX=Math.min(this.minX,S[0],j[0]),this.minY=Math.min(this.minY,S[1],j[1]),this.maxX=Math.max(this.maxX,S[0],j[0]),this.maxY=Math.max(this.maxY,S[1],j[1])}updateScalingPathMinMax(l,h){b.Util.scaleMinMax(l,h),this.minX=Math.min(this.minX,h[0]),this.maxX=Math.max(this.maxX,h[1]),this.minY=Math.min(this.minY,h[2]),this.maxY=Math.max(this.maxY,h[3])}updateCurvePathMinMax(l,h,S,j,D,H,O,R,M,e){const n=b.Util.bezierBoundingBox(h,S,j,D,H,O,R,M);if(e){e[0]=Math.min(e[0],n[0],n[2]),e[1]=Math.max(e[1],n[0],n[2]),e[2]=Math.min(e[2],n[1],n[3]),e[3]=Math.max(e[3],n[1],n[3]);return}this.updateRectMinMax(l,n)}getPathBoundingBox(l=X.PathType.FILL,h=null){const S=[this.minX,this.minY,this.maxX,this.maxY];if(l===X.PathType.STROKE){h||(0,b.unreachable)("Stroke bounding box must include transform.");const j=b.Util.singularValueDecompose2dScale(h),D=j[0]*this.lineWidth/2,H=j[1]*this.lineWidth/2;S[0]-=D,S[1]-=H,S[2]+=D,S[3]+=H}return S}updateClipFromPath(){const l=b.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(l||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(l){this.clipBox=l,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(l=X.PathType.FILL,h=null){return b.Util.intersect(this.clipBox,this.getPathBoundingBox(l,h))}}function g(U,l){if(typeof ImageData<"u"&&l instanceof ImageData){U.putImageData(l,0,0);return}const h=l.height,S=l.width,j=h%p,D=(h-j)/p,H=j===0?D:D+1,O=U.createImageData(S,p);let R=0,M;const e=l.data,n=O.data;let f,_,E,B;if(l.kind===b.ImageKind.GRAYSCALE_1BPP){const et=e.byteLength,V=new Uint32Array(n.buffer,0,n.byteLength>>2),nt=V.length,rt=S+7>>3,Z=4294967295,it=b.FeatureTest.isLittleEndian?4278190080:255;for(f=0;f<H;f++){for(E=f<D?p:j,M=0,_=0;_<E;_++){const ut=et-R;let ft=0;const Et=ut>rt?S:ut*8-7,_t=Et&-8;let Ct=0,G=0;for(;ft<_t;ft+=8)G=e[R++],V[M++]=G&128?Z:it,V[M++]=G&64?Z:it,V[M++]=G&32?Z:it,V[M++]=G&16?Z:it,V[M++]=G&8?Z:it,V[M++]=G&4?Z:it,V[M++]=G&2?Z:it,V[M++]=G&1?Z:it;for(;ft<Et;ft++)Ct===0&&(G=e[R++],Ct=128),V[M++]=G&Ct?Z:it,Ct>>=1}for(;M<nt;)V[M++]=0;U.putImageData(O,0,f*p)}}else if(l.kind===b.ImageKind.RGBA_32BPP){for(_=0,B=S*p*4,f=0;f<D;f++)n.set(e.subarray(R,R+B)),R+=B,U.putImageData(O,0,_),_+=p;f<H&&(B=S*j*4,n.set(e.subarray(R,R+B)),U.putImageData(O,0,_))}else if(l.kind===b.ImageKind.RGB_24BPP)for(E=p,B=S*E,f=0;f<H;f++){for(f>=D&&(E=j,B=S*E),M=0,_=B;_--;)n[M++]=e[R++],n[M++]=e[R++],n[M++]=e[R++],n[M++]=255;U.putImageData(O,0,f*p)}else throw new Error(`bad image kind: ${l.kind}`)}function t(U,l){if(l.bitmap){U.drawImage(l.bitmap,0,0);return}const h=l.height,S=l.width,j=h%p,D=(h-j)/p,H=j===0?D:D+1,O=U.createImageData(S,p);let R=0;const M=l.data,e=O.data;for(let n=0;n<H;n++){const f=n<D?p:j;({srcPos:R}=(0,z.convertBlackAndWhiteToRGBA)({src:M,srcPos:R,dest:e,width:S,height:f,nonBlackColor:0})),U.putImageData(O,0,n*p)}}function a(U,l){const h=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const S of h)U[S]!==void 0&&(l[S]=U[S]);U.setLineDash!==void 0&&(l.setLineDash(U.getLineDash()),l.lineDashOffset=U.lineDashOffset)}function o(U){U.strokeStyle=U.fillStyle="#000000",U.fillRule="nonzero",U.globalAlpha=1,U.lineWidth=1,U.lineCap="butt",U.lineJoin="miter",U.miterLimit=10,U.globalCompositeOperation="source-over",U.font="10px sans-serif",U.setLineDash!==void 0&&(U.setLineDash([]),U.lineDashOffset=0),ot.isNodeJS||(U.filter="none")}function s(U,l,h,S){const j=U.length;for(let D=3;D<j;D+=4){const H=U[D];if(H===0)U[D-3]=l,U[D-2]=h,U[D-1]=S;else if(H<255){const O=255-H;U[D-3]=U[D-3]*H+l*O>>8,U[D-2]=U[D-2]*H+h*O>>8,U[D-1]=U[D-1]*H+S*O>>8}}}function c(U,l,h){const S=U.length,j=1/255;for(let D=3;D<S;D+=4){const H=h?h[U[D]]:U[D];l[D]=l[D]*H*j|0}}function P(U,l,h){const S=U.length;for(let j=3;j<S;j+=4){const D=U[j-3]*77+U[j-2]*152+U[j-1]*28;l[j]=h?l[j]*h[D>>8]>>8:l[j]*D>>16}}function i(U,l,h,S,j,D,H,O,R,M,e){const n=!!D,f=n?D[0]:0,_=n?D[1]:0,E=n?D[2]:0;let B;j==="Luminosity"?B=P:B=c;const V=Math.min(S,Math.ceil(1048576/h));for(let nt=0;nt<S;nt+=V){const rt=Math.min(V,S-nt),Z=U.getImageData(O-M,nt+(R-e),h,rt),it=l.getImageData(O,nt+R,h,rt);n&&s(Z.data,f,_,E),B(Z.data,it.data,H),l.putImageData(it,O,nt+R)}}function I(U,l,h,S){const j=S[0],D=S[1],H=S[2]-j,O=S[3]-D;H===0||O===0||(i(l.context,h,H,O,l.subtype,l.backdrop,l.transferMap,j,D,l.offsetX,l.offsetY),U.save(),U.globalAlpha=1,U.globalCompositeOperation="source-over",U.setTransform(1,0,0,1,0,0),U.drawImage(h.canvas,0,0),U.restore())}function q(U,l){const h=b.Util.singularValueDecompose2dScale(U);h[0]=Math.fround(h[0]),h[1]=Math.fround(h[1]);const S=Math.fround((globalThis.devicePixelRatio||1)*k.PixelsPerInch.PDF_TO_CSS_UNITS);return l!==void 0?l:h[0]<=S||h[1]<=S}const $=["butt","round","square"],J=["miter","round","bevel"],st={},dt={},At=class At{constructor(l,h,S,j,D,{optionalContentConfig:H,markedContentStack:O=null},R,M){K(this,ht);K(this,vt);this.ctx=l,this.current=new T(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=h,this.objs=S,this.canvasFactory=j,this.filterFactory=D,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=O||[],this.optionalContentConfig=H,this.cachedCanvases=new r(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=R,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=M,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(l,h=null){return typeof l=="string"?l.startsWith("g_")?this.commonObjs.get(l):this.objs.get(l):h}beginDrawing({transform:l,viewport:h,transparency:S=!1,background:j=null}){const D=this.ctx.canvas.width,H=this.ctx.canvas.height,O=this.ctx.fillStyle;if(this.ctx.fillStyle=j||"#ffffff",this.ctx.fillRect(0,0,D,H),this.ctx.fillStyle=O,S){const R=this.cachedCanvases.getCanvas("transparent",D,H);this.compositeCtx=this.ctx,this.transparentCanvas=R.canvas,this.ctx=R.context,this.ctx.save(),this.ctx.transform(...(0,k.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),o(this.ctx),l&&(this.ctx.transform(...l),this.outputScaleX=l[0],this.outputScaleY=l[0]),this.ctx.transform(...h.transform),this.viewportScale=h.scale,this.baseTransform=(0,k.getCurrentTransform)(this.ctx)}executeOperatorList(l,h,S,j){const D=l.argsArray,H=l.fnArray;let O=h||0;const R=D.length;if(R===O)return O;const M=R-O>w&&typeof S=="function",e=M?Date.now()+N:0;let n=0;const f=this.commonObjs,_=this.objs;let E;for(;;){if(j!==void 0&&O===j.nextBreakPoint)return j.breakIt(O,S),O;if(E=H[O],E!==b.OPS.dependency)this[E].apply(this,D[O]);else for(const B of D[O]){const et=B.startsWith("g_")?f:_;if(!et.has(B))return et.get(B,S),O}if(O++,O===R)return O;if(M&&++n>w){if(Date.now()>e)return S(),O;n=0}}}endDrawing(){tt(this,ht,be).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const l of this._cachedBitmapsMap.values()){for(const h of l.values())typeof HTMLCanvasElement<"u"&&h instanceof HTMLCanvasElement&&(h.width=h.height=0);l.clear()}this._cachedBitmapsMap.clear(),tt(this,vt,Ae).call(this)}_scaleImage(l,h){const S=l.width,j=l.height;let D=Math.max(Math.hypot(h[0],h[1]),1),H=Math.max(Math.hypot(h[2],h[3]),1),O=S,R=j,M="prescale1",e,n;for(;D>2&&O>1||H>2&&R>1;){let f=O,_=R;D>2&&O>1&&(f=O>=16384?Math.floor(O/2)-1||1:Math.ceil(O/2),D/=O/f),H>2&&R>1&&(_=R>=16384?Math.floor(R/2)-1||1:Math.ceil(R)/2,H/=R/_),e=this.cachedCanvases.getCanvas(M,f,_),n=e.context,n.clearRect(0,0,f,_),n.drawImage(l,0,0,O,R,0,0,f,_),l=e.canvas,O=f,R=_,M=M==="prescale1"?"prescale2":"prescale1"}return{img:l,paintWidth:O,paintHeight:R}}_createMaskCanvas(l){const h=this.ctx,{width:S,height:j}=l,D=this.current.fillColor,H=this.current.patternFill,O=(0,k.getCurrentTransform)(h);let R,M,e,n;if((l.bitmap||l.data)&&l.count>1){const ft=l.bitmap||l.data.buffer;M=JSON.stringify(H?O:[O.slice(0,4),D]),R=this._cachedBitmapsMap.get(ft),R||(R=new Map,this._cachedBitmapsMap.set(ft,R));const Et=R.get(M);if(Et&&!H){const _t=Math.round(Math.min(O[0],O[2])+O[4]),Ct=Math.round(Math.min(O[1],O[3])+O[5]);return{canvas:Et,offsetX:_t,offsetY:Ct}}e=Et}e||(n=this.cachedCanvases.getCanvas("maskCanvas",S,j),t(n.context,l));let f=b.Util.transform(O,[1/S,0,0,-1/j,0,0]);f=b.Util.transform(f,[1,0,0,1,0,-j]);const _=b.Util.applyTransform([0,0],f),E=b.Util.applyTransform([S,j],f),B=b.Util.normalizeRect([_[0],_[1],E[0],E[1]]),et=Math.round(B[2]-B[0])||1,V=Math.round(B[3]-B[1])||1,nt=this.cachedCanvases.getCanvas("fillCanvas",et,V),rt=nt.context,Z=Math.min(_[0],E[0]),it=Math.min(_[1],E[1]);rt.translate(-Z,-it),rt.transform(...f),e||(e=this._scaleImage(n.canvas,(0,k.getCurrentTransformInverse)(rt)),e=e.img,R&&H&&R.set(M,e)),rt.imageSmoothingEnabled=q((0,k.getCurrentTransform)(rt),l.interpolate),A(rt,e,0,0,e.width,e.height,0,0,S,j),rt.globalCompositeOperation="source-in";const ut=b.Util.transform((0,k.getCurrentTransformInverse)(rt),[1,0,0,1,-Z,-it]);return rt.fillStyle=H?D.getPattern(h,this,ut,X.PathType.FILL):D,rt.fillRect(0,0,S,j),R&&!H&&(this.cachedCanvases.delete("fillCanvas"),R.set(M,nt.canvas)),{canvas:nt.canvas,offsetX:Math.round(Z),offsetY:Math.round(it)}}setLineWidth(l){l!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=l,this.ctx.lineWidth=l}setLineCap(l){this.ctx.lineCap=$[l]}setLineJoin(l){this.ctx.lineJoin=J[l]}setMiterLimit(l){this.ctx.miterLimit=l}setDash(l,h){const S=this.ctx;S.setLineDash!==void 0&&(S.setLineDash(l),S.lineDashOffset=h)}setRenderingIntent(l){}setFlatness(l){}setGState(l){for(const[h,S]of l)switch(h){case"LW":this.setLineWidth(S);break;case"LC":this.setLineCap(S);break;case"LJ":this.setLineJoin(S);break;case"ML":this.setMiterLimit(S);break;case"D":this.setDash(S[0],S[1]);break;case"RI":this.setRenderingIntent(S);break;case"FL":this.setFlatness(S);break;case"Font":this.setFont(S[0],S[1]);break;case"CA":this.current.strokeAlpha=S;break;case"ca":this.current.fillAlpha=S,this.ctx.globalAlpha=S;break;case"BM":this.ctx.globalCompositeOperation=S;break;case"SMask":this.current.activeSMask=S?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(S);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const l=this.inSMaskMode;this.current.activeSMask&&!l?this.beginSMaskMode():!this.current.activeSMask&&l&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const l=this.ctx.canvas.width,h=this.ctx.canvas.height,S="smaskGroupAt"+this.groupLevel,j=this.cachedCanvases.getCanvas(S,l,h);this.suspendedCtx=this.ctx,this.ctx=j.context;const D=this.ctx;D.setTransform(...(0,k.getCurrentTransform)(this.suspendedCtx)),a(this.suspendedCtx,D),d(D,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),a(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(l){if(!this.current.activeSMask)return;l?(l[0]=Math.floor(l[0]),l[1]=Math.floor(l[1]),l[2]=Math.ceil(l[2]),l[3]=Math.ceil(l[3])):l=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const h=this.current.activeSMask,S=this.suspendedCtx;I(S,h,this.ctx,l),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(a(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const l=this.current;this.stateStack.push(l),this.current=l.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),a(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(l,h,S,j,D,H){this.ctx.transform(l,h,S,j,D,H),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(l,h,S){const j=this.ctx,D=this.current;let H=D.x,O=D.y,R,M;const e=(0,k.getCurrentTransform)(j),n=e[0]===0&&e[3]===0||e[1]===0&&e[2]===0,f=n?S.slice(0):null;for(let _=0,E=0,B=l.length;_<B;_++)switch(l[_]|0){case b.OPS.rectangle:H=h[E++],O=h[E++];const et=h[E++],V=h[E++],nt=H+et,rt=O+V;j.moveTo(H,O),et===0||V===0?j.lineTo(nt,rt):(j.lineTo(nt,O),j.lineTo(nt,rt),j.lineTo(H,rt)),n||D.updateRectMinMax(e,[H,O,nt,rt]),j.closePath();break;case b.OPS.moveTo:H=h[E++],O=h[E++],j.moveTo(H,O),n||D.updatePathMinMax(e,H,O);break;case b.OPS.lineTo:H=h[E++],O=h[E++],j.lineTo(H,O),n||D.updatePathMinMax(e,H,O);break;case b.OPS.curveTo:R=H,M=O,H=h[E+4],O=h[E+5],j.bezierCurveTo(h[E],h[E+1],h[E+2],h[E+3],H,O),D.updateCurvePathMinMax(e,R,M,h[E],h[E+1],h[E+2],h[E+3],H,O,f),E+=6;break;case b.OPS.curveTo2:R=H,M=O,j.bezierCurveTo(H,O,h[E],h[E+1],h[E+2],h[E+3]),D.updateCurvePathMinMax(e,R,M,H,O,h[E],h[E+1],h[E+2],h[E+3],f),H=h[E+2],O=h[E+3],E+=4;break;case b.OPS.curveTo3:R=H,M=O,H=h[E+2],O=h[E+3],j.bezierCurveTo(h[E],h[E+1],H,O,H,O),D.updateCurvePathMinMax(e,R,M,h[E],h[E+1],H,O,H,O,f),E+=4;break;case b.OPS.closePath:j.closePath();break}n&&D.updateScalingPathMinMax(e,f),D.setCurrentPoint(H,O)}closePath(){this.ctx.closePath()}stroke(l=!0){const h=this.ctx,S=this.current.strokeColor;h.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof S=="object"&&(S!=null&&S.getPattern)?(h.save(),h.strokeStyle=S.getPattern(h,this,(0,k.getCurrentTransformInverse)(h),X.PathType.STROKE),this.rescaleAndStroke(!1),h.restore()):this.rescaleAndStroke(!0)),l&&this.consumePath(this.current.getClippedPathBoundingBox()),h.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(l=!0){const h=this.ctx,S=this.current.fillColor,j=this.current.patternFill;let D=!1;j&&(h.save(),h.fillStyle=S.getPattern(h,this,(0,k.getCurrentTransformInverse)(h),X.PathType.FILL),D=!0);const H=this.current.getClippedPathBoundingBox();this.contentVisible&&H!==null&&(this.pendingEOFill?(h.fill("evenodd"),this.pendingEOFill=!1):h.fill()),D&&h.restore(),l&&this.consumePath(H)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=st}eoClip(){this.pendingClip=dt}beginText(){this.current.textMatrix=b.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const l=this.pendingTextPaths,h=this.ctx;if(l===void 0){h.beginPath();return}h.save(),h.beginPath();for(const S of l)h.setTransform(...S.transform),h.translate(S.x,S.y),S.addToPath(h,S.fontSize);h.restore(),h.clip(),h.beginPath(),delete this.pendingTextPaths}setCharSpacing(l){this.current.charSpacing=l}setWordSpacing(l){this.current.wordSpacing=l}setHScale(l){this.current.textHScale=l/100}setLeading(l){this.current.leading=-l}setFont(l,h){const S=this.commonObjs.get(l),j=this.current;if(!S)throw new Error(`Can't find font for ${l}`);if(j.fontMatrix=S.fontMatrix||b.FONT_IDENTITY_MATRIX,(j.fontMatrix[0]===0||j.fontMatrix[3]===0)&&(0,b.warn)("Invalid font matrix for font "+l),h<0?(h=-h,j.fontDirection=-1):j.fontDirection=1,this.current.font=S,this.current.fontSize=h,S.isType3Font)return;const D=S.loadedName||"sans-serif";let H="normal";S.black?H="900":S.bold&&(H="bold");const O=S.italic?"italic":"normal",R=`"${D}", ${S.fallbackName}`;let M=h;h<W?M=W:h>L&&(M=L),this.current.fontSizeScale=h/M,this.ctx.font=`${O} ${H} ${M}px ${R}`}setTextRenderingMode(l){this.current.textRenderingMode=l}setTextRise(l){this.current.textRise=l}moveText(l,h){this.current.x=this.current.lineX+=l,this.current.y=this.current.lineY+=h}setLeadingMoveText(l,h){this.setLeading(-h),this.moveText(l,h)}setTextMatrix(l,h,S,j,D,H){this.current.textMatrix=[l,h,S,j,D,H],this.current.textMatrixScale=Math.hypot(l,h),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(l,h,S,j){const D=this.ctx,H=this.current,O=H.font,R=H.textRenderingMode,M=H.fontSize/H.fontSizeScale,e=R&b.TextRenderingMode.FILL_STROKE_MASK,n=!!(R&b.TextRenderingMode.ADD_TO_PATH_FLAG),f=H.patternFill&&!O.missingFile;let _;(O.disableFontFace||n||f)&&(_=O.getPathGenerator(this.commonObjs,l)),O.disableFontFace||f?(D.save(),D.translate(h,S),D.beginPath(),_(D,M),j&&D.setTransform(...j),(e===b.TextRenderingMode.FILL||e===b.TextRenderingMode.FILL_STROKE)&&D.fill(),(e===b.TextRenderingMode.STROKE||e===b.TextRenderingMode.FILL_STROKE)&&D.stroke(),D.restore()):((e===b.TextRenderingMode.FILL||e===b.TextRenderingMode.FILL_STROKE)&&D.fillText(l,h,S),(e===b.TextRenderingMode.STROKE||e===b.TextRenderingMode.FILL_STROKE)&&D.strokeText(l,h,S)),n&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,k.getCurrentTransform)(D),x:h,y:S,fontSize:M,addToPath:_})}get isFontSubpixelAAEnabled(){const{context:l}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);l.scale(1.5,1),l.fillText("I",0,10);const h=l.getImageData(0,0,10,10).data;let S=!1;for(let j=3;j<h.length;j+=4)if(h[j]>0&&h[j]<255){S=!0;break}return(0,b.shadow)(this,"isFontSubpixelAAEnabled",S)}showText(l){const h=this.current,S=h.font;if(S.isType3Font)return this.showType3Text(l);const j=h.fontSize;if(j===0)return;const D=this.ctx,H=h.fontSizeScale,O=h.charSpacing,R=h.wordSpacing,M=h.fontDirection,e=h.textHScale*M,n=l.length,f=S.vertical,_=f?1:-1,E=S.defaultVMetrics,B=j*h.fontMatrix[0],et=h.textRenderingMode===b.TextRenderingMode.FILL&&!S.disableFontFace&&!h.patternFill;D.save(),D.transform(...h.textMatrix),D.translate(h.x,h.y+h.textRise),M>0?D.scale(e,-1):D.scale(e,1);let V;if(h.patternFill){D.save();const ut=h.fillColor.getPattern(D,this,(0,k.getCurrentTransformInverse)(D),X.PathType.FILL);V=(0,k.getCurrentTransform)(D),D.restore(),D.fillStyle=ut}let nt=h.lineWidth;const rt=h.textMatrixScale;if(rt===0||nt===0){const ut=h.textRenderingMode&b.TextRenderingMode.FILL_STROKE_MASK;(ut===b.TextRenderingMode.STROKE||ut===b.TextRenderingMode.FILL_STROKE)&&(nt=this.getSinglePixelWidth())}else nt/=rt;if(H!==1&&(D.scale(H,H),nt/=H),D.lineWidth=nt,S.isInvalidPDFjsFont){const ut=[];let ft=0;for(const Et of l)ut.push(Et.unicode),ft+=Et.width;D.fillText(ut.join(""),0,0),h.x+=ft*B*e,D.restore(),this.compose();return}let Z=0,it;for(it=0;it<n;++it){const ut=l[it];if(typeof ut=="number"){Z+=_*ut*j/1e3;continue}let ft=!1;const Et=(ut.isSpace?R:0)+O,_t=ut.fontChar,Ct=ut.accent;let G,bt,yt=ut.width;if(f){const ct=ut.vmetric||E,C=-(ut.vmetric?ct[1]:yt*.5)*B,F=ct[2]*B;yt=ct?-ct[0]:yt,G=C/H,bt=(Z+F)/H}else G=Z/H,bt=0;if(S.remeasure&&yt>0){const ct=D.measureText(_t).width*1e3/j*H;if(yt<ct&&this.isFontSubpixelAAEnabled){const C=yt/ct;ft=!0,D.save(),D.scale(C,1),G/=C}else yt!==ct&&(G+=(yt-ct)/2e3*j/H)}if(this.contentVisible&&(ut.isInFont||S.missingFile)){if(et&&!Ct)D.fillText(_t,G,bt);else if(this.paintChar(_t,G,bt,V),Ct){const ct=G+j*Ct.offset.x/H,C=bt-j*Ct.offset.y/H;this.paintChar(Ct.fontChar,ct,C,V)}}let Rt;f?Rt=yt*B-Et*M:Rt=yt*B+Et*M,Z+=Rt,ft&&D.restore()}f?h.y-=Z:h.x+=Z*e,D.restore(),this.compose()}showType3Text(l){const h=this.ctx,S=this.current,j=S.font,D=S.fontSize,H=S.fontDirection,O=j.vertical?1:-1,R=S.charSpacing,M=S.wordSpacing,e=S.textHScale*H,n=S.fontMatrix||b.FONT_IDENTITY_MATRIX,f=l.length,_=S.textRenderingMode===b.TextRenderingMode.INVISIBLE;let E,B,et,V;if(!(_||D===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,h.save(),h.transform(...S.textMatrix),h.translate(S.x,S.y),h.scale(e,H),E=0;E<f;++E){if(B=l[E],typeof B=="number"){V=O*B*D/1e3,this.ctx.translate(V,0),S.x+=V*e;continue}const nt=(B.isSpace?M:0)+R,rt=j.charProcOperatorList[B.operatorListId];if(!rt){(0,b.warn)(`Type3 character "${B.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=B,this.save(),h.scale(D,D),h.transform(...n),this.executeOperatorList(rt),this.restore()),et=b.Util.applyTransform([B.width,0],n)[0]*D+nt,h.translate(et,0),S.x+=et*e}h.restore(),this.processingType3=null}}setCharWidth(l,h){}setCharWidthAndBounds(l,h,S,j,D,H){this.ctx.rect(S,j,D-S,H-j),this.ctx.clip(),this.endPath()}getColorN_Pattern(l){let h;if(l[0]==="TilingPattern"){const S=l[1],j=this.baseTransform||(0,k.getCurrentTransform)(this.ctx),D={createCanvasGraphics:H=>new At(H,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};h=new X.TilingPattern(l,S,this.ctx,D,j)}else h=this._getPattern(l[1],l[2]);return h}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(l,h,S){const j=b.Util.makeHexColor(l,h,S);this.ctx.strokeStyle=j,this.current.strokeColor=j}setFillRGBColor(l,h,S){const j=b.Util.makeHexColor(l,h,S);this.ctx.fillStyle=j,this.current.fillColor=j,this.current.patternFill=!1}_getPattern(l,h=null){let S;return this.cachedPatterns.has(l)?S=this.cachedPatterns.get(l):(S=(0,X.getShadingPattern)(this.getObject(l)),this.cachedPatterns.set(l,S)),h&&(S.matrix=h),S}shadingFill(l){if(!this.contentVisible)return;const h=this.ctx;this.save();const S=this._getPattern(l);h.fillStyle=S.getPattern(h,this,(0,k.getCurrentTransformInverse)(h),X.PathType.SHADING);const j=(0,k.getCurrentTransformInverse)(h);if(j){const D=h.canvas,H=D.width,O=D.height,R=b.Util.applyTransform([0,0],j),M=b.Util.applyTransform([0,O],j),e=b.Util.applyTransform([H,0],j),n=b.Util.applyTransform([H,O],j),f=Math.min(R[0],M[0],e[0],n[0]),_=Math.min(R[1],M[1],e[1],n[1]),E=Math.max(R[0],M[0],e[0],n[0]),B=Math.max(R[1],M[1],e[1],n[1]);this.ctx.fillRect(f,_,E-f,B-_)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,b.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,b.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(l,h){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(l)&&l.length===6&&this.transform(...l),this.baseTransform=(0,k.getCurrentTransform)(this.ctx),h)){const S=h[2]-h[0],j=h[3]-h[1];this.ctx.rect(h[0],h[1],S,j),this.current.updateRectMinMax((0,k.getCurrentTransform)(this.ctx),h),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(l){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const h=this.ctx;l.isolated||(0,b.info)("TODO: Support non-isolated groups."),l.knockout&&(0,b.warn)("Knockout groups not supported.");const S=(0,k.getCurrentTransform)(h);if(l.matrix&&h.transform(...l.matrix),!l.bbox)throw new Error("Bounding box is required.");let j=b.Util.getAxialAlignedBoundingBox(l.bbox,(0,k.getCurrentTransform)(h));const D=[0,0,h.canvas.width,h.canvas.height];j=b.Util.intersect(j,D)||[0,0,0,0];const H=Math.floor(j[0]),O=Math.floor(j[1]);let R=Math.max(Math.ceil(j[2])-H,1),M=Math.max(Math.ceil(j[3])-O,1),e=1,n=1;R>v&&(e=R/v,R=v),M>v&&(n=M/v,M=v),this.current.startNewPathAndClipBox([0,0,R,M]);let f="groupAt"+this.groupLevel;l.smask&&(f+="_smask_"+this.smaskCounter++%2);const _=this.cachedCanvases.getCanvas(f,R,M),E=_.context;E.scale(1/e,1/n),E.translate(-H,-O),E.transform(...S),l.smask?this.smaskStack.push({canvas:_.canvas,context:E,offsetX:H,offsetY:O,scaleX:e,scaleY:n,subtype:l.smask.subtype,backdrop:l.smask.backdrop,transferMap:l.smask.transferMap||null,startTransformInverse:null}):(h.setTransform(1,0,0,1,0,0),h.translate(H,O),h.scale(e,n),h.save()),a(h,E),this.ctx=E,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(h),this.groupLevel++}endGroup(l){if(!this.contentVisible)return;this.groupLevel--;const h=this.ctx,S=this.groupStack.pop();if(this.ctx=S,this.ctx.imageSmoothingEnabled=!1,l.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const j=(0,k.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...j);const D=b.Util.getAxialAlignedBoundingBox([0,0,h.canvas.width,h.canvas.height],j);this.ctx.drawImage(h.canvas,0,0),this.ctx.restore(),this.compose(D)}}beginAnnotation(l,h,S,j,D){if(tt(this,ht,be).call(this),o(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(h)&&h.length===4){const H=h[2]-h[0],O=h[3]-h[1];if(D&&this.annotationCanvasMap){S=S.slice(),S[4]-=h[0],S[5]-=h[1],h=h.slice(),h[0]=h[1]=0,h[2]=H,h[3]=O;const[R,M]=b.Util.singularValueDecompose2dScale((0,k.getCurrentTransform)(this.ctx)),{viewportScale:e}=this,n=Math.ceil(H*this.outputScaleX*e),f=Math.ceil(O*this.outputScaleY*e);this.annotationCanvas=this.canvasFactory.create(n,f);const{canvas:_,context:E}=this.annotationCanvas;this.annotationCanvasMap.set(l,_),this.annotationCanvas.savedCtx=this.ctx,this.ctx=E,this.ctx.save(),this.ctx.setTransform(R,0,0,-M,0,O*M),o(this.ctx)}else o(this.ctx),this.ctx.rect(h[0],h[1],H,O),this.ctx.clip(),this.endPath()}this.current=new T(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...S),this.transform(...j)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),tt(this,vt,Ae).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(l){if(!this.contentVisible)return;const h=l.count;l=this.getObject(l.data,l),l.count=h;const S=this.ctx,j=this.processingType3;if(j&&(j.compiled===void 0&&(j.compiled=y(l)),j.compiled)){j.compiled(S);return}const D=this._createMaskCanvas(l),H=D.canvas;S.save(),S.setTransform(1,0,0,1,0,0),S.drawImage(H,D.offsetX,D.offsetY),S.restore(),this.compose()}paintImageMaskXObjectRepeat(l,h,S=0,j=0,D,H){if(!this.contentVisible)return;l=this.getObject(l.data,l);const O=this.ctx;O.save();const R=(0,k.getCurrentTransform)(O);O.transform(h,S,j,D,0,0);const M=this._createMaskCanvas(l);O.setTransform(1,0,0,1,M.offsetX-R[4],M.offsetY-R[5]);for(let e=0,n=H.length;e<n;e+=2){const f=b.Util.transform(R,[h,S,j,D,H[e],H[e+1]]),[_,E]=b.Util.applyTransform([0,0],f);O.drawImage(M.canvas,_,E)}O.restore(),this.compose()}paintImageMaskXObjectGroup(l){if(!this.contentVisible)return;const h=this.ctx,S=this.current.fillColor,j=this.current.patternFill;for(const D of l){const{data:H,width:O,height:R,transform:M}=D,e=this.cachedCanvases.getCanvas("maskCanvas",O,R),n=e.context;n.save();const f=this.getObject(H,D);t(n,f),n.globalCompositeOperation="source-in",n.fillStyle=j?S.getPattern(n,this,(0,k.getCurrentTransformInverse)(h),X.PathType.FILL):S,n.fillRect(0,0,O,R),n.restore(),h.save(),h.transform(...M),h.scale(1,-1),A(h,e.canvas,0,0,O,R,0,-1,1,1),h.restore()}this.compose()}paintImageXObject(l){if(!this.contentVisible)return;const h=this.getObject(l);if(!h){(0,b.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(h)}paintImageXObjectRepeat(l,h,S,j){if(!this.contentVisible)return;const D=this.getObject(l);if(!D){(0,b.warn)("Dependent image isn't ready yet");return}const H=D.width,O=D.height,R=[];for(let M=0,e=j.length;M<e;M+=2)R.push({transform:[h,0,0,S,j[M],j[M+1]],x:0,y:0,w:H,h:O});this.paintInlineImageXObjectGroup(D,R)}applyTransferMapsToCanvas(l){return this.current.transferMaps!=="none"&&(l.filter=this.current.transferMaps,l.drawImage(l.canvas,0,0),l.filter="none"),l.canvas}applyTransferMapsToBitmap(l){if(this.current.transferMaps==="none")return l.bitmap;const{bitmap:h,width:S,height:j}=l,D=this.cachedCanvases.getCanvas("inlineImage",S,j),H=D.context;return H.filter=this.current.transferMaps,H.drawImage(h,0,0),H.filter="none",D.canvas}paintInlineImageXObject(l){if(!this.contentVisible)return;const h=l.width,S=l.height,j=this.ctx;this.save(),ot.isNodeJS||(j.filter="none"),j.scale(1/h,-1/S);let D;if(l.bitmap)D=this.applyTransferMapsToBitmap(l);else if(typeof HTMLElement=="function"&&l instanceof HTMLElement||!l.data)D=l;else{const R=this.cachedCanvases.getCanvas("inlineImage",h,S).context;g(R,l),D=this.applyTransferMapsToCanvas(R)}const H=this._scaleImage(D,(0,k.getCurrentTransformInverse)(j));j.imageSmoothingEnabled=q((0,k.getCurrentTransform)(j),l.interpolate),A(j,H.img,0,0,H.paintWidth,H.paintHeight,0,-S,h,S),this.compose(),this.restore()}paintInlineImageXObjectGroup(l,h){if(!this.contentVisible)return;const S=this.ctx;let j;if(l.bitmap)j=l.bitmap;else{const D=l.width,H=l.height,R=this.cachedCanvases.getCanvas("inlineImage",D,H).context;g(R,l),j=this.applyTransferMapsToCanvas(R)}for(const D of h)S.save(),S.transform(...D.transform),S.scale(1,-1),A(S,j,D.x,D.y,D.w,D.h,0,-1,1,1),S.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(l){}markPointProps(l,h){}beginMarkedContent(l){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(l,h){l==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(h)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(l){const h=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(l);const S=this.ctx;this.pendingClip&&(h||(this.pendingClip===dt?S.clip("evenodd"):S.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),S.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const l=(0,k.getCurrentTransform)(this.ctx);if(l[1]===0&&l[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(l[0]),Math.abs(l[3]));else{const h=Math.abs(l[0]*l[3]-l[2]*l[1]),S=Math.hypot(l[0],l[2]),j=Math.hypot(l[1],l[3]);this._cachedGetSinglePixelWidth=Math.max(S,j)/h}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:l}=this.current,h=(0,k.getCurrentTransform)(this.ctx);let S,j;if(h[1]===0&&h[2]===0){const D=Math.abs(h[0]),H=Math.abs(h[3]);if(l===0)S=1/D,j=1/H;else{const O=D*l,R=H*l;S=O<1?1/O:1,j=R<1?1/R:1}}else{const D=Math.abs(h[0]*h[3]-h[2]*h[1]),H=Math.hypot(h[0],h[1]),O=Math.hypot(h[2],h[3]);if(l===0)S=O/D,j=H/D;else{const R=l*D;S=O>R?O/R:1,j=H>R?H/R:1}}this._cachedScaleForStroking=[S,j]}return this._cachedScaleForStroking}rescaleAndStroke(l){const{ctx:h}=this,{lineWidth:S}=this.current,[j,D]=this.getScaleForStroking();if(h.lineWidth=S||1,j===1&&D===1){h.stroke();return}let H,O,R;l&&(H=(0,k.getCurrentTransform)(h),O=h.getLineDash().slice(),R=h.lineDashOffset),h.scale(j,D);const M=Math.max(j,D);h.setLineDash(h.getLineDash().map(e=>e/M)),h.lineDashOffset/=M,h.stroke(),l&&(h.setTransform(...H),h.setLineDash(O),h.lineDashOffset=R)}isContentVisible(){for(let l=this.markedContentStack.length-1;l>=0;l--)if(!this.markedContentStack[l].visible)return!1;return!0}};ht=new WeakSet,be=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},vt=new WeakSet,Ae=function(){if(this.pageColors){const l=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(l!=="none"){const h=this.ctx.filter;this.ctx.filter=l,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=h}}};let lt=At;m.CanvasGraphics=lt;for(const U in b.OPS)lt.prototype[U]!==void 0&&(lt.prototype[b.OPS[U]]=lt.prototype[U])},(Q,m,Y)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.TilingPattern=m.PathType=void 0,m.getShadingPattern=x;var b=Y(1),k=Y(6);const X={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};m.PathType=X;function z(A,y){if(!y)return;const T=y[2]-y[0],g=y[3]-y[1],t=new Path2D;t.rect(y[0],y[1],T,g),A.clip(t)}class ot{constructor(){this.constructor===ot&&(0,b.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,b.unreachable)("Abstract method `getPattern` called.")}}class W extends ot{constructor(y){super(),this._type=y[1],this._bbox=y[2],this._colorStops=y[3],this._p0=y[4],this._p1=y[5],this._r0=y[6],this._r1=y[7],this.matrix=null}_createGradient(y){let T;this._type==="axial"?T=y.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(T=y.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const g of this._colorStops)T.addColorStop(g[0],g[1]);return T}getPattern(y,T,g,t){let a;if(t===X.STROKE||t===X.FILL){const o=T.current.getClippedPathBoundingBox(t,(0,k.getCurrentTransform)(y))||[0,0,0,0],s=Math.ceil(o[2]-o[0])||1,c=Math.ceil(o[3]-o[1])||1,P=T.cachedCanvases.getCanvas("pattern",s,c,!0),i=P.context;i.clearRect(0,0,i.canvas.width,i.canvas.height),i.beginPath(),i.rect(0,0,i.canvas.width,i.canvas.height),i.translate(-o[0],-o[1]),g=b.Util.transform(g,[1,0,0,1,o[0],o[1]]),i.transform(...T.baseTransform),this.matrix&&i.transform(...this.matrix),z(i,this._bbox),i.fillStyle=this._createGradient(i),i.fill(),a=y.createPattern(P.canvas,"no-repeat");const I=new DOMMatrix(g);a.setTransform(I)}else z(y,this._bbox),a=this._createGradient(y);return a}}function L(A,y,T,g,t,a,o,s){const c=y.coords,P=y.colors,i=A.data,I=A.width*4;let q;c[T+1]>c[g+1]&&(q=T,T=g,g=q,q=a,a=o,o=q),c[g+1]>c[t+1]&&(q=g,g=t,t=q,q=o,o=s,s=q),c[T+1]>c[g+1]&&(q=T,T=g,g=q,q=a,a=o,o=q);const $=(c[T]+y.offsetX)*y.scaleX,J=(c[T+1]+y.offsetY)*y.scaleY,st=(c[g]+y.offsetX)*y.scaleX,dt=(c[g+1]+y.offsetY)*y.scaleY,lt=(c[t]+y.offsetX)*y.scaleX,ht=(c[t+1]+y.offsetY)*y.scaleY;if(J>=ht)return;const mt=P[a],vt=P[a+1],St=P[a+2],At=P[o],U=P[o+1],l=P[o+2],h=P[s],S=P[s+1],j=P[s+2],D=Math.round(J),H=Math.round(ht);let O,R,M,e,n,f,_,E;for(let B=D;B<=H;B++){if(B<dt){let Z;B<J?Z=0:Z=(J-B)/(J-dt),O=$-($-st)*Z,R=mt-(mt-At)*Z,M=vt-(vt-U)*Z,e=St-(St-l)*Z}else{let Z;B>ht?Z=1:dt===ht?Z=0:Z=(dt-B)/(dt-ht),O=st-(st-lt)*Z,R=At-(At-h)*Z,M=U-(U-S)*Z,e=l-(l-j)*Z}let et;B<J?et=0:B>ht?et=1:et=(J-B)/(J-ht),n=$-($-lt)*et,f=mt-(mt-h)*et,_=vt-(vt-S)*et,E=St-(St-j)*et;const V=Math.round(Math.min(O,n)),nt=Math.round(Math.max(O,n));let rt=I*B+V*4;for(let Z=V;Z<=nt;Z++)et=(O-Z)/(O-n),et<0?et=0:et>1&&(et=1),i[rt++]=R-(R-f)*et|0,i[rt++]=M-(M-_)*et|0,i[rt++]=e-(e-E)*et|0,i[rt++]=255}}function v(A,y,T){const g=y.coords,t=y.colors;let a,o;switch(y.type){case"lattice":const s=y.verticesPerRow,c=Math.floor(g.length/s)-1,P=s-1;for(a=0;a<c;a++){let i=a*s;for(let I=0;I<P;I++,i++)L(A,T,g[i],g[i+1],g[i+s],t[i],t[i+1],t[i+s]),L(A,T,g[i+s+1],g[i+1],g[i+s],t[i+s+1],t[i+1],t[i+s])}break;case"triangles":for(a=0,o=g.length;a<o;a+=3)L(A,T,g[a],g[a+1],g[a+2],t[a],t[a+1],t[a+2]);break;default:throw new Error("illegal figure")}}class N extends ot{constructor(y){super(),this._coords=y[2],this._colors=y[3],this._figures=y[4],this._bounds=y[5],this._bbox=y[7],this._background=y[8],this.matrix=null}_createMeshCanvas(y,T,g){const s=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),P=Math.ceil(this._bounds[2])-s,i=Math.ceil(this._bounds[3])-c,I=Math.min(Math.ceil(Math.abs(P*y[0]*1.1)),3e3),q=Math.min(Math.ceil(Math.abs(i*y[1]*1.1)),3e3),$=P/I,J=i/q,st={coords:this._coords,colors:this._colors,offsetX:-s,offsetY:-c,scaleX:1/$,scaleY:1/J},dt=I+2*2,lt=q+2*2,ht=g.getCanvas("mesh",dt,lt,!1),mt=ht.context,vt=mt.createImageData(I,q);if(T){const At=vt.data;for(let U=0,l=At.length;U<l;U+=4)At[U]=T[0],At[U+1]=T[1],At[U+2]=T[2],At[U+3]=255}for(const At of this._figures)v(vt,At,st);return mt.putImageData(vt,2,2),{canvas:ht.canvas,offsetX:s-2*$,offsetY:c-2*J,scaleX:$,scaleY:J}}getPattern(y,T,g,t){z(y,this._bbox);let a;if(t===X.SHADING)a=b.Util.singularValueDecompose2dScale((0,k.getCurrentTransform)(y));else if(a=b.Util.singularValueDecompose2dScale(T.baseTransform),this.matrix){const s=b.Util.singularValueDecompose2dScale(this.matrix);a=[a[0]*s[0],a[1]*s[1]]}const o=this._createMeshCanvas(a,t===X.SHADING?null:this._background,T.cachedCanvases);return t!==X.SHADING&&(y.setTransform(...T.baseTransform),this.matrix&&y.transform(...this.matrix)),y.translate(o.offsetX,o.offsetY),y.scale(o.scaleX,o.scaleY),y.createPattern(o.canvas,"no-repeat")}}class w extends ot{getPattern(){return"hotpink"}}function x(A){switch(A[0]){case"RadialAxial":return new W(A);case"Mesh":return new N(A);case"Dummy":return new w}throw new Error(`Unknown IR type: ${A[0]}`)}const p={COLORED:1,UNCOLORED:2},r=class r{constructor(y,T,g,t,a){this.operatorList=y[2],this.matrix=y[3]||[1,0,0,1,0,0],this.bbox=y[4],this.xstep=y[5],this.ystep=y[6],this.paintType=y[7],this.tilingType=y[8],this.color=T,this.ctx=g,this.canvasGraphicsFactory=t,this.baseTransform=a}createPatternCanvas(y){const T=this.operatorList,g=this.bbox,t=this.xstep,a=this.ystep,o=this.paintType,s=this.tilingType,c=this.color,P=this.canvasGraphicsFactory;(0,b.info)("TilingType: "+s);const i=g[0],I=g[1],q=g[2],$=g[3],J=b.Util.singularValueDecompose2dScale(this.matrix),st=b.Util.singularValueDecompose2dScale(this.baseTransform),dt=[J[0]*st[0],J[1]*st[1]],lt=this.getSizeAndScale(t,this.ctx.canvas.width,dt[0]),ht=this.getSizeAndScale(a,this.ctx.canvas.height,dt[1]),mt=y.cachedCanvases.getCanvas("pattern",lt.size,ht.size,!0),vt=mt.context,St=P.createCanvasGraphics(vt);St.groupLevel=y.groupLevel,this.setFillAndStrokeStyleToContext(St,o,c);let At=i,U=I,l=q,h=$;return i<0&&(At=0,l+=Math.abs(i)),I<0&&(U=0,h+=Math.abs(I)),vt.translate(-(lt.scale*At),-(ht.scale*U)),St.transform(lt.scale,0,0,ht.scale,0,0),vt.save(),this.clipBbox(St,At,U,l,h),St.baseTransform=(0,k.getCurrentTransform)(St.ctx),St.executeOperatorList(T),St.endDrawing(),{canvas:mt.canvas,scaleX:lt.scale,scaleY:ht.scale,offsetX:At,offsetY:U}}getSizeAndScale(y,T,g){y=Math.abs(y);const t=Math.max(r.MAX_PATTERN_SIZE,T);let a=Math.ceil(y*g);return a>=t?a=t:g=a/y,{scale:g,size:a}}clipBbox(y,T,g,t,a){const o=t-T,s=a-g;y.ctx.rect(T,g,o,s),y.current.updateRectMinMax((0,k.getCurrentTransform)(y.ctx),[T,g,t,a]),y.clip(),y.endPath()}setFillAndStrokeStyleToContext(y,T,g){const t=y.ctx,a=y.current;switch(T){case p.COLORED:const o=this.ctx;t.fillStyle=o.fillStyle,t.strokeStyle=o.strokeStyle,a.fillColor=o.fillStyle,a.strokeColor=o.strokeStyle;break;case p.UNCOLORED:const s=b.Util.makeHexColor(g[0],g[1],g[2]);t.fillStyle=s,t.strokeStyle=s,a.fillColor=s,a.strokeColor=s;break;default:throw new b.FormatError(`Unsupported paint type: ${T}`)}}getPattern(y,T,g,t){let a=g;t!==X.SHADING&&(a=b.Util.transform(a,T.baseTransform),this.matrix&&(a=b.Util.transform(a,this.matrix)));const o=this.createPatternCanvas(T);let s=new DOMMatrix(a);s=s.translate(o.offsetX,o.offsetY),s=s.scale(1/o.scaleX,1/o.scaleY);const c=y.createPattern(o.canvas,"repeat");return c.setTransform(s),c}};Dt(r,"MAX_PATTERN_SIZE",3e3);let d=r;m.TilingPattern=d},(Q,m,Y)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.convertBlackAndWhiteToRGBA=X,m.convertToRGBA=k,m.grayToRGBA=ot;var b=Y(1);function k(W){switch(W.kind){case b.ImageKind.GRAYSCALE_1BPP:return X(W);case b.ImageKind.RGB_24BPP:return z(W)}return null}function X({src:W,srcPos:L=0,dest:v,width:N,height:w,nonBlackColor:x=4294967295,inverseDecode:p=!1}){const d=b.FeatureTest.isLittleEndian?4278190080:255,[r,A]=p?[x,d]:[d,x],y=N>>3,T=N&7,g=W.length;v=new Uint32Array(v.buffer);let t=0;for(let a=0;a<w;a++){for(const s=L+y;L<s;L++){const c=L<g?W[L]:255;v[t++]=c&128?A:r,v[t++]=c&64?A:r,v[t++]=c&32?A:r,v[t++]=c&16?A:r,v[t++]=c&8?A:r,v[t++]=c&4?A:r,v[t++]=c&2?A:r,v[t++]=c&1?A:r}if(T===0)continue;const o=L<g?W[L++]:255;for(let s=0;s<T;s++)v[t++]=o&1<<7-s?A:r}return{srcPos:L,destPos:t}}function z({src:W,srcPos:L=0,dest:v,destPos:N=0,width:w,height:x}){let p=0;const d=W.length>>2,r=new Uint32Array(W.buffer,L,d);if(b.FeatureTest.isLittleEndian){for(;p<d-2;p+=3,N+=4){const A=r[p],y=r[p+1],T=r[p+2];v[N]=A|4278190080,v[N+1]=A>>>24|y<<8|4278190080,v[N+2]=y>>>16|T<<16|4278190080,v[N+3]=T>>>8|4278190080}for(let A=p*4,y=W.length;A<y;A+=3)v[N++]=W[A]|W[A+1]<<8|W[A+2]<<16|4278190080}else{for(;p<d-2;p+=3,N+=4){const A=r[p],y=r[p+1],T=r[p+2];v[N]=A|255,v[N+1]=A<<24|y>>>8|255,v[N+2]=y<<16|T>>>16|255,v[N+3]=T<<8|255}for(let A=p*4,y=W.length;A<y;A+=3)v[N++]=W[A]<<24|W[A+1]<<16|W[A+2]<<8|255}return{srcPos:L,destPos:N}}function ot(W,L){if(b.FeatureTest.isLittleEndian)for(let v=0,N=W.length;v<N;v++)L[v]=W[v]*65793|4278190080;else for(let v=0,N=W.length;v<N;v++)L[v]=W[v]*16843008|255}},(Q,m)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.GlobalWorkerOptions=void 0;const Y=Object.create(null);m.GlobalWorkerOptions=Y,Y.workerPort=null,Y.workerSrc=""},(Q,m,Y)=>{var W,We,v,He,w,ae;Object.defineProperty(m,"__esModule",{value:!0}),m.MessageHandler=void 0;var b=Y(1);const k={UNKNOWN:0,DATA:1,ERROR:2},X={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function z(p){switch(p instanceof Error||typeof p=="object"&&p!==null||(0,b.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),p.name){case"AbortException":return new b.AbortException(p.message);case"MissingPDFException":return new b.MissingPDFException(p.message);case"PasswordException":return new b.PasswordException(p.message,p.code);case"UnexpectedResponseException":return new b.UnexpectedResponseException(p.message,p.status);case"UnknownErrorException":return new b.UnknownErrorException(p.message,p.details);default:return new b.UnknownErrorException(p.message,p.toString())}}class ot{constructor(d,r,A){K(this,W);K(this,v);K(this,w);this.sourceName=d,this.targetName=r,this.comObj=A,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=y=>{const T=y.data;if(T.targetName!==this.sourceName)return;if(T.stream){tt(this,v,He).call(this,T);return}if(T.callback){const t=T.callbackId,a=this.callbackCapabilities[t];if(!a)throw new Error(`Cannot resolve callback ${t}`);if(delete this.callbackCapabilities[t],T.callback===k.DATA)a.resolve(T.data);else if(T.callback===k.ERROR)a.reject(z(T.reason));else throw new Error("Unexpected callback case");return}const g=this.actionHandler[T.action];if(!g)throw new Error(`Unknown action from worker: ${T.action}`);if(T.callbackId){const t=this.sourceName,a=T.sourceName;new Promise(function(o){o(g(T.data))}).then(function(o){A.postMessage({sourceName:t,targetName:a,callback:k.DATA,callbackId:T.callbackId,data:o})},function(o){A.postMessage({sourceName:t,targetName:a,callback:k.ERROR,callbackId:T.callbackId,reason:z(o)})});return}if(T.streamId){tt(this,W,We).call(this,T);return}g(T.data)},A.addEventListener("message",this._onComObjOnMessage)}on(d,r){const A=this.actionHandler;if(A[d])throw new Error(`There is already an actionName called "${d}"`);A[d]=r}send(d,r,A){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:d,data:r},A)}sendWithPromise(d,r,A){const y=this.callbackId++,T=new b.PromiseCapability;this.callbackCapabilities[y]=T;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:d,callbackId:y,data:r},A)}catch(g){T.reject(g)}return T.promise}sendWithStream(d,r,A,y){const T=this.streamId++,g=this.sourceName,t=this.targetName,a=this.comObj;return new ReadableStream({start:o=>{const s=new b.PromiseCapability;return this.streamControllers[T]={controller:o,startCall:s,pullCall:null,cancelCall:null,isClosed:!1},a.postMessage({sourceName:g,targetName:t,action:d,streamId:T,data:r,desiredSize:o.desiredSize},y),s.promise},pull:o=>{const s=new b.PromiseCapability;return this.streamControllers[T].pullCall=s,a.postMessage({sourceName:g,targetName:t,stream:X.PULL,streamId:T,desiredSize:o.desiredSize}),s.promise},cancel:o=>{(0,b.assert)(o instanceof Error,"cancel must have a valid reason");const s=new b.PromiseCapability;return this.streamControllers[T].cancelCall=s,this.streamControllers[T].isClosed=!0,a.postMessage({sourceName:g,targetName:t,stream:X.CANCEL,streamId:T,reason:z(o)}),s.promise}},A)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}W=new WeakSet,We=function(d){const r=d.streamId,A=this.sourceName,y=d.sourceName,T=this.comObj,g=this,t=this.actionHandler[d.action],a={enqueue(o,s=1,c){if(this.isCancelled)return;const P=this.desiredSize;this.desiredSize-=s,P>0&&this.desiredSize<=0&&(this.sinkCapability=new b.PromiseCapability,this.ready=this.sinkCapability.promise),T.postMessage({sourceName:A,targetName:y,stream:X.ENQUEUE,streamId:r,chunk:o},c)},close(){this.isCancelled||(this.isCancelled=!0,T.postMessage({sourceName:A,targetName:y,stream:X.CLOSE,streamId:r}),delete g.streamSinks[r])},error(o){(0,b.assert)(o instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,T.postMessage({sourceName:A,targetName:y,stream:X.ERROR,streamId:r,reason:z(o)}))},sinkCapability:new b.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:d.desiredSize,ready:null};a.sinkCapability.resolve(),a.ready=a.sinkCapability.promise,this.streamSinks[r]=a,new Promise(function(o){o(t(d.data,a))}).then(function(){T.postMessage({sourceName:A,targetName:y,stream:X.START_COMPLETE,streamId:r,success:!0})},function(o){T.postMessage({sourceName:A,targetName:y,stream:X.START_COMPLETE,streamId:r,reason:z(o)})})},v=new WeakSet,He=function(d){const r=d.streamId,A=this.sourceName,y=d.sourceName,T=this.comObj,g=this.streamControllers[r],t=this.streamSinks[r];switch(d.stream){case X.START_COMPLETE:d.success?g.startCall.resolve():g.startCall.reject(z(d.reason));break;case X.PULL_COMPLETE:d.success?g.pullCall.resolve():g.pullCall.reject(z(d.reason));break;case X.PULL:if(!t){T.postMessage({sourceName:A,targetName:y,stream:X.PULL_COMPLETE,streamId:r,success:!0});break}t.desiredSize<=0&&d.desiredSize>0&&t.sinkCapability.resolve(),t.desiredSize=d.desiredSize,new Promise(function(a){var o;a((o=t.onPull)==null?void 0:o.call(t))}).then(function(){T.postMessage({sourceName:A,targetName:y,stream:X.PULL_COMPLETE,streamId:r,success:!0})},function(a){T.postMessage({sourceName:A,targetName:y,stream:X.PULL_COMPLETE,streamId:r,reason:z(a)})});break;case X.ENQUEUE:if((0,b.assert)(g,"enqueue should have stream controller"),g.isClosed)break;g.controller.enqueue(d.chunk);break;case X.CLOSE:if((0,b.assert)(g,"close should have stream controller"),g.isClosed)break;g.isClosed=!0,g.controller.close(),tt(this,w,ae).call(this,g,r);break;case X.ERROR:(0,b.assert)(g,"error should have stream controller"),g.controller.error(z(d.reason)),tt(this,w,ae).call(this,g,r);break;case X.CANCEL_COMPLETE:d.success?g.cancelCall.resolve():g.cancelCall.reject(z(d.reason)),tt(this,w,ae).call(this,g,r);break;case X.CANCEL:if(!t)break;new Promise(function(a){var o;a((o=t.onCancel)==null?void 0:o.call(t,z(d.reason)))}).then(function(){T.postMessage({sourceName:A,targetName:y,stream:X.CANCEL_COMPLETE,streamId:r,success:!0})},function(a){T.postMessage({sourceName:A,targetName:y,stream:X.CANCEL_COMPLETE,streamId:r,reason:z(a)})}),t.sinkCapability.reject(z(d.reason)),t.isCancelled=!0,delete this.streamSinks[r];break;default:throw new Error("Unexpected stream case")}},w=new WeakSet,ae=async function(d,r){var A,y,T;await Promise.allSettled([(A=d.startCall)==null?void 0:A.promise,(y=d.pullCall)==null?void 0:y.promise,(T=d.cancelCall)==null?void 0:T.promise]),delete this.streamControllers[r]},m.MessageHandler=ot},(Q,m,Y)=>{var X,z;Object.defineProperty(m,"__esModule",{value:!0}),m.Metadata=void 0;var b=Y(1);class k{constructor({parsedData:W,rawData:L}){K(this,X,void 0);K(this,z,void 0);pt(this,X,W),pt(this,z,L)}getRaw(){return u(this,z)}get(W){return u(this,X).get(W)??null}getAll(){return(0,b.objectFromMap)(u(this,X))}has(W){return u(this,X).has(W)}}X=new WeakMap,z=new WeakMap,m.Metadata=k},(Q,m,Y)=>{var W,L,v,N,w,x,_e;Object.defineProperty(m,"__esModule",{value:!0}),m.OptionalContentConfig=void 0;var b=Y(1),k=Y(8);const X=Symbol("INTERNAL");class z{constructor(r,A){K(this,W,!0);this.name=r,this.intent=A}get visible(){return u(this,W)}_setVisible(r,A){r!==X&&(0,b.unreachable)("Internal method `_setVisible` called."),pt(this,W,A)}}W=new WeakMap;class ot{constructor(r){K(this,x);K(this,L,null);K(this,v,new Map);K(this,N,null);K(this,w,null);if(this.name=null,this.creator=null,r!==null){this.name=r.name,this.creator=r.creator,pt(this,w,r.order);for(const A of r.groups)u(this,v).set(A.id,new z(A.name,A.intent));if(r.baseState==="OFF")for(const A of u(this,v).values())A._setVisible(X,!1);for(const A of r.on)u(this,v).get(A)._setVisible(X,!0);for(const A of r.off)u(this,v).get(A)._setVisible(X,!1);pt(this,N,this.getHash())}}isVisible(r){if(u(this,v).size===0)return!0;if(!r)return(0,b.warn)("Optional content group not defined."),!0;if(r.type==="OCG")return u(this,v).has(r.id)?u(this,v).get(r.id).visible:((0,b.warn)(`Optional content group not found: ${r.id}`),!0);if(r.type==="OCMD"){if(r.expression)return tt(this,x,_e).call(this,r.expression);if(!r.policy||r.policy==="AnyOn"){for(const A of r.ids){if(!u(this,v).has(A))return(0,b.warn)(`Optional content group not found: ${A}`),!0;if(u(this,v).get(A).visible)return!0}return!1}else if(r.policy==="AllOn"){for(const A of r.ids){if(!u(this,v).has(A))return(0,b.warn)(`Optional content group not found: ${A}`),!0;if(!u(this,v).get(A).visible)return!1}return!0}else if(r.policy==="AnyOff"){for(const A of r.ids){if(!u(this,v).has(A))return(0,b.warn)(`Optional content group not found: ${A}`),!0;if(!u(this,v).get(A).visible)return!0}return!1}else if(r.policy==="AllOff"){for(const A of r.ids){if(!u(this,v).has(A))return(0,b.warn)(`Optional content group not found: ${A}`),!0;if(u(this,v).get(A).visible)return!1}return!0}return(0,b.warn)(`Unknown optional content policy ${r.policy}.`),!0}return(0,b.warn)(`Unknown group type ${r.type}.`),!0}setVisibility(r,A=!0){if(!u(this,v).has(r)){(0,b.warn)(`Optional content group not found: ${r}`);return}u(this,v).get(r)._setVisible(X,!!A),pt(this,L,null)}get hasInitialVisibility(){return this.getHash()===u(this,N)}getOrder(){return u(this,v).size?u(this,w)?u(this,w).slice():[...u(this,v).keys()]:null}getGroups(){return u(this,v).size>0?(0,b.objectFromMap)(u(this,v)):null}getGroup(r){return u(this,v).get(r)||null}getHash(){if(u(this,L)!==null)return u(this,L);const r=new k.MurmurHash3_64;for(const[A,y]of u(this,v))r.update(`${A}:${y.visible}`);return pt(this,L,r.hexdigest())}}L=new WeakMap,v=new WeakMap,N=new WeakMap,w=new WeakMap,x=new WeakSet,_e=function(r){const A=r.length;if(A<2)return!0;const y=r[0];for(let T=1;T<A;T++){const g=r[T];let t;if(Array.isArray(g))t=tt(this,x,_e).call(this,g);else if(u(this,v).has(g))t=u(this,v).get(g).visible;else return(0,b.warn)(`Optional content group not found: ${g}`),!0;switch(y){case"And":if(!t)return!1;break;case"Or":if(t)return!0;break;case"Not":return!t;default:return!0}}return y==="And"},m.OptionalContentConfig=ot},(Q,m,Y)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.PDFDataTransportStream=void 0;var b=Y(1),k=Y(6);class X{constructor({length:L,initialData:v,progressiveDone:N=!1,contentDispositionFilename:w=null,disableRange:x=!1,disableStream:p=!1},d){if((0,b.assert)(d,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=N,this._contentDispositionFilename=w,(v==null?void 0:v.length)>0){const r=v instanceof Uint8Array&&v.byteLength===v.buffer.byteLength?v.buffer:new Uint8Array(v).buffer;this._queuedChunks.push(r)}this._pdfDataRangeTransport=d,this._isStreamingSupported=!p,this._isRangeSupported=!x,this._contentLength=L,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((r,A)=>{this._onReceiveData({begin:r,chunk:A})}),this._pdfDataRangeTransport.addProgressListener((r,A)=>{this._onProgress({loaded:r,total:A})}),this._pdfDataRangeTransport.addProgressiveReadListener(r=>{this._onReceiveData({chunk:r})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:L,chunk:v}){const N=v instanceof Uint8Array&&v.byteLength===v.buffer.byteLength?v.buffer:new Uint8Array(v).buffer;if(L===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(N):this._queuedChunks.push(N);else{const w=this._rangeReaders.some(function(x){return x._begin!==L?!1:(x._enqueue(N),!0)});(0,b.assert)(w,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var L;return((L=this._fullRequestReader)==null?void 0:L._loaded)??0}_onProgress(L){var v,N,w,x;L.total===void 0?(N=(v=this._rangeReaders[0])==null?void 0:v.onProgress)==null||N.call(v,{loaded:L.loaded}):(x=(w=this._fullRequestReader)==null?void 0:w.onProgress)==null||x.call(w,{loaded:L.loaded,total:L.total})}_onProgressiveDone(){var L;(L=this._fullRequestReader)==null||L.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(L){const v=this._rangeReaders.indexOf(L);v>=0&&this._rangeReaders.splice(v,1)}getFullReader(){(0,b.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const L=this._queuedChunks;return this._queuedChunks=null,new z(this,L,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(L,v){if(v<=this._progressiveDataLength)return null;const N=new ot(this,L,v);return this._pdfDataRangeTransport.requestDataRange(L,v),this._rangeReaders.push(N),N}cancelAllRequests(L){var v;(v=this._fullRequestReader)==null||v.cancel(L);for(const N of this._rangeReaders.slice(0))N.cancel(L);this._pdfDataRangeTransport.abort()}}m.PDFDataTransportStream=X;class z{constructor(L,v,N=!1,w=null){this._stream=L,this._done=N||!1,this._filename=(0,k.isPdfFile)(w)?w:null,this._queuedChunks=v||[],this._loaded=0;for(const x of this._queuedChunks)this._loaded+=x.byteLength;this._requests=[],this._headersReady=Promise.resolve(),L._fullRequestReader=this,this.onProgress=null}_enqueue(L){this._done||(this._requests.length>0?this._requests.shift().resolve({value:L,done:!1}):this._queuedChunks.push(L),this._loaded+=L.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const L=new b.PromiseCapability;return this._requests.push(L),L.promise}cancel(L){this._done=!0;for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class ot{constructor(L,v,N){this._stream=L,this._begin=v,this._end=N,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(L){if(!this._done){if(this._requests.length===0)this._queuedChunk=L;else{this._requests.shift().resolve({value:L,done:!1});for(const N of this._requests)N.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const v=this._queuedChunk;return this._queuedChunk=null,{value:v,done:!1}}if(this._done)return{value:void 0,done:!0};const L=new b.PromiseCapability;return this._requests.push(L),L.promise}cancel(L){this._done=!0;for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(Q,m)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.XfaText=void 0;class Y{static textContent(k){const X=[],z={items:X,styles:Object.create(null)};function ot(W){var N;if(!W)return;let L=null;const v=W.name;if(v==="#text")L=W.value;else if(Y.shouldBuildText(v))(N=W==null?void 0:W.attributes)!=null&&N.textContent?L=W.attributes.textContent:W.value&&(L=W.value);else return;if(L!==null&&X.push({str:L}),!!W.children)for(const w of W.children)ot(w)}return ot(k),z}static shouldBuildText(k){return!(k==="textarea"||k==="input"||k==="option"||k==="select")}}m.XfaText=Y},(Q,m,Y)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.NodeStandardFontDataFactory=m.NodeFilterFactory=m.NodeCanvasFactory=m.NodeCMapReaderFactory=void 0;var b=Y(7);const k=function(L){return new Promise((v,N)=>{require$$5.readFile(L,(x,p)=>{if(x||!p){N(new Error(x));return}v(new Uint8Array(p))})})};class X extends b.BaseFilterFactory{}m.NodeFilterFactory=X;class z extends b.BaseCanvasFactory{_createCanvas(v,N){return require$$5.createCanvas(v,N)}}m.NodeCanvasFactory=z;class ot extends b.BaseCMapReaderFactory{_fetchData(v,N){return k(v).then(w=>({cMapData:w,compressionType:N}))}}m.NodeCMapReaderFactory=ot;class W extends b.BaseStandardFontDataFactory{_fetchData(v){return k(v)}}m.NodeStandardFontDataFactory=W},(Q,m,Y)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.PDFNodeStream=void 0;var b=Y(1),k=Y(22);const X=require$$5,z=require$$5,ot=require$$5,W=require$$5,L=/^file:\/\/\/[a-zA-Z]:\//;function v(T){const g=W.parse(T);return g.protocol==="file:"||g.host?g:/^[a-z]:[/\\]/i.test(T)?W.parse(`file:///${T}`):(g.host||(g.protocol="file:"),g)}class N{constructor(g){this.source=g,this.url=v(g.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&g.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var g;return((g=this._fullRequestReader)==null?void 0:g._loaded)??0}getFullReader(){return(0,b.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new A(this):new d(this),this._fullRequestReader}getRangeReader(g,t){if(t<=this._progressiveDataLength)return null;const a=this.isFsUrl?new y(this,g,t):new r(this,g,t);return this._rangeRequestReaders.push(a),a}cancelAllRequests(g){var t;(t=this._fullRequestReader)==null||t.cancel(g);for(const a of this._rangeRequestReaders.slice(0))a.cancel(g)}}m.PDFNodeStream=N;class w{constructor(g){this._url=g.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=g.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=new b.PromiseCapability,this._headersCapability=new b.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var a;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const g=this._readableStream.read();return g===null?(this._readCapability=new b.PromiseCapability,this.read()):(this._loaded+=g.length,(a=this.onProgress)==null||a.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(g).buffer,done:!1})}cancel(g){if(!this._readableStream){this._error(g);return}this._readableStream.destroy(g)}_error(g){this._storedError=g,this._readCapability.resolve()}_setReadableStream(g){this._readableStream=g,g.on("readable",()=>{this._readCapability.resolve()}),g.on("end",()=>{g.destroy(),this._done=!0,this._readCapability.resolve()}),g.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new b.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class x{constructor(g){this._url=g.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new b.PromiseCapability;const t=g.source;this._isStreamingSupported=!t.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var a;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const g=this._readableStream.read();return g===null?(this._readCapability=new b.PromiseCapability,this.read()):(this._loaded+=g.length,(a=this.onProgress)==null||a.call(this,{loaded:this._loaded}),{value:new Uint8Array(g).buffer,done:!1})}cancel(g){if(!this._readableStream){this._error(g);return}this._readableStream.destroy(g)}_error(g){this._storedError=g,this._readCapability.resolve()}_setReadableStream(g){this._readableStream=g,g.on("readable",()=>{this._readCapability.resolve()}),g.on("end",()=>{g.destroy(),this._done=!0,this._readCapability.resolve()}),g.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function p(T,g){return{protocol:T.protocol,auth:T.auth,host:T.hostname,port:T.port,path:T.path,method:"GET",headers:g}}class d extends w{constructor(g){super(g);const t=a=>{if(a.statusCode===404){const P=new b.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=P,this._headersCapability.reject(P);return}this._headersCapability.resolve(),this._setReadableStream(a);const o=P=>this._readableStream.headers[P.toLowerCase()],{allowRangeRequests:s,suggestedLength:c}=(0,k.validateRangeRequestCapabilities)({getResponseHeader:o,isHttp:g.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=s,this._contentLength=c||this._contentLength,this._filename=(0,k.extractFilenameFromHeader)(o)};this._request=null,this._url.protocol==="http:"?this._request=z.request(p(this._url,g.httpHeaders),t):this._request=ot.request(p(this._url,g.httpHeaders),t),this._request.on("error",a=>{this._storedError=a,this._headersCapability.reject(a)}),this._request.end()}}class r extends x{constructor(g,t,a){super(g),this._httpHeaders={};for(const s in g.httpHeaders){const c=g.httpHeaders[s];c!==void 0&&(this._httpHeaders[s]=c)}this._httpHeaders.Range=`bytes=${t}-${a-1}`;const o=s=>{if(s.statusCode===404){const c=new b.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=c;return}this._setReadableStream(s)};this._request=null,this._url.protocol==="http:"?this._request=z.request(p(this._url,this._httpHeaders),o):this._request=ot.request(p(this._url,this._httpHeaders),o),this._request.on("error",s=>{this._storedError=s}),this._request.end()}}class A extends w{constructor(g){super(g);let t=decodeURIComponent(this._url.path);L.test(this._url.href)&&(t=t.replace(/^\//,"")),X.lstat(t,(a,o)=>{if(a){a.code==="ENOENT"&&(a=new b.MissingPDFException(`Missing PDF "${t}".`)),this._storedError=a,this._headersCapability.reject(a);return}this._contentLength=o.size,this._setReadableStream(X.createReadStream(t)),this._headersCapability.resolve()})}}class y extends x{constructor(g,t,a){super(g);let o=decodeURIComponent(this._url.path);L.test(this._url.href)&&(o=o.replace(/^\//,"")),this._setReadableStream(X.createReadStream(o,{start:t,end:a-1}))}}},(Q,m,Y)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.createResponseStatusError=W,m.extractFilenameFromHeader=ot,m.validateRangeRequestCapabilities=z,m.validateResponseStatus=L;var b=Y(1),k=Y(23),X=Y(6);function z({getResponseHeader:v,isHttp:N,rangeChunkSize:w,disableRange:x}){const p={allowRangeRequests:!1,suggestedLength:void 0},d=parseInt(v("Content-Length"),10);return!Number.isInteger(d)||(p.suggestedLength=d,d<=2*w)||x||!N||v("Accept-Ranges")!=="bytes"||(v("Content-Encoding")||"identity")!=="identity"||(p.allowRangeRequests=!0),p}function ot(v){const N=v("Content-Disposition");if(N){let w=(0,k.getFilenameFromContentDispositionHeader)(N);if(w.includes("%"))try{w=decodeURIComponent(w)}catch{}if((0,X.isPdfFile)(w))return w}return null}function W(v,N){return v===404||v===0&&N.startsWith("file:")?new b.MissingPDFException('Missing PDF "'+N+'".'):new b.UnexpectedResponseException(`Unexpected server response (${v}) while retrieving PDF "${N}".`,v)}function L(v){return v===200||v===206}},(Q,m,Y)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.getFilenameFromContentDispositionHeader=k;var b=Y(1);function k(X){let z=!0,ot=W("filename\\*","i").exec(X);if(ot){ot=ot[1];let d=w(ot);return d=unescape(d),d=x(d),d=p(d),v(d)}if(ot=N(X),ot){const d=p(ot);return v(d)}if(ot=W("filename","i").exec(X),ot){ot=ot[1];let d=w(ot);return d=p(d),v(d)}function W(d,r){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',r)}function L(d,r){if(d){if(!/^[\x00-\xFF]+$/.test(r))return r;try{const A=new TextDecoder(d,{fatal:!0}),y=(0,b.stringToBytes)(r);r=A.decode(y),z=!1}catch{}}return r}function v(d){return z&&/[\x80-\xff]/.test(d)&&(d=L("utf-8",d),z&&(d=L("iso-8859-1",d))),d}function N(d){const r=[];let A;const y=W("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(A=y.exec(d))!==null;){let[,g,t,a]=A;if(g=parseInt(g,10),g in r){if(g===0)break;continue}r[g]=[t,a]}const T=[];for(let g=0;g<r.length&&g in r;++g){let[t,a]=r[g];a=w(a),t&&(a=unescape(a),g===0&&(a=x(a))),T.push(a)}return T.join("")}function w(d){if(d.startsWith('"')){const r=d.slice(1).split('\\"');for(let A=0;A<r.length;++A){const y=r[A].indexOf('"');y!==-1&&(r[A]=r[A].slice(0,y),r.length=A+1),r[A]=r[A].replaceAll(/\\(.)/g,"$1")}d=r.join('"')}return d}function x(d){const r=d.indexOf("'");if(r===-1)return d;const A=d.slice(0,r),T=d.slice(r+1).replace(/^[^']*'/,"");return L(A,T)}function p(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(r,A,y,T){if(y==="q"||y==="Q")return T=T.replaceAll("_"," "),T=T.replaceAll(/=([0-9a-fA-F]{2})/g,function(g,t){return String.fromCharCode(parseInt(t,16))}),L(A,T);try{T=atob(T)}catch{}return L(A,T)})}return""}},(Q,m,Y)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.PDFNetworkStream=void 0;var b=Y(1),k=Y(22);const X=200,z=206;function ot(w){const x=w.response;return typeof x!="string"?x:(0,b.stringToBytes)(x).buffer}class W{constructor(x,p={}){this.url=x,this.isHttp=/^https?:/i.test(x),this.httpHeaders=this.isHttp&&p.httpHeaders||Object.create(null),this.withCredentials=p.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(x,p,d){const r={begin:x,end:p};for(const A in d)r[A]=d[A];return this.request(r)}requestFull(x){return this.request(x)}request(x){const p=new XMLHttpRequest,d=this.currXhrId++,r=this.pendingRequests[d]={xhr:p};p.open("GET",this.url),p.withCredentials=this.withCredentials;for(const A in this.httpHeaders){const y=this.httpHeaders[A];y!==void 0&&p.setRequestHeader(A,y)}return this.isHttp&&"begin"in x&&"end"in x?(p.setRequestHeader("Range",`bytes=${x.begin}-${x.end-1}`),r.expectedStatus=z):r.expectedStatus=X,p.responseType="arraybuffer",x.onError&&(p.onerror=function(A){x.onError(p.status)}),p.onreadystatechange=this.onStateChange.bind(this,d),p.onprogress=this.onProgress.bind(this,d),r.onHeadersReceived=x.onHeadersReceived,r.onDone=x.onDone,r.onError=x.onError,r.onProgress=x.onProgress,p.send(null),d}onProgress(x,p){var r;const d=this.pendingRequests[x];d&&((r=d.onProgress)==null||r.call(d,p))}onStateChange(x,p){var g,t,a;const d=this.pendingRequests[x];if(!d)return;const r=d.xhr;if(r.readyState>=2&&d.onHeadersReceived&&(d.onHeadersReceived(),delete d.onHeadersReceived),r.readyState!==4||!(x in this.pendingRequests))return;if(delete this.pendingRequests[x],r.status===0&&this.isHttp){(g=d.onError)==null||g.call(d,r.status);return}const A=r.status||X;if(!(A===X&&d.expectedStatus===z)&&A!==d.expectedStatus){(t=d.onError)==null||t.call(d,r.status);return}const T=ot(r);if(A===z){const o=r.getResponseHeader("Content-Range"),s=/bytes (\d+)-(\d+)\/(\d+)/.exec(o);d.onDone({begin:parseInt(s[1],10),chunk:T})}else T?d.onDone({begin:0,chunk:T}):(a=d.onError)==null||a.call(d,r.status)}getRequestXhr(x){return this.pendingRequests[x].xhr}isPendingRequest(x){return x in this.pendingRequests}abortRequest(x){const p=this.pendingRequests[x].xhr;delete this.pendingRequests[x],p.abort()}}class L{constructor(x){this._source=x,this._manager=new W(x.url,{httpHeaders:x.httpHeaders,withCredentials:x.withCredentials}),this._rangeChunkSize=x.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(x){const p=this._rangeRequestReaders.indexOf(x);p>=0&&this._rangeRequestReaders.splice(p,1)}getFullReader(){return(0,b.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new v(this._manager,this._source),this._fullRequestReader}getRangeReader(x,p){const d=new N(this._manager,x,p);return d.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(d),d}cancelAllRequests(x){var p;(p=this._fullRequestReader)==null||p.cancel(x);for(const d of this._rangeRequestReaders.slice(0))d.cancel(x)}}m.PDFNetworkStream=L;class v{constructor(x,p){this._manager=x;const d={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=p.url,this._fullRequestId=x.requestFull(d),this._headersReceivedCapability=new b.PromiseCapability,this._disableRange=p.disableRange||!1,this._contentLength=p.length,this._rangeChunkSize=p.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const x=this._fullRequestId,p=this._manager.getRequestXhr(x),d=y=>p.getResponseHeader(y),{allowRangeRequests:r,suggestedLength:A}=(0,k.validateRangeRequestCapabilities)({getResponseHeader:d,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=A||this._contentLength,this._filename=(0,k.extractFilenameFromHeader)(d),this._isRangeSupported&&this._manager.abortRequest(x),this._headersReceivedCapability.resolve()}_onDone(x){if(x&&(this._requests.length>0?this._requests.shift().resolve({value:x.chunk,done:!1}):this._cachedChunks.push(x.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(x){this._storedError=(0,k.createResponseStatusError)(x,this._url),this._headersReceivedCapability.reject(this._storedError);for(const p of this._requests)p.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(x){var p;(p=this.onProgress)==null||p.call(this,{loaded:x.loaded,total:x.lengthComputable?x.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const x=new b.PromiseCapability;return this._requests.push(x),x.promise}cancel(x){this._done=!0,this._headersReceivedCapability.reject(x);for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class N{constructor(x,p,d){this._manager=x;const r={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=x.url,this._requestId=x.requestRange(p,d,r),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var x;(x=this.onClosed)==null||x.call(this,this)}_onDone(x){const p=x.chunk;this._requests.length>0?this._requests.shift().resolve({value:p,done:!1}):this._queuedChunk=p,this._done=!0;for(const d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(x){this._storedError=(0,k.createResponseStatusError)(x,this._url);for(const p of this._requests)p.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(x){var p;this.isStreamingSupported||(p=this.onProgress)==null||p.call(this,{loaded:x.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const p=this._queuedChunk;return this._queuedChunk=null,{value:p,done:!1}}if(this._done)return{value:void 0,done:!0};const x=new b.PromiseCapability;return this._requests.push(x),x.promise}cancel(x){this._done=!0;for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(Q,m,Y)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.PDFFetchStream=void 0;var b=Y(1),k=Y(22);function X(N,w,x){return{method:"GET",headers:N,signal:x.signal,mode:"cors",credentials:w?"include":"same-origin",redirect:"follow"}}function z(N){const w=new Headers;for(const x in N){const p=N[x];p!==void 0&&w.append(x,p)}return w}function ot(N){return N instanceof Uint8Array?N.buffer:N instanceof ArrayBuffer?N:((0,b.warn)(`getArrayBuffer - unexpected data format: ${N}`),new Uint8Array(N).buffer)}class W{constructor(w){this.source=w,this.isHttp=/^https?:/i.test(w.url),this.httpHeaders=this.isHttp&&w.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var w;return((w=this._fullRequestReader)==null?void 0:w._loaded)??0}getFullReader(){return(0,b.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new L(this),this._fullRequestReader}getRangeReader(w,x){if(x<=this._progressiveDataLength)return null;const p=new v(this,w,x);return this._rangeRequestReaders.push(p),p}cancelAllRequests(w){var x;(x=this._fullRequestReader)==null||x.cancel(w);for(const p of this._rangeRequestReaders.slice(0))p.cancel(w)}}m.PDFFetchStream=W;class L{constructor(w){this._stream=w,this._reader=null,this._loaded=0,this._filename=null;const x=w.source;this._withCredentials=x.withCredentials||!1,this._contentLength=x.length,this._headersCapability=new b.PromiseCapability,this._disableRange=x.disableRange||!1,this._rangeChunkSize=x.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!x.disableStream,this._isRangeSupported=!x.disableRange,this._headers=z(this._stream.httpHeaders);const p=x.url;fetch(p,X(this._headers,this._withCredentials,this._abortController)).then(d=>{if(!(0,k.validateResponseStatus)(d.status))throw(0,k.createResponseStatusError)(d.status,p);this._reader=d.body.getReader(),this._headersCapability.resolve();const r=T=>d.headers.get(T),{allowRangeRequests:A,suggestedLength:y}=(0,k.validateRangeRequestCapabilities)({getResponseHeader:r,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=A,this._contentLength=y||this._contentLength,this._filename=(0,k.extractFilenameFromHeader)(r),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new b.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var p;await this._headersCapability.promise;const{value:w,done:x}=await this._reader.read();return x?{value:w,done:x}:(this._loaded+=w.byteLength,(p=this.onProgress)==null||p.call(this,{loaded:this._loaded,total:this._contentLength}),{value:ot(w),done:!1})}cancel(w){var x;(x=this._reader)==null||x.cancel(w),this._abortController.abort()}}class v{constructor(w,x,p){this._stream=w,this._reader=null,this._loaded=0;const d=w.source;this._withCredentials=d.withCredentials||!1,this._readCapability=new b.PromiseCapability,this._isStreamingSupported=!d.disableStream,this._abortController=new AbortController,this._headers=z(this._stream.httpHeaders),this._headers.append("Range",`bytes=${x}-${p-1}`);const r=d.url;fetch(r,X(this._headers,this._withCredentials,this._abortController)).then(A=>{if(!(0,k.validateResponseStatus)(A.status))throw(0,k.createResponseStatusError)(A.status,r);this._readCapability.resolve(),this._reader=A.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var p;await this._readCapability.promise;const{value:w,done:x}=await this._reader.read();return x?{value:w,done:x}:(this._loaded+=w.byteLength,(p=this.onProgress)==null||p.call(this,{loaded:this._loaded}),{value:ot(w),done:!1})}cancel(w){var x;(x=this._reader)==null||x.cancel(w),this._abortController.abort()}}},(Q,m,Y)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.TextLayerRenderTask=void 0,m.renderTextLayer=d,m.updateTextLayer=r;var b=Y(1),k=Y(6);const X=1e5,z=30,ot=.8,W=new Map;function L(A,y){let T;if(y&&b.FeatureTest.isOffscreenCanvasSupported)T=new OffscreenCanvas(A,A).getContext("2d",{alpha:!1});else{const g=document.createElement("canvas");g.width=g.height=A,T=g.getContext("2d",{alpha:!1})}return T}function v(A,y){const T=W.get(A);if(T)return T;const g=L(z,y);g.font=`${z}px ${A}`;const t=g.measureText("");let a=t.fontBoundingBoxAscent,o=Math.abs(t.fontBoundingBoxDescent);if(a){const c=a/(a+o);return W.set(A,c),g.canvas.width=g.canvas.height=0,c}g.strokeStyle="red",g.clearRect(0,0,z,z),g.strokeText("g",0,0);let s=g.getImageData(0,0,z,z).data;o=0;for(let c=s.length-1-3;c>=0;c-=4)if(s[c]>0){o=Math.ceil(c/4/z);break}g.clearRect(0,0,z,z),g.strokeText("A",0,z),s=g.getImageData(0,0,z,z).data,a=0;for(let c=0,P=s.length;c<P;c+=4)if(s[c]>0){a=z-Math.floor(c/4/z);break}if(g.canvas.width=g.canvas.height=0,a){const c=a/(a+o);return W.set(A,c),c}return W.set(A,ot),ot}function N(A,y,T){const g=document.createElement("span"),t={angle:0,canvasWidth:0,hasText:y.str!=="",hasEOL:y.hasEOL,fontSize:0};A._textDivs.push(g);const a=b.Util.transform(A._transform,y.transform);let o=Math.atan2(a[1],a[0]);const s=T[y.fontName];s.vertical&&(o+=Math.PI/2);const c=Math.hypot(a[2],a[3]),P=c*v(s.fontFamily,A._isOffscreenCanvasSupported);let i,I;o===0?(i=a[4],I=a[5]-P):(i=a[4]+P*Math.sin(o),I=a[5]-P*Math.cos(o));const q="calc(var(--scale-factor)*",$=g.style;A._container===A._rootContainer?($.left=`${(100*i/A._pageWidth).toFixed(2)}%`,$.top=`${(100*I/A._pageHeight).toFixed(2)}%`):($.left=`${q}${i.toFixed(2)}px)`,$.top=`${q}${I.toFixed(2)}px)`),$.fontSize=`${q}${c.toFixed(2)}px)`,$.fontFamily=s.fontFamily,t.fontSize=c,g.setAttribute("role","presentation"),g.textContent=y.str,g.dir=y.dir,A._fontInspectorEnabled&&(g.dataset.fontName=y.fontName),o!==0&&(t.angle=o*(180/Math.PI));let J=!1;if(y.str.length>1)J=!0;else if(y.str!==" "&&y.transform[0]!==y.transform[3]){const st=Math.abs(y.transform[0]),dt=Math.abs(y.transform[3]);st!==dt&&Math.max(st,dt)/Math.min(st,dt)>1.5&&(J=!0)}J&&(t.canvasWidth=s.vertical?y.height:y.width),A._textDivProperties.set(g,t),A._isReadableStream&&A._layoutText(g)}function w(A){const{div:y,scale:T,properties:g,ctx:t,prevFontSize:a,prevFontFamily:o}=A,{style:s}=y;let c="";if(g.canvasWidth!==0&&g.hasText){const{fontFamily:P}=s,{canvasWidth:i,fontSize:I}=g;(a!==I||o!==P)&&(t.font=`${I*T}px ${P}`,A.prevFontSize=I,A.prevFontFamily=P);const{width:q}=t.measureText(y.textContent);q>0&&(c=`scaleX(${i*T/q})`)}g.angle!==0&&(c=`rotate(${g.angle}deg) ${c}`),c.length>0&&(s.transform=c)}function x(A){if(A._canceled)return;const y=A._textDivs,T=A._capability;if(y.length>X){T.resolve();return}if(!A._isReadableStream)for(const t of y)A._layoutText(t);T.resolve()}class p{constructor({textContentSource:y,container:T,viewport:g,textDivs:t,textDivProperties:a,textContentItemsStr:o,isOffscreenCanvasSupported:s}){var q;this._textContentSource=y,this._isReadableStream=y instanceof ReadableStream,this._container=this._rootContainer=T,this._textDivs=t||[],this._textContentItemsStr=o||[],this._isOffscreenCanvasSupported=s,this._fontInspectorEnabled=!!((q=globalThis.FontInspector)!=null&&q.enabled),this._reader=null,this._textDivProperties=a||new WeakMap,this._canceled=!1,this._capability=new b.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:g.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:L(0,s)};const{pageWidth:c,pageHeight:P,pageX:i,pageY:I}=g.rawDims;this._transform=[1,0,0,-1,-i,I+P],this._pageWidth=c,this._pageHeight=P,(0,k.setLayerDimensions)(T,g),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new b.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new b.AbortException("TextLayer task cancelled."))}_processItems(y,T){for(const g of y){if(g.str===void 0){if(g.type==="beginMarkedContentProps"||g.type==="beginMarkedContent"){const t=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),g.id!==null&&this._container.setAttribute("id",`${g.id}`),t.append(this._container)}else g.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(g.str),N(this,g,T)}}_layoutText(y){const T=this._layoutTextParams.properties=this._textDivProperties.get(y);if(this._layoutTextParams.div=y,w(this._layoutTextParams),T.hasText&&this._container.append(y),T.hasEOL){const g=document.createElement("br");g.setAttribute("role","presentation"),this._container.append(g)}}_render(){const y=new b.PromiseCapability;let T=Object.create(null);if(this._isReadableStream){const g=()=>{this._reader.read().then(({value:t,done:a})=>{if(a){y.resolve();return}Object.assign(T,t.styles),this._processItems(t.items,T),g()},y.reject)};this._reader=this._textContentSource.getReader(),g()}else if(this._textContentSource){const{items:g,styles:t}=this._textContentSource;this._processItems(g,t),y.resolve()}else throw new Error('No "textContentSource" parameter specified.');y.promise.then(()=>{T=null,x(this)},this._capability.reject)}}m.TextLayerRenderTask=p;function d(A){!A.textContentSource&&(A.textContent||A.textContentStream)&&((0,k.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),A.textContentSource=A.textContent||A.textContentStream);const{container:y,viewport:T}=A,g=getComputedStyle(y),t=g.getPropertyValue("visibility"),a=parseFloat(g.getPropertyValue("--scale-factor"));t==="visible"&&(!a||Math.abs(a-T.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const o=new p(A);return o._render(),o}function r({container:A,viewport:y,textDivs:T,textDivProperties:g,isOffscreenCanvasSupported:t,mustRotate:a=!0,mustRescale:o=!0}){if(a&&(0,k.setLayerDimensions)(A,{rotation:y.rotation}),o){const s=L(0,t),P={prevFontSize:null,prevFontFamily:null,div:null,scale:y.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:s};for(const i of T)P.properties=g.get(i),P.div=i,w(P)}}},(Q,m,Y)=>{var L,v,N,w,x,p,d,r,A,ye,T,qe,t,ve,o,Se;Object.defineProperty(m,"__esModule",{value:!0}),m.AnnotationEditorLayer=void 0;var b=Y(1),k=Y(5),X=Y(28),z=Y(29),ot=Y(6);const c=class c{constructor(i){K(this,A);K(this,T);K(this,t);K(this,o);K(this,L,void 0);K(this,v,!1);K(this,N,this.pointerup.bind(this));K(this,w,this.pointerdown.bind(this));K(this,x,new Map);K(this,p,!1);K(this,d,!1);K(this,r,void 0);c._initialized||(c._initialized=!0,X.FreeTextEditor.initialize(i.l10n),z.InkEditor.initialize(i.l10n)),i.uiManager.registerEditorTypes([X.FreeTextEditor,z.InkEditor]),pt(this,r,i.uiManager),this.pageIndex=i.pageIndex,this.div=i.div,pt(this,L,i.accessibilityManager),u(this,r).addLayer(this)}get isEmpty(){return u(this,x).size===0}updateToolbar(i){u(this,r).updateToolbar(i)}updateMode(i=u(this,r).getMode()){tt(this,o,Se).call(this),i===b.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),u(this,r).unselectAll(),i!==b.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",i===b.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",i===b.AnnotationEditorType.INK),this.div.hidden=!1)}addInkEditorIfNeeded(i){if(!i&&u(this,r).getMode()!==b.AnnotationEditorType.INK)return;if(!i){for(const q of u(this,x).values())if(q.isEmpty()){q.setInBackground();return}}tt(this,t,ve).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(i){u(this,r).setEditingState(i)}addCommands(i){u(this,r).addCommands(i)}enable(){this.div.style.pointerEvents="auto";for(const i of u(this,x).values())i.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const i of u(this,x).values())i.disableEditing();tt(this,o,Se).call(this),this.isEmpty&&(this.div.hidden=!0)}setActiveEditor(i){u(this,r).getActive()!==i&&u(this,r).setActiveEditor(i)}enableClick(){this.div.addEventListener("pointerdown",u(this,w)),this.div.addEventListener("pointerup",u(this,N))}disableClick(){this.div.removeEventListener("pointerdown",u(this,w)),this.div.removeEventListener("pointerup",u(this,N))}attach(i){u(this,x).set(i.id,i)}detach(i){var I;u(this,x).delete(i.id),(I=u(this,L))==null||I.removePointerInTextLayer(i.contentDiv)}remove(i){u(this,r).removeEditor(i),this.detach(i),i.div.style.display="none",setTimeout(()=>{i.div.style.display="",i.div.remove(),i.isAttachedToDOM=!1,document.activeElement===document.body&&u(this,r).focusMainContainer()},0),u(this,d)||this.addInkEditorIfNeeded(!1)}add(i){if(tt(this,A,ye).call(this,i),u(this,r).addEditor(i),this.attach(i),!i.isAttachedToDOM){const I=i.render();this.div.append(I),i.isAttachedToDOM=!0}this.moveEditorInDOM(i),i.onceAdded(),u(this,r).addToAnnotationStorage(i)}moveEditorInDOM(i){var I;(I=u(this,L))==null||I.moveElementInDOM(this.div,i.div,i.contentDiv,!0)}addOrRebuild(i){i.needsToBeRebuilt()?i.rebuild():this.add(i)}addANewEditor(i){const I=()=>{this.addOrRebuild(i)},q=()=>{i.remove()};this.addCommands({cmd:I,undo:q,mustExec:!0})}addUndoableEditor(i){const I=()=>{this.addOrRebuild(i)},q=()=>{i.remove()};this.addCommands({cmd:I,undo:q,mustExec:!1})}getNextId(){return u(this,r).getId()}deserialize(i){switch(i.annotationType){case b.AnnotationEditorType.FREETEXT:return X.FreeTextEditor.deserialize(i,this,u(this,r));case b.AnnotationEditorType.INK:return z.InkEditor.deserialize(i,this,u(this,r))}return null}setSelected(i){u(this,r).setSelected(i)}toggleSelected(i){u(this,r).toggleSelected(i)}isSelected(i){return u(this,r).isSelected(i)}unselect(i){u(this,r).unselect(i)}pointerup(i){const{isMac:I}=b.FeatureTest.platform;if(!(i.button!==0||i.ctrlKey&&I)&&i.target===this.div&&u(this,p)){if(pt(this,p,!1),!u(this,v)){pt(this,v,!0);return}tt(this,t,ve).call(this,i)}}pointerdown(i){const{isMac:I}=b.FeatureTest.platform;if(i.button!==0||i.ctrlKey&&I||i.target!==this.div)return;pt(this,p,!0);const q=u(this,r).getActive();pt(this,v,!q||q.isEmpty())}drop(i){const I=i.dataTransfer.getData("text/plain"),q=u(this,r).getEditor(I);if(!q)return;i.preventDefault(),i.dataTransfer.dropEffect="move",tt(this,A,ye).call(this,q);const $=this.div.getBoundingClientRect(),J=i.clientX-$.x,st=i.clientY-$.y;q.translate(J-q.startX,st-q.startY),this.moveEditorInDOM(q),q.div.focus()}dragover(i){i.preventDefault()}destroy(){var i,I;((i=u(this,r).getActive())==null?void 0:i.parent)===this&&u(this,r).setActiveEditor(null);for(const q of u(this,x).values())(I=u(this,L))==null||I.removePointerInTextLayer(q.contentDiv),q.setParent(null),q.isAttachedToDOM=!1,q.div.remove();this.div=null,u(this,x).clear(),u(this,r).removeLayer(this)}render({viewport:i}){this.viewport=i,(0,ot.setLayerDimensions)(this.div,i),(0,k.bindEvents)(this,this.div,["dragover","drop"]);for(const I of u(this,r).getEditors(this.pageIndex))this.add(I);this.updateMode()}update({viewport:i}){u(this,r).commitOrRemove(),this.viewport=i,(0,ot.setLayerDimensions)(this.div,{rotation:i.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:i,pageHeight:I}=this.viewport.rawDims;return[i,I]}};L=new WeakMap,v=new WeakMap,N=new WeakMap,w=new WeakMap,x=new WeakMap,p=new WeakMap,d=new WeakMap,r=new WeakMap,A=new WeakSet,ye=function(i){var I;i.parent!==this&&(this.attach(i),(I=i.parent)==null||I.detach(i),i.setParent(this),i.div&&i.isAttachedToDOM&&(i.div.remove(),this.div.append(i.div)))},T=new WeakSet,qe=function(i){switch(u(this,r).getMode()){case b.AnnotationEditorType.FREETEXT:return new X.FreeTextEditor(i);case b.AnnotationEditorType.INK:return new z.InkEditor(i)}return null},t=new WeakSet,ve=function(i){const I=this.getNextId(),q=tt(this,T,qe).call(this,{parent:this,id:I,x:i.offsetX,y:i.offsetY,uiManager:u(this,r)});return q&&this.add(q),q},o=new WeakSet,Se=function(){pt(this,d,!0);for(const i of u(this,x).values())i.isEmpty()&&i.remove();pt(this,d,!1)},Dt(c,"_initialized",!1);let W=c;m.AnnotationEditorLayer=W},(Q,m,Y)=>{var ot,W,L,v,N,w,x,p,d,r,Ge,y,Xe,g,Ve,a,Ee;Object.defineProperty(m,"__esModule",{value:!0}),m.FreeTextEditor=void 0;var b=Y(1),k=Y(5),X=Y(4);const s=class s extends X.AnnotationEditor{constructor(i){super({...i,name:"freeTextEditor"});K(this,r);K(this,y);K(this,g);K(this,a);K(this,ot,this.editorDivBlur.bind(this));K(this,W,this.editorDivFocus.bind(this));K(this,L,this.editorDivInput.bind(this));K(this,v,this.editorDivKeydown.bind(this));K(this,N,void 0);K(this,w,"");K(this,x,`${this.id}-editor`);K(this,p,!1);K(this,d,void 0);pt(this,N,i.color||s._defaultColor||X.AnnotationEditor._defaultLineColor),pt(this,d,i.fontSize||s._defaultFontSize)}static initialize(i){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map(q=>[q,i.get(q)]));const I=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(I.getPropertyValue("--freetext-padding"))}static updateDefaultParams(i,I){switch(i){case b.AnnotationEditorParamsType.FREETEXT_SIZE:s._defaultFontSize=I;break;case b.AnnotationEditorParamsType.FREETEXT_COLOR:s._defaultColor=I;break}}updateParams(i,I){switch(i){case b.AnnotationEditorParamsType.FREETEXT_SIZE:tt(this,r,Ge).call(this,I);break;case b.AnnotationEditorParamsType.FREETEXT_COLOR:tt(this,y,Xe).call(this,I);break}}static get defaultPropertiesToUpdate(){return[[b.AnnotationEditorParamsType.FREETEXT_SIZE,s._defaultFontSize],[b.AnnotationEditorParamsType.FREETEXT_COLOR,s._defaultColor||X.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[b.AnnotationEditorParamsType.FREETEXT_SIZE,u(this,d)],[b.AnnotationEditorParamsType.FREETEXT_COLOR,u(this,N)]]}getInitialTranslation(){const i=this.parentScale;return[-s._internalPadding*i,-(s._internalPadding+u(this,d))*i]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(b.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",u(this,v)),this.editorDiv.addEventListener("focus",u(this,W)),this.editorDiv.addEventListener("blur",u(this,ot)),this.editorDiv.addEventListener("input",u(this,L)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",u(this,x)),this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",u(this,v)),this.editorDiv.removeEventListener("focus",u(this,W)),this.editorDiv.removeEventListener("blur",u(this,ot)),this.editorDiv.removeEventListener("input",u(this,L)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(i){super.focusin(i),i.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing"),super.remove()}commit(){this.isInEditMode()&&(super.commit(),u(this,p)||(pt(this,p,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),pt(this,w,tt(this,g,Ve).call(this).trimEnd()),tt(this,a,Ee).call(this))}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(i){this.enableEditMode(),this.editorDiv.focus()}keydown(i){i.target===this.div&&i.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(i){s._keyboardManager.exec(this,i)}editorDivFocus(i){this.isEditing=!0}editorDivBlur(i){this.isEditing=!1}editorDivInput(i){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let i,I;this.width&&(i=this.x,I=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",u(this,x)),this.enableEditing(),s._l10nPromise.get("editor_free_text2_aria_label").then($=>{var J;return(J=this.editorDiv)==null?void 0:J.setAttribute("aria-label",$)}),s._l10nPromise.get("free_text2_default_content").then($=>{var J;return(J=this.editorDiv)==null?void 0:J.setAttribute("default-content",$)}),this.editorDiv.contentEditable=!0;const{style:q}=this.editorDiv;if(q.fontSize=`calc(${u(this,d)}px * var(--scale-factor))`,q.color=u(this,N),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,k.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[$,J]=this.parentDimensions;this.setAt(i*$,I*J,this.width*$,this.height*J);for(const st of u(this,w).split(`
`)){const dt=document.createElement("div");dt.append(st?document.createTextNode(st):document.createElement("br")),this.editorDiv.append(dt)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(i,I,q){const $=super.deserialize(i,I,q);return pt($,d,i.fontSize),pt($,N,b.Util.makeHexColor(...i.color)),pt($,w,i.value),$}serialize(){if(this.isEmpty())return null;const i=s._internalPadding*this.parentScale,I=this.getRect(i,i),q=X.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:u(this,N));return{annotationType:b.AnnotationEditorType.FREETEXT,color:q,fontSize:u(this,d),value:u(this,w),pageIndex:this.pageIndex,rect:I,rotation:this.rotation}}};ot=new WeakMap,W=new WeakMap,L=new WeakMap,v=new WeakMap,N=new WeakMap,w=new WeakMap,x=new WeakMap,p=new WeakMap,d=new WeakMap,r=new WeakSet,Ge=function(i){const I=$=>{this.editorDiv.style.fontSize=`calc(${$}px * var(--scale-factor))`,this.translate(0,-($-u(this,d))*this.parentScale),pt(this,d,$),tt(this,a,Ee).call(this)},q=u(this,d);this.addCommands({cmd:()=>{I(i)},undo:()=>{I(q)},mustExec:!0,type:b.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},y=new WeakSet,Xe=function(i){const I=u(this,N);this.addCommands({cmd:()=>{pt(this,N,this.editorDiv.style.color=i)},undo:()=>{pt(this,N,this.editorDiv.style.color=I)},mustExec:!0,type:b.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},g=new WeakSet,Ve=function(){const i=this.editorDiv.getElementsByTagName("div");if(i.length===0)return this.editorDiv.innerText;const I=[];for(const q of i)I.push(q.innerText.replace(/\r\n?|\n/,""));return I.join(`
`)},a=new WeakSet,Ee=function(){const[i,I]=this.parentDimensions;let q;if(this.isAttachedToDOM)q=this.div.getBoundingClientRect();else{const{currentLayer:$,div:J}=this,st=J.style.display;J.style.display="hidden",$.div.append(this.div),q=J.getBoundingClientRect(),J.remove(),J.style.display=st}this.width=q.width/i,this.height=q.height/I},Dt(s,"_freeTextDefaultContent",""),Dt(s,"_l10nPromise"),Dt(s,"_internalPadding",0),Dt(s,"_defaultColor",null),Dt(s,"_defaultFontSize",10),Dt(s,"_keyboardManager",new k.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],s.prototype.commitOrRemove]])),Dt(s,"_type","freetext");let z=s;m.FreeTextEditor=z},(Q,m,Y)=>{var L,v,N,w,x,p,d,r,A,y,T,g,t,a,o,ze,c,$e,i,Ye,q,Ke,J,Ce,dt,Je,ht,Qe,vt,Ze,At,Vt,l,Te,S,oe,D,le,O,Qt,M,we,n,ce,_,xe,B,ts,V,es,rt,ss,it,Pe,ft,he,_t,Zt,G,ke;Object.defineProperty(m,"__esModule",{value:!0}),m.InkEditor=void 0,Object.defineProperty(m,"fitCurve",{enumerable:!0,get:function(){return X.fitCurve}});var b=Y(1),k=Y(4),X=Y(30),z=Y(5);const ot=16,yt=class yt extends k.AnnotationEditor{constructor(C){super({...C,name:"inkEditor"});K(this,o);K(this,c);K(this,i);K(this,q);K(this,J);K(this,dt);K(this,ht);K(this,vt);K(this,At);K(this,l);K(this,S);K(this,D);K(this,O);K(this,M);K(this,n);K(this,B);K(this,V);K(this,rt);K(this,it);K(this,ft);K(this,_t);K(this,G);K(this,L,0);K(this,v,0);K(this,N,0);K(this,w,this.canvasPointermove.bind(this));K(this,x,this.canvasPointerleave.bind(this));K(this,p,this.canvasPointerup.bind(this));K(this,d,this.canvasPointerdown.bind(this));K(this,r,!1);K(this,A,!1);K(this,y,null);K(this,T,null);K(this,g,0);K(this,t,0);K(this,a,null);this.color=C.color||null,this.thickness=C.thickness||null,this.opacity=C.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(C){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(F=>[F,C.get(F)]))}static updateDefaultParams(C,F){switch(C){case b.AnnotationEditorParamsType.INK_THICKNESS:yt._defaultThickness=F;break;case b.AnnotationEditorParamsType.INK_COLOR:yt._defaultColor=F;break;case b.AnnotationEditorParamsType.INK_OPACITY:yt._defaultOpacity=F/100;break}}updateParams(C,F){switch(C){case b.AnnotationEditorParamsType.INK_THICKNESS:tt(this,o,ze).call(this,F);break;case b.AnnotationEditorParamsType.INK_COLOR:tt(this,c,$e).call(this,F);break;case b.AnnotationEditorParamsType.INK_OPACITY:tt(this,i,Ye).call(this,F);break}}static get defaultPropertiesToUpdate(){return[[b.AnnotationEditorParamsType.INK_THICKNESS,yt._defaultThickness],[b.AnnotationEditorParamsType.INK_COLOR,yt._defaultColor||k.AnnotationEditor._defaultLineColor],[b.AnnotationEditorParamsType.INK_OPACITY,Math.round(yt._defaultOpacity*100)]]}get propertiesToUpdate(){return[[b.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||yt._defaultThickness],[b.AnnotationEditorParamsType.INK_COLOR,this.color||yt._defaultColor||k.AnnotationEditor._defaultLineColor],[b.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??yt._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(tt(this,S,oe).call(this),tt(this,D,le).call(this)),this.isAttachedToDOM||(this.parent.add(this),tt(this,O,Qt).call(this)),tt(this,_t,Zt).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,u(this,T).disconnect(),pt(this,T,null),super.remove())}setParent(C){!this.parent&&C?this._uiManager.removeShouldRescale(this):this.parent&&C===null&&this._uiManager.addShouldRescale(this),super.setParent(C)}onScaleChanging(){const[C,F]=this.parentDimensions,at=this.width*C,gt=this.height*F;this.setDimensions(at,gt)}enableEditMode(){u(this,r)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",u(this,d)),this.canvas.addEventListener("pointerup",u(this,p)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",u(this,d)),this.canvas.removeEventListener("pointerup",u(this,p)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){u(this,r)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),pt(this,r,!0),this.div.classList.add("disabled"),tt(this,_t,Zt).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus({preventScroll:!0}))}focusin(C){super.focusin(C),this.enableEditMode()}canvasPointerdown(C){C.button!==0||!this.isInEditMode()||u(this,r)||(this.setInForeground(),C.type!=="mouse"&&this.div.focus(),C.stopPropagation(),this.canvas.addEventListener("pointerleave",u(this,x)),this.canvas.addEventListener("pointermove",u(this,w)),tt(this,dt,Je).call(this,C.offsetX,C.offsetY))}canvasPointermove(C){C.stopPropagation(),tt(this,ht,Qe).call(this,C.offsetX,C.offsetY)}canvasPointerup(C){C.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(C.stopPropagation(),tt(this,l,Te).call(this,C),this.setInBackground())}canvasPointerleave(C){tt(this,l,Te).call(this,C),this.setInBackground()}render(){if(this.div)return this.div;let C,F;this.width&&(C=this.x,F=this.y),super.render(),yt._l10nPromise.get("editor_ink2_aria_label").then(kt=>{var Pt;return(Pt=this.div)==null?void 0:Pt.setAttribute("aria-label",kt)});const[at,gt,Tt,xt]=tt(this,q,Ke).call(this);if(this.setAt(at,gt,0,0),this.setDims(Tt,xt),tt(this,S,oe).call(this),this.width){const[kt,Pt]=this.parentDimensions;this.setAt(C*kt,F*Pt,this.width*kt,this.height*Pt),pt(this,A,!0),tt(this,O,Qt).call(this),this.setDims(this.width*kt,this.height*Pt),tt(this,At,Vt).call(this),tt(this,G,ke).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return tt(this,D,le).call(this),this.div}setDimensions(C,F){const at=Math.round(C),gt=Math.round(F);if(u(this,g)===at&&u(this,t)===gt)return;pt(this,g,at),pt(this,t,gt),this.canvas.style.visibility="hidden",u(this,L)&&Math.abs(u(this,L)-C/F)>.01&&(F=Math.ceil(C/u(this,L)),this.setDims(C,F));const[Tt,xt]=this.parentDimensions;this.width=C/Tt,this.height=F/xt,u(this,r)&&tt(this,M,we).call(this,C,F),tt(this,O,Qt).call(this),tt(this,At,Vt).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(C,F,at){var Ot,It;const gt=super.deserialize(C,F,at);gt.thickness=C.thickness,gt.color=b.Util.makeHexColor(...C.color),gt.opacity=C.opacity;const[Tt,xt]=gt.pageDimensions,kt=gt.width*Tt,Pt=gt.height*xt,Mt=gt.parentScale,wt=C.thickness/2;pt(gt,L,kt/Pt),pt(gt,r,!0),pt(gt,g,Math.round(kt)),pt(gt,t,Math.round(Pt));for(const{bezier:Ft}of C.paths){const Bt=[];gt.paths.push(Bt);let Ut=Mt*(Ft[0]-wt),Wt=Mt*(Pt-Ft[1]-wt);for(let Nt=2,jt=Ft.length;Nt<jt;Nt+=6){const Gt=Mt*(Ft[Nt]-wt),zt=Mt*(Pt-Ft[Nt+1]-wt),se=Mt*(Ft[Nt+2]-wt),ne=Mt*(Pt-Ft[Nt+3]-wt),Me=Mt*(Ft[Nt+4]-wt),Oe=Mt*(Pt-Ft[Nt+5]-wt);Bt.push([[Ut,Wt],[Gt,zt],[se,ne],[Me,Oe]]),Ut=Me,Wt=Oe}const qt=tt(this,_,xe).call(this,Bt);gt.bezierPath2D.push(qt)}const Lt=tt(Ot=gt,it,Pe).call(Ot);return pt(gt,N,Math.max(ot,Lt[2]-Lt[0])),pt(gt,v,Math.max(ot,Lt[3]-Lt[1])),tt(It=gt,M,we).call(It,kt,Pt),gt}serialize(){if(this.isEmpty())return null;const C=this.getRect(0,0),F=this.rotation%180===0?C[3]-C[1]:C[2]-C[0],at=k.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:b.AnnotationEditorType.INK,color:at,thickness:this.thickness,opacity:this.opacity,paths:tt(this,B,ts).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,F),pageIndex:this.pageIndex,rect:C,rotation:this.rotation}}};L=new WeakMap,v=new WeakMap,N=new WeakMap,w=new WeakMap,x=new WeakMap,p=new WeakMap,d=new WeakMap,r=new WeakMap,A=new WeakMap,y=new WeakMap,T=new WeakMap,g=new WeakMap,t=new WeakMap,a=new WeakMap,o=new WeakSet,ze=function(C){const F=this.thickness;this.addCommands({cmd:()=>{this.thickness=C,tt(this,_t,Zt).call(this)},undo:()=>{this.thickness=F,tt(this,_t,Zt).call(this)},mustExec:!0,type:b.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},c=new WeakSet,$e=function(C){const F=this.color;this.addCommands({cmd:()=>{this.color=C,tt(this,At,Vt).call(this)},undo:()=>{this.color=F,tt(this,At,Vt).call(this)},mustExec:!0,type:b.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},i=new WeakSet,Ye=function(C){C/=100;const F=this.opacity;this.addCommands({cmd:()=>{this.opacity=C,tt(this,At,Vt).call(this)},undo:()=>{this.opacity=F,tt(this,At,Vt).call(this)},mustExec:!0,type:b.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},q=new WeakSet,Ke=function(){const{parentRotation:C,parentDimensions:[F,at]}=this;switch(C){case 90:return[0,at,at,F];case 180:return[F,at,F,at];case 270:return[F,0,at,F];default:return[0,0,F,at]}},J=new WeakSet,Ce=function(){const{ctx:C,color:F,opacity:at,thickness:gt,parentScale:Tt,scaleFactor:xt}=this;C.lineWidth=gt*Tt/xt,C.lineCap="round",C.lineJoin="round",C.miterLimit=10,C.strokeStyle=`${F}${(0,z.opacityToHex)(at)}`},dt=new WeakSet,Je=function(C,F){this.isEditing=!0,u(this,A)||(pt(this,A,!0),tt(this,O,Qt).call(this),this.thickness||(this.thickness=yt._defaultThickness),this.color||(this.color=yt._defaultColor||k.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=yt._defaultOpacity)),this.currentPath.push([C,F]),pt(this,y,null),tt(this,J,Ce).call(this),this.ctx.beginPath(),this.ctx.moveTo(C,F),pt(this,a,()=>{u(this,a)&&(u(this,y)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):tt(this,At,Vt).call(this),this.ctx.lineTo(...u(this,y)),pt(this,y,null),this.ctx.stroke()),window.requestAnimationFrame(u(this,a)))}),window.requestAnimationFrame(u(this,a))},ht=new WeakSet,Qe=function(C,F){const[at,gt]=this.currentPath.at(-1);C===at&&F===gt||(this.currentPath.push([C,F]),pt(this,y,[C,F]))},vt=new WeakSet,Ze=function(C,F){var Mt;this.ctx.closePath(),pt(this,a,null),C=Math.min(Math.max(C,0),this.canvas.width),F=Math.min(Math.max(F,0),this.canvas.height);const[at,gt]=this.currentPath.at(-1);(C!==at||F!==gt)&&this.currentPath.push([C,F]);let Tt;if(this.currentPath.length!==1)Tt=(0,X.fitCurve)(this.currentPath,30,null);else{const wt=[C,F];Tt=[[wt,wt.slice(),wt.slice(),wt]]}const xt=tt(Mt=yt,_,xe).call(Mt,Tt);this.currentPath.length=0;const kt=()=>{this.paths.push(Tt),this.bezierPath2D.push(xt),this.rebuild()},Pt=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(tt(this,S,oe).call(this),tt(this,D,le).call(this)),tt(this,_t,Zt).call(this))};this.addCommands({cmd:kt,undo:Pt,mustExec:!0})},At=new WeakSet,Vt=function(){if(this.isEmpty()){tt(this,n,ce).call(this);return}tt(this,J,Ce).call(this);const{canvas:C,ctx:F}=this;F.setTransform(1,0,0,1,0,0),F.clearRect(0,0,C.width,C.height),tt(this,n,ce).call(this);for(const at of this.bezierPath2D)F.stroke(at)},l=new WeakSet,Te=function(C){tt(this,vt,Ze).call(this,C.offsetX,C.offsetY),this.canvas.removeEventListener("pointerleave",u(this,x)),this.canvas.removeEventListener("pointermove",u(this,w)),this.addToAnnotationStorage()},S=new WeakSet,oe=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",yt._l10nPromise.get("editor_ink_canvas_aria_label").then(C=>{var F;return(F=this.canvas)==null?void 0:F.setAttribute("aria-label",C)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},D=new WeakSet,le=function(){pt(this,T,new ResizeObserver(C=>{const F=C[0].contentRect;F.width&&F.height&&this.setDimensions(F.width,F.height)})),u(this,T).observe(this.div)},O=new WeakSet,Qt=function(){if(!u(this,A))return;const[C,F]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*C),this.canvas.height=Math.ceil(this.height*F),tt(this,n,ce).call(this)},M=new WeakSet,we=function(C,F){const at=tt(this,ft,he).call(this),gt=(C-at)/u(this,N),Tt=(F-at)/u(this,v);this.scaleFactor=Math.min(gt,Tt)},n=new WeakSet,ce=function(){const C=tt(this,ft,he).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+C,this.translationY*this.scaleFactor+C)},_=new WeakSet,xe=function(C){const F=new Path2D;for(let at=0,gt=C.length;at<gt;at++){const[Tt,xt,kt,Pt]=C[at];at===0&&F.moveTo(...Tt),F.bezierCurveTo(xt[0],xt[1],kt[0],kt[1],Pt[0],Pt[1])}return F},B=new WeakSet,ts=function(C,F,at,gt){const xt=[],kt=this.thickness/2;let Pt,Mt;for(const wt of this.paths){Pt=[],Mt=[];for(let Lt=0,Ot=wt.length;Lt<Ot;Lt++){const[It,Ft,Bt,Ut]=wt[Lt],Wt=C*(It[0]+F)+kt,qt=gt-C*(It[1]+at)-kt,Nt=C*(Ft[0]+F)+kt,jt=gt-C*(Ft[1]+at)-kt,Gt=C*(Bt[0]+F)+kt,zt=gt-C*(Bt[1]+at)-kt,se=C*(Ut[0]+F)+kt,ne=gt-C*(Ut[1]+at)-kt;Lt===0&&(Pt.push(Wt,qt),Mt.push(Wt,qt)),Pt.push(Nt,jt,Gt,zt,se,ne),tt(this,V,es).call(this,Wt,qt,Nt,jt,Gt,zt,se,ne,4,Mt)}xt.push({bezier:Pt,points:Mt})}return xt},V=new WeakSet,es=function(C,F,at,gt,Tt,xt,kt,Pt,Mt,wt){if(tt(this,rt,ss).call(this,C,F,at,gt,Tt,xt,kt,Pt)){wt.push(kt,Pt);return}for(let Lt=1;Lt<Mt-1;Lt++){const Ot=Lt/Mt,It=1-Ot;let Ft=Ot*C+It*at,Bt=Ot*F+It*gt,Ut=Ot*at+It*Tt,Wt=Ot*gt+It*xt;const qt=Ot*Tt+It*kt,Nt=Ot*xt+It*Pt;Ft=Ot*Ft+It*Ut,Bt=Ot*Bt+It*Wt,Ut=Ot*Ut+It*qt,Wt=Ot*Wt+It*Nt,Ft=Ot*Ft+It*Ut,Bt=Ot*Bt+It*Wt,wt.push(Ft,Bt)}wt.push(kt,Pt)},rt=new WeakSet,ss=function(C,F,at,gt,Tt,xt,kt,Pt){const wt=(3*at-2*C-kt)**2,Lt=(3*gt-2*F-Pt)**2,Ot=(3*Tt-C-2*kt)**2,It=(3*xt-F-2*Pt)**2;return Math.max(wt,Ot)+Math.max(Lt,It)<=10},it=new WeakSet,Pe=function(){let C=1/0,F=-1/0,at=1/0,gt=-1/0;for(const Tt of this.paths)for(const[xt,kt,Pt,Mt]of Tt){const wt=b.Util.bezierBoundingBox(...xt,...kt,...Pt,...Mt);C=Math.min(C,wt[0]),at=Math.min(at,wt[1]),F=Math.max(F,wt[2]),gt=Math.max(gt,wt[3])}return[C,at,F,gt]},ft=new WeakSet,he=function(){return u(this,r)?Math.ceil(this.thickness*this.parentScale):0},_t=new WeakSet,Zt=function(C=!1){if(this.isEmpty())return;if(!u(this,r)){tt(this,At,Vt).call(this);return}const F=tt(this,it,Pe).call(this),at=tt(this,ft,he).call(this);pt(this,N,Math.max(ot,F[2]-F[0])),pt(this,v,Math.max(ot,F[3]-F[1]));const gt=Math.ceil(at+u(this,N)*this.scaleFactor),Tt=Math.ceil(at+u(this,v)*this.scaleFactor),[xt,kt]=this.parentDimensions;this.width=gt/xt,this.height=Tt/kt,pt(this,L,gt/Tt),tt(this,G,ke).call(this);const Pt=this.translationX,Mt=this.translationY;this.translationX=-F[0],this.translationY=-F[1],tt(this,O,Qt).call(this),tt(this,At,Vt).call(this),pt(this,g,gt),pt(this,t,Tt),this.setDims(gt,Tt);const wt=C?at/this.scaleFactor/2:0;this.translate(Pt-this.translationX-wt,Mt-this.translationY-wt)},G=new WeakSet,ke=function(){const{style:C}=this.div;u(this,L)>=1?(C.minHeight=`${ot}px`,C.minWidth=`${Math.round(u(this,L)*ot)}px`):(C.minWidth=`${ot}px`,C.minHeight=`${Math.round(ot/u(this,L))}px`)},K(yt,_),Dt(yt,"_defaultColor",null),Dt(yt,"_defaultOpacity",1),Dt(yt,"_defaultThickness",1),Dt(yt,"_l10nPromise"),Dt(yt,"_type","ink");let W=yt;m.InkEditor=W},(Q,m,Y)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.fitCurve=void 0;const b=Y(31);m.fitCurve=b},Q=>{function m(p,d,r){if(!Array.isArray(p))throw new TypeError("First argument should be an array");if(p.forEach(g=>{if(!Array.isArray(g)||g.some(t=>typeof t!="number")||g.length!==p[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),p=p.filter((g,t)=>t===0||!g.every((a,o)=>a===p[t-1][o])),p.length<2)return[];const A=p.length,y=N(p[1],p[0]),T=N(p[A-2],p[A-1]);return Y(p,y,T,d,r)}function Y(p,d,r,A,y){var g,t,a,o,s,c,P,i,I,q,$,J,st;if(p.length===2)return J=w.vectorLen(w.subtract(p[0],p[1]))/3,g=[p[0],w.addArrays(p[0],w.mulItems(d,J)),w.addArrays(p[1],w.mulItems(r,J)),p[1]],[g];if(t=ot(p),[g,o,c]=b(p,t,t,d,r,y),o===0||o<A)return[g];if(o<A*A)for(a=t,s=o,P=c,st=0;st<20;st++){if(a=X(g,p,a),[g,o,c]=b(p,t,a,d,r,y),o<A)return[g];if(c===P){let dt=o/s;if(dt>.9999&&dt<1.0001)break}s=o,P=c}return $=[],i=w.subtract(p[c-1],p[c+1]),i.every(dt=>dt===0)&&(i=w.subtract(p[c-1],p[c]),[i[0],i[1]]=[-i[1],i[0]]),I=w.normalize(i),q=w.mulItems(I,-1),$=$.concat(Y(p.slice(0,c+1),d,I,A,y)),$=$.concat(Y(p.slice(c),q,r,A,y)),$}function b(p,d,r,A,y,T){var g,t,a;return g=k(p,r,A,y),[t,a]=W(p,g,d),T&&T({bez:g,points:p,params:d,maxErr:t,maxPoint:a}),[g,t,a]}function k(p,d,r,A){var y,T,g,t,a,o,s,c,P,i,I,q,$,J,st,dt,lt,ht=p[0],mt=p[p.length-1];for(y=[ht,null,null,mt],T=w.zeros_Xx2x2(d.length),$=0,J=d.length;$<J;$++)dt=d[$],lt=1-dt,g=T[$],g[0]=w.mulItems(r,3*dt*(lt*lt)),g[1]=w.mulItems(A,3*lt*(dt*dt));for(t=[[0,0],[0,0]],a=[0,0],$=0,J=p.length;$<J;$++)dt=d[$],g=T[$],t[0][0]+=w.dot(g[0],g[0]),t[0][1]+=w.dot(g[0],g[1]),t[1][0]+=w.dot(g[0],g[1]),t[1][1]+=w.dot(g[1],g[1]),st=w.subtract(p[$],x.q([ht,ht,mt,mt],dt)),a[0]+=w.dot(g[0],st),a[1]+=w.dot(g[1],st);return o=t[0][0]*t[1][1]-t[1][0]*t[0][1],s=t[0][0]*a[1]-t[1][0]*a[0],c=a[0]*t[1][1]-a[1]*t[0][1],P=o===0?0:c/o,i=o===0?0:s/o,q=w.vectorLen(w.subtract(ht,mt)),I=1e-6*q,P<I||i<I?(y[1]=w.addArrays(ht,w.mulItems(r,q/3)),y[2]=w.addArrays(mt,w.mulItems(A,q/3))):(y[1]=w.addArrays(ht,w.mulItems(r,P)),y[2]=w.addArrays(mt,w.mulItems(A,i))),y}function X(p,d,r){return r.map((A,y)=>z(p,d[y],A))}function z(p,d,r){var A=w.subtract(x.q(p,r),d),y=x.qprime(p,r),T=w.mulMatrix(A,y),g=w.sum(w.squareItems(y))+2*w.mulMatrix(A,x.qprimeprime(p,r));return g===0?r:r-T/g}function ot(p){var d=[],r,A,y;return p.forEach((T,g)=>{r=g?A+w.vectorLen(w.subtract(T,y)):0,d.push(r),A=r,y=T}),d=d.map(T=>T/A),d}function W(p,d,r){var A,y,T,g,t,a,o,s;y=0,T=Math.floor(p.length/2);const c=L(d,10);for(t=0,a=p.length;t<a;t++)o=p[t],s=v(d,r[t],c,10),g=w.subtract(x.q(d,s),o),A=g[0]*g[0]+g[1]*g[1],A>y&&(y=A,T=t);return[y,T]}var L=function(p,d){for(var r,A=[0],y=p[0],T=0,g=1;g<=d;g++)r=x.q(p,g/d),T+=w.vectorLen(w.subtract(r,y)),A.push(T),y=r;return A=A.map(t=>t/T),A};function v(p,d,r,A){if(d<0)return 0;if(d>1)return 1;for(var y,T,g,t,a,o=1;o<=A;o++)if(d<=r[o]){t=(o-1)/A,g=o/A,T=r[o-1],y=r[o],a=(d-T)/(y-T)*(g-t)+t;break}return a}function N(p,d){return w.normalize(w.subtract(p,d))}class w{static zeros_Xx2x2(d){for(var r=[];d--;)r.push([0,0]);return r}static mulItems(d,r){return d.map(A=>A*r)}static mulMatrix(d,r){return d.reduce((A,y,T)=>A+y*r[T],0)}static subtract(d,r){return d.map((A,y)=>A-r[y])}static addArrays(d,r){return d.map((A,y)=>A+r[y])}static addItems(d,r){return d.map(A=>A+r)}static sum(d){return d.reduce((r,A)=>r+A)}static dot(d,r){return w.mulMatrix(d,r)}static vectorLen(d){return Math.hypot(...d)}static divItems(d,r){return d.map(A=>A/r)}static squareItems(d){return d.map(r=>r*r)}static normalize(d){return this.divItems(d,this.vectorLen(d))}}class x{static q(d,r){var A=1-r,y=w.mulItems(d[0],A*A*A),T=w.mulItems(d[1],3*A*A*r),g=w.mulItems(d[2],3*A*r*r),t=w.mulItems(d[3],r*r*r);return w.addArrays(w.addArrays(y,T),w.addArrays(g,t))}static qprime(d,r){var A=1-r,y=w.mulItems(w.subtract(d[1],d[0]),3*A*A),T=w.mulItems(w.subtract(d[2],d[1]),6*A*r),g=w.mulItems(w.subtract(d[3],d[2]),3*r*r);return w.addArrays(w.addArrays(y,T),g)}static qprimeprime(d,r){return w.addArrays(w.mulItems(w.addArrays(w.subtract(d[2],w.mulItems(d[1],2)),d[0]),6*(1-r)),w.mulItems(w.addArrays(w.subtract(d[3],w.mulItems(d[2],2)),d[1]),6*r))}}Q.exports=m,Q.exports.fitCubic=Y,Q.exports.createTangent=N},(Q,m,Y)=>{var At,Yt,l,ns,j,Fe,H,Re;Object.defineProperty(m,"__esModule",{value:!0}),m.AnnotationLayer=void 0;var b=Y(1),k=Y(6),X=Y(3),z=Y(33),ot=Y(34);const W=1e3,L=9,v=new WeakSet;function N(M){return{width:M[2]-M[0],height:M[3]-M[1]}}class w{static create(e){switch(e.data.annotationType){case b.AnnotationType.LINK:return new p(e);case b.AnnotationType.TEXT:return new d(e);case b.AnnotationType.WIDGET:switch(e.data.fieldType){case"Tx":return new A(e);case"Btn":return e.data.radioButton?new T(e):e.data.checkBox?new y(e):new g(e);case"Ch":return new t(e)}return new r(e);case b.AnnotationType.POPUP:return new a(e);case b.AnnotationType.FREETEXT:return new s(e);case b.AnnotationType.LINE:return new c(e);case b.AnnotationType.SQUARE:return new P(e);case b.AnnotationType.CIRCLE:return new i(e);case b.AnnotationType.POLYLINE:return new I(e);case b.AnnotationType.CARET:return new $(e);case b.AnnotationType.INK:return new J(e);case b.AnnotationType.POLYGON:return new q(e);case b.AnnotationType.HIGHLIGHT:return new st(e);case b.AnnotationType.UNDERLINE:return new dt(e);case b.AnnotationType.SQUIGGLY:return new lt(e);case b.AnnotationType.STRIKEOUT:return new ht(e);case b.AnnotationType.STAMP:return new mt(e);case b.AnnotationType.FILEATTACHMENT:return new vt(e);default:return new x(e)}}}class x{constructor(e,{isRenderable:n=!1,ignoreBorder:f=!1,createQuadrilaterals:_=!1}={}){this.isRenderable=n,this.data=e.data,this.layer=e.layer,this.page=e.page,this.viewport=e.viewport,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,n&&(this.container=this._createContainer(f)),_&&(this.quadrilaterals=this._createQuadrilaterals(f))}_createContainer(e=!1){const{data:n,page:f,viewport:_}=this,E=document.createElement("section");E.setAttribute("data-annotation-id",n.id),n.noRotate&&E.classList.add("norotate");const{pageWidth:B,pageHeight:et,pageX:V,pageY:nt}=_.rawDims,{width:rt,height:Z}=N(n.rect),it=b.Util.normalizeRect([n.rect[0],f.view[3]-n.rect[1]+f.view[1],n.rect[2],f.view[3]-n.rect[3]+f.view[1]]);if(!e&&n.borderStyle.width>0){E.style.borderWidth=`${n.borderStyle.width}px`;const ft=n.borderStyle.horizontalCornerRadius,Et=n.borderStyle.verticalCornerRadius;if(ft>0||Et>0){const Ct=`calc(${ft}px * var(--scale-factor)) / calc(${Et}px * var(--scale-factor))`;E.style.borderRadius=Ct}else if(this instanceof T){const Ct=`calc(${rt}px * var(--scale-factor)) / calc(${Z}px * var(--scale-factor))`;E.style.borderRadius=Ct}switch(n.borderStyle.style){case b.AnnotationBorderStyleType.SOLID:E.style.borderStyle="solid";break;case b.AnnotationBorderStyleType.DASHED:E.style.borderStyle="dashed";break;case b.AnnotationBorderStyleType.BEVELED:(0,b.warn)("Unimplemented border style: beveled");break;case b.AnnotationBorderStyleType.INSET:(0,b.warn)("Unimplemented border style: inset");break;case b.AnnotationBorderStyleType.UNDERLINE:E.style.borderBottomStyle="solid";break}const _t=n.borderColor||null;_t?E.style.borderColor=b.Util.makeHexColor(_t[0]|0,_t[1]|0,_t[2]|0):E.style.borderWidth=0}E.style.left=`${100*(it[0]-V)/B}%`,E.style.top=`${100*(it[1]-nt)/et}%`;const{rotation:ut}=n;return n.hasOwnCanvas||ut===0?(E.style.width=`${100*rt/B}%`,E.style.height=`${100*Z/et}%`):this.setRotation(ut,E),E}setRotation(e,n=this.container){const{pageWidth:f,pageHeight:_}=this.viewport.rawDims,{width:E,height:B}=N(this.data.rect);let et,V;e%180===0?(et=100*E/f,V=100*B/_):(et=100*B/f,V=100*E/_),n.style.width=`${et}%`,n.style.height=`${V}%`,n.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(n,f,_)=>{const E=_.detail[n];_.target.style[f]=z.ColorConverters[`${E[0]}_HTML`](E.slice(1))};return(0,b.shadow)(this,"_commonActions",{display:n=>{const f=n.detail.display%2===1;this.container.style.visibility=f?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:f,print:n.detail.display===0||n.detail.display===3})},print:n=>{this.annotationStorage.setValue(this.data.id,{print:n.detail.print})},hidden:n=>{this.container.style.visibility=n.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:n.detail.hidden})},focus:n=>{setTimeout(()=>n.target.focus({preventScroll:!1}),0)},userName:n=>{n.target.title=n.detail.userName},readonly:n=>{n.detail.readonly?n.target.setAttribute("readonly",""):n.target.removeAttribute("readonly")},required:n=>{this._setRequired(n.target,n.detail.required)},bgColor:n=>{e("bgColor","backgroundColor",n)},fillColor:n=>{e("fillColor","backgroundColor",n)},fgColor:n=>{e("fgColor","color",n)},textColor:n=>{e("textColor","color",n)},borderColor:n=>{e("borderColor","borderColor",n)},strokeColor:n=>{e("strokeColor","borderColor",n)},rotation:n=>{const f=n.detail.rotation;this.setRotation(f),this.annotationStorage.setValue(this.data.id,{rotation:f})}})}_dispatchEventFromSandbox(e,n){const f=this._commonActions;for(const _ of Object.keys(n.detail)){const E=e[_]||f[_];E==null||E(n)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const n=this.annotationStorage.getRawValue(this.data.id);if(!n)return;const f=this._commonActions;for(const[_,E]of Object.entries(n)){const B=f[_];if(B){const et={detail:{[_]:E},target:e};B(et),delete n[_]}}}_createQuadrilaterals(e=!1){if(!this.data.quadPoints)return null;const n=[],f=this.data.rect;for(const _ of this.data.quadPoints)this.data.rect=[_[2].x,_[2].y,_[1].x,_[1].y],n.push(this._createContainer(e));return this.data.rect=f,n}_createPopup(e,n){let f=this.container;this.quadrilaterals&&(e||(e=this.quadrilaterals),f=this.quadrilaterals[0]),e||(e=document.createElement("div"),e.classList.add("popupTriggerArea"),f.append(e));const E=new o({container:f,trigger:e,color:n.color,titleObj:n.titleObj,modificationDate:n.modificationDate,contentsObj:n.contentsObj,richText:n.richText,hideWrapper:!0}).render();E.style.left="100%",f.append(E)}_renderQuadrilaterals(e){for(const n of this.quadrilaterals)n.classList.add(e);return this.quadrilaterals}render(){(0,b.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,n=null){const f=[];if(this._fieldObjects){const _=this._fieldObjects[e];if(_)for(const{page:E,id:B,exportValues:et}of _){if(E===-1||B===n)continue;const V=typeof et=="string"?et:null,nt=document.querySelector(`[data-element-id="${B}"]`);if(nt&&!v.has(nt)){(0,b.warn)(`_getElementsByName - element not allowed: ${B}`);continue}f.push({id:B,exportValue:V,domElement:nt})}return f}for(const _ of document.getElementsByName(e)){const{exportValue:E}=_,B=_.getAttribute("data-element-id");B!==n&&v.has(_)&&f.push({id:B,exportValue:E,domElement:_})}return f}}class p extends x{constructor(n,f=null){super(n,{isRenderable:!0,ignoreBorder:!!(f!=null&&f.ignoreBorder),createQuadrilaterals:!0});K(this,At);K(this,l);this.isTooltipOnly=n.data.isTooltipOnly}render(){const{data:n,linkService:f}=this,_=document.createElement("a");_.setAttribute("data-element-id",n.id);let E=!1;return n.url?(f.addLinkAttributes(_,n.url,n.newWindow),E=!0):n.action?(this._bindNamedAction(_,n.action),E=!0):n.attachment?(this._bindAttachment(_,n.attachment),E=!0):n.setOCGState?(tt(this,l,ns).call(this,_,n.setOCGState),E=!0):n.dest?(this._bindLink(_,n.dest),E=!0):(n.actions&&(n.actions.Action||n.actions["Mouse Up"]||n.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(_,n),E=!0),n.resetForm?(this._bindResetFormAction(_,n.resetForm),E=!0):this.isTooltipOnly&&!E&&(this._bindLink(_,""),E=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((B,et)=>{const V=et===0?_:_.cloneNode();return B.append(V),B}):(this.container.classList.add("linkAnnotation"),E&&this.container.append(_),this.container)}_bindLink(n,f){n.href=this.linkService.getDestinationHash(f),n.onclick=()=>(f&&this.linkService.goToDestination(f),!1),(f||f==="")&&tt(this,At,Yt).call(this)}_bindNamedAction(n,f){n.href=this.linkService.getAnchorUrl(""),n.onclick=()=>(this.linkService.executeNamedAction(f),!1),tt(this,At,Yt).call(this)}_bindAttachment(n,f){n.href=this.linkService.getAnchorUrl(""),n.onclick=()=>{var _;return(_=this.downloadManager)==null||_.openOrDownloadData(this.container,f.content,f.filename),!1},tt(this,At,Yt).call(this)}_bindJSAction(n,f){n.href=this.linkService.getAnchorUrl("");const _=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const E of Object.keys(f.actions)){const B=_.get(E);B&&(n[B]=()=>{var et;return(et=this.linkService.eventBus)==null||et.dispatch("dispatcheventinsandbox",{source:this,detail:{id:f.id,name:E}}),!1})}n.onclick||(n.onclick=()=>!1),tt(this,At,Yt).call(this)}_bindResetFormAction(n,f){const _=n.onclick;if(_||(n.href=this.linkService.getAnchorUrl("")),tt(this,At,Yt).call(this),!this._fieldObjects){(0,b.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),_||(n.onclick=()=>!1);return}n.onclick=()=>{var Z;_==null||_();const{fields:E,refs:B,include:et}=f,V=[];if(E.length!==0||B.length!==0){const it=new Set(B);for(const ut of E){const ft=this._fieldObjects[ut]||[];for(const{id:Et}of ft)it.add(Et)}for(const ut of Object.values(this._fieldObjects))for(const ft of ut)it.has(ft.id)===et&&V.push(ft)}else for(const it of Object.values(this._fieldObjects))V.push(...it);const nt=this.annotationStorage,rt=[];for(const it of V){const{id:ut}=it;switch(rt.push(ut),it.type){case"text":{const Et=it.defaultValue||"";nt.setValue(ut,{value:Et});break}case"checkbox":case"radiobutton":{const Et=it.defaultValue===it.exportValues;nt.setValue(ut,{value:Et});break}case"combobox":case"listbox":{const Et=it.defaultValue||"";nt.setValue(ut,{value:Et});break}default:continue}const ft=document.querySelector(`[data-element-id="${ut}"]`);if(ft){if(!v.has(ft)){(0,b.warn)(`_bindResetFormAction - element not allowed: ${ut}`);continue}}else continue;ft.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Z=this.linkService.eventBus)==null||Z.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:rt,name:"ResetForm"}})),!1}}}At=new WeakSet,Yt=function(){this.container.setAttribute("data-internal-link","")},l=new WeakSet,ns=function(n,f){n.href=this.linkService.getAnchorUrl(""),n.onclick=()=>(this.linkService.executeSetOCGState(f),!1),tt(this,At,Yt).call(this)};class d extends x{constructor(e){var f,_,E;const n=!!(e.data.hasPopup||(f=e.data.titleObj)!=null&&f.str||(_=e.data.contentsObj)!=null&&_.str||(E=e.data.richText)!=null&&E.str);super(e,{isRenderable:n})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.alt="[{{type}} Annotation]",e.dataset.l10nId="text_annotation_type",e.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(e,this.data),this.container.append(e),this.container}}class r extends x{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(e){var n;this.data.hasOwnCanvas&&(((n=e.previousSibling)==null?void 0:n.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){const{isWin:n,isMac:f}=b.FeatureTest.platform;return n&&e.ctrlKey||f&&e.metaKey}_setEventListener(e,n,f,_){n.includes("mouse")?e.addEventListener(n,E=>{var B;(B=this.linkService.eventBus)==null||B.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:f,value:_(E),shift:E.shiftKey,modifier:this._getKeyModifier(E)}})}):e.addEventListener(n,E=>{var B;(B=this.linkService.eventBus)==null||B.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:f,value:_(E)}})})}_setEventListeners(e,n,f){var _;for(const[E,B]of n)(B==="Action"||(_=this.data.actions)!=null&&_[B])&&this._setEventListener(e,E,B,f)}_setBackgroundColor(e){const n=this.data.backgroundColor||null;e.style.backgroundColor=n===null?"transparent":b.Util.makeHexColor(n[0],n[1],n[2])}_setTextStyle(e){const n=["left","center","right"],{fontColor:f}=this.data.defaultAppearanceData,_=this.data.defaultAppearanceData.fontSize||L,E=e.style;let B;const et=2,V=nt=>Math.round(10*nt)/10;if(this.data.multiLine){const nt=Math.abs(this.data.rect[3]-this.data.rect[1]-et),rt=Math.round(nt/(b.LINE_FACTOR*_))||1,Z=nt/rt;B=Math.min(_,V(Z/b.LINE_FACTOR))}else{const nt=Math.abs(this.data.rect[3]-this.data.rect[1]-et);B=Math.min(_,V(nt/b.LINE_FACTOR))}E.fontSize=`calc(${B}px * var(--scale-factor))`,E.color=b.Util.makeHexColor(f[0],f[1],f[2]),this.data.textAlignment!==null&&(E.textAlign=n[this.data.textAlignment])}_setRequired(e,n){n?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",n)}}class A extends r{constructor(e){const n=e.renderForms||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:n})}setPropertyOnSiblings(e,n,f,_){const E=this.annotationStorage;for(const B of this._getElementsByName(e.name,e.id))B.domElement&&(B.domElement[n]=f),E.setValue(B.id,{[_]:f})}render(){var _;const e=this.annotationStorage,n=this.data.id;this.container.classList.add("textWidgetAnnotation");let f=null;if(this.renderForms){const E=e.getValue(n,{value:this.data.fieldValue});let B=E.formattedValue||E.value||"";const et=e.getValue(n,{charLimit:this.data.maxLen}).charLimit;et&&B.length>et&&(B=B.slice(0,et));const V={userValue:B,formattedValue:null,lastCommittedValue:null,commitKey:1};this.data.multiLine?(f=document.createElement("textarea"),f.textContent=B,this.data.doNotScroll&&(f.style.overflowY="hidden")):(f=document.createElement("input"),f.type="text",f.setAttribute("value",B),this.data.doNotScroll&&(f.style.overflowX="hidden")),this.data.hasOwnCanvas&&(f.hidden=!0),v.add(f),f.setAttribute("data-element-id",n),f.disabled=this.data.readOnly,f.name=this.data.fieldName,f.tabIndex=W,this._setRequired(f,this.data.required),et&&(f.maxLength=et),f.addEventListener("input",rt=>{e.setValue(n,{value:rt.target.value}),this.setPropertyOnSiblings(f,"value",rt.target.value,"value")}),f.addEventListener("resetform",rt=>{const Z=this.data.defaultFieldValue??"";f.value=V.userValue=Z,V.formattedValue=null});let nt=rt=>{const{formattedValue:Z}=V;Z!=null&&(rt.target.value=Z),rt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){f.addEventListener("focus",Z=>{const{target:it}=Z;V.userValue&&(it.value=V.userValue),V.lastCommittedValue=it.value,V.commitKey=1}),f.addEventListener("updatefromsandbox",Z=>{this.showElementAndHideCanvas(Z.target);const it={value(ut){V.userValue=ut.detail.value??"",e.setValue(n,{value:V.userValue.toString()}),ut.target.value=V.userValue},formattedValue(ut){const{formattedValue:ft}=ut.detail;V.formattedValue=ft,ft!=null&&ut.target!==document.activeElement&&(ut.target.value=ft),e.setValue(n,{formattedValue:ft})},selRange(ut){ut.target.setSelectionRange(...ut.detail.selRange)},charLimit:ut=>{var Ct;const{charLimit:ft}=ut.detail,{target:Et}=ut;if(ft===0){Et.removeAttribute("maxLength");return}Et.setAttribute("maxLength",ft);let _t=V.userValue;!_t||_t.length<=ft||(_t=_t.slice(0,ft),Et.value=V.userValue=_t,e.setValue(n,{value:_t}),(Ct=this.linkService.eventBus)==null||Ct.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n,name:"Keystroke",value:_t,willCommit:!0,commitKey:1,selStart:Et.selectionStart,selEnd:Et.selectionEnd}}))}};this._dispatchEventFromSandbox(it,Z)}),f.addEventListener("keydown",Z=>{var ft;V.commitKey=1;let it=-1;if(Z.key==="Escape"?it=0:Z.key==="Enter"&&!this.data.multiLine?it=2:Z.key==="Tab"&&(V.commitKey=3),it===-1)return;const{value:ut}=Z.target;V.lastCommittedValue!==ut&&(V.lastCommittedValue=ut,V.userValue=ut,(ft=this.linkService.eventBus)==null||ft.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n,name:"Keystroke",value:ut,willCommit:!0,commitKey:it,selStart:Z.target.selectionStart,selEnd:Z.target.selectionEnd}}))});const rt=nt;nt=null,f.addEventListener("blur",Z=>{var ut;if(!Z.relatedTarget)return;const{value:it}=Z.target;V.userValue=it,V.lastCommittedValue!==it&&((ut=this.linkService.eventBus)==null||ut.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n,name:"Keystroke",value:it,willCommit:!0,commitKey:V.commitKey,selStart:Z.target.selectionStart,selEnd:Z.target.selectionEnd}})),rt(Z)}),(_=this.data.actions)!=null&&_.Keystroke&&f.addEventListener("beforeinput",Z=>{var bt;V.lastCommittedValue=null;const{data:it,target:ut}=Z,{value:ft,selectionStart:Et,selectionEnd:_t}=ut;let Ct=Et,G=_t;switch(Z.inputType){case"deleteWordBackward":{const yt=ft.substring(0,Et).match(/\w*[^\w]*$/);yt&&(Ct-=yt[0].length);break}case"deleteWordForward":{const yt=ft.substring(Et).match(/^[^\w]*\w*/);yt&&(G+=yt[0].length);break}case"deleteContentBackward":Et===_t&&(Ct-=1);break;case"deleteContentForward":Et===_t&&(G+=1);break}Z.preventDefault(),(bt=this.linkService.eventBus)==null||bt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n,name:"Keystroke",value:ft,change:it||"",willCommit:!1,selStart:Ct,selEnd:G}})}),this._setEventListeners(f,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Z=>Z.target.value)}if(nt&&f.addEventListener("blur",nt),this.data.comb){const Z=(this.data.rect[2]-this.data.rect[0])/et;f.classList.add("comb"),f.style.letterSpacing=`calc(${Z}px * var(--scale-factor) - 1ch)`}}else f=document.createElement("div"),f.textContent=this.data.fieldValue,f.style.verticalAlign="middle",f.style.display="table-cell";return this._setTextStyle(f),this._setBackgroundColor(f),this._setDefaultPropertiesFromJS(f),this.container.append(f),this.container}}class y extends r{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,n=this.data,f=n.id;let _=e.getValue(f,{value:n.exportValue===n.fieldValue}).value;typeof _=="string"&&(_=_!=="Off",e.setValue(f,{value:_})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const E=document.createElement("input");return v.add(E),E.setAttribute("data-element-id",f),E.disabled=n.readOnly,this._setRequired(E,this.data.required),E.type="checkbox",E.name=n.fieldName,_&&E.setAttribute("checked",!0),E.setAttribute("exportValue",n.exportValue),E.tabIndex=W,E.addEventListener("change",B=>{const{name:et,checked:V}=B.target;for(const nt of this._getElementsByName(et,f)){const rt=V&&nt.exportValue===n.exportValue;nt.domElement&&(nt.domElement.checked=rt),e.setValue(nt.id,{value:rt})}e.setValue(f,{value:V})}),E.addEventListener("resetform",B=>{const et=n.defaultFieldValue||"Off";B.target.checked=et===n.exportValue}),this.enableScripting&&this.hasJSActions&&(E.addEventListener("updatefromsandbox",B=>{const et={value(V){V.target.checked=V.detail.value!=="Off",e.setValue(f,{value:V.target.checked})}};this._dispatchEventFromSandbox(et,B)}),this._setEventListeners(E,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],B=>B.target.checked)),this._setBackgroundColor(E),this._setDefaultPropertiesFromJS(E),this.container.append(E),this.container}}class T extends r{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,n=this.data,f=n.id;let _=e.getValue(f,{value:n.fieldValue===n.buttonValue}).value;typeof _=="string"&&(_=_!==n.buttonValue,e.setValue(f,{value:_}));const E=document.createElement("input");if(v.add(E),E.setAttribute("data-element-id",f),E.disabled=n.readOnly,this._setRequired(E,this.data.required),E.type="radio",E.name=n.fieldName,_&&E.setAttribute("checked",!0),E.tabIndex=W,E.addEventListener("change",B=>{const{name:et,checked:V}=B.target;for(const nt of this._getElementsByName(et,f))e.setValue(nt.id,{value:!1});e.setValue(f,{value:V})}),E.addEventListener("resetform",B=>{const et=n.defaultFieldValue;B.target.checked=et!=null&&et===n.buttonValue}),this.enableScripting&&this.hasJSActions){const B=n.buttonValue;E.addEventListener("updatefromsandbox",et=>{const V={value:nt=>{const rt=B===nt.detail.value;for(const Z of this._getElementsByName(nt.target.name)){const it=rt&&Z.id===f;Z.domElement&&(Z.domElement.checked=it),e.setValue(Z.id,{value:it})}}};this._dispatchEventFromSandbox(V,et)}),this._setEventListeners(E,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],et=>et.target.checked)}return this._setBackgroundColor(E),this._setDefaultPropertiesFromJS(E),this.container.append(E),this.container}}class g extends p{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(e.title=this.data.alternativeText);const n=e.lastChild;return this.enableScripting&&this.hasJSActions&&n&&(this._setDefaultPropertiesFromJS(n),n.addEventListener("updatefromsandbox",f=>{this._dispatchEventFromSandbox({},f)})),e}}class t extends r{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,n=this.data.id,f=e.getValue(n,{value:this.data.fieldValue}),_=document.createElement("select");v.add(_),_.setAttribute("data-element-id",n),_.disabled=this.data.readOnly,this._setRequired(_,this.data.required),_.name=this.data.fieldName,_.tabIndex=W;let E=this.data.combo&&this.data.options.length>0;this.data.combo||(_.size=this.data.options.length,this.data.multiSelect&&(_.multiple=!0)),_.addEventListener("resetform",rt=>{const Z=this.data.defaultFieldValue;for(const it of _.options)it.selected=it.value===Z});for(const rt of this.data.options){const Z=document.createElement("option");Z.textContent=rt.displayValue,Z.value=rt.exportValue,f.value.includes(rt.exportValue)&&(Z.setAttribute("selected",!0),E=!1),_.append(Z)}let B=null;if(E){const rt=document.createElement("option");rt.value=" ",rt.setAttribute("hidden",!0),rt.setAttribute("selected",!0),_.prepend(rt),B=()=>{rt.remove(),_.removeEventListener("input",B),B=null},_.addEventListener("input",B)}const et=rt=>{const Z=rt?"value":"textContent",{options:it,multiple:ut}=_;return ut?Array.prototype.filter.call(it,ft=>ft.selected).map(ft=>ft[Z]):it.selectedIndex===-1?null:it[it.selectedIndex][Z]};let V=et(!1);const nt=rt=>{const Z=rt.target.options;return Array.prototype.map.call(Z,it=>({displayValue:it.textContent,exportValue:it.value}))};return this.enableScripting&&this.hasJSActions?(_.addEventListener("updatefromsandbox",rt=>{const Z={value(it){B==null||B();const ut=it.detail.value,ft=new Set(Array.isArray(ut)?ut:[ut]);for(const Et of _.options)Et.selected=ft.has(Et.value);e.setValue(n,{value:et(!0)}),V=et(!1)},multipleSelection(it){_.multiple=!0},remove(it){const ut=_.options,ft=it.detail.remove;ut[ft].selected=!1,_.remove(ft),ut.length>0&&Array.prototype.findIndex.call(ut,_t=>_t.selected)===-1&&(ut[0].selected=!0),e.setValue(n,{value:et(!0),items:nt(it)}),V=et(!1)},clear(it){for(;_.length!==0;)_.remove(0);e.setValue(n,{value:null,items:[]}),V=et(!1)},insert(it){const{index:ut,displayValue:ft,exportValue:Et}=it.detail.insert,_t=_.children[ut],Ct=document.createElement("option");Ct.textContent=ft,Ct.value=Et,_t?_t.before(Ct):_.append(Ct),e.setValue(n,{value:et(!0),items:nt(it)}),V=et(!1)},items(it){const{items:ut}=it.detail;for(;_.length!==0;)_.remove(0);for(const ft of ut){const{displayValue:Et,exportValue:_t}=ft,Ct=document.createElement("option");Ct.textContent=Et,Ct.value=_t,_.append(Ct)}_.options.length>0&&(_.options[0].selected=!0),e.setValue(n,{value:et(!0),items:nt(it)}),V=et(!1)},indices(it){const ut=new Set(it.detail.indices);for(const ft of it.target.options)ft.selected=ut.has(ft.index);e.setValue(n,{value:et(!0)}),V=et(!1)},editable(it){it.target.disabled=!it.detail.editable}};this._dispatchEventFromSandbox(Z,rt)}),_.addEventListener("input",rt=>{var it;const Z=et(!0);e.setValue(n,{value:Z}),rt.preventDefault(),(it=this.linkService.eventBus)==null||it.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n,name:"Keystroke",value:V,changeEx:Z,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(_,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],rt=>rt.target.value)):_.addEventListener("input",function(rt){e.setValue(n,{value:et(!0)})}),this.data.combo&&this._setTextStyle(_),this._setBackgroundColor(_),this._setDefaultPropertiesFromJS(_),this.container.append(_),this.container}}const S=class S extends x{constructor(e){var _,E,B;const{data:n}=e,f=!S.IGNORE_TYPES.has(n.parentType)&&!!((_=n.titleObj)!=null&&_.str||(E=n.contentsObj)!=null&&E.str||(B=n.richText)!=null&&B.str);super(e,{isRenderable:f})}render(){this.container.classList.add("popupAnnotation");const e=this.layer.querySelectorAll(`[data-annotation-id="${this.data.parentId}"]`);if(e.length===0)return this.container;const n=new o({container:this.container,trigger:Array.from(e),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),f=this.page,_=b.Util.normalizeRect([this.data.parentRect[0],f.view[3]-this.data.parentRect[1]+f.view[1],this.data.parentRect[2],f.view[3]-this.data.parentRect[3]+f.view[1]]),E=_[0]+this.data.parentRect[2]-this.data.parentRect[0],B=_[1],{pageWidth:et,pageHeight:V,pageX:nt,pageY:rt}=this.viewport.rawDims;return this.container.style.left=`${100*(E-nt)/et}%`,this.container.style.top=`${100*(B-rt)/V}%`,this.container.append(n.render()),this.container}};Dt(S,"IGNORE_TYPES",new Set(["Line","Square","Circle","PolyLine","Polygon","Ink"]));let a=S;class o{constructor(e){this.container=e.container,this.trigger=e.trigger,this.color=e.color,this.titleObj=e.titleObj,this.modificationDate=e.modificationDate,this.contentsObj=e.contentsObj,this.richText=e.richText,this.hideWrapper=e.hideWrapper||!1,this.pinned=!1}render(){var et,V;const n=document.createElement("div");n.classList.add("popupWrapper"),this.hideElement=this.hideWrapper?n:this.container,this.hideElement.hidden=!0;const f=document.createElement("div");f.classList.add("popup");const _=this.color;if(_){const nt=.7*(255-_[0])+_[0],rt=.7*(255-_[1])+_[1],Z=.7*(255-_[2])+_[2];f.style.backgroundColor=b.Util.makeHexColor(nt|0,rt|0,Z|0)}const E=document.createElement("h1");E.dir=this.titleObj.dir,E.textContent=this.titleObj.str,f.append(E);const B=k.PDFDateString.toDateObject(this.modificationDate);if(B){const nt=document.createElement("span");nt.classList.add("popupDate"),nt.textContent="{{date}}, {{time}}",nt.dataset.l10nId="annotation_date_string",nt.dataset.l10nArgs=JSON.stringify({date:B.toLocaleDateString(),time:B.toLocaleTimeString()}),f.append(nt)}if((et=this.richText)!=null&&et.str&&(!((V=this.contentsObj)!=null&&V.str)||this.contentsObj.str===this.richText.str))ot.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:f}),f.lastChild.classList.add("richText","popupContent");else{const nt=this._formatContents(this.contentsObj);f.append(nt)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const nt of this.trigger)nt.addEventListener("click",this._toggle.bind(this)),nt.addEventListener("mouseover",this._show.bind(this,!1)),nt.addEventListener("mouseout",this._hide.bind(this,!1));return f.addEventListener("click",this._hide.bind(this,!0)),n.append(f),n}_formatContents({str:e,dir:n}){const f=document.createElement("p");f.classList.add("popupContent"),f.dir=n;const _=e.split(/(?:\r\n?|\n)/);for(let E=0,B=_.length;E<B;++E){const et=_[E];f.append(document.createTextNode(et)),E<B-1&&f.append(document.createElement("br"))}return f}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(e=!1){e&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(e=!0){e&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class s extends x{constructor(e){var f,_,E;const n=!!(e.data.hasPopup||(f=e.data.titleObj)!=null&&f.str||(_=e.data.contentsObj)!=null&&_.str||(E=e.data.richText)!=null&&E.str);super(e,{isRenderable:n,ignoreBorder:!0}),this.textContent=e.data.textContent}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const n of this.textContent){const f=document.createElement("span");f.textContent=n,e.append(f)}this.container.append(e)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class c extends x{constructor(e){var f,_,E;const n=!!(e.data.hasPopup||(f=e.data.titleObj)!=null&&f.str||(_=e.data.contentsObj)!=null&&_.str||(E=e.data.richText)!=null&&E.str);super(e,{isRenderable:n,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:n,height:f}=N(e.rect),_=this.svgFactory.create(n,f,!0),E=this.svgFactory.createElement("svg:line");return E.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),E.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),E.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),E.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),E.setAttribute("stroke-width",e.borderStyle.width||1),E.setAttribute("stroke","transparent"),E.setAttribute("fill","transparent"),_.append(E),this.container.append(_),this._createPopup(E,e),this.container}}class P extends x{constructor(e){var f,_,E;const n=!!(e.data.hasPopup||(f=e.data.titleObj)!=null&&f.str||(_=e.data.contentsObj)!=null&&_.str||(E=e.data.richText)!=null&&E.str);super(e,{isRenderable:n,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:n,height:f}=N(e.rect),_=this.svgFactory.create(n,f,!0),E=e.borderStyle.width,B=this.svgFactory.createElement("svg:rect");return B.setAttribute("x",E/2),B.setAttribute("y",E/2),B.setAttribute("width",n-E),B.setAttribute("height",f-E),B.setAttribute("stroke-width",E||1),B.setAttribute("stroke","transparent"),B.setAttribute("fill","transparent"),_.append(B),this.container.append(_),this._createPopup(B,e),this.container}}class i extends x{constructor(e){var f,_,E;const n=!!(e.data.hasPopup||(f=e.data.titleObj)!=null&&f.str||(_=e.data.contentsObj)!=null&&_.str||(E=e.data.richText)!=null&&E.str);super(e,{isRenderable:n,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:n,height:f}=N(e.rect),_=this.svgFactory.create(n,f,!0),E=e.borderStyle.width,B=this.svgFactory.createElement("svg:ellipse");return B.setAttribute("cx",n/2),B.setAttribute("cy",f/2),B.setAttribute("rx",n/2-E/2),B.setAttribute("ry",f/2-E/2),B.setAttribute("stroke-width",E||1),B.setAttribute("stroke","transparent"),B.setAttribute("fill","transparent"),_.append(B),this.container.append(_),this._createPopup(B,e),this.container}}class I extends x{constructor(e){var f,_,E;const n=!!(e.data.hasPopup||(f=e.data.titleObj)!=null&&f.str||(_=e.data.contentsObj)!=null&&_.str||(E=e.data.richText)!=null&&E.str);super(e,{isRenderable:n,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:n,height:f}=N(e.rect),_=this.svgFactory.create(n,f,!0);let E=[];for(const et of e.vertices){const V=et.x-e.rect[0],nt=e.rect[3]-et.y;E.push(V+","+nt)}E=E.join(" ");const B=this.svgFactory.createElement(this.svgElementName);return B.setAttribute("points",E),B.setAttribute("stroke-width",e.borderStyle.width||1),B.setAttribute("stroke","transparent"),B.setAttribute("fill","transparent"),_.append(B),this.container.append(_),this._createPopup(B,e),this.container}}class q extends I{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class $ extends x{constructor(e){var f,_,E;const n=!!(e.data.hasPopup||(f=e.data.titleObj)!=null&&f.str||(_=e.data.contentsObj)!=null&&_.str||(E=e.data.richText)!=null&&E.str);super(e,{isRenderable:n,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}class J extends x{constructor(e){var f,_,E;const n=!!(e.data.hasPopup||(f=e.data.titleObj)!=null&&f.str||(_=e.data.contentsObj)!=null&&_.str||(E=e.data.richText)!=null&&E.str);super(e,{isRenderable:n,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:n,height:f}=N(e.rect),_=this.svgFactory.create(n,f,!0);for(const E of e.inkLists){let B=[];for(const V of E){const nt=V.x-e.rect[0],rt=e.rect[3]-V.y;B.push(`${nt},${rt}`)}B=B.join(" ");const et=this.svgFactory.createElement(this.svgElementName);et.setAttribute("points",B),et.setAttribute("stroke-width",e.borderStyle.width||1),et.setAttribute("stroke","transparent"),et.setAttribute("fill","transparent"),this._createPopup(et,e),_.append(et)}return this.container.append(_),this.container}}class st extends x{constructor(e){var f,_,E;const n=!!(e.data.hasPopup||(f=e.data.titleObj)!=null&&f.str||(_=e.data.contentsObj)!=null&&_.str||(E=e.data.richText)!=null&&E.str);super(e,{isRenderable:n,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.classList.add("highlightAnnotation"),this.container)}}class dt extends x{constructor(e){var f,_,E;const n=!!(e.data.hasPopup||(f=e.data.titleObj)!=null&&f.str||(_=e.data.contentsObj)!=null&&_.str||(E=e.data.richText)!=null&&E.str);super(e,{isRenderable:n,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.classList.add("underlineAnnotation"),this.container)}}class lt extends x{constructor(e){var f,_,E;const n=!!(e.data.hasPopup||(f=e.data.titleObj)!=null&&f.str||(_=e.data.contentsObj)!=null&&_.str||(E=e.data.richText)!=null&&E.str);super(e,{isRenderable:n,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.classList.add("squigglyAnnotation"),this.container)}}class ht extends x{constructor(e){var f,_,E;const n=!!(e.data.hasPopup||(f=e.data.titleObj)!=null&&f.str||(_=e.data.contentsObj)!=null&&_.str||(E=e.data.richText)!=null&&E.str);super(e,{isRenderable:n,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.classList.add("strikeoutAnnotation"),this.container)}}class mt extends x{constructor(e){var f,_,E;const n=!!(e.data.hasPopup||(f=e.data.titleObj)!=null&&f.str||(_=e.data.contentsObj)!=null&&_.str||(E=e.data.richText)!=null&&E.str);super(e,{isRenderable:n,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}class vt extends x{constructor(e){var _;super(e,{isRenderable:!0});const{filename:n,content:f}=this.data.file;this.filename=(0,k.getFilenameFromUrl)(n,!0),this.content=f,(_=this.linkService.eventBus)==null||_.dispatch("fileattachmentannotation",{source:this,filename:n,content:f})}render(){var n,f;this.container.classList.add("fileAttachmentAnnotation");let e;return this.data.hasAppearance?e=document.createElement("div"):(e=document.createElement("img"),e.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(this.data.name)?"paperclip":"pushpin"}.svg`),e.classList.add("popupTriggerArea"),e.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((n=this.data.titleObj)!=null&&n.str||(f=this.data.contentsObj)!=null&&f.str||this.data.richText)&&this._createPopup(e,this.data),this.container.append(e),this.container}_download(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.container,this.content,this.filename)}}const R=class R{static render(e){var V,nt;const{annotations:n,div:f,viewport:_,accessibilityManager:E}=e;(0,k.setLayerDimensions)(f,_);const B={data:null,layer:f,page:e.page,viewport:_,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new k.DOMSVGFactory,annotationStorage:e.annotationStorage||new X.AnnotationStorage,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects};let et=0;for(const rt of n){if(rt.noHTML)continue;if(rt.annotationType!==b.AnnotationType.POPUP){const{width:ut,height:ft}=N(rt.rect);if(ut<=0||ft<=0)continue}B.data=rt;const Z=w.create(B);if(!Z.isRenderable)continue;const it=Z.render();if(rt.hidden&&(it.style.visibility="hidden"),Array.isArray(it))for(const ut of it)ut.style.zIndex=et++,tt(V=R,j,Fe).call(V,ut,rt.id,f,E);else it.style.zIndex=et++,Z instanceof a?f.prepend(it):tt(nt=R,j,Fe).call(nt,it,rt.id,f,E)}tt(this,H,Re).call(this,f,e.annotationCanvasMap)}static update(e){const{annotationCanvasMap:n,div:f,viewport:_}=e;(0,k.setLayerDimensions)(f,{rotation:_.rotation}),tt(this,H,Re).call(this,f,n),f.hidden=!1}};j=new WeakSet,Fe=function(e,n,f,_){const E=e.firstChild||e;E.id=`${k.AnnotationPrefix}${n}`,f.append(e),_==null||_.moveElementInDOM(f,e,E,!1)},H=new WeakSet,Re=function(e,n){if(n){for(const[f,_]of n){const E=e.querySelector(`[data-annotation-id="${f}"]`);if(!E)continue;const{firstChild:B}=E;B?B.nodeName==="CANVAS"?B.replaceWith(_):B.before(_):E.append(_)}n.clear()}},K(R,j),K(R,H);let St=R;m.AnnotationLayer=St},(Q,m)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.ColorConverters=void 0;function Y(k){return Math.floor(Math.max(0,Math.min(1,k))*255).toString(16).padStart(2,"0")}class b{static CMYK_G([X,z,ot,W]){return["G",1-Math.min(1,.3*X+.59*ot+.11*z+W)]}static G_CMYK([X]){return["CMYK",0,0,0,1-X]}static G_RGB([X]){return["RGB",X,X,X]}static G_HTML([X]){const z=Y(X);return`#${z}${z}${z}`}static RGB_G([X,z,ot]){return["G",.3*X+.59*z+.11*ot]}static RGB_HTML([X,z,ot]){const W=Y(X),L=Y(z),v=Y(ot);return`#${W}${L}${v}`}static T_HTML(){return"#00000000"}static CMYK_RGB([X,z,ot,W]){return["RGB",1-Math.min(1,X+W),1-Math.min(1,ot+W),1-Math.min(1,z+W)]}static CMYK_HTML(X){const z=this.CMYK_RGB(X).slice(1);return this.RGB_HTML(z)}static RGB_CMYK([X,z,ot]){const W=1-X,L=1-z,v=1-ot,N=Math.min(W,L,v);return["CMYK",W,L,v,N]}}m.ColorConverters=b},(Q,m,Y)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.XfaLayer=void 0;var b=Y(19);class k{static setupStorage(z,ot,W,L,v){const N=L.getValue(ot,{value:null});switch(W.name){case"textarea":if(N.value!==null&&(z.textContent=N.value),v==="print")break;z.addEventListener("input",w=>{L.setValue(ot,{value:w.target.value})});break;case"input":if(W.attributes.type==="radio"||W.attributes.type==="checkbox"){if(N.value===W.attributes.xfaOn?z.setAttribute("checked",!0):N.value===W.attributes.xfaOff&&z.removeAttribute("checked"),v==="print")break;z.addEventListener("change",w=>{L.setValue(ot,{value:w.target.checked?w.target.getAttribute("xfaOn"):w.target.getAttribute("xfaOff")})})}else{if(N.value!==null&&z.setAttribute("value",N.value),v==="print")break;z.addEventListener("input",w=>{L.setValue(ot,{value:w.target.value})})}break;case"select":if(N.value!==null)for(const w of W.children)w.attributes.value===N.value&&(w.attributes.selected=!0);z.addEventListener("input",w=>{const x=w.target.options,p=x.selectedIndex===-1?"":x[x.selectedIndex].value;L.setValue(ot,{value:p})});break}}static setAttributes({html:z,element:ot,storage:W=null,intent:L,linkService:v}){const{attributes:N}=ot,w=z instanceof HTMLAnchorElement;N.type==="radio"&&(N.name=`${N.name}-${L}`);for(const[x,p]of Object.entries(N))if(p!=null)switch(x){case"class":p.length&&z.setAttribute(x,p.join(" "));break;case"dataId":break;case"id":z.setAttribute("data-element-id",p);break;case"style":Object.assign(z.style,p);break;case"textContent":z.textContent=p;break;default:(!w||x!=="href"&&x!=="newWindow")&&z.setAttribute(x,p)}w&&v.addLinkAttributes(z,N.href,N.newWindow),W&&N.dataId&&this.setupStorage(z,N.dataId,ot,W)}static render(z){var d;const ot=z.annotationStorage,W=z.linkService,L=z.xfaHtml,v=z.intent||"display",N=document.createElement(L.name);L.attributes&&this.setAttributes({html:N,element:L,intent:v,linkService:W});const w=[[L,-1,N]],x=z.div;if(x.append(N),z.viewport){const r=`matrix(${z.viewport.transform.join(",")})`;x.style.transform=r}v!=="richText"&&x.setAttribute("class","xfaLayer xfaFont");const p=[];for(;w.length>0;){const[r,A,y]=w.at(-1);if(A+1===r.children.length){w.pop();continue}const T=r.children[++w.at(-1)[1]];if(T===null)continue;const{name:g}=T;if(g==="#text"){const a=document.createTextNode(T.value);p.push(a),y.append(a);continue}let t;if((d=T==null?void 0:T.attributes)!=null&&d.xmlns?t=document.createElementNS(T.attributes.xmlns,g):t=document.createElement(g),y.append(t),T.attributes&&this.setAttributes({html:t,element:T,storage:ot,intent:v,linkService:W}),T.children&&T.children.length>0)w.push([T,-1,t]);else if(T.value){const a=document.createTextNode(T.value);b.XfaText.shouldBuildText(g)&&p.push(a),t.append(a)}}for(const r of x.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))r.setAttribute("readOnly",!0);return{textDivs:p}}static update(z){const ot=`matrix(${z.viewport.transform.join(",")})`;z.div.style.transform=ot,z.div.hidden=!1}}m.XfaLayer=k},(Q,m,Y)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.SVGGraphics=void 0;var b=Y(6),k=Y(1),X=Y(10);let z=class{constructor(){(0,k.unreachable)("Not implemented: SVGGraphics")}};m.SVGGraphics=z;{let d=function(t){let a=[];const o=[];for(const s of t){if(s.fn==="save"){a.push({fnId:92,fn:"group",items:[]}),o.push(a),a=a.at(-1).items;continue}s.fn==="restore"?a=o.pop():a.push(s)}return a},r=function(t){if(Number.isInteger(t))return t.toString();const a=t.toFixed(10);let o=a.length-1;if(a[o]!=="0")return a;do o--;while(a[o]==="0");return a.substring(0,a[o]==="."?o:o+1)},A=function(t){if(t[4]===0&&t[5]===0){if(t[1]===0&&t[2]===0)return t[0]===1&&t[3]===1?"":`scale(${r(t[0])} ${r(t[3])})`;if(t[0]===t[3]&&t[1]===-t[2]){const a=Math.acos(t[0])*180/Math.PI;return`rotate(${r(a)})`}}else if(t[0]===1&&t[1]===0&&t[2]===0&&t[3]===1)return`translate(${r(t[4])} ${r(t[5])})`;return`matrix(${r(t[0])} ${r(t[1])} ${r(t[2])} ${r(t[3])} ${r(t[4])} ${r(t[5])})`};const ot={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},W="http://www.w3.org/XML/1998/namespace",L="http://www.w3.org/1999/xlink",v=["butt","round","square"],N=["miter","round","bevel"],w=function(t,a="",o=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!o)return URL.createObjectURL(new Blob([t],{type:a}));const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let c=`data:${a};base64,`;for(let P=0,i=t.length;P<i;P+=3){const I=t[P]&255,q=t[P+1]&255,$=t[P+2]&255,J=I>>2,st=(I&3)<<4|q>>4,dt=P+1<i?(q&15)<<2|$>>6:64,lt=P+2<i?$&63:64;c+=s[J]+s[st]+s[dt]+s[lt]}return c},x=function(){const t=new Uint8Array([137,80,78,71,13,10,26,10]),a=12,o=new Int32Array(256);for(let $=0;$<256;$++){let J=$;for(let st=0;st<8;st++)J&1?J=3988292384^J>>1&2147483647:J=J>>1&2147483647;o[$]=J}function s($,J,st){let dt=-1;for(let lt=J;lt<st;lt++){const ht=(dt^$[lt])&255,mt=o[ht];dt=dt>>>8^mt}return dt^-1}function c($,J,st,dt){let lt=dt;const ht=J.length;st[lt]=ht>>24&255,st[lt+1]=ht>>16&255,st[lt+2]=ht>>8&255,st[lt+3]=ht&255,lt+=4,st[lt]=$.charCodeAt(0)&255,st[lt+1]=$.charCodeAt(1)&255,st[lt+2]=$.charCodeAt(2)&255,st[lt+3]=$.charCodeAt(3)&255,lt+=4,st.set(J,lt),lt+=J.length;const mt=s(st,dt+4,lt);st[lt]=mt>>24&255,st[lt+1]=mt>>16&255,st[lt+2]=mt>>8&255,st[lt+3]=mt&255}function P($,J,st){let dt=1,lt=0;for(let ht=J;ht<st;++ht)dt=(dt+($[ht]&255))%65521,lt=(lt+dt)%65521;return lt<<16|dt}function i($){if(!X.isNodeJS)return I($);try{let J;parseInt(process.versions.node)>=8?J=$:J=Buffer.from($);const st=require$$5.deflateSync(J,{level:9});return st instanceof Uint8Array?st:new Uint8Array(st)}catch(J){(0,k.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+J)}return I($)}function I($){let J=$.length;const st=65535,dt=Math.ceil(J/st),lt=new Uint8Array(2+J+dt*5+4);let ht=0;lt[ht++]=120,lt[ht++]=156;let mt=0;for(;J>st;)lt[ht++]=0,lt[ht++]=255,lt[ht++]=255,lt[ht++]=0,lt[ht++]=0,lt.set($.subarray(mt,mt+st),ht),ht+=st,mt+=st,J-=st;lt[ht++]=1,lt[ht++]=J&255,lt[ht++]=J>>8&255,lt[ht++]=~J&65535&255,lt[ht++]=(~J&65535)>>8&255,lt.set($.subarray(mt),ht),ht+=$.length-mt;const vt=P($,0,$.length);return lt[ht++]=vt>>24&255,lt[ht++]=vt>>16&255,lt[ht++]=vt>>8&255,lt[ht++]=vt&255,lt}function q($,J,st,dt){const lt=$.width,ht=$.height;let mt,vt,St;const At=$.data;switch(J){case k.ImageKind.GRAYSCALE_1BPP:vt=0,mt=1,St=lt+7>>3;break;case k.ImageKind.RGB_24BPP:vt=2,mt=8,St=lt*3;break;case k.ImageKind.RGBA_32BPP:vt=6,mt=8,St=lt*4;break;default:throw new Error("invalid format")}const U=new Uint8Array((1+St)*ht);let l=0,h=0;for(let R=0;R<ht;++R)U[l++]=0,U.set(At.subarray(h,h+St),l),h+=St,l+=St;if(J===k.ImageKind.GRAYSCALE_1BPP&&dt){l=0;for(let R=0;R<ht;R++){l++;for(let M=0;M<St;M++)U[l++]^=255}}const S=new Uint8Array([lt>>24&255,lt>>16&255,lt>>8&255,lt&255,ht>>24&255,ht>>16&255,ht>>8&255,ht&255,mt,vt,0,0,0]),j=i(U),D=t.length+a*3+S.length+j.length,H=new Uint8Array(D);let O=0;return H.set(t,O),O+=t.length,c("IHDR",S,H,O),O+=a+S.length,c("IDATA",j,H,O),O+=a+j.length,c("IEND",new Uint8Array(0),H,O),w(H,"image/png",st)}return function(J,st,dt){const lt=J.kind===void 0?k.ImageKind.GRAYSCALE_1BPP:J.kind;return q(J,lt,st,dt)}}();class p{constructor(){this.fontSizeScale=1,this.fontWeight=ot.fontWeight,this.fontSize=0,this.textMatrix=k.IDENTITY_MATRIX,this.fontMatrix=k.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=k.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=ot.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(a,o){this.x=a,this.y=o}}let y=0,T=0,g=0;m.SVGGraphics=z=class{constructor(t,a,o=!1){(0,b.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new b.DOMSVGFactory,this.current=new p,this.transformMatrix=k.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=t,this.objs=a,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!o,this._operatorIdMapping=[];for(const s in k.OPS)this._operatorIdMapping[k.OPS[s]]=s}getObject(t,a=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):a}save(){this.transformStack.push(this.transformMatrix);const t=this.current;this.extraStack.push(t),this.current=t.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(t){this.save(),this.executeOpTree(t),this.restore()}loadDependencies(t){const a=t.fnArray,o=t.argsArray;for(let s=0,c=a.length;s<c;s++)if(a[s]===k.OPS.dependency)for(const P of o[s]){const i=P.startsWith("g_")?this.commonObjs:this.objs,I=new Promise(q=>{i.get(P,q)});this.current.dependencies.push(I)}return Promise.all(this.current.dependencies)}transform(t,a,o,s,c,P){const i=[t,a,o,s,c,P];this.transformMatrix=k.Util.transform(this.transformMatrix,i),this.tgrp=null}getSVG(t,a){this.viewport=a;const o=this._initialize(a);return this.loadDependencies(t).then(()=>(this.transformMatrix=k.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(t)),o))}convertOpList(t){const a=this._operatorIdMapping,o=t.argsArray,s=t.fnArray,c=[];for(let P=0,i=s.length;P<i;P++){const I=s[P];c.push({fnId:I,fn:a[I],args:o[P]})}return d(c)}executeOpTree(t){for(const a of t){const o=a.fn,s=a.fnId,c=a.args;switch(s|0){case k.OPS.beginText:this.beginText();break;case k.OPS.dependency:break;case k.OPS.setLeading:this.setLeading(c);break;case k.OPS.setLeadingMoveText:this.setLeadingMoveText(c[0],c[1]);break;case k.OPS.setFont:this.setFont(c);break;case k.OPS.showText:this.showText(c[0]);break;case k.OPS.showSpacedText:this.showText(c[0]);break;case k.OPS.endText:this.endText();break;case k.OPS.moveText:this.moveText(c[0],c[1]);break;case k.OPS.setCharSpacing:this.setCharSpacing(c[0]);break;case k.OPS.setWordSpacing:this.setWordSpacing(c[0]);break;case k.OPS.setHScale:this.setHScale(c[0]);break;case k.OPS.setTextMatrix:this.setTextMatrix(c[0],c[1],c[2],c[3],c[4],c[5]);break;case k.OPS.setTextRise:this.setTextRise(c[0]);break;case k.OPS.setTextRenderingMode:this.setTextRenderingMode(c[0]);break;case k.OPS.setLineWidth:this.setLineWidth(c[0]);break;case k.OPS.setLineJoin:this.setLineJoin(c[0]);break;case k.OPS.setLineCap:this.setLineCap(c[0]);break;case k.OPS.setMiterLimit:this.setMiterLimit(c[0]);break;case k.OPS.setFillRGBColor:this.setFillRGBColor(c[0],c[1],c[2]);break;case k.OPS.setStrokeRGBColor:this.setStrokeRGBColor(c[0],c[1],c[2]);break;case k.OPS.setStrokeColorN:this.setStrokeColorN(c);break;case k.OPS.setFillColorN:this.setFillColorN(c);break;case k.OPS.shadingFill:this.shadingFill(c[0]);break;case k.OPS.setDash:this.setDash(c[0],c[1]);break;case k.OPS.setRenderingIntent:this.setRenderingIntent(c[0]);break;case k.OPS.setFlatness:this.setFlatness(c[0]);break;case k.OPS.setGState:this.setGState(c[0]);break;case k.OPS.fill:this.fill();break;case k.OPS.eoFill:this.eoFill();break;case k.OPS.stroke:this.stroke();break;case k.OPS.fillStroke:this.fillStroke();break;case k.OPS.eoFillStroke:this.eoFillStroke();break;case k.OPS.clip:this.clip("nonzero");break;case k.OPS.eoClip:this.clip("evenodd");break;case k.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case k.OPS.paintImageXObject:this.paintImageXObject(c[0]);break;case k.OPS.paintInlineImageXObject:this.paintInlineImageXObject(c[0]);break;case k.OPS.paintImageMaskXObject:this.paintImageMaskXObject(c[0]);break;case k.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(c[0],c[1]);break;case k.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case k.OPS.closePath:this.closePath();break;case k.OPS.closeStroke:this.closeStroke();break;case k.OPS.closeFillStroke:this.closeFillStroke();break;case k.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case k.OPS.nextLine:this.nextLine();break;case k.OPS.transform:this.transform(c[0],c[1],c[2],c[3],c[4],c[5]);break;case k.OPS.constructPath:this.constructPath(c[0],c[1]);break;case k.OPS.endPath:this.endPath();break;case 92:this.group(a.items);break;default:(0,k.warn)(`Unimplemented operator ${o}`);break}}}setWordSpacing(t){this.current.wordSpacing=t}setCharSpacing(t){this.current.charSpacing=t}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(t,a,o,s,c,P){const i=this.current;i.textMatrix=i.lineMatrix=[t,a,o,s,c,P],i.textMatrixScale=Math.hypot(t,a),i.x=i.lineX=0,i.y=i.lineY=0,i.xcoords=[],i.ycoords=[],i.tspan=this.svgFactory.createElement("svg:tspan"),i.tspan.setAttributeNS(null,"font-family",i.fontFamily),i.tspan.setAttributeNS(null,"font-size",`${r(i.fontSize)}px`),i.tspan.setAttributeNS(null,"y",r(-i.y)),i.txtElement=this.svgFactory.createElement("svg:text"),i.txtElement.append(i.tspan)}beginText(){const t=this.current;t.x=t.lineX=0,t.y=t.lineY=0,t.textMatrix=k.IDENTITY_MATRIX,t.lineMatrix=k.IDENTITY_MATRIX,t.textMatrixScale=1,t.tspan=this.svgFactory.createElement("svg:tspan"),t.txtElement=this.svgFactory.createElement("svg:text"),t.txtgrp=this.svgFactory.createElement("svg:g"),t.xcoords=[],t.ycoords=[]}moveText(t,a){const o=this.current;o.x=o.lineX+=t,o.y=o.lineY+=a,o.xcoords=[],o.ycoords=[],o.tspan=this.svgFactory.createElement("svg:tspan"),o.tspan.setAttributeNS(null,"font-family",o.fontFamily),o.tspan.setAttributeNS(null,"font-size",`${r(o.fontSize)}px`),o.tspan.setAttributeNS(null,"y",r(-o.y))}showText(t){const a=this.current,o=a.font,s=a.fontSize;if(s===0)return;const c=a.fontSizeScale,P=a.charSpacing,i=a.wordSpacing,I=a.fontDirection,q=a.textHScale*I,$=o.vertical,J=$?1:-1,st=o.defaultVMetrics,dt=s*a.fontMatrix[0];let lt=0;for(const vt of t){if(vt===null){lt+=I*i;continue}else if(typeof vt=="number"){lt+=J*vt*s/1e3;continue}const St=(vt.isSpace?i:0)+P,At=vt.fontChar;let U,l,h=vt.width;if($){let j;const D=vt.vmetric||st;j=vt.vmetric?D[1]:h*.5,j=-j*dt;const H=D[2]*dt;h=D?-D[0]:h,U=j/c,l=(lt+H)/c}else U=lt/c,l=0;(vt.isInFont||o.missingFile)&&(a.xcoords.push(a.x+U),$&&a.ycoords.push(-a.y+l),a.tspan.textContent+=At);let S;$?S=h*dt-St*I:S=h*dt+St*I,lt+=S}a.tspan.setAttributeNS(null,"x",a.xcoords.map(r).join(" ")),$?a.tspan.setAttributeNS(null,"y",a.ycoords.map(r).join(" ")):a.tspan.setAttributeNS(null,"y",r(-a.y)),$?a.y-=lt:a.x+=lt*q,a.tspan.setAttributeNS(null,"font-family",a.fontFamily),a.tspan.setAttributeNS(null,"font-size",`${r(a.fontSize)}px`),a.fontStyle!==ot.fontStyle&&a.tspan.setAttributeNS(null,"font-style",a.fontStyle),a.fontWeight!==ot.fontWeight&&a.tspan.setAttributeNS(null,"font-weight",a.fontWeight);const ht=a.textRenderingMode&k.TextRenderingMode.FILL_STROKE_MASK;if(ht===k.TextRenderingMode.FILL||ht===k.TextRenderingMode.FILL_STROKE?(a.fillColor!==ot.fillColor&&a.tspan.setAttributeNS(null,"fill",a.fillColor),a.fillAlpha<1&&a.tspan.setAttributeNS(null,"fill-opacity",a.fillAlpha)):a.textRenderingMode===k.TextRenderingMode.ADD_TO_PATH?a.tspan.setAttributeNS(null,"fill","transparent"):a.tspan.setAttributeNS(null,"fill","none"),ht===k.TextRenderingMode.STROKE||ht===k.TextRenderingMode.FILL_STROKE){const vt=1/(a.textMatrixScale||1);this._setStrokeAttributes(a.tspan,vt)}let mt=a.textMatrix;a.textRise!==0&&(mt=mt.slice(),mt[5]+=a.textRise),a.txtElement.setAttributeNS(null,"transform",`${A(mt)} scale(${r(q)}, -1)`),a.txtElement.setAttributeNS(W,"xml:space","preserve"),a.txtElement.append(a.tspan),a.txtgrp.append(a.txtElement),this._ensureTransformGroup().append(a.txtElement)}setLeadingMoveText(t,a){this.setLeading(-a),this.moveText(t,a)}addFontStyle(t){if(!t.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const a=w(t.data,t.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${t.loadedName}"; src: url(${a}); }
`}setFont(t){const a=this.current,o=this.commonObjs.get(t[0]);let s=t[1];a.font=o,this.embedFonts&&!o.missingFile&&!this.embeddedFonts[o.loadedName]&&(this.addFontStyle(o),this.embeddedFonts[o.loadedName]=o),a.fontMatrix=o.fontMatrix||k.FONT_IDENTITY_MATRIX;let c="normal";o.black?c="900":o.bold&&(c="bold");const P=o.italic?"italic":"normal";s<0?(s=-s,a.fontDirection=-1):a.fontDirection=1,a.fontSize=s,a.fontFamily=o.loadedName,a.fontWeight=c,a.fontStyle=P,a.tspan=this.svgFactory.createElement("svg:tspan"),a.tspan.setAttributeNS(null,"y",r(-a.y)),a.xcoords=[],a.ycoords=[]}endText(){var a;const t=this.current;t.textRenderingMode&k.TextRenderingMode.ADD_TO_PATH_FLAG&&((a=t.txtElement)!=null&&a.hasChildNodes())&&(t.element=t.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(t){t>0&&(this.current.lineWidth=t)}setLineCap(t){this.current.lineCap=v[t]}setLineJoin(t){this.current.lineJoin=N[t]}setMiterLimit(t){this.current.miterLimit=t}setStrokeAlpha(t){this.current.strokeAlpha=t}setStrokeRGBColor(t,a,o){this.current.strokeColor=k.Util.makeHexColor(t,a,o)}setFillAlpha(t){this.current.fillAlpha=t}setFillRGBColor(t,a,o){this.current.fillColor=k.Util.makeHexColor(t,a,o),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(t){this.current.strokeColor=this._makeColorN_Pattern(t)}setFillColorN(t){this.current.fillColor=this._makeColorN_Pattern(t)}shadingFill(t){const a=this.viewport.width,o=this.viewport.height,s=k.Util.inverseTransform(this.transformMatrix),c=k.Util.applyTransform([0,0],s),P=k.Util.applyTransform([0,o],s),i=k.Util.applyTransform([a,0],s),I=k.Util.applyTransform([a,o],s),q=Math.min(c[0],P[0],i[0],I[0]),$=Math.min(c[1],P[1],i[1],I[1]),J=Math.max(c[0],P[0],i[0],I[0]),st=Math.max(c[1],P[1],i[1],I[1]),dt=this.svgFactory.createElement("svg:rect");dt.setAttributeNS(null,"x",q),dt.setAttributeNS(null,"y",$),dt.setAttributeNS(null,"width",J-q),dt.setAttributeNS(null,"height",st-$),dt.setAttributeNS(null,"fill",this._makeShadingPattern(t)),this.current.fillAlpha<1&&dt.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(dt)}_makeColorN_Pattern(t){return t[0]==="TilingPattern"?this._makeTilingPattern(t):this._makeShadingPattern(t)}_makeTilingPattern(t){const a=t[1],o=t[2],s=t[3]||k.IDENTITY_MATRIX,[c,P,i,I]=t[4],q=t[5],$=t[6],J=t[7],st=`shading${g++}`,[dt,lt,ht,mt]=k.Util.normalizeRect([...k.Util.applyTransform([c,P],s),...k.Util.applyTransform([i,I],s)]),[vt,St]=k.Util.singularValueDecompose2dScale(s),At=q*vt,U=$*St,l=this.svgFactory.createElement("svg:pattern");l.setAttributeNS(null,"id",st),l.setAttributeNS(null,"patternUnits","userSpaceOnUse"),l.setAttributeNS(null,"width",At),l.setAttributeNS(null,"height",U),l.setAttributeNS(null,"x",`${dt}`),l.setAttributeNS(null,"y",`${lt}`);const h=this.svg,S=this.transformMatrix,j=this.current.fillColor,D=this.current.strokeColor,H=this.svgFactory.create(ht-dt,mt-lt);if(this.svg=H,this.transformMatrix=s,J===2){const O=k.Util.makeHexColor(...a);this.current.fillColor=O,this.current.strokeColor=O}return this.executeOpTree(this.convertOpList(o)),this.svg=h,this.transformMatrix=S,this.current.fillColor=j,this.current.strokeColor=D,l.append(H.childNodes[0]),this.defs.append(l),`url(#${st})`}_makeShadingPattern(t){switch(typeof t=="string"&&(t=this.objs.get(t)),t[0]){case"RadialAxial":const a=`shading${g++}`,o=t[3];let s;switch(t[1]){case"axial":const c=t[4],P=t[5];s=this.svgFactory.createElement("svg:linearGradient"),s.setAttributeNS(null,"id",a),s.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),s.setAttributeNS(null,"x1",c[0]),s.setAttributeNS(null,"y1",c[1]),s.setAttributeNS(null,"x2",P[0]),s.setAttributeNS(null,"y2",P[1]);break;case"radial":const i=t[4],I=t[5],q=t[6],$=t[7];s=this.svgFactory.createElement("svg:radialGradient"),s.setAttributeNS(null,"id",a),s.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),s.setAttributeNS(null,"cx",I[0]),s.setAttributeNS(null,"cy",I[1]),s.setAttributeNS(null,"r",$),s.setAttributeNS(null,"fx",i[0]),s.setAttributeNS(null,"fy",i[1]),s.setAttributeNS(null,"fr",q);break;default:throw new Error(`Unknown RadialAxial type: ${t[1]}`)}for(const c of o){const P=this.svgFactory.createElement("svg:stop");P.setAttributeNS(null,"offset",c[0]),P.setAttributeNS(null,"stop-color",c[1]),s.append(P)}return this.defs.append(s),`url(#${a})`;case"Mesh":return(0,k.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${t[0]}`)}}setDash(t,a){this.current.dashArray=t,this.current.dashPhase=a}constructPath(t,a){const o=this.current;let s=o.x,c=o.y,P=[],i=0;for(const I of t)switch(I|0){case k.OPS.rectangle:s=a[i++],c=a[i++];const q=a[i++],$=a[i++],J=s+q,st=c+$;P.push("M",r(s),r(c),"L",r(J),r(c),"L",r(J),r(st),"L",r(s),r(st),"Z");break;case k.OPS.moveTo:s=a[i++],c=a[i++],P.push("M",r(s),r(c));break;case k.OPS.lineTo:s=a[i++],c=a[i++],P.push("L",r(s),r(c));break;case k.OPS.curveTo:s=a[i+4],c=a[i+5],P.push("C",r(a[i]),r(a[i+1]),r(a[i+2]),r(a[i+3]),r(s),r(c)),i+=6;break;case k.OPS.curveTo2:P.push("C",r(s),r(c),r(a[i]),r(a[i+1]),r(a[i+2]),r(a[i+3])),s=a[i+2],c=a[i+3],i+=4;break;case k.OPS.curveTo3:s=a[i+2],c=a[i+3],P.push("C",r(a[i]),r(a[i+1]),r(s),r(c),r(s),r(c)),i+=4;break;case k.OPS.closePath:P.push("Z");break}P=P.join(" "),o.path&&t.length>0&&t[0]!==k.OPS.rectangle&&t[0]!==k.OPS.moveTo?P=o.path.getAttributeNS(null,"d")+P:(o.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(o.path)),o.path.setAttributeNS(null,"d",P),o.path.setAttributeNS(null,"fill","none"),o.element=o.path,o.setCurrentPoint(s,c)}endPath(){const t=this.current;if(t.path=null,!this.pendingClip)return;if(!t.element){this.pendingClip=null;return}const a=`clippath${y++}`,o=this.svgFactory.createElement("svg:clipPath");o.setAttributeNS(null,"id",a),o.setAttributeNS(null,"transform",A(this.transformMatrix));const s=t.element.cloneNode(!0);if(this.pendingClip==="evenodd"?s.setAttributeNS(null,"clip-rule","evenodd"):s.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,o.append(s),this.defs.append(o),t.activeClipUrl){t.clipGroup=null;for(const c of this.extraStack)c.clipGroup=null;o.setAttributeNS(null,"clip-path",t.activeClipUrl)}t.activeClipUrl=`url(#${a})`,this.tgrp=null}clip(t){this.pendingClip=t}closePath(){const t=this.current;if(t.path){const a=`${t.path.getAttributeNS(null,"d")}Z`;t.path.setAttributeNS(null,"d",a)}}setLeading(t){this.current.leading=-t}setTextRise(t){this.current.textRise=t}setTextRenderingMode(t){this.current.textRenderingMode=t}setHScale(t){this.current.textHScale=t/100}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[a,o]of t)switch(a){case"LW":this.setLineWidth(o);break;case"LC":this.setLineCap(o);break;case"LJ":this.setLineJoin(o);break;case"ML":this.setMiterLimit(o);break;case"D":this.setDash(o[0],o[1]);break;case"RI":this.setRenderingIntent(o);break;case"FL":this.setFlatness(o);break;case"Font":this.setFont(o);break;case"CA":this.setStrokeAlpha(o);break;case"ca":this.setFillAlpha(o);break;default:(0,k.warn)(`Unimplemented graphic state operator ${a}`);break}}fill(){const t=this.current;t.element&&(t.element.setAttributeNS(null,"fill",t.fillColor),t.element.setAttributeNS(null,"fill-opacity",t.fillAlpha),this.endPath())}stroke(){const t=this.current;t.element&&(this._setStrokeAttributes(t.element),t.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(t,a=1){const o=this.current;let s=o.dashArray;a!==1&&s.length>0&&(s=s.map(function(c){return a*c})),t.setAttributeNS(null,"stroke",o.strokeColor),t.setAttributeNS(null,"stroke-opacity",o.strokeAlpha),t.setAttributeNS(null,"stroke-miterlimit",r(o.miterLimit)),t.setAttributeNS(null,"stroke-linecap",o.lineCap),t.setAttributeNS(null,"stroke-linejoin",o.lineJoin),t.setAttributeNS(null,"stroke-width",r(a*o.lineWidth)+"px"),t.setAttributeNS(null,"stroke-dasharray",s.map(r).join(" ")),t.setAttributeNS(null,"stroke-dashoffset",r(a*o.dashPhase)+"px")}eoFill(){var t;(t=this.current.element)==null||t.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var t;(t=this.current.element)==null||t.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const t=this.svgFactory.createElement("svg:rect");t.setAttributeNS(null,"x","0"),t.setAttributeNS(null,"y","0"),t.setAttributeNS(null,"width","1px"),t.setAttributeNS(null,"height","1px"),t.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(t)}paintImageXObject(t){const a=this.getObject(t);if(!a){(0,k.warn)(`Dependent image with object ID ${t} is not ready yet`);return}this.paintInlineImageXObject(a)}paintInlineImageXObject(t,a){const o=t.width,s=t.height,c=x(t,this.forceDataSchema,!!a),P=this.svgFactory.createElement("svg:rect");P.setAttributeNS(null,"x","0"),P.setAttributeNS(null,"y","0"),P.setAttributeNS(null,"width",r(o)),P.setAttributeNS(null,"height",r(s)),this.current.element=P,this.clip("nonzero");const i=this.svgFactory.createElement("svg:image");i.setAttributeNS(L,"xlink:href",c),i.setAttributeNS(null,"x","0"),i.setAttributeNS(null,"y",r(-s)),i.setAttributeNS(null,"width",r(o)+"px"),i.setAttributeNS(null,"height",r(s)+"px"),i.setAttributeNS(null,"transform",`scale(${r(1/o)} ${r(-1/s)})`),a?a.append(i):this._ensureTransformGroup().append(i)}paintImageMaskXObject(t){const a=this.getObject(t.data,t);if(a.bitmap){(0,k.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const o=this.current,s=a.width,c=a.height,P=o.fillColor;o.maskId=`mask${T++}`;const i=this.svgFactory.createElement("svg:mask");i.setAttributeNS(null,"id",o.maskId);const I=this.svgFactory.createElement("svg:rect");I.setAttributeNS(null,"x","0"),I.setAttributeNS(null,"y","0"),I.setAttributeNS(null,"width",r(s)),I.setAttributeNS(null,"height",r(c)),I.setAttributeNS(null,"fill",P),I.setAttributeNS(null,"mask",`url(#${o.maskId})`),this.defs.append(i),this._ensureTransformGroup().append(I),this.paintInlineImageXObject(a,i)}paintFormXObjectBegin(t,a){if(Array.isArray(t)&&t.length===6&&this.transform(t[0],t[1],t[2],t[3],t[4],t[5]),a){const o=a[2]-a[0],s=a[3]-a[1],c=this.svgFactory.createElement("svg:rect");c.setAttributeNS(null,"x",a[0]),c.setAttributeNS(null,"y",a[1]),c.setAttributeNS(null,"width",r(o)),c.setAttributeNS(null,"height",r(s)),this.current.element=c,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(t){const a=this.svgFactory.create(t.width,t.height),o=this.svgFactory.createElement("svg:defs");a.append(o),this.defs=o;const s=this.svgFactory.createElement("svg:g");return s.setAttributeNS(null,"transform",A(t.transform)),a.append(s),this.svg=s,a}_ensureClipGroup(){if(!this.current.clipGroup){const t=this.svgFactory.createElement("svg:g");t.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(t),this.current.clipGroup=t}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",A(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}}],__webpack_module_cache__={};function __w_pdfjs_require__(Q){var m=__webpack_module_cache__[Q];if(m!==void 0)return m.exports;var Y=__webpack_module_cache__[Q]={exports:{}};return __webpack_modules__[Q](Y,Y.exports,__w_pdfjs_require__),Y.exports}var __webpack_exports__={};return(()=>{var Q=__webpack_exports__;Object.defineProperty(Q,"__esModule",{value:!0}),Object.defineProperty(Q,"AbortException",{enumerable:!0,get:function(){return m.AbortException}}),Object.defineProperty(Q,"AnnotationEditorLayer",{enumerable:!0,get:function(){return X.AnnotationEditorLayer}}),Object.defineProperty(Q,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return m.AnnotationEditorParamsType}}),Object.defineProperty(Q,"AnnotationEditorType",{enumerable:!0,get:function(){return m.AnnotationEditorType}}),Object.defineProperty(Q,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return z.AnnotationEditorUIManager}}),Object.defineProperty(Q,"AnnotationLayer",{enumerable:!0,get:function(){return ot.AnnotationLayer}}),Object.defineProperty(Q,"AnnotationMode",{enumerable:!0,get:function(){return m.AnnotationMode}}),Object.defineProperty(Q,"CMapCompressionType",{enumerable:!0,get:function(){return m.CMapCompressionType}}),Object.defineProperty(Q,"FeatureTest",{enumerable:!0,get:function(){return m.FeatureTest}}),Object.defineProperty(Q,"GlobalWorkerOptions",{enumerable:!0,get:function(){return W.GlobalWorkerOptions}}),Object.defineProperty(Q,"InvalidPDFException",{enumerable:!0,get:function(){return m.InvalidPDFException}}),Object.defineProperty(Q,"MissingPDFException",{enumerable:!0,get:function(){return m.MissingPDFException}}),Object.defineProperty(Q,"OPS",{enumerable:!0,get:function(){return m.OPS}}),Object.defineProperty(Q,"PDFDataRangeTransport",{enumerable:!0,get:function(){return Y.PDFDataRangeTransport}}),Object.defineProperty(Q,"PDFDateString",{enumerable:!0,get:function(){return b.PDFDateString}}),Object.defineProperty(Q,"PDFWorker",{enumerable:!0,get:function(){return Y.PDFWorker}}),Object.defineProperty(Q,"PasswordResponses",{enumerable:!0,get:function(){return m.PasswordResponses}}),Object.defineProperty(Q,"PermissionFlag",{enumerable:!0,get:function(){return m.PermissionFlag}}),Object.defineProperty(Q,"PixelsPerInch",{enumerable:!0,get:function(){return b.PixelsPerInch}}),Object.defineProperty(Q,"PromiseCapability",{enumerable:!0,get:function(){return m.PromiseCapability}}),Object.defineProperty(Q,"RenderingCancelledException",{enumerable:!0,get:function(){return b.RenderingCancelledException}}),Object.defineProperty(Q,"SVGGraphics",{enumerable:!0,get:function(){return L.SVGGraphics}}),Object.defineProperty(Q,"UnexpectedResponseException",{enumerable:!0,get:function(){return m.UnexpectedResponseException}}),Object.defineProperty(Q,"Util",{enumerable:!0,get:function(){return m.Util}}),Object.defineProperty(Q,"VerbosityLevel",{enumerable:!0,get:function(){return m.VerbosityLevel}}),Object.defineProperty(Q,"XfaLayer",{enumerable:!0,get:function(){return v.XfaLayer}}),Object.defineProperty(Q,"build",{enumerable:!0,get:function(){return Y.build}}),Object.defineProperty(Q,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return m.createValidAbsoluteUrl}}),Object.defineProperty(Q,"getDocument",{enumerable:!0,get:function(){return Y.getDocument}}),Object.defineProperty(Q,"getFilenameFromUrl",{enumerable:!0,get:function(){return b.getFilenameFromUrl}}),Object.defineProperty(Q,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return b.getPdfFilenameFromUrl}}),Object.defineProperty(Q,"getXfaPageViewport",{enumerable:!0,get:function(){return b.getXfaPageViewport}}),Object.defineProperty(Q,"isDataScheme",{enumerable:!0,get:function(){return b.isDataScheme}}),Object.defineProperty(Q,"isPdfFile",{enumerable:!0,get:function(){return b.isPdfFile}}),Object.defineProperty(Q,"loadScript",{enumerable:!0,get:function(){return b.loadScript}}),Object.defineProperty(Q,"normalizeUnicode",{enumerable:!0,get:function(){return m.normalizeUnicode}}),Object.defineProperty(Q,"renderTextLayer",{enumerable:!0,get:function(){return k.renderTextLayer}}),Object.defineProperty(Q,"setLayerDimensions",{enumerable:!0,get:function(){return b.setLayerDimensions}}),Object.defineProperty(Q,"shadow",{enumerable:!0,get:function(){return m.shadow}}),Object.defineProperty(Q,"updateTextLayer",{enumerable:!0,get:function(){return k.updateTextLayer}}),Object.defineProperty(Q,"version",{enumerable:!0,get:function(){return Y.version}});var m=__w_pdfjs_require__(1),Y=__w_pdfjs_require__(2),b=__w_pdfjs_require__(6),k=__w_pdfjs_require__(26),X=__w_pdfjs_require__(27),z=__w_pdfjs_require__(5),ot=__w_pdfjs_require__(32),W=__w_pdfjs_require__(14),L=__w_pdfjs_require__(35),v=__w_pdfjs_require__(34)})(),__webpack_exports__})())})(pdf$1);var pdfExports=pdf$1.exports;const pdf=getDefaultExportFromCjs(pdfExports),pdfjsModule=_mergeNamespaces({__proto__:null,default:pdf},[pdfExports]),pdfjs="default"in pdfjsModule?pdf:pdfjsModule,pdfjs$1=pdfjs;function warning(Q,m){}const isBrowser=typeof document<"u",isLocalFileSystem=isBrowser&&window.location.protocol==="file:";function isDefined(Q){return typeof Q<"u"}function isProvided(Q){return isDefined(Q)&&Q!==null}function isString(Q){return typeof Q=="string"}function isArrayBuffer(Q){return Q instanceof ArrayBuffer}function isBlob(Q){return invariant(isBrowser,"isBlob can only be used in a browser environment"),Q instanceof Blob}function isDataURI(Q){return isString(Q)&&/^data:/.test(Q)}function dataURItoByteString(Q){invariant(isDataURI(Q),"Invalid data URI.");const[m="",Y=""]=Q.split(",");return m.split(";").indexOf("base64")!==-1?atob(Y):unescape(Y)}function getDevicePixelRatio(){return isBrowser&&window.devicePixelRatio||1}function displayWorkerWarning(){}function cancelRunningTask(Q){Q&&Q.cancel&&Q.cancel()}function makePageCallback(Q,m){return Object.defineProperty(Q,"width",{get(){return this.view[2]*m},configurable:!0}),Object.defineProperty(Q,"height",{get(){return this.view[3]*m},configurable:!0}),Object.defineProperty(Q,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(Q,"originalHeight",{get(){return this.view[3]},configurable:!0}),Q}function isCancelException(Q){return Q.name==="RenderingCancelledException"}function loadFromFile(Q){return new Promise((m,Y)=>{const b=new FileReader;b.onload=()=>{if(!b.result)return Y(new Error("Error while reading a file."));m(b.result)},b.onerror=k=>{if(!k.target)return Y(new Error("Error while reading a file."));const{error:X}=k.target;if(!X)return Y(new Error("Error while reading a file."));switch(X.code){case X.NOT_FOUND_ERR:return Y(new Error("Error while reading a file: File not found."));case X.SECURITY_ERR:return Y(new Error("Error while reading a file: Security error."));case X.ABORT_ERR:return Y(new Error("Error while reading a file: Aborted."));default:return Y(new Error("Error while reading a file."))}},b.readAsArrayBuffer(Q)})}displayWorkerWarning();pdfjs$1.GlobalWorkerOptions.workerSrc="pdf.worker.js";export{isDataURI as a,isArrayBuffer as b,isBrowser as c,dataURItoByteString as d,isBlob as e,cancelRunningTask as f,getDevicePixelRatio as g,isCancelException as h,isDefined as i,isProvided as j,loadFromFile as l,makePageCallback as m,pdfjs$1 as p,warning as w};
