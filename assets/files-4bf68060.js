import{bJ as pe,bK as ge,bH as fe,bL as Se,bV as K,w as I,bx as V,r as s,bG as he,b8 as me,j as e,bT as oe,bU as xe,bX as ye,aV as v,aZ as se,aR as G,a0 as _,a$ as we,b$ as H,g as q,dn as ie,_ as w,cq as Te,af as Z,aw as M,iJ as ke,iK as ze,c as Be,u as $e,cX as ee,iL as Re,cT as ne,B as de,cV as Oe,aX as Me}from"./index-ccfcd4da.js";import{F as Ie}from"./file_item_component-d475cd2c.js";import{U as Ue,a as We}from"./upload_folder-18d72a10.js";import{D as Le}from"./index-36291a54.js";import{f as Ne}from"./data_objects-ce8f5e44.js";import{F as Ee}from"./files_component-67e684ff.js";import{a as Ge}from"./index.esm-a9bf82b4.js";import{G as ve}from"./index-efb9c68a.js";import{C as je}from"./index-e733c2fd.js";import{F as Ae}from"./index-b84643af.js";import{P as ce}from"./index-27f5ca3f.js";import{A as De}from"./index-7945450f.js";import"./index-3cbde207.js";import"./defineProperty-396cb65c.js";import"./pdf_document_viewer-45e7c6a7.js";import"./index-b8a04bf2.js";import"./transButton-719ccb9d.js";import"./index-a75cd6c4.js";import"./index-885f566c.js";import"./index-3bfb9ed3.js";import"./index-afc6ce50.js";import"./index-08a49527.js";import"./Image-eeb38737.js";import"./DialogWrap-1d0538d4.js";import"./index-7da8bd4f.js";import"./fade-dd39912a.js";import"./index-8ddfcaf4.js";import"./InfoCircleFilled-f916d949.js";import"./index-200f56a0.js";import"./Upload-a74f9032.js";import"./index-0a57a0d3.js";import"./useNotification-bc6f4548.js";import"./index-98406364.js";import"./localeData-8c06fba4.js";import"./SinglePicker-5ae69ed8.js";import"./index-5c2e1e93.js";import"./useMutateObserver-ca2a7753.js";import"./index-477d9320.js";import"./InputNumber-df6a3867.js";import"./Rate-1c034551.js";import"./index-ba1d69b2.js";import"./index-65dd5ac4.js";import"./ActionButton-3b8e0c74.js";import"./iconBase-fee9e477.js";import"./Skeleton-a2d4f426.js";function qe(t){return ge("MuiToggleButton",t)}const Pe=pe("MuiToggleButton",["root","disabled","selected","standard","primary","secondary","sizeSmall","sizeMedium","sizeLarge"]),ue=Pe,Ve=["children","className","color","disabled","disableFocusRipple","fullWidth","onChange","onClick","selected","size","value"],He=t=>{const{classes:o,fullWidth:l,selected:d,disabled:x,size:y,color:T}=t,g={root:["root",d&&"selected",x&&"disabled",l&&"fullWidth",`size${K(y)}`,T]};return xe(g,qe,o)},_e=fe(Se,{name:"MuiToggleButton",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:l}=t;return[o.root,o[`size${K(l.size)}`]]}})(({theme:t,ownerState:o})=>{let l=o.color==="standard"?t.palette.text.primary:t.palette[o.color].main,d;return t.vars&&(l=o.color==="standard"?t.vars.palette.text.primary:t.vars.palette[o.color].main,d=o.color==="standard"?t.vars.palette.text.primaryChannel:t.vars.palette[o.color].mainChannel),I({},t.typography.button,{borderRadius:(t.vars||t).shape.borderRadius,padding:11,border:`1px solid ${(t.vars||t).palette.divider}`,color:(t.vars||t).palette.action.active},o.fullWidth&&{width:"100%"},{[`&.${ue.disabled}`]:{color:(t.vars||t).palette.action.disabled,border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`},"&:hover":{textDecoration:"none",backgroundColor:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:V(t.palette.text.primary,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${ue.selected}`]:{color:l,backgroundColor:t.vars?`rgba(${d} / ${t.vars.palette.action.selectedOpacity})`:V(l,t.palette.action.selectedOpacity),"&:hover":{backgroundColor:t.vars?`rgba(${d} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:V(l,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${d} / ${t.vars.palette.action.selectedOpacity})`:V(l,t.palette.action.selectedOpacity)}}}},o.size==="small"&&{padding:7,fontSize:t.typography.pxToRem(13)},o.size==="large"&&{padding:15,fontSize:t.typography.pxToRem(15)})}),Ke=s.forwardRef(function(o,l){const d=he({props:o,name:"MuiToggleButton"}),{children:x,className:y,color:T="standard",disabled:g=!1,disableFocusRipple:k=!1,fullWidth:m=!1,onChange:j,onClick:z,selected:U,size:u="medium",value:b}=d,F=me(d,Ve),f=I({},d,{color:T,disabled:g,disableFocusRipple:k,fullWidth:m,size:u}),C=He(f),W=i=>{z&&(z(i,b),i.defaultPrevented)||j&&j(i,b)};return e.jsx(_e,I({className:oe(C.root,y),disabled:g,focusRipple:!k,ref:l,onClick:W,onChange:j,value:b,ownerState:f,"aria-pressed":U},F,{children:x}))}),te=Ke;function Je(t,o){return o===void 0||t===void 0?!1:Array.isArray(o)?o.indexOf(t)>=0:t===o}function Xe(t){return ge("MuiToggleButtonGroup",t)}const Ye=pe("MuiToggleButtonGroup",["root","selected","vertical","disabled","grouped","groupedHorizontal","groupedVertical"]),R=Ye,Qe=["children","className","color","disabled","exclusive","fullWidth","onChange","orientation","size","value"],Ze=t=>{const{classes:o,orientation:l,fullWidth:d,disabled:x}=t,y={root:["root",l==="vertical"&&"vertical",d&&"fullWidth"],grouped:["grouped",`grouped${K(l)}`,x&&"disabled"]};return xe(y,Xe,o)},et=fe("div",{name:"MuiToggleButtonGroup",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:l}=t;return[{[`& .${R.grouped}`]:o.grouped},{[`& .${R.grouped}`]:o[`grouped${K(l.orientation)}`]},o.root,l.orientation==="vertical"&&o.vertical,l.fullWidth&&o.fullWidth]}})(({ownerState:t,theme:o})=>I({display:"inline-flex",borderRadius:(o.vars||o).shape.borderRadius},t.orientation==="vertical"&&{flexDirection:"column"},t.fullWidth&&{width:"100%"},{[`& .${R.grouped}`]:I({},t.orientation==="horizontal"?{"&:not(:first-of-type)":{marginLeft:-1,borderLeft:"1px solid transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0},"&:not(:last-of-type)":{borderTopRightRadius:0,borderBottomRightRadius:0},[`&.${R.selected} + .${R.grouped}.${R.selected}`]:{borderLeft:0,marginLeft:0}}:{"&:not(:first-of-type)":{marginTop:-1,borderTop:"1px solid transparent",borderTopLeftRadius:0,borderTopRightRadius:0},"&:not(:last-of-type)":{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`&.${R.selected} + .${R.grouped}.${R.selected}`]:{borderTop:0,marginTop:0}})})),tt=s.forwardRef(function(o,l){const d=he({props:o,name:"MuiToggleButtonGroup"}),{children:x,className:y,color:T="standard",disabled:g=!1,exclusive:k=!1,fullWidth:m=!1,onChange:j,orientation:z="horizontal",size:U="medium",value:u}=d,b=me(d,Qe),F=I({},d,{disabled:g,fullWidth:m,orientation:z,size:U}),f=Ze(F),C=(i,B)=>{if(!j)return;const O=u&&u.indexOf(B);let $;u&&O>=0?($=u.slice(),$.splice(O,1)):$=u?u.concat(B):[B],j(i,$)},W=(i,B)=>{j&&j(i,u===B?null:B)};return e.jsx(et,I({role:"group",className:oe(f.root,y),ref:l,ownerState:F},b,{children:s.Children.map(x,i=>s.isValidElement(i)?s.cloneElement(i,{className:oe(f.grouped,i.props.className),onChange:k?W:C,selected:i.props.selected===void 0?Je(i.props.value,u):i.props.selected,size:i.props.size||U,fullWidth:m,color:i.props.color||T,disabled:i.props.disabled||g}):null)}))}),ot=tt,st=ye(e.jsx("path",{d:"m9.17 6 2 2H20v10H4V6h5.17M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"}),"FolderOutlined"),rt=ye(e.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),"SearchOutlined"),at=()=>{const[t,o]=s.useState(""),[l,d]=s.useState(10),[x,y]=s.useState(0),[T,g]=s.useState(0),[k,m]=s.useState(1),[j,z]=s.useState(!1),[U,u]=s.useState(!1),[b,F]=s.useState([]),[f,C]=s.useState(null);s.useState(!1),s.useState(!1);const[W,i]=s.useState(!1),O=!ve.useBreakpoint().lg,[$]=v.useForm(),[P]=v.useForm(),A=async r=>{const{data:n}=await q.custom({url:"",method:"post",meta:{operation:"deleteFolder",variables:{folderId:{value:parseInt(r.id.toString()),type:"Int",required:!0}},fields:["success","message"]}}).catch(()=>(w.remove(),w.error("Error deleting folder"),{data:null})).then(p=>p);if(n){w.success(n.message);const p=b.filter(c=>c.id!==r.id);F(p)}},J=async(r,n)=>{const{data:p}=await q.custom({url:"",method:"post",meta:{operation:"renameFolder",variables:{folderId:{value:parseInt(r.id.toString()),type:"Int",required:!0},name:{value:n,type:"String",required:!0}},fields:["success","message",{folder:["id","name","totalFiles","totalSize","canDelete","canEdit","canManage","isActive","created","updated",{author:ie}]}]}}).catch(()=>(w.remove(),w.error("Error renaming folder"),{data:null})).then(c=>c);if(p){w.success(p.message);const c=b.map(h=>h.id===r.id?p.folder:h);F(c)}},L=async(r,n="",p=25)=>{u(!0);const{data:c}=await q.custom({url:"",method:"get",meta:{operation:"myFolders",variables:{page:{value:r,type:"Int",required:!0},key:{value:n,type:"String",required:!1},pageSize:{value:p,type:"Int",required:!0}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","totalFiles","totalSize","canDelete","canEdit","canManage","isActive","created","updated",{author:ie}]}]}}).catch(h=>(w.remove(),w.error("Error getting files"),console.error(h),{data:null})).then(h=>h);c&&(y(c.total),g(c.pages),m(c.page),z(c.hasNext),F(c.results)),u(!1)},D=r=>{C(r)},re=r=>{C(r)},X=r=>{C(r),i(!0)},Y=[{title:"Name",dataIndex:"name",key:"name",render:(r,n)=>e.jsx(Te,{to:"/odrive/folder/"+n.id+"/"+n.name+"/files",children:e.jsx("a",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5,cursor:"pointer",color:"#333",transition:"all 0.3s"},children:[e.jsx(st,{}),r]})})})},{title:"Total Files",dataIndex:"totalFiles",key:"totalFiles"},{title:"Total Size",dataIndex:"totalSize",key:"totalSize"},{title:"",key:"action",render:(r,n)=>e.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end"},children:e.jsxs(Ae,{gap:"small",wrap:"wrap",children:[e.jsx(Z,{title:"Share folder",children:e.jsx(M,{type:"primary",shape:"circle",icon:e.jsx(Ge,{}),size:"small",onClick:()=>{X(n)}})}),e.jsx(Z,{title:"Delete folder",children:e.jsx(ce,{title:"Are you sure you want to delete this folder?",description:"This action cannot be undone, all files in this folder will be deleted too.",onConfirm:()=>{A(n)},okText:"Yes",cancelText:"No",children:e.jsx(M,{type:"primary",shape:"circle",icon:e.jsx(ke,{}),size:"small",onClick:()=>{D(n)}})})}),e.jsx(Z,{title:"Rename folder",children:e.jsx(ce,{title:"Are you sure you want to rename this folder?",description:e.jsx(v,{form:P,initialValues:{name:f==null?void 0:f.name},onFinish:p=>{console.log(p),J(n,p.name)},children:e.jsx(v.Item,{name:"name",children:e.jsx(_,{placeholder:"Enter new folder name"})})}),onConfirm:()=>{P.submit()},okText:"Yes",cancelText:"No",onOpenChange:p=>{p||C(null)},children:e.jsx(M,{type:"primary",shape:"circle",icon:e.jsx(ze,{}),size:"small",onClick:()=>{re(n)}})})})]})})}];return s.useEffect(()=>{L(k,t,l)},[]),e.jsxs("div",{style:{marginTop:5},children:[e.jsx("div",{style:{paddingTop:10,paddingBottom:0},children:e.jsx(se,{children:e.jsx(G,{span:O?24:12,children:e.jsx(v,{layout:"vertical",form:$,onFinish:r=>{o(r.key),L(1,r.key,l)},children:e.jsx(v.Item,{name:"key",children:e.jsx(_,{size:"large",placeholder:"Search folder(s)...",prefix:e.jsx(rt,{}),autoComplete:"off",allowClear:!0})})})})})}),e.jsx(we,{dataSource:b,columns:Y,pagination:{total:x,current:k,pageSize:l,showSizeChanger:!0,onChange:(r,n)=>{L(r,t,n||25)},onShowSizeChange:(r,n)=>{L(r,t,n||25)}}}),e.jsx(H,{title:"Share File",open:W,onClose:r=>i(r),width:O?"100vw":"50vw",children:e.jsx(je,{title:"Click Copy icon to copy share link",children:"sharing folder"})})]})},Yt=t=>{const[o,l]=s.useState(!1),[d,x]=s.useState([]),[y,T]=s.useState(!0),[g,k]=s.useState(1),[m,j]=s.useState(t.min?5:20),[z]=v.useForm();v.useForm();const[U,u]=s.useState(0),[b,F]=s.useState(0),[f,C]=s.useState(""),[W,i]=s.useState(!0),{push:B}=Be(),[O,$]=s.useState(!1),[P,A]=s.useState(!1),[J,L]=s.useState(!1),[D,re]=s.useState(),[X,Y]=s.useState(!1),[r,n]=s.useState("files"),c=!ve.useBreakpoint().lg,h=$e(),ae=()=>{$(!0)},le=a=>{x([...a,...d])},N=async(a,S="",Fe=25)=>{T(!0);const{data:E}=await q.custom({url:"",method:"get",meta:{operation:"files",variables:{page:{value:a,type:"Int",required:!0},key:{value:S,type:"String",required:!1},pageSize:{value:Fe,type:"Int",required:!0},folder:{value:h.folder,type:"String",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:Ne}]}}).catch(Q=>(console.error(Q),w.error("Error getting files"),{data:null})).then(Q=>Q);E&&(F(E.total),u(E.pages),k(E.page),i(E.hasNext),x(E.results)),T(!1)},be=(a,S)=>{j(S),N(g,f,S)},Ce=async()=>{const{data:a}=await q.custom({url:"",method:"get",meta:{operation:"odriveAuthorization",variables:{},fields:["auth"]}}).catch(()=>(w.error("Error getting Odrive Authorization"),{data:null})).then(S=>S);a&&l(a.auth.upload_files)};return s.useEffect(()=>{Ce(),N(g,f,m),h.folder&&n("files")},[h]),e.jsxs(e.Fragment,{children:[!t.min&&e.jsx(De,{offsetTop:63,children:e.jsxs(se,{children:[c&&e.jsxs(e.Fragment,{children:[e.jsxs(G,{span:24,style:{display:"flex",justifyContent:"flex-end",marginBottom:10},children:[e.jsx(M,{size:"large",icon:e.jsx(ee,{}),disabled:!o,onClick:()=>ae(),children:"Upload File(s)"}),e.jsx(M,{size:"large",icon:e.jsx(Re,{}),disabled:!o,onClick:()=>A(!0),children:"Upload Folder"})]}),e.jsx(G,{span:24,children:e.jsx(je,{bodyStyle:{paddingTop:10,paddingBottom:0},children:e.jsx(v,{layout:"vertical",form:z,onFinish:a=>{C(a.key),N(1,a.key,m)},children:e.jsx(v.Item,{name:"key",children:e.jsx(_,{size:"large",placeholder:"Search file(s)...",prefix:e.jsx(ne,{}),autoComplete:"off",allowClear:!0})})})})})]}),!c&&e.jsxs(e.Fragment,{children:[e.jsx(G,{span:12,children:!t.min&&e.jsx(de,{sx:{display:"flex",justifyContent:"flex-start",alignItems:"center"},children:e.jsxs(ot,{color:"primary",value:h.folder?"folderOpen":r,exclusive:!0,onChange:(a,S)=>{S!==null&&(n(S),S==="files"&&N(1,f,m),h.folder&&B("/odrive"))},"aria-label":"Alignment",sx:{display:"flex",justifyContent:"flex-start",alignItems:"center"},children:[e.jsx(te,{value:"files",sx:{"&.Mui-selected":{backgroundColor:"red",color:"white",fontWeight:"bold","&:hover":{backgroundColor:"red",color:"white",fontWeight:"bold"}},fontWeight:"bold"},children:"Files"}),e.jsx(te,{value:"folders",sx:{"&.Mui-selected":{backgroundColor:"red",color:"white",fontWeight:"bold","&:hover":{backgroundColor:"red",color:"white",fontWeight:"bold"}},fontWeight:"bold"},children:"Folders"}),h.folder&&e.jsxs(te,{disabled:!0,value:"folderOpen",sx:{"&.Mui-selected":{backgroundColor:"red",color:"white",fontWeight:"bold","&:hover":{backgroundColor:"red",color:"white",fontWeight:"bold"}},fontWeight:"bold"},children:[e.jsx(Oe,{}),e.jsx("span",{style:{marginLeft:"3px"},children:h.name})]})]})})}),r==="files"&&e.jsxs(G,{span:12,style:{display:"flex",justifyContent:"flex-end"},children:[e.jsx(M,{size:"large",icon:e.jsx(ee,{}),disabled:!o,onClick:()=>ae(),children:"Upload File(s)"}),e.jsx(M,{size:"large",icon:e.jsx(ee,{}),disabled:!o,onClick:()=>A(!0),children:"Upload Folder"})]})]})]})}),r==="files"&&e.jsxs("div",{style:{marginTop:5},children:[!t.min&&e.jsx("div",{style:{paddingTop:10,paddingBottom:0},children:e.jsx(se,{children:e.jsx(G,{span:c?24:12,children:e.jsx(v,{layout:"vertical",form:z,onFinish:a=>{C(a.key),N(1,a.key,m)},children:e.jsx(v.Item,{name:"key",children:e.jsx(_,{size:"large",placeholder:"Search file(s)...",prefix:e.jsx(ne,{}),autoComplete:"off",allowClear:!0})})})})})}),e.jsx(de,{sx:{maxHeight:"calc(100vh - 280px)",overflowY:"auto"},children:e.jsx("div",{style:{marginTop:t.min?0:20},children:e.jsx(Ee,{showDrive:!0,loading:y,data:d,min:t.min??!1})})}),!t.min&&e.jsx(e.Fragment,{children:!y&&d.length>0&&e.jsx("div",{style:{display:"flex",justifyContent:"center",marginBottom:10,marginTop:20},children:e.jsx(Me,{showSizeChanger:!0,showQuickJumper:!0,defaultCurrent:g,current:g,total:b,pageSize:m,onShowSizeChange:be,onChange:a=>N(a,f,m)})})})]}),r==="folders"&&e.jsx(e.Fragment,{children:e.jsx(at,{})}),e.jsx(H,{title:"Uploading Files",open:O,onClose:a=>$(a),width:c?"100vw":"50vw",children:e.jsx(Ue,{onFinish:a=>le(a),mode:"file"})}),e.jsx(H,{title:"Uploading Folder",open:P,onClose:a=>A(a),width:c?"100vw":"50vw",children:e.jsx(We,{onFinish:a=>le(a),mode:"file"})}),e.jsx(Le,{title:"File Informations",anchor:"right",width:c?"100vw":"35vw",onClose:a=>L(a),open:J,noOverFlow:!0,children:e.jsx(Ie,{id:D==null?void 0:D.id})}),e.jsx(H,{title:"Share File",open:X,onClose:a=>Y(a),width:c?"100vw":"50vw",children:e.jsx("span",{})})]})};export{Yt as Files};
