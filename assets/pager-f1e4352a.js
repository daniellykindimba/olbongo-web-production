import{r as n,R as z,i as F,P as s,a as be,p as re,b as ut,d as ht,c as sn,e as an,f as on,l as ln,g as ie,h as Ge,w as te,k as cn,m as ze,n as kt,o as he,F as w,q as Y,j as e,s as q,C as N,I as ne,S as le,t as $e,E as He,u as ve,B as M,v as Be,T as Ae,M as Et,x as pe,y as oe,A as De,z as Ue,D as Le,G as J,H as V,J as Ie,O as Ct,K as dn,N as un,Q as pt,U as ft,V as hn,W as gt,X as Tt,Y as Se,Z as pn,$ as Rt,a0 as qe,a1 as fn,a2 as gn,a3 as Ze,a4 as Ke,a5 as mn,a6 as xn,a7 as lt,a8 as ee,a9 as jn,aa as yn,ab as et,ac as tt,ad as nt,ae as rt,af as st,ag as at,ah as mt,ai as we,aj as _e,ak as xt}from"./index-afb01353.js";import{B as ct}from"./book_payment_form-9917317c.js";import{B as _}from"./Breadcrumb-835bbd39.js";import{T as dt}from"./Table-b9b9cf3b.js";import{R as ot}from"./index-515bcb5c.js";var U=globalThis&&globalThis.__spreadArray||function(t,r,a){if(a||arguments.length===2)for(var i=0,o=r.length,c;i<o;i++)(c||!(i in r))&&(c||(c=Array.prototype.slice.call(r,0,i)),c[i]=r[i]);return t.concat(c||Array.prototype.slice.call(r))},bn=["onCopy","onCut","onPaste"],vn=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],Sn=["onFocus","onBlur"],Pn=["onInput","onInvalid","onReset","onSubmit"],kn=["onLoad","onError"],En=["onKeyDown","onKeyPress","onKeyUp"],Cn=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],Tn=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],Rn=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],wn=["onSelect"],An=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],Bn=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],Dn=["onScroll"],Ln=["onWheel"],In=["onAnimationStart","onAnimationEnd","onAnimationIteration"],Nn=["onTransitionEnd"],On=["onToggle"],Fn=["onChange"],wt=U(U(U(U(U(U(U(U(U(U(U(U(U(U(U(U(U(U([],bn,!0),vn,!0),Sn,!0),Pn,!0),kn,!0),En,!0),Cn,!0),Tn,!0),Rn,!0),wn,!0),An,!0),Bn,!0),Dn,!0),Ln,!0),In,!0),Nn,!0),Fn,!0),On,!0);function At(t,r){var a={};return wt.forEach(function(i){var o=t[i];o&&(r?a[i]=function(c){return o(c,r(i))}:a[i]=o)}),a}function ke(t){var r=!1,a=new Promise(function(i,o){t.then(function(c){return!r&&i(c)}).catch(function(c){return!r&&o(c)})});return{promise:a,cancel:function(){r=!0}}}const Bt=n.createContext(null);function Pe({children:t,type:r}){return z.createElement("div",{className:`react-pdf__message react-pdf__message--${r}`},t)}const Mn="noopener noreferrer nofollow";class Dt{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(r){this.pdfDocument=r}setViewer(r){this.pdfViewer=r}setExternalLinkRel(r){this.externalLinkRel=r}setExternalLinkTarget(r){this.externalLinkTarget=r}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return F(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber||0}set page(r){F(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber=r}get rotation(){return 0}set rotation(r){}goToDestination(r){return new Promise(a=>{F(this.pdfDocument,"PDF document not loaded."),F(r,"Destination is not specified."),typeof r=="string"?this.pdfDocument.getDestination(r).then(a):Array.isArray(r)?a(r):r.then(a)}).then(a=>{F(Array.isArray(a),`"${a}" is not a valid destination array.`);const i=a[0];new Promise(o=>{F(this.pdfDocument,"PDF document not loaded."),i instanceof Object?this.pdfDocument.getPageIndex(i).then(c=>{o(c)}).catch(()=>{F(!1,`"${i}" is not a valid page reference.`)}):typeof i=="number"?o(i):F(!1,`"${i}" is not a valid destination reference.`)}).then(o=>{const c=o+1;F(this.pdfViewer,"PDF viewer is not initialized."),F(c>=1&&c<=this.pagesCount,`"${c}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({dest:a,pageIndex:o,pageNumber:c})})})}navigateTo(r){this.goToDestination(r)}goToPage(r){const a=r-1;F(this.pdfViewer,"PDF viewer is not initialized."),F(r>=1&&r<=this.pagesCount,`"${r}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({pageIndex:a,pageNumber:r})}addLinkAttributes(r,a,i){r.href=a,r.rel=this.externalLinkRel||Mn,r.target=i?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const _n={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},jt=_n;function Vn(t,r){switch(r.type){case"RESOLVE":return{value:r.value,error:void 0};case"REJECT":return{value:!1,error:r.error};case"RESET":return{value:void 0,error:void 0};default:return t}}function fe(){return n.useReducer(Vn,{value:void 0,error:void 0})}const{PDFDataRangeTransport:zn}=re,Lt=(()=>{const t={};return wt.forEach(r=>{t[r]=s.func}),t})(),qn=s.oneOfType([s.instanceOf(Int8Array),s.instanceOf(Uint8Array),s.instanceOf(Uint8ClampedArray),s.instanceOf(Int16Array),s.instanceOf(Uint16Array),s.instanceOf(Int32Array),s.instanceOf(Uint32Array),s.instanceOf(Float32Array),s.instanceOf(Float64Array)]),It=[s.string,s.instanceOf(ArrayBuffer),s.shape({data:s.oneOfType([s.string,s.instanceOf(ArrayBuffer),s.arrayOf(s.number.isRequired),qn]).isRequired}),s.shape({range:s.instanceOf(zn).isRequired}),s.shape({url:s.string.isRequired})];typeof Blob<"u"&&It.push(s.instanceOf(Blob));const Nt=s.oneOfType([s.string,s.arrayOf(s.string)]),Gn=s.oneOfType(It);s.instanceOf(Dt);s.oneOf(["_self","_blank","_parent","_top"]);s.shape({commonObjs:s.shape({}).isRequired,getAnnotations:s.func.isRequired,getTextContent:s.func.isRequired,getViewport:s.func.isRequired,render:s.func.isRequired});const $n=function(r,a,i){const{[a]:o,pageNumber:c,pdf:x}=r;if(!be(x))return null;if(be(o)){if(typeof o!="number")return new Error(`\`${a}\` of type \`${typeof o}\` supplied to \`${i}\`, expected \`number\`.`);if(o<0)return new Error(`Expected \`${a}\` to be greater or equal to 0.`);const{numPages:C}=x;if(o+1>C)return new Error(`Expected \`${a}\` to be less or equal to ${C-1}.`)}else if(!be(c))return new Error(`\`${a}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${i}\`.`);return null},Hn=function(r,a,i){const{[a]:o,pageIndex:c,pdf:x}=r;if(!be(x))return null;if(be(o)){if(typeof o!="number")return new Error(`\`${a}\` of type \`${typeof o}\` supplied to \`${i}\`, expected \`number\`.`);if(o<1)return new Error(`Expected \`${a}\` to be greater or equal to 1.`);const{numPages:C}=x;if(o>C)return new Error(`Expected \`${a}\` to be less or equal to ${C}.`)}else if(!be(c))return new Error(`\`${a}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${i}\`.`);return null},Un=s.oneOfType([s.any,s.oneOf([!1])]),it=s.oneOfType([s.func,s.exact({current:s.any})]),Kn=s.oneOf(["canvas","custom","none","svg"]),Wn=s.oneOf([0,90,180,270]);var Jn=globalThis&&globalThis.__awaiter||function(t,r,a,i){function o(c){return c instanceof a?c:new a(function(x){x(c)})}return new(a||(a=Promise))(function(c,x){function C(E){try{j(i.next(E))}catch(P){x(P)}}function p(E){try{j(i.throw(E))}catch(P){x(P)}}function j(E){E.done?c(E.value):o(E.value).then(C,p)}j((i=i.apply(t,r||[])).next())})},yt=globalThis&&globalThis.__rest||function(t,r){var a={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&r.indexOf(i)<0&&(a[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(t);o<i.length;o++)r.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(t,i[o])&&(a[i[o]]=t[i[o]]);return a};const{PDFDataRangeTransport:Yn}=re,Zn=(t,r)=>{switch(r){case jt.NEED_PASSWORD:{const a=prompt("Enter the password to open this PDF file.");t(a);break}case jt.INCORRECT_PASSWORD:{const a=prompt("Invalid password. Please try again.");t(a);break}}},Ot=n.forwardRef(function(r,a){var{children:i,className:o,error:c="Failed to load PDF file.",externalLinkRel:x,externalLinkTarget:C,file:p,inputRef:j,imageResourcesPath:E,loading:P="Loading PDFâ€¦",noData:R="No PDF file specified.",onItemClick:v,onLoadError:A,onLoadProgress:d,onLoadSuccess:k,onPassword:B=Zn,onSourceError:T,onSourceSuccess:f,options:b,renderMode:u,rotate:L}=r,g=yt(r,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[S,m]=fe(),{value:h,error:y}=S,[l,D]=fe(),{value:I,error:Z}=l,K=n.useRef(new Dt),Q=n.useRef([]),X=n.useRef({scrollPageIntoView:O=>{const{dest:$,pageNumber:W,pageIndex:H=W-1}=O;if(v){v({dest:$,pageIndex:H,pageNumber:W});return}const Fe=Q.current[H];if(Fe){Fe.scrollIntoView();return}}});n.useImperativeHandle(a,()=>({linkService:K,pages:Q,viewer:X}),[]);function se(){f&&f()}function ae(){y&&(te(!1,y.toString()),T&&T(y))}function ge(){m({type:"RESET"})}n.useEffect(ge,[p,m]);const ce=n.useCallback(()=>Jn(this,void 0,void 0,function*(){if(!p)return null;if(typeof p=="string")return ut(p)?{data:ht(p)}:{url:p};if(p instanceof Yn)return{range:p};if(sn(p))return{data:p};if(an&&on(p))return{data:yield ln(p)};if(F(typeof p=="object","Invalid parameter in file, need either Uint8Array, string or a parameter object"),F("data"in p||"range"in p||"url"in p,"Invalid parameter object: need either .data, .range or .url"),"url"in p&&typeof p.url=="string"&&ut(p.url)){const{url:O}=p,$=yt(p,["url"]),W=ht(O);return Object.assign({data:W},$)}return p}),[p]);n.useEffect(()=>{const O=ke(ce());return O.promise.then($=>{m({type:"RESOLVE",value:$})}).catch($=>{m({type:"REJECT",error:$})}),()=>{ie(O)}},[ce,m]),n.useEffect(()=>{if(!(typeof h>"u")){if(h===!1){ae();return}se()}},[h]);function de(){I&&(k&&k(I),Q.current=new Array(I.numPages),K.current.setDocument(I))}function Ee(){Z&&(te(!1,Z.toString()),A&&A(Z))}function me(){D({type:"RESET"})}n.useEffect(me,[D,h]);function Ce(){if(!h)return;const O=b?Object.assign(Object.assign({},h),b):h,$=re.getDocument(O);d&&($.onProgress=d),B&&($.onPassword=B);const W=$;return W.promise.then(H=>{D({type:"RESOLVE",value:H})}).catch(H=>{W.destroyed||D({type:"REJECT",error:H})}),()=>{W.destroy()}}n.useEffect(Ce,[b,D,h]),n.useEffect(()=>{if(!(typeof I>"u")){if(I===!1){Ee();return}de()}},[I]);function xe(){K.current.setViewer(X.current),K.current.setExternalLinkRel(x),K.current.setExternalLinkTarget(C)}n.useEffect(xe,[x,C]);function Oe(O,$){Q.current[O]=$}function Je(O){delete Q.current[O]}const ue=n.useMemo(()=>({imageResourcesPath:E,linkService:K.current,onItemClick:v,pdf:I,registerPage:Oe,renderMode:u,rotate:L,unregisterPage:Je}),[E,v,I,u,L]),G=n.useMemo(()=>At(g,()=>I),[g,I]);function Te(){return z.createElement(Bt.Provider,{value:ue},i)}function Re(){return p?I==null?z.createElement(Pe,{type:"loading"},typeof P=="function"?P():P):I===!1?z.createElement(Pe,{type:"error"},typeof c=="function"?c():c):Te():z.createElement(Pe,{type:"no-data"},typeof R=="function"?R():R)}return z.createElement("div",Object.assign({className:Ge("react-pdf__Document",o),ref:j,style:{"--scale-factor":"1"}},G),Re())}),Xe=s.oneOfType([s.func,s.node]);Ot.propTypes=Object.assign(Object.assign({},Lt),{children:s.node,className:Nt,error:Xe,externalLinkRel:s.string,externalLinkTarget:s.oneOf(["_self","_blank","_parent","_top"]),file:Gn,imageResourcesPath:s.string,inputRef:it,loading:Xe,noData:Xe,onItemClick:s.func,onLoadError:s.func,onLoadProgress:s.func,onLoadSuccess:s.func,onPassword:s.func,onSourceError:s.func,onSourceSuccess:s.func,options:s.shape({canvasFactory:s.any,canvasMaxAreaInBytes:s.number,cMapPacked:s.bool,CMapReaderFactory:s.any,cMapUrl:s.string,disableAutoFetch:s.bool,disableFontFace:s.bool,disableRange:s.bool,disableStream:s.bool,docBaseUrl:s.string,enableXfa:s.bool,filterFactory:s.any,fontExtraProperties:s.bool,httpHeaders:s.object,isEvalSupported:s.bool,isOffscreenCanvasSupported:s.bool,length:s.number,maxImageSize:s.number,ownerDocument:s.any,password:s.string,pdfBug:s.bool,rangeChunkSize:s.number,StandardFontDataFactory:s.any,standardFontDataUrl:s.string,stopAtErrors:s.bool,useSystemFonts:s.bool,useWorkerFetch:s.bool,verbosity:s.number,withCredentials:s.bool,worker:s.any}),rotate:s.number});const Xn=Ot;function Ft(){return n.useContext(Bt)}function Mt(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var a=t.filter(Boolean);if(a.length<=1){var i=a[0];return i||null}return function(c){a.forEach(function(x){typeof x=="function"?x(c):x&&(x.current=c)})}}const _t=n.createContext(null),Vt={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},Qn=/^H(\d+)$/;function er(t){return t in Vt}function We(t){return"children"in t}function zt(t){return We(t)?t.children.length===1&&0 in t.children&&"id"in t.children[0]:!1}function tr(t){const r={};if(We(t)){const{role:a}=t,i=a.match(Qn);if(i)r.role="heading",r["aria-level"]=Number(i[1]);else if(er(a)){const o=Vt[a];o&&(r.role=o)}}return r}function qt(t){const r={};if(We(t)){if(t.alt!==void 0&&(r["aria-label"]=t.alt),t.lang!==void 0&&(r.lang=t.lang),zt(t)){const[a]=t.children;if(a){const i=qt(a);return Object.assign(Object.assign({},r),i)}}}else"id"in t&&(r["aria-owns"]=t.id);return r}function nr(t){return t?Object.assign(Object.assign({},tr(t)),qt(t)):null}function Gt({className:t,node:r}){const a=n.useMemo(()=>nr(r),[r]),i=n.useMemo(()=>!We(r)||zt(r)?null:r.children.map((o,c)=>z.createElement(Gt,{key:c,node:o})),[r]);return z.createElement("span",Object.assign({className:t},a),i)}function Ne(){return n.useContext(_t)}function rr(){const t=Ne();F(t,"Unable to find Page context.");const{onGetStructTreeError:r,onGetStructTreeSuccess:a}=t,[i,o]=fe(),{value:c,error:x}=i,{customTextRenderer:C,page:p}=t;function j(){c&&a&&a(c)}function E(){x&&(te(!1,x.toString()),r&&r(x))}function P(){o({type:"RESET"})}n.useEffect(P,[o,p]);function R(){if(C||!p)return;const v=ke(p.getStructTree()),A=v;return v.promise.then(d=>{o({type:"RESOLVE",value:d})}).catch(d=>{o({type:"REJECT",error:d})}),()=>ie(A)}return n.useEffect(R,[C,p,o]),n.useEffect(()=>{if(c!==void 0){if(c===!1){E();return}j()}},[c]),c?z.createElement(Gt,{className:"react-pdf__Page__structTree structTree",node:c}):null}const bt=re.AnnotationMode;function sr(t){const r=Ne();F(r,"Unable to find Page context.");const a=Object.assign(Object.assign({},r),t),{_className:i,canvasBackground:o,devicePixelRatio:c=cn(),onRenderError:x,onRenderSuccess:C,page:p,renderForms:j,renderTextLayer:E,rotate:P,scale:R}=a,{canvasRef:v}=t;F(p,"Attempted to render page canvas, but no page was specified.");const A=n.useRef(null);function d(){p&&C&&C(ze(p,R))}function k(u){kt(u)||(te(!1,u.toString()),x&&x(u))}const B=n.useMemo(()=>p.getViewport({scale:R*c,rotation:P}),[c,p,P,R]),T=n.useMemo(()=>p.getViewport({scale:R,rotation:P}),[p,P,R]);function f(){if(!p)return;p.cleanup();const{current:u}=A;if(!u)return;u.width=B.width,u.height=B.height,u.style.width=`${Math.floor(T.width)}px`,u.style.height=`${Math.floor(T.height)}px`,u.style.visibility="hidden";const L={annotationMode:j?bt.ENABLE_FORMS:bt.ENABLE,canvasContext:u.getContext("2d",{alpha:!1}),viewport:B};o&&(L.background=o);const g=p.render(L),S=g;return g.promise.then(()=>{u.style.visibility="",d()}).catch(k),()=>ie(S)}n.useEffect(f,[o,A,c,p,j,B,T]);const b=n.useCallback(()=>{const{current:u}=A;u&&(u.width=0,u.height=0)},[A]);return n.useEffect(()=>b,[b]),z.createElement("canvas",{className:`${i}__canvas`,dir:"ltr",ref:Mt(v,A),style:{display:"block",userSelect:"none"}},E?z.createElement(rr,null):null)}function ar(){const t=Ne();F(t,"Unable to find Page context.");const{_className:r,onRenderSuccess:a,onRenderError:i,page:o,rotate:c,scale:x}=t;F(o,"Attempted to render page SVG, but no page was specified.");const[C,p]=fe(),{value:j,error:E}=C;function P(){o&&a&&a(ze(o,x))}function R(){E&&(kt(E)||(te(!1,E.toString()),i&&i(E)))}const v=n.useMemo(()=>o.getViewport({scale:x,rotation:c}),[o,c,x]);function A(){p({type:"RESET"})}n.useEffect(A,[o,p,v]);function d(){if(!o)return;const f=ke(o.getOperatorList());return f.promise.then(b=>{new re.SVGGraphics(o.commonObjs,o.objs).getSVG(b,v).then(L=>{p({type:"RESOLVE",value:L})}).catch(L=>{p({type:"REJECT",error:L})})}).catch(b=>{p({type:"REJECT",error:b})}),()=>ie(f)}n.useEffect(d,[o,p,v]),n.useEffect(()=>{if(j!==void 0){if(j===!1){R();return}P()}},[j]);function k(f){if(!f||!j)return;f.firstElementChild||f.appendChild(j);const{width:b,height:u}=v;j.setAttribute("width",`${b}`),j.setAttribute("height",`${u}`)}const{width:B,height:T}=v;return z.createElement("div",{className:`${r}__svg`,ref:f=>k(f),style:{display:"block",backgroundColor:"white",overflow:"hidden",width:B,height:T,userSelect:"none"}})}function or(t){return"str"in t}function ir(){const t=Ne();F(t,"Unable to find Page context.");const{customTextRenderer:r,onGetTextError:a,onGetTextSuccess:i,onRenderTextLayerError:o,onRenderTextLayerSuccess:c,page:x,pageIndex:C,pageNumber:p,rotate:j,scale:E}=t;F(x,"Attempted to load page text content, but no page was specified.");const[P,R]=fe(),{value:v,error:A}=P,d=n.useRef(null),k=n.useRef();te(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1);function B(){v&&i&&i(v)}function T(){A&&(te(!1,A.toString()),a&&a(A))}function f(){R({type:"RESET"})}n.useEffect(f,[x,R]);function b(){if(!x)return;const y=ke(x.getTextContent()),l=y;return y.promise.then(D=>{R({type:"RESOLVE",value:D})}).catch(D=>{R({type:"REJECT",error:D})}),()=>ie(l)}n.useEffect(b,[x,R]),n.useEffect(()=>{if(v!==void 0){if(v===!1){T();return}B()}},[v]);const u=n.useCallback(()=>{c&&c()},[c]),L=n.useCallback(y=>{te(!1,y.toString()),o&&o(y)},[o]);function g(){const y=k.current;y&&y.classList.add("active")}function S(){const y=k.current;y&&y.classList.remove("active")}const m=n.useMemo(()=>x.getViewport({scale:E,rotation:j}),[x,j,E]);function h(){if(!x||!v)return;const{current:y}=d;if(!y)return;y.innerHTML="";const l=x.streamTextContent({includeMarkedContent:!0}),D={container:y,textContentSource:l,viewport:m},I=re.renderTextLayer(D),Z=I;return I.promise.then(()=>{const K=document.createElement("div");K.className="endOfContent",y.append(K),k.current=K;const X=!!y.querySelector(".markedContent")?y.querySelectorAll(".markedContent > *:not(.markedContent"):y.children;if(r){let se=0;v.items.forEach((ae,ge)=>{if(!or(ae))return;const ce=X[se];if(!ce)return;const de=r(Object.assign({pageIndex:C,pageNumber:p,itemIndex:ge},ae));ce.innerHTML=de,se+=ae.str&&ae.hasEOL?2:1})}u()}).catch(L),()=>ie(Z)}return n.useLayoutEffect(h,[r,L,u,x,C,p,v,m]),z.createElement("div",{className:Ge("react-pdf__Page__textContent","textLayer"),onMouseUp:S,onMouseDown:g,ref:d})}function lr(){const t=Ft();F(t,"Unable to find Document context. Did you wrap <Page /> in <Document />?");const r=Ne();F(r,"Unable to find Page context.");const a=Object.assign(Object.assign({},t),r),{imageResourcesPath:i,linkService:o,onGetAnnotationsError:c,onGetAnnotationsSuccess:x,onRenderAnnotationLayerError:C,onRenderAnnotationLayerSuccess:p,page:j,pdf:E,renderForms:P,rotate:R,scale:v=1}=a;F(j,"Attempted to load page annotations, but no page was specified.");const[A,d]=fe(),{value:k,error:B}=A,T=n.useRef(null);te(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1);function f(){k&&x&&x(k)}function b(){B&&(te(!1,B.toString()),c&&c(B))}function u(){d({type:"RESET"})}n.useEffect(u,[d,j]);function L(){if(!j)return;const y=ke(j.getAnnotations()),l=y;return y.promise.then(D=>{d({type:"RESOLVE",value:D})}).catch(D=>{d({type:"REJECT",error:D})}),()=>{ie(l)}}n.useEffect(L,[d,j,P]),n.useEffect(()=>{if(k!==void 0){if(k===!1){b();return}f()}},[k]);function g(){p&&p()}function S(y){C&&C(y)}const m=n.useMemo(()=>j.getViewport({scale:v,rotation:R}),[j,R,v]);function h(){if(!E||!j||!k)return;const{current:y}=T;if(!y)return;const l=m.clone({dontFlip:!0}),D={annotations:k,annotationStorage:E.annotationStorage,div:y,downloadManager:null,imageResourcesPath:i,linkService:o,page:j,renderForms:P,viewport:l};y.innerHTML="";try{re.AnnotationLayer.render(D),g()}catch(I){S(I)}return()=>{}}return n.useEffect(h,[k,i,o,j,P,m]),z.createElement("div",{className:Ge("react-pdf__Page__annotations","annotationLayer"),ref:T})}var cr=globalThis&&globalThis.__rest||function(t,r){var a={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&r.indexOf(i)<0&&(a[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(t);o<i.length;o++)r.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(t,i[o])&&(a[i[o]]=t[i[o]]);return a};const vt=1,$t=function(r){const a=Ft();F(a,"Unable to find Document context. Did you wrap <Page /> in <Document />?");const i=Object.assign(Object.assign({},a),r),{_className:o="react-pdf__Page",_enableRegisterUnregisterPage:c=!0,canvasBackground:x,canvasRef:C,children:p,className:j,customRenderer:E,customTextRenderer:P,devicePixelRatio:R,error:v="Failed to load the page.",height:A,inputRef:d,loading:k="Loading pageâ€¦",noData:B="No page specified.",onGetAnnotationsError:T,onGetAnnotationsSuccess:f,onGetStructTreeError:b,onGetStructTreeSuccess:u,onGetTextError:L,onGetTextSuccess:g,onLoadError:S,onLoadSuccess:m,onRenderAnnotationLayerError:h,onRenderAnnotationLayerSuccess:y,onRenderError:l,onRenderSuccess:D,onRenderTextLayerError:I,onRenderTextLayerSuccess:Z,pageIndex:K,pageNumber:Q,pdf:X,registerPage:se,renderAnnotationLayer:ae=!0,renderForms:ge=!1,renderMode:ce="canvas",renderTextLayer:de=!0,rotate:Ee,scale:me=vt,unregisterPage:Ce,width:xe}=i,Oe=cr(i,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[Je,ue]=fe(),{value:G,error:Te}=Je,Re=n.useRef(null);F(X,"Attempted to load a page, but no document was specified.");const O=he(Q)?Q-1:K??null,$=Q??(he(K)?K+1:null),W=Ee??(G?G.rotate:null),H=n.useMemo(()=>{if(!G)return null;let je=1;const Ye=me??vt;if(xe||A){const ye=G.getViewport({scale:1,rotation:W});xe?je=xe/ye.width:A&&(je=A/ye.height)}return Ye*je},[A,G,W,me,xe]);function Fe(){return()=>{he(O)&&c&&Ce&&Ce(O)}}n.useEffect(Fe,[c,X,O,Ce]);function Ut(){if(m){if(!G||!H)return;m(ze(G,H))}if(c&&se){if(!he(O)||!Re.current)return;se(O,Re.current)}}function Kt(){Te&&(te(!1,Te.toString()),S&&S(Te))}function Wt(){ue({type:"RESET"})}n.useEffect(Wt,[ue,X,O]);function Jt(){if(!X||!$)return;const je=ke(X.getPage($)),Ye=je;return je.promise.then(ye=>{ue({type:"RESOLVE",value:ye})}).catch(ye=>{ue({type:"REJECT",error:ye})}),()=>ie(Ye)}n.useEffect(Jt,[ue,X,O,$,se]),n.useEffect(()=>{if(G!==void 0){if(G===!1){Kt();return}Ut()}},[G,H]);const Yt=n.useMemo(()=>G&&he(O)&&$&&he(W)&&he(H)?{_className:o,canvasBackground:x,customTextRenderer:P,devicePixelRatio:R,onGetAnnotationsError:T,onGetAnnotationsSuccess:f,onGetStructTreeError:b,onGetStructTreeSuccess:u,onGetTextError:L,onGetTextSuccess:g,onRenderAnnotationLayerError:h,onRenderAnnotationLayerSuccess:y,onRenderError:l,onRenderSuccess:D,onRenderTextLayerError:I,onRenderTextLayerSuccess:Z,page:G,pageIndex:O,pageNumber:$,renderForms:ge,renderTextLayer:de,rotate:W,scale:H}:null,[o,x,P,R,T,f,b,u,L,g,h,y,l,D,I,Z,G,O,$,ge,de,W,H]),Zt=n.useMemo(()=>At(Oe,()=>G&&(H?ze(G,H):void 0)),[Oe,G,H]),Me=`${O}@${H}/${W}`,Xt=`${O}/${W}`;function Qt(){switch(ce){case"custom":return F(E,'renderMode was set to "custom", but no customRenderer was passed.'),z.createElement(E,{key:`${Me}_custom`});case"none":return null;case"svg":return z.createElement(ar,{key:`${Xt}_svg`});case"canvas":default:return z.createElement(sr,{key:`${Me}_canvas`,canvasRef:C})}}function en(){return de?z.createElement(ir,{key:`${Me}_text`}):null}function tn(){return ae?z.createElement(lr,{key:`${Me}_annotations`}):null}function nn(){return z.createElement(_t.Provider,{value:Yt},Qt(),en(),tn(),p)}function rn(){return $?X===null||G===void 0||G===null?z.createElement(Pe,{type:"loading"},typeof k=="function"?k():k):X===!1||G===!1?z.createElement(Pe,{type:"error"},typeof v=="function"?v():v):nn():z.createElement(Pe,{type:"no-data"},typeof B=="function"?B():B)}return z.createElement("div",Object.assign({className:Ge(o,j),"data-page-number":$,ref:Mt(d,Re),style:{"--scale-factor":`${H}`,backgroundColor:x||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},Zt),rn())},Qe=s.oneOfType([s.func,s.node]);$t.propTypes=Object.assign(Object.assign({},Lt),{canvasBackground:s.string,canvasRef:it,children:s.node,className:Nt,customRenderer:s.func,customTextRenderer:s.func,devicePixelRatio:s.number,error:Qe,height:s.number,imageResourcesPath:s.string,inputRef:it,loading:Qe,noData:Qe,onGetTextError:s.func,onGetTextSuccess:s.func,onLoadError:s.func,onLoadSuccess:s.func,onRenderError:s.func,onRenderSuccess:s.func,onRenderTextLayerError:s.func,onRenderTextLayerSuccess:s.func,pageIndex:$n,pageNumber:Hn,pdf:Un,renderAnnotationLayer:s.bool,renderForms:s.bool,renderMode:Kn,renderTextLayer:s.bool,rotate:Wn,scale:s.number,width:s.number});const dr=$t,Ht=t=>{const[r,a]=n.useState(!1),[i,o]=n.useState(0),[c,x]=n.useState(0),[C,p]=n.useState(1),[j,E]=n.useState([]),[P,R]=n.useState(),[v,A]=n.useState(!1),[d]=w.useForm();Y();const k=f=>{R(f),A(!0)},B=async f=>{const{data:b}=await J.custom({url:"",method:"post",meta:{operation:"addBookToReadings",variables:{bookId:{value:f,type:"Int",required:!0}},fields:["success","message",{book:["id","title","description","file","cover","price","downloadable","publisherCanAddToReadings","created","updated","isActive","isPublic","canEdit","canDelete","canManage",{author:["id","firstName","lastName","middleName","fullName","email","pic"]}]}]}}).catch(u=>(V.error("Error deleting book"),{data:null})).then(u=>u);b&&(b.success?(V.success(b.message),E(j.map(u=>u.id===f?b.book:u))):V.error(b.message))},T=async(f,b="")=>{a(!0);const{data:u}=await J.custom({url:"",method:"get",meta:{operation:"marketplaceBooks",variables:{page:{value:f,type:"Int",required:!0},key:{value:b,type:"String",required:!1},public:{value:t.public,type:"Boolean",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","title","description","file","cover","price","created","updated","isActive","isPublic","hasPurchaseOrder","orderPaid","canEdit","canDelete","canManage",{author:["id","firstName","lastName","middleName","fullName","email","pic"]}]}]}}).catch(L=>(V.error("Error getting Books"),{data:null})).then(L=>L);u&&(o(u.total),x(u.pages),p(u.page),E(u.results)),a(!1)};return n.useEffect(()=>{T(C,"")},[t.randKey]),e.jsxs(e.Fragment,{children:[e.jsx(q,{style:{display:"flex",justifyContent:"center",marginTop:20},children:e.jsx(N,{span:10,children:e.jsx(w,{layout:"vertical",form:d,children:e.jsx(w.Item,{name:"key",children:e.jsx(ne,{size:"large",placeholder:"Search Book(s)...",prefix:e.jsx(le,{}),autoComplete:"off",allowClear:!0})})})})}),e.jsx($e,{spinning:r,children:e.jsxs(q,{children:[j.length===0&&e.jsx(e.Fragment,{children:e.jsx(N,{span:24,children:e.jsx(He,{description:"No Book Published"})})}),j.map(f=>e.jsx(N,{span:12,children:e.jsx(ve,{hoverable:!0,bordered:!0,style:{margin:"2px"},bodyStyle:{minHeight:190,maxHeight:190},type:"inner",actions:[e.jsxs("span",{style:{fontSize:"18px"},children:[f.price," Tsh"]}),e.jsx("span",{style:{float:"right",marginRight:"10px",display:"flex"},children:f.isPublic?e.jsx(M,{size:"large",icon:e.jsx(Be,{}),onClick:()=>B(f.id),children:"Add to Readings"}):e.jsxs(e.Fragment,{children:[f.orderPaid&&e.jsx(e.Fragment,{children:e.jsx(Ae,{color:"green",children:"Already Purchased"})}),!f.orderPaid&&e.jsx(M,{size:"large",icon:e.jsx(Et,{}),onClick:()=>k(f),children:"Buy"})]})})],children:e.jsxs(q,{children:[e.jsx(N,{span:8,style:{backgroundImage:"url("+f.cover+")",backgroundSize:"cover"}}),e.jsx(N,{span:16,style:{padding:"10px"},children:e.jsxs(pe,{direction:"vertical",children:[e.jsx("a",{children:e.jsx("h3",{children:f.title.length>50?f.title.substring(0,50)+"...":f.title})}),e.jsx("p",{children:f.description.length>100?f.description.substring(0,100)+"...":f.description}),e.jsx("div",{children:e.jsx(pe,{children:e.jsx(oe,{title:"Click to View Author Profile",children:e.jsxs("a",{children:[e.jsx(De,{size:"small",src:f.author.pic}),e.jsx("span",{style:{marginLeft:"10px"},children:f.author.fullName})]})})})})]})})]})})},f.id))]})}),e.jsx(q,{children:e.jsx(N,{span:24,style:{display:"flex",justifyContent:"center",marginTop:"10px",marginBottom:"20px"},children:e.jsx(Ue,{defaultCurrent:C,total:i})})}),e.jsx(Le,{title:"Purchase Book",open:v,onClose:f=>A(f),width:"40vw",children:e.jsx(ct,{book:P,randKey:Math.random()})})]})},ur=()=>{const{push:t}=Y();return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10},children:e.jsxs(_,{children:[e.jsx(_.Item,{children:e.jsx("a",{onClick:()=>t("/olib"),children:"Home"})}),e.jsx(_.Item,{children:"Books MarketPlace"})]})}),e.jsx(Ht,{public:!1,randKey:Math.random()})]})},hr=()=>e.jsx(ur,{}),pr=()=>{const{push:t}=Y();return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10},children:e.jsxs(_,{children:[e.jsx(_.Item,{children:e.jsx("a",{onClick:()=>t("/olib"),children:"Home"})}),e.jsx(_.Item,{children:"Public Books"})]})}),e.jsx(Ht,{public:!0,randKey:Math.random()})]})},fr=()=>e.jsx(pr,{}),gr=t=>{const[r,a]=n.useState(!1),[i,o]=n.useState(0),[c,x]=n.useState(0),[C,p]=n.useState(1),[j,E]=n.useState(25),[P,R]=n.useState(""),[v,A]=n.useState([]);n.useState();const[d]=w.useForm();n.useState(!1);const[k,B]=n.useState(!1);Y();const T=async(b,u="",L=25)=>{a(!0);const{data:g}=await J.custom({url:"",method:"get",meta:{operation:"authorBooksPurchases",variables:{page:{value:b,type:"Int",required:!0},key:{value:u,type:"String",required:!1},pageSize:{value:L,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","price","paymentDate","receiptNumber","isPaid",{book:["id","title","description","file","cover","price","created","updated","isActive","isPublic","hasPurchaseOrder","canEdit","canDelete","canManage",{author:["id","firstName","lastName","middleName","fullName","email","pic"]}]},{user:["id","firstName","middleName","lastName"]},{bill:["id","billNumber"]},"isActive","created","updated","canDelete","canManage"]}]}}).catch(S=>(V.error("Error getting Bills"),{data:null})).then(S=>S);g&&(o(g.total),x(g.pages),p(g.page),A(g.results)),a(!1)},f=[{title:"Bill#",dataIndex:"billNumber",fixed:!0,render:(b,u,L)=>{var g;return e.jsx("span",{children:e.jsx("a",{children:(g=u==null?void 0:u.bill)==null?void 0:g.billNumber})})}},{title:"Book Title",dataIndex:"bookTitle",fixed:!0,render:(b,u,L)=>{var g;return e.jsx("span",{children:e.jsx("a",{children:(g=u==null?void 0:u.book)==null?void 0:g.title})})}},{title:"Amount",dataIndex:"billAmount",fixed:!0,render:(b,u,L)=>e.jsxs("span",{children:[u.price," Tsh"]})}];return n.useEffect(()=>{T(C,"",25)},[t.randKey]),e.jsxs(e.Fragment,{children:[e.jsx(Ie,{offsetTop:75,children:e.jsxs(q,{style:{display:"flex",justifyContent:"center",marginTop:20},children:[e.jsx(N,{span:10,children:e.jsx(w,{layout:"vertical",form:d,onFinish:b=>{T(1,b.key,25)},children:e.jsx(w.Item,{name:"key",children:e.jsx(ne,{size:"large",placeholder:"Search Bill(s)...",prefix:e.jsx(le,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(N,{span:14,style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(M,{icon:e.jsx(Be,{}),size:"large",onClick:()=>B(!0),children:"Create Disbursement"})})]})}),e.jsx(q,{children:e.jsx(N,{span:24,children:e.jsx(dt,{loading:r,columns:f,dataSource:v,pagination:{onChange:(b,u)=>{E(u),T(b,P,u)},total:i,pageSize:j,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0}})})}),e.jsx(Le,{title:"Creating Dibursement",width:"35vw",open:k,onClose:b=>B(b),children:e.jsx("p",{children:"Creating Dibursement"})})]})},mr=()=>{const{push:t}=Y();return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10},children:e.jsxs(_,{children:[e.jsx(_.Item,{children:e.jsx("a",{onClick:()=>t("/olib"),children:"Home"})}),e.jsx(_.Item,{children:e.jsx("a",{onClick:()=>t("/olib/publish/books"),children:"Published Books"})}),e.jsx(_.Item,{children:e.jsx("a",{onClick:()=>t("/olib/books/purchases"),children:"Books Purchases"})}),e.jsx(_.Item,{children:"Books Purchases Disbursement"})]})}),e.jsx(gr,{})]})},xr=()=>e.jsx(mr,{}),jr=t=>{const[r,a]=n.useState(!1),[i,o]=n.useState(0),[c,x]=n.useState(0),[C,p]=n.useState(1),[j,E]=n.useState(25),[P,R]=n.useState(""),[v,A]=n.useState([]),[d,k]=n.useState(),[B]=w.useForm(),[T,f]=n.useState(!1),{push:b}=Y(),u=async(g,S="",m=25)=>{a(!0);const{data:h}=await J.custom({url:"",method:"get",meta:{operation:"authorBooksPurchases",variables:{page:{value:g,type:"Int",required:!0},key:{value:S,type:"String",required:!1},pageSize:{value:m,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","price","paymentDate","receiptNumber","isPaid",{book:["id","title","description","file","cover","price","created","updated","isActive","isPublic","hasPurchaseOrder","canEdit","canDelete","canManage",{author:["id","firstName","lastName","middleName","fullName","email","pic"]}]},{user:["id","firstName","middleName","lastName"]},{bill:["id","billNumber"]},"isActive","created","updated","canDelete","canManage"]}]}}).catch(y=>(V.error("Error getting Bills"),{data:null})).then(y=>y);h&&(o(h.total),x(h.pages),p(h.page),A(h.results)),a(!1)},L=[{title:"Bill#",dataIndex:"billNumber",fixed:!0,render:(g,S,m)=>{var h;return e.jsx("span",{children:e.jsx("a",{children:(h=S==null?void 0:S.bill)==null?void 0:h.billNumber})})}},{title:"Book Title",dataIndex:"bookTitle",fixed:!0,render:(g,S,m)=>{var h;return e.jsx("span",{children:e.jsx("a",{children:(h=S==null?void 0:S.book)==null?void 0:h.title})})}},{title:"Amount",dataIndex:"billAmount",fixed:!0,render:(g,S,m)=>e.jsxs("span",{children:[S.price," Tsh"]})}];return n.useEffect(()=>{u(C,"",25)},[t.randKey]),e.jsxs(e.Fragment,{children:[e.jsx(Ie,{offsetTop:75,children:e.jsxs(q,{style:{display:"flex",justifyContent:"center",marginTop:20},children:[e.jsx(N,{span:10,children:e.jsx(w,{layout:"vertical",form:B,onFinish:g=>{u(1,g.key,25)},children:e.jsx(w.Item,{name:"key",children:e.jsx(ne,{size:"large",placeholder:"Search Bill(s)...",prefix:e.jsx(le,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(N,{span:14,style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(M,{icon:e.jsx(Ct,{}),size:"large",onClick:()=>b("/olib/books/purchases/disbursements"),children:"Disbursement"})})]})}),e.jsx(q,{children:e.jsx(N,{span:24,children:e.jsx(dt,{loading:r,columns:L,dataSource:v,pagination:{onChange:(g,S)=>{E(S),u(g,P,S)},total:i,pageSize:j,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0}})})}),e.jsx(Le,{title:"Order Details & Payment",open:T,width:"50vw",onClose:g=>f(g),children:e.jsx(ct,{book:d==null?void 0:d.book})})]})},yr=()=>{const{push:t}=Y();return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10},children:e.jsxs(_,{children:[e.jsx(_.Item,{children:e.jsx("a",{onClick:()=>t("/olib"),children:"Home"})}),e.jsx(_.Item,{children:e.jsx("a",{onClick:()=>t("/olib/publish/books"),children:"Published Books"})}),e.jsx(_.Item,{children:"Books Purchases"})]})}),e.jsx(jr,{})]})},br=()=>e.jsx(yr,{});re.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${re.version}/pdf.worker.js`;const vr=t=>{const[r,a]=n.useState(900),[i,o]=n.useState(),[c,x]=n.useState(1),[C,p]=n.useState(!1),j=R=>{x(v=>v+R)},E=()=>{j(-1)},P=()=>{j(1)};return n.useEffect(()=>{a(window.innerWidth)},[t.randKey]),e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx("div",{style:{maxHeight:"85vh",minHeight:"85vh",overflowY:"auto",overflowX:"hidden"},onContextMenu:R=>{},children:e.jsx(Xn,{file:t.book.file,onLoadSuccess:({numPages:R})=>{o(R),p(!0)},children:e.jsx(dr,{pageNumber:c,width:r/1.3})})}),C&&e.jsxs("div",{style:{display:"flex",justifyContent:"center",paddingTop:"10px"},children:[e.jsxs(M,{disabled:c<=1,onClick:E,children:[e.jsx(dn,{}),"Previous Page (",c," of ",i,")"]}),"  ",e.jsxs(M,{disabled:c===i,onClick:P,children:["Next Page (",c," of ",i,")",e.jsx(un,{})]})]})]})})},Sr=t=>{const[r,a]=n.useState(!1),[i,o]=n.useState(!1),[c,x]=n.useState(),[C,p]=n.useState(0),[j,E]=n.useState(0),[P,R]=n.useState(1),[v,A]=n.useState([]),[d,k]=n.useState(),[B,T]=n.useState(!1),[f]=w.useForm(),{push:b}=Y(),u=h=>{k(h),T(!0)},L=async(h,y="")=>{a(!0);const{data:l}=await J.custom({url:"",method:"get",meta:{operation:"userBooks",variables:{page:{value:h,type:"Int",required:!0},key:{value:y,type:"String",required:!1},pageSize:{value:20,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{book:["id","title","description","file","cover","price","created","updated","isActive","isPublic","averageRating","downloadable","canEdit","canDelete","canManage",{author:["id","firstName","lastName","middleName","fullName","email","pic"]}]}]}]}}).catch(D=>(V.error("Error getting Books"),{data:null})).then(D=>D);l&&(p(l.total),E(l.pages),R(l.page),A(l.results)),a(!1)},g=async()=>{o(!0);const{data:h}=await J.custom({url:"",method:"get",meta:{operation:"olibDashboardAnalytics",fields:["analytics"]}}).catch(y=>(V.error("Error fetching analytics"),{data:null})).then(y=>y);h&&x(h.analytics),o(!1)},S=async(h,y)=>{const{data:l}=await J.custom({url:"",method:"post",meta:{operation:"createBookRating",variables:{bookId:{value:y,type:"Int",required:!0},rating:{value:h,type:"Int",required:!0}},fields:["success","message",{userBook:["id",{book:["id","title","description","file","cover","price","created","updated","isActive","isPublic","averageRating","downloadable","canEdit","canDelete","canManage",{author:["id","firstName","lastName","middleName","fullName","email","pic"]}]}]}]}}).catch(D=>(console.log(D),{data:null})).then(D=>D);if(l){const D=v.map(I=>I.id===l.userBook.id?l.userBook:I);A(D)}},m=(h,y)=>e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Rated: "}),e.jsxs("span",{children:[[1,2,3,4,5].map(l=>e.jsx("span",{style:{marginRight:5},children:l<=h?e.jsx(oe,{title:l,children:e.jsx("a",{onClick:()=>{S(l,y)},style:{display:"inline"},children:e.jsx(fn,{style:{color:"orange"}})})}):e.jsx(oe,{title:l,children:e.jsx("a",{onClick:()=>{S(l,y)},style:{display:"inline"},children:e.jsx(gn,{})})})})),e.jsx(Ae,{color:"green",children:h})]})]});return n.useEffect(()=>{g(),L(P,"")},[t.randKey]),e.jsxs(e.Fragment,{children:[e.jsxs(q,{style:{display:"flex",justifyContent:"flex-start"},children:[e.jsx(N,{span:3,children:e.jsx("a",{onClick:()=>b("/olib"),children:e.jsx(ve,{children:e.jsx(pt,{title:"Books To Read",value:c==null?void 0:c.my_books,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(ft,{})})})})}),e.jsx(N,{span:3,children:e.jsx("a",{onClick:()=>b("/olib/books/public"),children:e.jsx(ve,{children:e.jsx(pt,{title:"Public Books",value:c==null?void 0:c.public_books,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(ft,{})})})})})]}),e.jsx(Ie,{offsetTop:75,children:e.jsx(q,{style:{display:"flex",justifyContent:"center",marginTop:20},children:e.jsx(N,{span:10,children:e.jsx(w,{layout:"vertical",form:f,onFinish:h=>{L(1,h.key)},children:e.jsx(w.Item,{name:"key",children:e.jsx(ne,{size:"large",placeholder:"Search Book(s)...",prefix:e.jsx(le,{}),autoComplete:"off",allowClear:!0})})})})})}),e.jsxs($e,{spinning:r,children:[e.jsxs(q,{children:[v.length===0&&!r&&e.jsx(e.Fragment,{children:e.jsx(N,{span:24,children:e.jsx(He,{description:"No Book Published"})})}),v.map(h=>e.jsx(N,{span:12,children:e.jsx(ve,{hoverable:!0,bordered:!0,style:{margin:"2px"},bodyStyle:{minHeight:190,maxHeight:190},type:"inner",actions:[e.jsx("span",{children:m(h.book.averageRating,h.book.id)}),e.jsxs("span",{style:{float:"right",marginRight:"10px",display:"flex"},children:[h.book.downloadable&&e.jsx(M,{icon:e.jsx(hn,{}),children:e.jsx("a",{href:h.book.file,target:"_blank",download:!0,children:"Download"})}),e.jsx(M,{style:{marginRight:"10px"},icon:e.jsx(gt,{}),onClick:()=>u(h),children:"Read"}),e.jsx(Tt,{trigger:["click"],overlay:e.jsxs(Se,{children:[e.jsx(Se.Item,{icon:e.jsx(gt,{}),onClick:()=>u(h),children:e.jsx("a",{rel:"noopener noreferrer",children:"Read"})}),e.jsx(Se.Item,{icon:e.jsx(pn,{}),onClick:()=>V("Under construction"),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Report"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:y=>y.preventDefault(),children:e.jsx(Rt,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})]})],children:e.jsxs(q,{children:[e.jsx(N,{span:8,style:{backgroundImage:"url("+h.book.cover+")",backgroundSize:"cover"}}),e.jsx(N,{span:16,style:{padding:"10px"},children:e.jsxs(pe,{direction:"vertical",children:[e.jsx("a",{children:e.jsx("h3",{children:h.book.title.length>50?h.book.title.substring(0,50)+"...":h.book.title})}),e.jsx("p",{children:h.book.description.replace(/(<([^>]+)>)/gi,"").length>100?h.book.description.replace(/(<([^>]+)>)/gi,"").substring(0,100)+"...":h.book.description.replace(/(<([^>]+)>)/gi,"")}),e.jsx("div",{children:e.jsx(pe,{children:e.jsx(oe,{title:"Click to View Author Profile",children:e.jsxs("a",{children:[e.jsx(De,{size:"small",src:h.book.author.pic}),e.jsx("span",{style:{marginLeft:"10px"},children:h.book.author.fullName})]})})})})]})})]})})},h.id))]}),e.jsx(q,{children:e.jsx(N,{span:24,style:{display:"flex",justifyContent:"center",marginTop:"10px",marginBottom:"20px"},children:e.jsx(Ue,{defaultCurrent:P,total:C,defaultPageSize:20,onChange:h=>{R(h),L(h,"")}})})})]}),e.jsx(qe,{title:d==null?void 0:d.book.title,anchor:"right",width:"80vw",onClose:h=>T(h),open:B,children:e.jsx(vr,{book:d==null?void 0:d.book,randKey:Math.random()})})]})},Pr=()=>{const{push:t}=Y();return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10},children:e.jsxs(_,{children:[e.jsx(_.Item,{children:e.jsx("a",{onClick:()=>t("/olib"),children:"Home"})}),e.jsx(_.Item,{children:"Dashboard"})]})}),e.jsx(Sr,{})]})},kr=()=>e.jsx(Pr,{}),Er=t=>{const[r,a]=n.useState(!0),[i,o]=n.useState(!1),[c,x]=n.useState(0),[C,p]=n.useState(0),[j,E]=n.useState(1),[P,R]=n.useState(!1);n.useState(25),n.useState("");const[v,A]=n.useState([]);n.useState();const[d]=w.useForm();n.useState(!1),Y();const k=async(f,b="",u=25)=>{o(!0);const{data:L}=await J.custom({url:"",method:"get",meta:{operation:"booksAuthorsToAdd",variables:{page:{value:f,type:"Int",required:!0},key:{value:b,type:"String",required:!1},pageSize:{value:u,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","firstName","middleName","lastName","fullName","email","pic","isActive","created","updated","canDelete","canManage"]}]}}).catch(g=>(V.error("Error getting authors"),{data:null})).then(g=>g);L&&(x(L.total),p(L.pages),E(L.page),R(L.hasNext),A([...v,...L.results])),o(!1)},B=async f=>{const{data:b}=await J.custom({url:"",method:"post",meta:{operation:"addBooksAuthor",variables:{authorId:{value:f,type:"Int",required:!0}},fields:["success","message",{bookAuthor:["id",{user:["id","firstName","middleName","lastName","fullName","email","pic","isActive","created","updated","canDelete","canManage"]},"isActive","created","updated","canDelete","canManage"]}]}}).catch(u=>(V.error("Error Adding Author"),{data:null})).then(u=>u);b&&(b.success?(V.success(b.message),A(v.filter(u=>parseInt(u.id.toString())!==f)),t.onAdd(b.bookAuthor)):V.error(b.message)),o(!1)},T=P?e.jsx("div",{style:{textAlign:"center",marginTop:12,height:32,lineHeight:"32px"},children:e.jsx(M,{size:"large",onClick:()=>k(j,"",25),children:"loading more"})}):null;return n.useEffect(()=>{k(j,"",25),a(!1)},[t.randKey]),e.jsxs(e.Fragment,{children:[e.jsx(Ie,{offsetTop:90,children:e.jsx(q,{style:{display:"flex",justifyContent:"center"},children:e.jsx(N,{span:10,children:e.jsx(w,{layout:"vertical",form:d,onFinish:f=>{k(1,f.key,25)},children:e.jsx(w.Item,{name:"key",children:e.jsx(ne,{size:"large",placeholder:"Search Bill(s)...",prefix:e.jsx(le,{}),autoComplete:"off",allowClear:!0})})})})})}),e.jsx("div",{style:{maxHeight:"80vh",overflowY:"auto",overflowX:"hidden"},children:e.jsx(Ze,{itemLayout:"horizontal",loadMore:T,dataSource:v,renderItem:f=>e.jsx(Ze.Item,{actions:[e.jsx(Ke,{title:"Adding Books Author??",onConfirm:()=>B(parseInt(f.id.toString())),okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx(M,{icon:e.jsx(Be,{}),size:"large"})})],children:e.jsx(mn,{avatar:!0,title:!1,loading:i,active:!0,children:e.jsx(Ze.Item.Meta,{avatar:e.jsx(De,{src:f.pic}),title:e.jsx("a",{children:f.fullName}),description:e.jsx(e.Fragment,{children:e.jsx(Ae,{color:"green",children:f.email})})})})})})})]})},Cr=t=>{const[r,a]=n.useState(!1),[i,o]=n.useState(0),[c,x]=n.useState(0),[C,p]=n.useState(1),[j,E]=n.useState([]);n.useState(),n.useState(!1);const[P,R]=n.useState(!1),[v,A]=n.useState(!1),[d]=w.useForm();Y();const k=async(T,f="")=>{a(!0);const{data:b}=await J.custom({url:"",method:"get",meta:{operation:"vertedBooksPublishers",variables:{page:{value:T,type:"Int",required:!0},key:{value:f,type:"String",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{user:["id","firstName","lastName","middleName","fullName","email","pic"]},"canEdit","canDelete","canManage"]}]}}).catch(u=>(V.error("Error getting Books"),{data:null})).then(u=>u);b&&(o(b.total),x(b.pages),p(b.page),E(b.results)),a(!1)},B=async T=>{E([T,...j])};return n.useEffect(()=>{k(C,"")},[t.randKey]),e.jsxs(e.Fragment,{children:[e.jsxs(q,{style:{display:"flex",justifyContent:"center",marginTop:20},children:[e.jsx(N,{span:10,children:e.jsx(w,{layout:"vertical",form:d,children:e.jsx(w.Item,{name:"key",children:e.jsx(ne,{size:"large",placeholder:"Search Book(s)...",prefix:e.jsx(le,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(N,{span:14,style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(M,{icon:e.jsx(Be,{}),size:"large",onClick:()=>R(!0),children:"Add Authors"})})]}),e.jsx($e,{spinning:r,children:e.jsxs(q,{children:[j.length===0&&e.jsx(e.Fragment,{children:e.jsx(N,{span:24,children:e.jsx(He,{description:"No Book Published"})})}),j.map(T=>e.jsx(N,{span:6,children:e.jsx(ve,{hoverable:!0,bordered:!0,style:{margin:"2px"},bodyStyle:{minHeight:100,maxHeight:100},actions:[e.jsx(M,{disabled:!0,size:"large",children:"100 Books"}),e.jsx(oe,{title:"View Authors Details",color:"green",children:e.jsx(M,{icon:e.jsx(xn,{}),size:"large",onClick:()=>A(!0)})}),e.jsx("span",{style:{background:"red"},children:T.canDelete&&e.jsx(Ke,{title:"Delete the Author",okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx(M,{size:"large",icon:e.jsx(lt,{})})})})],children:e.jsx(q,{children:e.jsx(N,{span:24,style:{padding:"10px"},children:e.jsx(pe,{direction:"horizontal",children:e.jsxs("a",{children:[e.jsx(De,{src:T.user.pic,size:"large"}),e.jsx("span",{style:{marginLeft:10},children:T.user.fullName})]})})})})})},T.id))]})}),e.jsx(q,{children:e.jsx(N,{span:24,style:{display:"flex",justifyContent:"center",marginTop:"10px",marginBottom:"20px"},children:e.jsx(Ue,{defaultCurrent:C,total:i})})}),e.jsx(qe,{title:"Adding Authors",anchor:"right",width:"50vw",onClose:T=>R(T),open:P,children:e.jsx(Er,{randKey:Math.random(),onAdd:B})}),e.jsx(qe,{title:"Author Details",width:"50vw",anchor:"right",onClose:T=>A(T),open:v,children:e.jsxs(e.Fragment,{children:[e.jsxs(ee,{title:"Author Info",children:[e.jsx(ee.Item,{label:"UserName",children:"Zhou Maomao"}),e.jsx(ee.Item,{label:"Telephone",children:"1810000000"}),e.jsx(ee.Item,{label:"Live",children:"Hangzhou, Zhejiang"}),e.jsx(ee.Item,{label:"Remark",children:"empty"}),e.jsx(ee.Item,{label:"Address",children:"No. 18, Wantang Road, Xihu District, Hangzhou, Zhejiang, China"})]}),e.jsxs(ee,{title:"Author Company Info",children:[e.jsx(ee.Item,{label:"UserName",children:"Zhou Maomao"}),e.jsx(ee.Item,{label:"Telephone",children:"1810000000"}),e.jsx(ee.Item,{label:"Live",children:"Hangzhou, Zhejiang"}),e.jsx(ee.Item,{label:"Remark",children:"empty"}),e.jsx(ee.Item,{label:"Address",children:"No. 18, Wantang Road, Xihu District, Hangzhou, Zhejiang, China"})]})]})})]})},Tr=()=>{const{push:t}=Y();return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10},children:e.jsxs(_,{children:[e.jsx(_.Item,{children:e.jsx("a",{onClick:()=>t("/olib"),children:"Home"})}),e.jsx(_.Item,{children:"Books Authors"})]})}),e.jsx(Cr,{randKey:Math.random()})]})},Rr=()=>e.jsx(Tr,{}),wr=t=>{const[r,a]=n.useState(!1),[i,o]=n.useState(0),[c,x]=n.useState(0),[C,p]=n.useState(1),[j,E]=n.useState(25),[P,R]=n.useState(""),[v,A]=n.useState([]),[d,k]=n.useState(),[B]=w.useForm(),[T,f]=n.useState(!1);Y();const b=async S=>{k(S),f(!0)},u=async(S,m="",h=25)=>{a(!0);const{data:y}=await J.custom({url:"",method:"get",meta:{operation:"myBooksOrders",variables:{page:{value:S,type:"Int",required:!0},key:{value:m,type:"String",required:!1},pageSize:{value:h,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","price","paymentDate","receiptNumber","isPaid",{book:["id","title","description","file","cover","price","created","updated","isActive","isPublic","hasPurchaseOrder","canEdit","canDelete","canManage",{author:["id","firstName","lastName","middleName","fullName","email","pic"]}]},{user:["id","firstName","middleName","lastName"]},{bill:["id","billNumber"]},"isActive","created","updated","canDelete","canManage"]}]}}).catch(l=>(V.error("Error getting Bills"),{data:null})).then(l=>l);y&&(o(y.total),x(y.pages),p(y.page),A(y.results)),a(!1)},L=async S=>{const{data:m}=await J.custom({url:"",method:"post",meta:{operation:"deleteBookOrder",variables:{id:{value:S,type:"Int",required:!0}},fields:["success","message"]}}).catch(h=>(V.error("Error deleting Order"),{data:null})).then(h=>h);m&&A(v.filter(h=>h.id!==S))},g=[{title:"Bill#",dataIndex:"billNumber",fixed:!0,render:(S,m,h)=>{var y;return e.jsx("span",{children:e.jsx("a",{children:(y=m==null?void 0:m.bill)==null?void 0:y.billNumber})})}},{title:"Book Title",dataIndex:"bookTitle",fixed:!0,render:(S,m,h)=>{var y;return e.jsx("span",{children:e.jsx("a",{children:(y=m==null?void 0:m.book)==null?void 0:y.title})})}},{title:"Bill Amount",dataIndex:"billAmount",fixed:!0,render:(S,m,h)=>e.jsxs("span",{children:[m.price," Tsh"]})},{title:"Paid",dataIndex:"isPaid",fixed:!0,render:(S,m,h)=>e.jsx("span",{children:m.isPaid?e.jsx(Ae,{color:"green",children:"Yes"}):e.jsx(Ae,{color:"red",children:"No"})})},{title:"Created",dataIndex:"created",render:(S,m,h)=>e.jsx(e.Fragment,{children:e.jsx("span",{children:e.jsx(jn,{date:new Date(m.created)})})})},{title:"Status",dataIndex:"isActive",render:(S,m,h)=>e.jsx("a",{children:m!=null&&m.isActive?e.jsx("span",{style:{color:"green"},children:"Active"}):e.jsx("span",{style:{color:"red"},children:"Inactive"})})},{title:"",dataIndex:"action",render:(S,m,h)=>e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end"},children:[!m.isPaid&&e.jsx(Ke,{title:"Are you sure to delete this Order?",onConfirm:()=>L(m.id),okText:"Yes",cancelText:"No",disabled:!(m!=null&&m.canDelete),overlayStyle:{zIndex:9999},children:e.jsx(M,{icon:e.jsx(lt,{}),disabled:!(m!=null&&m.canDelete),size:"large"})}),m.isPaid&&e.jsx(oe,{title:"Print Receipt",children:e.jsx(M,{icon:e.jsx(yn,{}),size:"large"})}),!m.isPaid&&e.jsx(oe,{title:"View Order Details",placement:"topLeft",children:e.jsx(M,{icon:e.jsx(Ct,{}),size:"large",onClick:()=>b(m)})})]})}];return n.useEffect(()=>{u(C,"",25)},[t.randKey]),e.jsxs(e.Fragment,{children:[e.jsx(Ie,{offsetTop:75,children:e.jsx(q,{style:{display:"flex",justifyContent:"center",marginTop:20},children:e.jsx(N,{span:10,children:e.jsx(w,{layout:"vertical",form:B,onFinish:S=>{u(1,S.key,25)},children:e.jsx(w.Item,{name:"key",children:e.jsx(ne,{size:"large",placeholder:"Search Bill(s)...",prefix:e.jsx(le,{}),autoComplete:"off",allowClear:!0})})})})})}),e.jsx(q,{children:e.jsx(N,{span:24,children:e.jsx(dt,{loading:r,columns:g,dataSource:v,pagination:{onChange:(S,m)=>{E(m),u(S,P,m)},total:i,pageSize:j,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0}})})}),e.jsx(Le,{title:"Order Details & Payment",open:T,width:"50vw",onClose:S=>f(S),children:e.jsx(ct,{book:d==null?void 0:d.book})})]})},Ar=()=>{const{push:t}=Y();return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10},children:e.jsxs(_,{children:[e.jsx(_.Item,{children:e.jsx("a",{onClick:()=>t("/olib"),children:"Home"})}),e.jsx(_.Item,{children:"Books Orders"})]})}),e.jsx(wr,{})]})},Br=()=>e.jsx(Ar,{}),St=[".pdf"],Dr=t=>Array.isArray(t)?t:t==null?void 0:t.fileList,Lr=t=>{const[r,a]=n.useState(""),[i,o]=n.useState(!1),[c,x]=n.useState(!1),[C,p]=n.useState(!1),[j,E]=n.useState(""),[P]=w.useForm(),R=[{label:"Public (Free)",value:!0},{label:"Private (Payable or Rentable)",value:!1}],v=async d=>{o(!0);const{data:k}=await J.custom({url:"",method:"post",meta:{operation:"publishBook",variables:{file:{value:d.file,type:"Upload",required:!0},title:{value:d.title,type:"String",required:!0},description:{value:d.description,type:"String",required:!0},price:{value:d.price,type:"Float",required:!1},isPublic:{value:d.is_public,type:"Boolean",required:!0},downloadable:{value:d.downloadable,type:"Boolean",required:!1}},fields:["success","message"]}}).catch(B=>(V.error("Error creating publishing book"),{data:null})).then(B=>B);k&&(k.success?(V.success(k.message),t.onFinish()):V.error(k.message)),o(!1)},A=d=>(d=d.replace(/[-_]/g," "),d=d.replace(/.pdf/g,""),d=d.replace(/[.]/g," "),d=d.replace(/\s+/g," "),d=d.trim(),d);return e.jsx(e.Fragment,{children:e.jsx($e,{spinning:i,children:e.jsxs(w,{layout:"vertical",form:P,onFinish:d=>{d.price=d.price??0,d.downloadable=C,d.description=j,v(d)},requiredMark:!0,children:[e.jsx(w.Item,{label:"Pick a Book ("+St.join()+")",children:e.jsx(w.Item,{name:"file",valuePropName:"fileList",getValueFromEvent:d=>{var B,T;a((B=d==null?void 0:d.file)==null?void 0:B.name);const k=(T=d==null?void 0:d.file)==null?void 0:T.name.split(".");return k.pop(),P.setFieldsValue({title:A(k.join("."))}),Dr(d)},noStyle:!0,rules:[{required:!0,type:"array",message:"Please upload Book file"}],children:e.jsxs(et.Dragger,{name:"file",accept:St.join(),multiple:!1,maxCount:1,beforeUpload:()=>!1,onRemove:()=>{a(""),P.setFieldsValue({title:""})},children:[e.jsx("p",{className:"ant-upload-drag-icon",children:e.jsx(tt,{})}),e.jsx("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"})]})})}),e.jsx(w.Item,{name:"title",label:"Book Title",initialValue:r,rules:[{required:!0,type:"string"}],children:e.jsx(ne,{size:"large",placeholder:"Enter Book Title ..."})}),e.jsx(w.Item,{name:"is_public",label:"Availability",initialValue:!0,children:e.jsx(ot.Group,{options:R,onChange:d=>{x(!d.target.value)},value:!0})}),c&&e.jsx(w.Item,{label:"Book Cost (Tsh)",name:"price",rules:[{required:c,type:"number",min:1e3,message:"Price must be greater than 1000"}],children:e.jsx(nt,{style:{width:"50%"},size:"large"})}),e.jsx(w.Item,{name:"downloadable",valuePropName:"checked",children:e.jsx(rt,{onChange:d=>{p(d.target.checked)},children:"Downloadable"})}),e.jsxs("div",{style:{marginBottom:20},children:[e.jsx("h3",{children:"Description"}),e.jsx(st.CKEditor,{disabled:i,editor:at,data:j,onReady:d=>{d.editing.view.change(k=>{k.setStyle("min-height","100px",d.editing.view.document.getRoot())})},onChange:(d,k)=>{const B=k.getData();E(B)},config:{toolbar:{items:["bold","italic","strikethrough","underline","code","subscript","superscript","removeFormat","|","bulletedList","numberedList","todoList","|","outdent","indent","|","-","fontSize","fontFamily","fontColor","fontBackgroundColor","highlight","|","alignment","|","EmojiPanel"],shouldNotGroupWhenFull:!0},fontFamily:{options:["default","Arial, Helvetica, sans-serif","Courier New, Courier, monospace","Georgia, serif","Lucida Sans Unicode, Lucida Grande, sans-serif","Tahoma, Geneva, sans-serif","Times New Roman, Times, serif","Trebuchet MS, Helvetica, sans-serif","Verdana, Geneva, sans-serif"],supportAllValues:!0},fontSize:{options:[10,12,14,"default",18,20,22],supportAllValues:!0}}})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(M,{type:"primary",size:"large",htmlType:"submit",loading:i,children:"Publish"})})]})})})},Ve=[".pdf"],Pt=t=>Array.isArray(t)?t:t==null?void 0:t.fileList,Ir=t=>{var T,f,b,u,L,g,S,m,h,y;const[r,a]=n.useState(0),[i,o]=n.useState(""),[c,x]=n.useState(!1),[C,p]=n.useState(!1),[j,E]=n.useState(!1),[P,R]=n.useState(""),[v]=w.useForm(),[A]=w.useForm(),d=[{label:"Public (Free)",value:!0},{label:"Private (Payable or Rentable)",value:!1}],k=async l=>{x(!0);const{data:D}=await J.custom({url:"",method:"post",meta:{operation:"publishBook",variables:{file:{value:l.file,type:"Upload",required:!0},title:{value:l.title,type:"String",required:!0},description:{value:l.description,type:"String",required:!0},price:{value:l.price,type:"Float",required:!1},isPublic:{value:l.is_public,type:"Boolean",required:!0},downloadable:{value:l.downloadable,type:"Boolean",required:!1}},fields:["success","message"]}}).catch(I=>(V.error("Error creating publishing book"),{data:null})).then(I=>I);D&&(D.success?(V.success(D.message),t.onFinish()):V.error(D.message)),x(!1)},B=l=>(l=l.replace(/[-_]/g," "),l=l.replace(/.pdf/g,""),l=l.replace(/[.]/g," "),l=l.replace(/\s+/g," "),l=l.trim(),l);return e.jsxs(e.Fragment,{children:[e.jsxs(mt,{sx:{display:"flex",justifyContent:"flex-end"},children:[e.jsx(M,{onClick:()=>a(0),children:"Book Info"}),e.jsx(M,{onClick:()=>a(1),children:"Edit Book Basic Info"}),e.jsx(M,{onClick:()=>a(2),children:"Edit Book Cover Image"}),e.jsx(M,{onClick:()=>a(3),children:"Edit Book Descriptions"})]}),r===0&&e.jsx(e.Fragment,{children:e.jsxs(mt,{sx:{width:"100%"},children:[e.jsxs(we,{variant:"h4",gutterBottom:!0,children:[e.jsx("b",{children:"Title"}),": ",(T=t.book)==null?void 0:T.title,e.jsx(_e,{})]}),e.jsxs(we,{variant:"h5",gutterBottom:!0,children:[e.jsx("b",{children:"Availability"}),": ",(f=t.book)!=null&&f.isPublic?"Public":"Private",e.jsx(_e,{})]}),e.jsxs(we,{variant:"h5",gutterBottom:!0,children:[e.jsx("b",{children:"Downloadable"}),": ",(b=t.book)!=null&&b.downloadable?"Yes":"No",e.jsx(_e,{})]}),e.jsxs(we,{variant:"h5",gutterBottom:!0,children:[e.jsx("b",{children:"Price"}),": ",(u=t.book)==null?void 0:u.price," Tsh",e.jsx(_e,{})]}),e.jsxs(we,{variant:"subtitle1",gutterBottom:!0,children:[e.jsx("b",{children:"Description"}),": ",(L=t.book)==null?void 0:L.description]})]})}),r===1&&e.jsxs(w,{layout:"vertical",form:A,onFinish:l=>{l.price=l.price??0,l.downloadable=j,l.description=P,k(l)},requiredMark:!0,initialValues:{title:(g=t.book)==null?void 0:g.title,is_public:(S=t.book)==null?void 0:S.isPublic,price:(m=t.book)==null?void 0:m.price,downloadable:(h=t.book)==null?void 0:h.downloadable},children:[e.jsx(w.Item,{name:"title",label:"Book Title",initialValue:i,rules:[{required:!0,type:"string"}],children:e.jsx(ne,{size:"large",placeholder:"Enter Book Title ..."})}),e.jsx(w.Item,{name:"is_public",label:"Availability",initialValue:!0,children:e.jsx(ot.Group,{options:d,onChange:l=>{p(!l.target.value)},value:!0})}),!((y=t.book)!=null&&y.isPublic)&&e.jsx(w.Item,{label:"Book Cost (Tsh)",name:"price",rules:[{required:C,type:"number",min:0}],children:e.jsx(nt,{style:{width:"50%"},size:"large"})}),e.jsx(w.Item,{name:"downloadable",valuePropName:"checked",children:e.jsx(rt,{onChange:l=>{E(l.target.checked)},children:"Downloadable"})}),e.jsxs("div",{style:{marginBottom:20},children:[e.jsx("h3",{children:"Description"}),e.jsx(st.CKEditor,{disabled:c,editor:at,data:P,onReady:l=>{l.editing.view.change(D=>{D.setStyle("min-height","100px",l.editing.view.document.getRoot())})},onChange:(l,D)=>{const I=D.getData();R(I)},config:{toolbar:{items:["bold","italic","strikethrough","underline","code","subscript","superscript","removeFormat","|","bulletedList","numberedList","todoList","|","outdent","indent","|","-","fontSize","fontFamily","fontColor","fontBackgroundColor","highlight","|","alignment","|","EmojiPanel"],shouldNotGroupWhenFull:!0},fontFamily:{options:["default","Arial, Helvetica, sans-serif","Courier New, Courier, monospace","Georgia, serif","Lucida Sans Unicode, Lucida Grande, sans-serif","Tahoma, Geneva, sans-serif","Times New Roman, Times, serif","Trebuchet MS, Helvetica, sans-serif","Verdana, Geneva, sans-serif"],supportAllValues:!0},fontSize:{options:[10,12,14,"default",18,20,22],supportAllValues:!0}}})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(M,{type:"primary",size:"large",htmlType:"submit",loading:c,children:"Publish"})})]}),r===2&&e.jsx(w,{layout:"vertical",form:v,onFinish:l=>{l.price=l.price??0,l.downloadable=j,l.description=P,k(l)},requiredMark:!0,children:e.jsx(w.Item,{label:"Pick a Book ("+Ve.join()+")",children:e.jsx(w.Item,{name:"file",valuePropName:"fileList",getValueFromEvent:l=>{var I,Z;o((I=l==null?void 0:l.file)==null?void 0:I.name);const D=(Z=l==null?void 0:l.file)==null?void 0:Z.name.split(".");return D.pop(),v.setFieldsValue({title:B(D.join("."))}),Pt(l)},noStyle:!0,rules:[{required:!0,type:"array",message:"Please upload Book file"}],children:e.jsxs(et.Dragger,{name:"file",accept:Ve.join(),multiple:!1,maxCount:1,beforeUpload:()=>!1,onRemove:()=>{o(""),v.setFieldsValue({title:""})},children:[e.jsx("p",{className:"ant-upload-drag-icon",children:e.jsx(tt,{})}),e.jsx("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"})]})})})}),r===3&&e.jsxs(w,{layout:"vertical",form:v,onFinish:l=>{l.price=l.price??0,l.downloadable=j,l.description=P,k(l)},requiredMark:!0,children:[e.jsx(w.Item,{label:"Pick a Book ("+Ve.join()+")",children:e.jsx(w.Item,{name:"file",valuePropName:"fileList",getValueFromEvent:l=>{var I,Z;o((I=l==null?void 0:l.file)==null?void 0:I.name);const D=(Z=l==null?void 0:l.file)==null?void 0:Z.name.split(".");return D.pop(),v.setFieldsValue({title:B(D.join("."))}),Pt(l)},noStyle:!0,rules:[{required:!0,type:"array",message:"Please upload Book file"}],children:e.jsxs(et.Dragger,{name:"file",accept:Ve.join(),multiple:!1,maxCount:1,beforeUpload:()=>!1,onRemove:()=>{o(""),v.setFieldsValue({title:""})},children:[e.jsx("p",{className:"ant-upload-drag-icon",children:e.jsx(tt,{})}),e.jsx("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"})]})})}),e.jsx(w.Item,{name:"title",label:"Book Title",initialValue:i,rules:[{required:!0,type:"string"}],children:e.jsx(ne,{size:"large",placeholder:"Enter Book Title ..."})}),e.jsx(w.Item,{name:"is_public",label:"Availability",initialValue:!0,children:e.jsx(ot.Group,{options:d,onChange:l=>{p(!l.target.value)},value:!0})}),C&&e.jsx(w.Item,{label:"Book Cost (Tsh)",name:"price",rules:[{required:C,type:"number",min:0}],children:e.jsx(nt,{style:{width:"50%"},size:"large"})}),e.jsx(w.Item,{name:"downloadable",valuePropName:"checked",children:e.jsx(rt,{onChange:l=>{E(l.target.checked)},children:"Downloadable"})}),e.jsxs("div",{style:{marginBottom:20},children:[e.jsx("h3",{children:"Description"}),e.jsx(st.CKEditor,{disabled:c,editor:at,data:P,onReady:l=>{l.editing.view.change(D=>{D.setStyle("min-height","100px",l.editing.view.document.getRoot())})},onChange:(l,D)=>{const I=D.getData();R(I)},config:{toolbar:{items:["bold","italic","strikethrough","underline","code","subscript","superscript","removeFormat","|","bulletedList","numberedList","todoList","|","outdent","indent","|","-","fontSize","fontFamily","fontColor","fontBackgroundColor","highlight","|","alignment","|","EmojiPanel"],shouldNotGroupWhenFull:!0},fontFamily:{options:["default","Arial, Helvetica, sans-serif","Courier New, Courier, monospace","Georgia, serif","Lucida Sans Unicode, Lucida Grande, sans-serif","Tahoma, Geneva, sans-serif","Times New Roman, Times, serif","Trebuchet MS, Helvetica, sans-serif","Verdana, Geneva, sans-serif"],supportAllValues:!0},fontSize:{options:[10,12,14,"default",18,20,22],supportAllValues:!0}}})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(M,{type:"primary",size:"large",htmlType:"submit",loading:c,children:"Publish"})})]})]})},Nr=t=>{const[r,a]=n.useState(!1),[i,o]=n.useState(0),[c,x]=n.useState(0),[C,p]=n.useState(1),[j,E]=n.useState([]),[P,R]=n.useState(),[v]=w.useForm(),[A,d]=n.useState(!1),[k,B]=n.useState(!1),{push:T}=Y(),f=async g=>{R(g),B(!0)},b=async()=>{L(1,""),d(!1)},u=async g=>{const{data:S}=await J.custom({url:"",method:"post",meta:{operation:"deleteBook",variables:{bookId:{value:g,type:"Int",required:!0}},fields:["success","message"]}}).catch(m=>(V.error("Error deleting book"),{data:null})).then(m=>m);S&&(S.success?(V.success(S.message),E(j.filter(m=>m.id!==g))):V.error(S.message))},L=async(g,S="")=>{a(!0);const{data:m}=await J.custom({url:"",method:"get",meta:{operation:"publisherBooks",variables:{page:{value:g,type:"Int",required:!0},key:{value:S,type:"String",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","title","description","file","cover","price","downloadable","publisherCanAddToReadings","created","updated","isActive","isPublic","canEdit","canDelete","canManage",{author:["id","firstName","lastName","middleName","fullName","email","pic"]}]}]}}).catch(h=>(V.error("Error getting Books"),{data:null})).then(h=>h);m&&(o(m.total),x(m.pages),p(m.page),E(m.results)),a(!1)};return n.useEffect(()=>{L(C,"")},[]),e.jsxs(e.Fragment,{children:[e.jsxs(q,{style:{display:"flex",justifyContent:"center",marginTop:20},children:[e.jsx(N,{span:10,children:e.jsx(w,{layout:"vertical",form:v,onFinish:g=>{L(1,g.key)},children:e.jsx(w.Item,{name:"key",children:e.jsx(ne,{size:"large",placeholder:"Search Book(s)...",prefix:e.jsx(le,{}),autoComplete:"off",allowClear:!0})})})}),e.jsxs(N,{span:14,children:[e.jsx(M,{size:"large",style:{float:"right"},icon:e.jsx(Et,{}),onClick:()=>T("/olib/books/purchases"),children:"Purchases"}),e.jsx(M,{size:"large",style:{float:"right"},icon:e.jsx(Be,{}),onClick:()=>d(!0),children:"Publish"})]})]}),e.jsxs(q,{children:[j.length===0&&e.jsx(e.Fragment,{children:e.jsx(N,{span:24,children:e.jsx(He,{description:"No Book Published"})})}),j.map(g=>e.jsx(N,{span:12,children:e.jsx(ve,{hoverable:!0,bordered:!0,style:{margin:"2px"},bodyStyle:{minHeight:190,maxHeight:190},type:"inner",actions:[e.jsxs("span",{style:{fontSize:"18px"},children:[g.price," Tsh"]}),e.jsxs("span",{style:{float:"right",marginRight:"10px",display:"flex"},children:[e.jsx(M,{style:{marginRight:"10px"},icon:e.jsx(xt,{}),onClick:()=>f(g),children:"View"}),e.jsx(Tt,{trigger:["click"],overlay:e.jsxs(Se,{children:[e.jsx(Se.Item,{icon:e.jsx(xt,{}),onClick:()=>f(g),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"View"})}),e.jsx(Se.Item,{icon:e.jsx(lt,{}),children:e.jsx(Ke,{title:"Are you sure to delete this Book?",onConfirm:()=>u(g.id),okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx("a",{rel:"noopener noreferrer",children:"Delete"})})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:S=>S.preventDefault(),children:e.jsx(Rt,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})]})],children:e.jsxs(q,{children:[e.jsx(N,{span:8,style:{backgroundImage:"url("+g.cover+")",backgroundSize:"cover"}}),e.jsx(N,{span:16,style:{padding:"10px"},children:e.jsxs(pe,{direction:"vertical",children:[e.jsx("a",{children:e.jsx("h3",{children:g.title.length>50?g.title.substring(0,50)+"...":g.title})}),e.jsx("p",{children:g.description.length>100?g.description.substring(0,100)+"...":g.description}),e.jsx("div",{children:e.jsx(pe,{children:e.jsx(oe,{title:"Click to View Author Profile",children:e.jsxs("a",{children:[e.jsx(De,{size:"small",src:g.author.pic}),e.jsx("span",{style:{marginLeft:"10px"},children:g.author.fullName})]})})})})]})})]})})},g.id))]}),e.jsx(q,{children:e.jsx(N,{span:24,style:{display:"flex",justifyContent:"center",marginTop:"10px",marginBottom:"20px"},children:e.jsx(Ue,{defaultCurrent:C,total:c})})}),e.jsx(Le,{title:"Publishing Book",open:A,width:"60vw",onClose:g=>d(g),children:e.jsx(Lr,{randKey:Math.random(),onFinish:b})}),e.jsx(qe,{title:P==null?void 0:P.title,width:"80vw",anchor:"right",onClose:g=>B(g),open:k,children:e.jsx(Ir,{book:P})})]})},Or=()=>{const{push:t}=Y();return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10},children:e.jsxs(_,{children:[e.jsx(_.Item,{children:e.jsx("a",{onClick:()=>t("/olib"),children:"Home"})}),e.jsx(_.Item,{children:"Publish Books"})]})}),e.jsx(Nr,{})]})},Fr=()=>e.jsx(Or,{}),Gr=t=>{const{page:r}=t;return r==="PublishBooksPage"?e.jsx(Fr,{}):r==="OlibOrdersPage"?e.jsx(Br,{}):r==="OlibBooksAuthorsPage"?e.jsx(Rr,{}):r==="OlibDashboardPage"?e.jsx(kr,{}):r==="BooksPurchasesPage"?e.jsx(br,{}):r==="BooksPurchasesDisbursementsPage"?e.jsx(xr,{}):r==="BooksPublicPage"?e.jsx(fr,{}):r==="BooksMarketPlacePage"?e.jsx(hr,{}):e.jsx("div",{children:"Page not found ..."})};export{Gr as OlibPages};
