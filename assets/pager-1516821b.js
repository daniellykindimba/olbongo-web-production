import{r as n,q as z,u as O,v as s,w as He,c as w,l as Y,j as e,G as F,I as se,e as de,a as Ue,E as Ke,C as Se,B as M,P as Ie,b as De,x as Et,y as ne,S as ge,T as le,A as Be,R as X,d as U,z as We,M as Ne,g as J,_ as V,H as _,J as Oe,K as dt,O as Ct,N as an,Q as on,U as pt,V as ft,W as ln,X as gt,Y as Tt,Z as ke,$ as cn,a0 as Rt,D as Ge,a1 as dn,a2 as un,L as Qe,a3 as Je,f as hn,a4 as pn,a5 as ut,a6 as te,a7 as fn,a8 as gn,a9 as nt,aa as rt,ab as st,ac as at,o as ot,m as it,n as lt,ad as Le,ae as ze,af as mt}from"./index-c92f9f6b.js";import{B as ht}from"./book_payment_form-7e09c370.js";import{i as Pe,p as ae,a as xt,d as jt,b as mn,c as xn,e as jn,l as yn,f as ce,w as re,g as bn,m as $e,h as wt,j as fe}from"./index-8dba23b7.js";var H=globalThis&&globalThis.__spreadArray||function(t,r,a){if(a||arguments.length===2)for(var i=0,o=r.length,c;i<o;i++)(c||!(i in r))&&(c||(c=Array.prototype.slice.call(r,0,i)),c[i]=r[i]);return t.concat(c||Array.prototype.slice.call(r))},vn=["onCopy","onCut","onPaste"],Sn=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],kn=["onFocus","onBlur"],Pn=["onInput","onInvalid","onReset","onSubmit"],En=["onLoad","onError"],Cn=["onKeyDown","onKeyPress","onKeyUp"],Tn=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],Rn=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],wn=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],An=["onSelect"],Ln=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],Dn=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],In=["onScroll"],Bn=["onWheel"],Nn=["onAnimationStart","onAnimationEnd","onAnimationIteration"],On=["onTransitionEnd"],Fn=["onToggle"],Mn=["onChange"],At=H(H(H(H(H(H(H(H(H(H(H(H(H(H(H(H(H(H([],vn,!0),Sn,!0),kn,!0),Pn,!0),En,!0),Cn,!0),Tn,!0),Rn,!0),wn,!0),An,!0),Ln,!0),Dn,!0),In,!0),Bn,!0),Nn,!0),On,!0),Mn,!0),Fn,!0);function Lt(t,r){var a={};return At.forEach(function(i){var o=t[i];o&&(r?a[i]=function(c){return o(c,r(i))}:a[i]=o)}),a}function Ce(t){var r=!1,a=new Promise(function(i,o){t.then(function(c){return!r&&i(c)}).catch(function(c){return!r&&o(c)})});return{promise:a,cancel:function(){r=!0}}}const Dt=n.createContext(null);function Ee({children:t,type:r}){return z.createElement("div",{className:`react-pdf__message react-pdf__message--${r}`},t)}const _n="noopener noreferrer nofollow";class It{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(r){this.pdfDocument=r}setViewer(r){this.pdfViewer=r}setExternalLinkRel(r){this.externalLinkRel=r}setExternalLinkTarget(r){this.externalLinkTarget=r}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return O(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber||0}set page(r){O(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber=r}get rotation(){return 0}set rotation(r){}goToDestination(r){return new Promise(a=>{O(this.pdfDocument,"PDF document not loaded."),O(r,"Destination is not specified."),typeof r=="string"?this.pdfDocument.getDestination(r).then(a):Array.isArray(r)?a(r):r.then(a)}).then(a=>{O(Array.isArray(a),`"${a}" is not a valid destination array.`);const i=a[0];new Promise(o=>{O(this.pdfDocument,"PDF document not loaded."),i instanceof Object?this.pdfDocument.getPageIndex(i).then(c=>{o(c)}).catch(()=>{O(!1,`"${i}" is not a valid page reference.`)}):typeof i=="number"?o(i):O(!1,`"${i}" is not a valid destination reference.`)}).then(o=>{const c=o+1;O(this.pdfViewer,"PDF viewer is not initialized."),O(c>=1&&c<=this.pagesCount,`"${c}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({dest:a,pageIndex:o,pageNumber:c})})})}navigateTo(r){this.goToDestination(r)}goToPage(r){const a=r-1;O(this.pdfViewer,"PDF viewer is not initialized."),O(r>=1&&r<=this.pagesCount,`"${r}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({pageIndex:a,pageNumber:r})}addLinkAttributes(r,a,i){r.href=a,r.rel=this.externalLinkRel||_n,r.target=i?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const Vn={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},yt=Vn;function zn(t,r){switch(r.type){case"RESOLVE":return{value:r.value,error:void 0};case"REJECT":return{value:!1,error:r.error};case"RESET":return{value:void 0,error:void 0};default:return t}}function me(){return n.useReducer(zn,{value:void 0,error:void 0})}const{PDFDataRangeTransport:qn}=ae,Bt=(()=>{const t={};return At.forEach(r=>{t[r]=s.func}),t})(),Gn=s.oneOfType([s.instanceOf(Int8Array),s.instanceOf(Uint8Array),s.instanceOf(Uint8ClampedArray),s.instanceOf(Int16Array),s.instanceOf(Uint16Array),s.instanceOf(Int32Array),s.instanceOf(Uint32Array),s.instanceOf(Float32Array),s.instanceOf(Float64Array)]),Nt=[s.string,s.instanceOf(ArrayBuffer),s.shape({data:s.oneOfType([s.string,s.instanceOf(ArrayBuffer),s.arrayOf(s.number.isRequired),Gn]).isRequired}),s.shape({range:s.instanceOf(qn).isRequired}),s.shape({url:s.string.isRequired})];typeof Blob<"u"&&Nt.push(s.instanceOf(Blob));const Ot=s.oneOfType([s.string,s.arrayOf(s.string)]),$n=s.oneOfType(Nt);s.instanceOf(It);s.oneOf(["_self","_blank","_parent","_top"]);s.shape({commonObjs:s.shape({}).isRequired,getAnnotations:s.func.isRequired,getTextContent:s.func.isRequired,getViewport:s.func.isRequired,render:s.func.isRequired});const Hn=function(r,a,i){const{[a]:o,pageNumber:c,pdf:x}=r;if(!Pe(x))return null;if(Pe(o)){if(typeof o!="number")return new Error(`\`${a}\` of type \`${typeof o}\` supplied to \`${i}\`, expected \`number\`.`);if(o<0)return new Error(`Expected \`${a}\` to be greater or equal to 0.`);const{numPages:C}=x;if(o+1>C)return new Error(`Expected \`${a}\` to be less or equal to ${C-1}.`)}else if(!Pe(c))return new Error(`\`${a}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${i}\`.`);return null},Un=function(r,a,i){const{[a]:o,pageIndex:c,pdf:x}=r;if(!Pe(x))return null;if(Pe(o)){if(typeof o!="number")return new Error(`\`${a}\` of type \`${typeof o}\` supplied to \`${i}\`, expected \`number\`.`);if(o<1)return new Error(`Expected \`${a}\` to be greater or equal to 1.`);const{numPages:C}=x;if(o>C)return new Error(`Expected \`${a}\` to be less or equal to ${C}.`)}else if(!Pe(c))return new Error(`\`${a}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${i}\`.`);return null},Kn=s.oneOfType([s.any,s.oneOf([!1])]),ct=s.oneOfType([s.func,s.exact({current:s.any})]),Wn=s.oneOf(["canvas","custom","none","svg"]),Jn=s.oneOf([0,90,180,270]);var Yn=globalThis&&globalThis.__awaiter||function(t,r,a,i){function o(c){return c instanceof a?c:new a(function(x){x(c)})}return new(a||(a=Promise))(function(c,x){function C(E){try{j(i.next(E))}catch(k){x(k)}}function p(E){try{j(i.throw(E))}catch(k){x(k)}}function j(E){E.done?c(E.value):o(E.value).then(C,p)}j((i=i.apply(t,r||[])).next())})},bt=globalThis&&globalThis.__rest||function(t,r){var a={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&r.indexOf(i)<0&&(a[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(t);o<i.length;o++)r.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(t,i[o])&&(a[i[o]]=t[i[o]]);return a};const{PDFDataRangeTransport:Zn}=ae,Xn=(t,r)=>{switch(r){case yt.NEED_PASSWORD:{const a=prompt("Enter the password to open this PDF file.");t(a);break}case yt.INCORRECT_PASSWORD:{const a=prompt("Invalid password. Please try again.");t(a);break}}},Ft=n.forwardRef(function(r,a){var{children:i,className:o,error:c="Failed to load PDF file.",externalLinkRel:x,externalLinkTarget:C,file:p,inputRef:j,imageResourcesPath:E,loading:k="Loading PDF…",noData:R="No PDF file specified.",onItemClick:v,onLoadError:A,onLoadProgress:d,onLoadSuccess:P,onPassword:L=Xn,onSourceError:T,onSourceSuccess:f,options:b,renderMode:u,rotate:I}=r,g=bt(r,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[S,m]=me(),{value:h,error:y}=S,[l,D]=me(),{value:B,error:Z}=l,K=n.useRef(new It),ee=n.useRef([]),Q=n.useRef({scrollPageIntoView:N=>{const{dest:G,pageNumber:W,pageIndex:$=W-1}=N;if(v){v({dest:G,pageIndex:$,pageNumber:W});return}const _e=ee.current[$];if(_e){_e.scrollIntoView();return}}});n.useImperativeHandle(a,()=>({linkService:K,pages:ee,viewer:Q}),[]);function oe(){f&&f()}function ie(){y&&(re(!1,y.toString()),T&&T(y))}function xe(){m({type:"RESET"})}n.useEffect(xe,[p,m]);const ue=n.useCallback(()=>Yn(this,void 0,void 0,function*(){if(!p)return null;if(typeof p=="string")return xt(p)?{data:jt(p)}:{url:p};if(p instanceof Zn)return{range:p};if(mn(p))return{data:p};if(xn&&jn(p))return{data:yield yn(p)};if(O(typeof p=="object","Invalid parameter in file, need either Uint8Array, string or a parameter object"),O("data"in p||"range"in p||"url"in p,"Invalid parameter object: need either .data, .range or .url"),"url"in p&&typeof p.url=="string"&&xt(p.url)){const{url:N}=p,G=bt(p,["url"]),W=jt(N);return Object.assign({data:W},G)}return p}),[p]);n.useEffect(()=>{const N=Ce(ue());return N.promise.then(G=>{m({type:"RESOLVE",value:G})}).catch(G=>{m({type:"REJECT",error:G})}),()=>{ce(N)}},[ue,m]),n.useEffect(()=>{if(!(typeof h>"u")){if(h===!1){ie();return}oe()}},[h]);function he(){B&&(P&&P(B),ee.current=new Array(B.numPages),K.current.setDocument(B))}function Te(){Z&&(re(!1,Z.toString()),A&&A(Z))}function je(){D({type:"RESET"})}n.useEffect(je,[D,h]);function Re(){if(!h)return;const N=b?Object.assign(Object.assign({},h),b):h,G=ae.getDocument(N);d&&(G.onProgress=d),L&&(G.onPassword=L);const W=G;return W.promise.then($=>{D({type:"RESOLVE",value:$})}).catch($=>{W.destroyed||D({type:"REJECT",error:$})}),()=>{W.destroy()}}n.useEffect(Re,[b,D,h]),n.useEffect(()=>{if(!(typeof B>"u")){if(B===!1){Te();return}he()}},[B]);function ye(){K.current.setViewer(Q.current),K.current.setExternalLinkRel(x),K.current.setExternalLinkTarget(C)}n.useEffect(ye,[x,C]);function Me(N,G){ee.current[N]=G}function Ze(N){delete ee.current[N]}const pe=n.useMemo(()=>({imageResourcesPath:E,linkService:K.current,onItemClick:v,pdf:B,registerPage:Me,renderMode:u,rotate:I,unregisterPage:Ze}),[E,v,B,u,I]),q=n.useMemo(()=>Lt(g,()=>B),[g,B]);function we(){return z.createElement(Dt.Provider,{value:pe},i)}function Ae(){return p?B==null?z.createElement(Ee,{type:"loading"},typeof k=="function"?k():k):B===!1?z.createElement(Ee,{type:"error"},typeof c=="function"?c():c):we():z.createElement(Ee,{type:"no-data"},typeof R=="function"?R():R)}return z.createElement("div",Object.assign({className:He("react-pdf__Document",o),ref:j,style:{"--scale-factor":"1"}},q),Ae())}),et=s.oneOfType([s.func,s.node]);Ft.propTypes=Object.assign(Object.assign({},Bt),{children:s.node,className:Ot,error:et,externalLinkRel:s.string,externalLinkTarget:s.oneOf(["_self","_blank","_parent","_top"]),file:$n,imageResourcesPath:s.string,inputRef:ct,loading:et,noData:et,onItemClick:s.func,onLoadError:s.func,onLoadProgress:s.func,onLoadSuccess:s.func,onPassword:s.func,onSourceError:s.func,onSourceSuccess:s.func,options:s.shape({canvasFactory:s.any,canvasMaxAreaInBytes:s.number,cMapPacked:s.bool,CMapReaderFactory:s.any,cMapUrl:s.string,disableAutoFetch:s.bool,disableFontFace:s.bool,disableRange:s.bool,disableStream:s.bool,docBaseUrl:s.string,enableXfa:s.bool,filterFactory:s.any,fontExtraProperties:s.bool,httpHeaders:s.object,isEvalSupported:s.bool,isOffscreenCanvasSupported:s.bool,length:s.number,maxImageSize:s.number,ownerDocument:s.any,password:s.string,pdfBug:s.bool,rangeChunkSize:s.number,StandardFontDataFactory:s.any,standardFontDataUrl:s.string,stopAtErrors:s.bool,useSystemFonts:s.bool,useWorkerFetch:s.bool,verbosity:s.number,withCredentials:s.bool,worker:s.any}),rotate:s.number});const Qn=Ft;function Mt(){return n.useContext(Dt)}function _t(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var a=t.filter(Boolean);if(a.length<=1){var i=a[0];return i||null}return function(c){a.forEach(function(x){typeof x=="function"?x(c):x&&(x.current=c)})}}const Vt=n.createContext(null),zt={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},er=/^H(\d+)$/;function tr(t){return t in zt}function Ye(t){return"children"in t}function qt(t){return Ye(t)?t.children.length===1&&0 in t.children&&"id"in t.children[0]:!1}function nr(t){const r={};if(Ye(t)){const{role:a}=t,i=a.match(er);if(i)r.role="heading",r["aria-level"]=Number(i[1]);else if(tr(a)){const o=zt[a];o&&(r.role=o)}}return r}function Gt(t){const r={};if(Ye(t)){if(t.alt!==void 0&&(r["aria-label"]=t.alt),t.lang!==void 0&&(r.lang=t.lang),qt(t)){const[a]=t.children;if(a){const i=Gt(a);return Object.assign(Object.assign({},r),i)}}}else"id"in t&&(r["aria-owns"]=t.id);return r}function rr(t){return t?Object.assign(Object.assign({},nr(t)),Gt(t)):null}function $t({className:t,node:r}){const a=n.useMemo(()=>rr(r),[r]),i=n.useMemo(()=>!Ye(r)||qt(r)?null:r.children.map((o,c)=>z.createElement($t,{key:c,node:o})),[r]);return z.createElement("span",Object.assign({className:t},a),i)}function Fe(){return n.useContext(Vt)}function sr(){const t=Fe();O(t,"Unable to find Page context.");const{onGetStructTreeError:r,onGetStructTreeSuccess:a}=t,[i,o]=me(),{value:c,error:x}=i,{customTextRenderer:C,page:p}=t;function j(){c&&a&&a(c)}function E(){x&&(re(!1,x.toString()),r&&r(x))}function k(){o({type:"RESET"})}n.useEffect(k,[o,p]);function R(){if(C||!p)return;const v=Ce(p.getStructTree()),A=v;return v.promise.then(d=>{o({type:"RESOLVE",value:d})}).catch(d=>{o({type:"REJECT",error:d})}),()=>ce(A)}return n.useEffect(R,[C,p,o]),n.useEffect(()=>{if(c!==void 0){if(c===!1){E();return}j()}},[c]),c?z.createElement($t,{className:"react-pdf__Page__structTree structTree",node:c}):null}const vt=ae.AnnotationMode;function ar(t){const r=Fe();O(r,"Unable to find Page context.");const a=Object.assign(Object.assign({},r),t),{_className:i,canvasBackground:o,devicePixelRatio:c=bn(),onRenderError:x,onRenderSuccess:C,page:p,renderForms:j,renderTextLayer:E,rotate:k,scale:R}=a,{canvasRef:v}=t;O(p,"Attempted to render page canvas, but no page was specified.");const A=n.useRef(null);function d(){p&&C&&C($e(p,R))}function P(u){wt(u)||(re(!1,u.toString()),x&&x(u))}const L=n.useMemo(()=>p.getViewport({scale:R*c,rotation:k}),[c,p,k,R]),T=n.useMemo(()=>p.getViewport({scale:R,rotation:k}),[p,k,R]);function f(){if(!p)return;p.cleanup();const{current:u}=A;if(!u)return;u.width=L.width,u.height=L.height,u.style.width=`${Math.floor(T.width)}px`,u.style.height=`${Math.floor(T.height)}px`,u.style.visibility="hidden";const I={annotationMode:j?vt.ENABLE_FORMS:vt.ENABLE,canvasContext:u.getContext("2d",{alpha:!1}),viewport:L};o&&(I.background=o);const g=p.render(I),S=g;return g.promise.then(()=>{u.style.visibility="",d()}).catch(P),()=>ce(S)}n.useEffect(f,[o,A,c,p,j,L,T]);const b=n.useCallback(()=>{const{current:u}=A;u&&(u.width=0,u.height=0)},[A]);return n.useEffect(()=>b,[b]),z.createElement("canvas",{className:`${i}__canvas`,dir:"ltr",ref:_t(v,A),style:{display:"block",userSelect:"none"}},E?z.createElement(sr,null):null)}function or(){const t=Fe();O(t,"Unable to find Page context.");const{_className:r,onRenderSuccess:a,onRenderError:i,page:o,rotate:c,scale:x}=t;O(o,"Attempted to render page SVG, but no page was specified.");const[C,p]=me(),{value:j,error:E}=C;function k(){o&&a&&a($e(o,x))}function R(){E&&(wt(E)||(re(!1,E.toString()),i&&i(E)))}const v=n.useMemo(()=>o.getViewport({scale:x,rotation:c}),[o,c,x]);function A(){p({type:"RESET"})}n.useEffect(A,[o,p,v]);function d(){if(!o)return;const f=Ce(o.getOperatorList());return f.promise.then(b=>{new ae.SVGGraphics(o.commonObjs,o.objs).getSVG(b,v).then(I=>{p({type:"RESOLVE",value:I})}).catch(I=>{p({type:"REJECT",error:I})})}).catch(b=>{p({type:"REJECT",error:b})}),()=>ce(f)}n.useEffect(d,[o,p,v]),n.useEffect(()=>{if(j!==void 0){if(j===!1){R();return}k()}},[j]);function P(f){if(!f||!j)return;f.firstElementChild||f.appendChild(j);const{width:b,height:u}=v;j.setAttribute("width",`${b}`),j.setAttribute("height",`${u}`)}const{width:L,height:T}=v;return z.createElement("div",{className:`${r}__svg`,ref:f=>P(f),style:{display:"block",backgroundColor:"white",overflow:"hidden",width:L,height:T,userSelect:"none"}})}function ir(t){return"str"in t}function lr(){const t=Fe();O(t,"Unable to find Page context.");const{customTextRenderer:r,onGetTextError:a,onGetTextSuccess:i,onRenderTextLayerError:o,onRenderTextLayerSuccess:c,page:x,pageIndex:C,pageNumber:p,rotate:j,scale:E}=t;O(x,"Attempted to load page text content, but no page was specified.");const[k,R]=me(),{value:v,error:A}=k,d=n.useRef(null),P=n.useRef();re(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1);function L(){v&&i&&i(v)}function T(){A&&(re(!1,A.toString()),a&&a(A))}function f(){R({type:"RESET"})}n.useEffect(f,[x,R]);function b(){if(!x)return;const y=Ce(x.getTextContent()),l=y;return y.promise.then(D=>{R({type:"RESOLVE",value:D})}).catch(D=>{R({type:"REJECT",error:D})}),()=>ce(l)}n.useEffect(b,[x,R]),n.useEffect(()=>{if(v!==void 0){if(v===!1){T();return}L()}},[v]);const u=n.useCallback(()=>{c&&c()},[c]),I=n.useCallback(y=>{re(!1,y.toString()),o&&o(y)},[o]);function g(){const y=P.current;y&&y.classList.add("active")}function S(){const y=P.current;y&&y.classList.remove("active")}const m=n.useMemo(()=>x.getViewport({scale:E,rotation:j}),[x,j,E]);function h(){if(!x||!v)return;const{current:y}=d;if(!y)return;y.innerHTML="";const l=x.streamTextContent({includeMarkedContent:!0}),D={container:y,textContentSource:l,viewport:m},B=ae.renderTextLayer(D),Z=B;return B.promise.then(()=>{const K=document.createElement("div");K.className="endOfContent",y.append(K),P.current=K;const Q=!!y.querySelector(".markedContent")?y.querySelectorAll(".markedContent > *:not(.markedContent"):y.children;if(r){let oe=0;v.items.forEach((ie,xe)=>{if(!ir(ie))return;const ue=Q[oe];if(!ue)return;const he=r(Object.assign({pageIndex:C,pageNumber:p,itemIndex:xe},ie));ue.innerHTML=he,oe+=ie.str&&ie.hasEOL?2:1})}u()}).catch(I),()=>ce(Z)}return n.useLayoutEffect(h,[r,I,u,x,C,p,v,m]),z.createElement("div",{className:He("react-pdf__Page__textContent","textLayer"),onMouseUp:S,onMouseDown:g,ref:d})}function cr(){const t=Mt();O(t,"Unable to find Document context. Did you wrap <Page /> in <Document />?");const r=Fe();O(r,"Unable to find Page context.");const a=Object.assign(Object.assign({},t),r),{imageResourcesPath:i,linkService:o,onGetAnnotationsError:c,onGetAnnotationsSuccess:x,onRenderAnnotationLayerError:C,onRenderAnnotationLayerSuccess:p,page:j,pdf:E,renderForms:k,rotate:R,scale:v=1}=a;O(j,"Attempted to load page annotations, but no page was specified.");const[A,d]=me(),{value:P,error:L}=A,T=n.useRef(null);re(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1);function f(){P&&x&&x(P)}function b(){L&&(re(!1,L.toString()),c&&c(L))}function u(){d({type:"RESET"})}n.useEffect(u,[d,j]);function I(){if(!j)return;const y=Ce(j.getAnnotations()),l=y;return y.promise.then(D=>{d({type:"RESOLVE",value:D})}).catch(D=>{d({type:"REJECT",error:D})}),()=>{ce(l)}}n.useEffect(I,[d,j,k]),n.useEffect(()=>{if(P!==void 0){if(P===!1){b();return}f()}},[P]);function g(){p&&p()}function S(y){C&&C(y)}const m=n.useMemo(()=>j.getViewport({scale:v,rotation:R}),[j,R,v]);function h(){if(!E||!j||!P)return;const{current:y}=T;if(!y)return;const l=m.clone({dontFlip:!0}),D={annotations:P,annotationStorage:E.annotationStorage,div:y,downloadManager:null,imageResourcesPath:i,linkService:o,page:j,renderForms:k,viewport:l};y.innerHTML="";try{ae.AnnotationLayer.render(D),g()}catch(B){S(B)}return()=>{}}return n.useEffect(h,[P,i,o,j,k,m]),z.createElement("div",{className:He("react-pdf__Page__annotations","annotationLayer"),ref:T})}var dr=globalThis&&globalThis.__rest||function(t,r){var a={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&r.indexOf(i)<0&&(a[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(t);o<i.length;o++)r.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(t,i[o])&&(a[i[o]]=t[i[o]]);return a};const St=1,Ht=function(r){const a=Mt();O(a,"Unable to find Document context. Did you wrap <Page /> in <Document />?");const i=Object.assign(Object.assign({},a),r),{_className:o="react-pdf__Page",_enableRegisterUnregisterPage:c=!0,canvasBackground:x,canvasRef:C,children:p,className:j,customRenderer:E,customTextRenderer:k,devicePixelRatio:R,error:v="Failed to load the page.",height:A,inputRef:d,loading:P="Loading page…",noData:L="No page specified.",onGetAnnotationsError:T,onGetAnnotationsSuccess:f,onGetStructTreeError:b,onGetStructTreeSuccess:u,onGetTextError:I,onGetTextSuccess:g,onLoadError:S,onLoadSuccess:m,onRenderAnnotationLayerError:h,onRenderAnnotationLayerSuccess:y,onRenderError:l,onRenderSuccess:D,onRenderTextLayerError:B,onRenderTextLayerSuccess:Z,pageIndex:K,pageNumber:ee,pdf:Q,registerPage:oe,renderAnnotationLayer:ie=!0,renderForms:xe=!1,renderMode:ue="canvas",renderTextLayer:he=!0,rotate:Te,scale:je=St,unregisterPage:Re,width:ye}=i,Me=dr(i,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[Ze,pe]=me(),{value:q,error:we}=Ze,Ae=n.useRef(null);O(Q,"Attempted to load a page, but no document was specified.");const N=fe(ee)?ee-1:K??null,G=ee??(fe(K)?K+1:null),W=Te??(q?q.rotate:null),$=n.useMemo(()=>{if(!q)return null;let be=1;const Xe=je??St;if(ye||A){const ve=q.getViewport({scale:1,rotation:W});ye?be=ye/ve.width:A&&(be=A/ve.height)}return Xe*be},[A,q,W,je,ye]);function _e(){return()=>{fe(N)&&c&&Re&&Re(N)}}n.useEffect(_e,[c,Q,N,Re]);function Kt(){if(m){if(!q||!$)return;m($e(q,$))}if(c&&oe){if(!fe(N)||!Ae.current)return;oe(N,Ae.current)}}function Wt(){we&&(re(!1,we.toString()),S&&S(we))}function Jt(){pe({type:"RESET"})}n.useEffect(Jt,[pe,Q,N]);function Yt(){if(!Q||!G)return;const be=Ce(Q.getPage(G)),Xe=be;return be.promise.then(ve=>{pe({type:"RESOLVE",value:ve})}).catch(ve=>{pe({type:"REJECT",error:ve})}),()=>ce(Xe)}n.useEffect(Yt,[pe,Q,N,G,oe]),n.useEffect(()=>{if(q!==void 0){if(q===!1){Wt();return}Kt()}},[q,$]);const Zt=n.useMemo(()=>q&&fe(N)&&G&&fe(W)&&fe($)?{_className:o,canvasBackground:x,customTextRenderer:k,devicePixelRatio:R,onGetAnnotationsError:T,onGetAnnotationsSuccess:f,onGetStructTreeError:b,onGetStructTreeSuccess:u,onGetTextError:I,onGetTextSuccess:g,onRenderAnnotationLayerError:h,onRenderAnnotationLayerSuccess:y,onRenderError:l,onRenderSuccess:D,onRenderTextLayerError:B,onRenderTextLayerSuccess:Z,page:q,pageIndex:N,pageNumber:G,renderForms:xe,renderTextLayer:he,rotate:W,scale:$}:null,[o,x,k,R,T,f,b,u,I,g,h,y,l,D,B,Z,q,N,G,xe,he,W,$]),Xt=n.useMemo(()=>Lt(Me,()=>q&&($?$e(q,$):void 0)),[Me,q,$]),Ve=`${N}@${$}/${W}`,Qt=`${N}/${W}`;function en(){switch(ue){case"custom":return O(E,'renderMode was set to "custom", but no customRenderer was passed.'),z.createElement(E,{key:`${Ve}_custom`});case"none":return null;case"svg":return z.createElement(or,{key:`${Qt}_svg`});case"canvas":default:return z.createElement(ar,{key:`${Ve}_canvas`,canvasRef:C})}}function tn(){return he?z.createElement(lr,{key:`${Ve}_text`}):null}function nn(){return ie?z.createElement(cr,{key:`${Ve}_annotations`}):null}function rn(){return z.createElement(Vt.Provider,{value:Zt},en(),tn(),nn(),p)}function sn(){return G?Q===null||q===void 0||q===null?z.createElement(Ee,{type:"loading"},typeof P=="function"?P():P):Q===!1||q===!1?z.createElement(Ee,{type:"error"},typeof v=="function"?v():v):rn():z.createElement(Ee,{type:"no-data"},typeof L=="function"?L():L)}return z.createElement("div",Object.assign({className:He(o,j),"data-page-number":G,ref:_t(d,Ae),style:{"--scale-factor":`${$}`,backgroundColor:x||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},Xt),sn())},tt=s.oneOfType([s.func,s.node]);Ht.propTypes=Object.assign(Object.assign({},Bt),{canvasBackground:s.string,canvasRef:ct,children:s.node,className:Ot,customRenderer:s.func,customTextRenderer:s.func,devicePixelRatio:s.number,error:tt,height:s.number,imageResourcesPath:s.string,inputRef:ct,loading:tt,noData:tt,onGetTextError:s.func,onGetTextSuccess:s.func,onLoadError:s.func,onLoadSuccess:s.func,onRenderError:s.func,onRenderSuccess:s.func,onRenderTextLayerError:s.func,onRenderTextLayerSuccess:s.func,pageIndex:Hn,pageNumber:Un,pdf:Kn,renderAnnotationLayer:s.bool,renderForms:s.bool,renderMode:Wn,renderTextLayer:s.bool,rotate:Jn,scale:s.number,width:s.number});const ur=Ht,Ut=t=>{const[r,a]=n.useState(!1),[i,o]=n.useState(0),[c,x]=n.useState(0),[C,p]=n.useState(1),[j,E]=n.useState([]),[k,R]=n.useState(),[v,A]=n.useState(!1),[d]=w.useForm();Y();const P=f=>{R(f),A(!0)},L=async f=>{const{data:b}=await J.custom({url:"",method:"post",meta:{operation:"addBookToReadings",variables:{bookId:{value:f,type:"Int",required:!0}},fields:["success","message",{book:["id","title","description","file","cover","price","downloadable","publisherCanAddToReadings","created","updated","isActive","isPublic","canEdit","canDelete","canManage",{author:["id","firstName","lastName","middleName","fullName","email","pic"]}]}]}}).catch(u=>(V.error("Error deleting book"),{data:null})).then(u=>u);b&&(b.success?(V.success(b.message),E(j.map(u=>u.id===f?b.book:u))):V.error(b.message))},T=async(f,b="")=>{a(!0);const{data:u}=await J.custom({url:"",method:"get",meta:{operation:"marketplaceBooks",variables:{page:{value:f,type:"Int",required:!0},key:{value:b,type:"String",required:!1},public:{value:t.public,type:"Boolean",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","title","description","file","cover","price","created","updated","isActive","isPublic","hasPurchaseOrder","orderPaid","canEdit","canDelete","canManage",{author:["id","firstName","lastName","middleName","fullName","email","pic"]}]}]}}).catch(I=>(V.error("Error getting Books"),{data:null})).then(I=>I);u&&(o(u.total),x(u.pages),p(u.page),E(u.results)),a(!1)};return n.useEffect(()=>{T(C,"")},[t.randKey]),e.jsxs(e.Fragment,{children:[e.jsx(F,{container:!0,spacing:0,sx:{display:"flex",justifyContent:"center"},children:e.jsx(F,{item:!0,xs:12,sm:12,md:4,lg:4,xl:4,children:e.jsx(w,{layout:"vertical",form:d,children:e.jsx(w.Item,{name:"key",children:e.jsx(se,{size:"large",placeholder:"Search Book(s)...",prefix:e.jsx(de,{}),autoComplete:"off",allowClear:!0})})})})}),e.jsx(Ue,{spinning:r,children:e.jsxs(F,{container:!0,spacing:0,children:[j.length===0&&e.jsx(e.Fragment,{children:e.jsx(F,{item:!0,xs:12,sm:12,md:12,lg:12,xl:12,children:e.jsx(Ke,{description:"No Book Published"})})}),j.map(f=>e.jsx(F,{item:!0,xs:12,sm:12,md:6,lg:6,xl:6,children:e.jsx(Se,{hoverable:!0,bordered:!0,style:{margin:"2px"},type:"inner",actions:[e.jsxs("span",{style:{fontSize:"18px",display:f.price>0?"block":"none"},children:[f.price," Tsh"]}),e.jsx("span",{style:{float:"right",marginRight:"10px",display:"flex"},children:f.isPublic?e.jsx(M,{size:"large",icon:e.jsx(Ie,{}),onClick:()=>L(f.id),children:"Add to Readings"}):e.jsxs(e.Fragment,{children:[f.orderPaid&&e.jsx(e.Fragment,{children:e.jsx(De,{color:"green",children:"Already Purchased"})}),!f.orderPaid&&e.jsx(M,{size:"large",icon:e.jsx(Et,{}),onClick:()=>P(f),children:"Buy"})]})})],children:e.jsxs(F,{container:!0,spacing:0,children:[e.jsx(F,{item:!0,xs:12,sm:12,md:4,sx:{backgroundSize:"cover",backgroundPosition:"center",backgroundImage:"url("+f.cover+")"},children:e.jsx(ne,{sx:{display:{xs:"block",md:"none"},height:100,width:"100%",backgroundSize:"cover",backgroundPosition:"center",backgroundImage:"url("+f.cover+")"}})}),e.jsx(F,{item:!0,xs:12,sm:12,md:8,children:e.jsx(ne,{style:{padding:"10px"},children:e.jsxs(ge,{direction:"vertical",children:[e.jsx("a",{children:e.jsx("h3",{children:f.title.length>50?f.title.substring(0,50)+"...":f.title})}),e.jsx("p",{children:f.description.replace(/(<([^>]+)>)/gi,"").length>100?f.description.replace(/(<([^>]+)>)/gi,"").substring(0,100)+"...":f.description.replace(/(<([^>]+)>)/gi,"")}),e.jsx("div",{children:e.jsx(ge,{children:e.jsx(le,{title:"Click to View Author Profile",children:e.jsxs("a",{children:[e.jsx(Be,{size:"small",src:f.author.pic}),e.jsx("span",{style:{marginLeft:"10px"},children:f.author.fullName})]})})})})]})})})]})})}))]})}),e.jsx(X,{children:e.jsx(U,{span:24,style:{display:"flex",justifyContent:"center",marginTop:"10px",marginBottom:"20px"},children:e.jsx(We,{defaultCurrent:C,total:i})})}),e.jsx(Ne,{title:"Purchase Book",open:v,onClose:f=>A(f),width:"40vw",children:e.jsx(ht,{book:k,randKey:Math.random()})})]})},hr=()=>{const{push:t}=Y();return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10},children:e.jsxs(_,{children:[e.jsx(_.Item,{children:e.jsx("a",{onClick:()=>t("/olib"),children:"Home"})}),e.jsx(_.Item,{children:"Books MarketPlace"})]})}),e.jsx(Ut,{public:!1,randKey:Math.random()})]})},pr=()=>{const{push:t}=Y();return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10},children:e.jsxs(_,{children:[e.jsx(_.Item,{children:e.jsx("a",{onClick:()=>t("/olib"),children:"Home"})}),e.jsx(_.Item,{children:"Public Books"})]})}),e.jsx(Ut,{public:!0,randKey:Math.random()})]})},fr=t=>{const[r,a]=n.useState(!1),[i,o]=n.useState(0),[c,x]=n.useState(0),[C,p]=n.useState(1),[j,E]=n.useState(25),[k,R]=n.useState(""),[v,A]=n.useState([]);n.useState();const[d]=w.useForm();n.useState(!1);const[P,L]=n.useState(!1);Y();const T=async(b,u="",I=25)=>{a(!0);const{data:g}=await J.custom({url:"",method:"get",meta:{operation:"authorBooksPurchases",variables:{page:{value:b,type:"Int",required:!0},key:{value:u,type:"String",required:!1},pageSize:{value:I,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","price","paymentDate","receiptNumber","isPaid",{book:["id","title","description","file","cover","price","created","updated","isActive","isPublic","hasPurchaseOrder","canEdit","canDelete","canManage",{author:["id","firstName","lastName","middleName","fullName","email","pic"]}]},{user:["id","firstName","middleName","lastName"]},{bill:["id","billNumber"]},"isActive","created","updated","canDelete","canManage"]}]}}).catch(S=>(V.error("Error getting Bills"),{data:null})).then(S=>S);g&&(o(g.total),x(g.pages),p(g.page),A(g.results)),a(!1)},f=[{title:"Bill#",dataIndex:"billNumber",fixed:!0,render:(b,u,I)=>{var g;return e.jsx("span",{children:e.jsx("a",{children:(g=u==null?void 0:u.bill)==null?void 0:g.billNumber})})}},{title:"Book Title",dataIndex:"bookTitle",fixed:!0,render:(b,u,I)=>{var g;return e.jsx("span",{children:e.jsx("a",{children:(g=u==null?void 0:u.book)==null?void 0:g.title})})}},{title:"Amount",dataIndex:"billAmount",fixed:!0,render:(b,u,I)=>e.jsxs("span",{children:[u.price," Tsh"]})}];return n.useEffect(()=>{T(C,"",25)},[t.randKey]),e.jsxs(e.Fragment,{children:[e.jsx(Oe,{offsetTop:75,children:e.jsxs(X,{style:{display:"flex",justifyContent:"center",marginTop:20},children:[e.jsx(U,{span:10,children:e.jsx(w,{layout:"vertical",form:d,onFinish:b=>{T(1,b.key,25)},children:e.jsx(w.Item,{name:"key",children:e.jsx(se,{size:"large",placeholder:"Search Bill(s)...",prefix:e.jsx(de,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(U,{span:14,style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(M,{icon:e.jsx(Ie,{}),size:"large",onClick:()=>L(!0),children:"Create Disbursement"})})]})}),e.jsx(X,{children:e.jsx(U,{span:24,children:e.jsx(dt,{loading:r,columns:f,dataSource:v,pagination:{onChange:(b,u)=>{E(u),T(b,k,u)},total:i,pageSize:j,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0}})})}),e.jsx(Ne,{title:"Creating Dibursement",width:"35vw",open:P,onClose:b=>L(b),children:e.jsx("p",{children:"Creating Dibursement"})})]})},gr=()=>{const{push:t}=Y();return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10},children:e.jsxs(_,{children:[e.jsx(_.Item,{children:e.jsx("a",{onClick:()=>t("/olib"),children:"Home"})}),e.jsx(_.Item,{children:e.jsx("a",{onClick:()=>t("/olib/publish/books"),children:"Published Books"})}),e.jsx(_.Item,{children:e.jsx("a",{onClick:()=>t("/olib/books/purchases"),children:"Books Purchases"})}),e.jsx(_.Item,{children:"Books Purchases Disbursement"})]})}),e.jsx(fr,{})]})},mr=t=>{const[r,a]=n.useState(!1),[i,o]=n.useState(0),[c,x]=n.useState(0),[C,p]=n.useState(1),[j,E]=n.useState(25),[k,R]=n.useState(""),[v,A]=n.useState([]),[d,P]=n.useState(),[L]=w.useForm(),[T,f]=n.useState(!1),{push:b}=Y(),u=async(g,S="",m=25)=>{a(!0);const{data:h}=await J.custom({url:"",method:"get",meta:{operation:"authorBooksPurchases",variables:{page:{value:g,type:"Int",required:!0},key:{value:S,type:"String",required:!1},pageSize:{value:m,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","price","paymentDate","receiptNumber","isPaid",{book:["id","title","description","file","cover","price","created","updated","isActive","isPublic","hasPurchaseOrder","canEdit","canDelete","canManage",{author:["id","firstName","lastName","middleName","fullName","email","pic"]}]},{user:["id","firstName","middleName","lastName"]},{bill:["id","billNumber"]},"isActive","created","updated","canDelete","canManage"]}]}}).catch(y=>(V.error("Error getting Bills"),{data:null})).then(y=>y);h&&(o(h.total),x(h.pages),p(h.page),A(h.results)),a(!1)},I=[{title:"Bill#",dataIndex:"billNumber",fixed:!0,render:(g,S,m)=>{var h;return e.jsx("span",{children:e.jsx("a",{children:(h=S==null?void 0:S.bill)==null?void 0:h.billNumber})})}},{title:"Book Title",dataIndex:"bookTitle",fixed:!0,render:(g,S,m)=>{var h;return e.jsx("span",{children:e.jsx("a",{children:(h=S==null?void 0:S.book)==null?void 0:h.title})})}},{title:"Amount",dataIndex:"billAmount",fixed:!0,render:(g,S,m)=>e.jsxs("span",{children:[S.price," Tsh"]})}];return n.useEffect(()=>{u(C,"",25)},[t.randKey]),e.jsxs(e.Fragment,{children:[e.jsx(Oe,{offsetTop:75,children:e.jsxs(X,{style:{display:"flex",justifyContent:"center",marginTop:20},children:[e.jsx(U,{span:10,children:e.jsx(w,{layout:"vertical",form:L,onFinish:g=>{u(1,g.key,25)},children:e.jsx(w.Item,{name:"key",children:e.jsx(se,{size:"large",placeholder:"Search Bill(s)...",prefix:e.jsx(de,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(U,{span:14,style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(M,{icon:e.jsx(Ct,{}),size:"large",onClick:()=>b("/olib/books/purchases/disbursements"),children:"Disbursement"})})]})}),e.jsx(X,{children:e.jsx(U,{span:24,children:e.jsx(dt,{loading:r,columns:I,dataSource:v,pagination:{onChange:(g,S)=>{E(S),u(g,k,S)},total:i,pageSize:j,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0}})})}),e.jsx(Ne,{title:"Order Details & Payment",open:T,width:"50vw",onClose:g=>f(g),children:e.jsx(ht,{book:d==null?void 0:d.book})})]})},xr=()=>{const{push:t}=Y();return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10},children:e.jsxs(_,{children:[e.jsx(_.Item,{children:e.jsx("a",{onClick:()=>t("/olib"),children:"Home"})}),e.jsx(_.Item,{children:e.jsx("a",{onClick:()=>t("/olib/publish/books"),children:"Published Books"})}),e.jsx(_.Item,{children:"Books Purchases"})]})}),e.jsx(mr,{})]})};ae.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${ae.version}/pdf.worker.js`;const jr=t=>{const[r,a]=n.useState(900),[i,o]=n.useState(),[c,x]=n.useState(1),[C,p]=n.useState(!1),j=R=>{x(v=>v+R)},E=()=>{j(-1)},k=()=>{j(1)};return n.useEffect(()=>{a(window.innerWidth)},[t.randKey]),e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx("div",{style:{maxHeight:"85vh",minHeight:"85vh",overflowY:"auto",overflowX:"hidden"},onContextMenu:R=>{},children:e.jsx(Qn,{file:t.book.file,onLoadSuccess:({numPages:R})=>{o(R),p(!0)},children:e.jsx(ur,{pageNumber:c,width:r/1.3})})}),C&&e.jsxs("div",{style:{display:"flex",justifyContent:"center",paddingTop:"10px"},children:[e.jsxs(M,{disabled:c<=1,onClick:E,children:[e.jsx(an,{}),"Previous Page (",c," of ",i,")"]}),"  ",e.jsxs(M,{disabled:c===i,onClick:k,children:["Next Page (",c," of ",i,")",e.jsx(on,{})]})]})]})})},yr=t=>{const[r,a]=n.useState(!1),[i,o]=n.useState(!1),[c,x]=n.useState(),[C,p]=n.useState(0),[j,E]=n.useState(0),[k,R]=n.useState(1),[v,A]=n.useState([]),[d,P]=n.useState(),[L,T]=n.useState(!1),[f]=w.useForm(),{push:b}=Y(),u=h=>{P(h),T(!0)},I=async(h,y="")=>{a(!0);const{data:l}=await J.custom({url:"",method:"get",meta:{operation:"userBooks",variables:{page:{value:h,type:"Int",required:!0},key:{value:y,type:"String",required:!1},pageSize:{value:20,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{book:["id","title","description","file","cover","price","created","updated","isActive","isPublic","averageRating","downloadable","canEdit","canDelete","canManage",{author:["id","firstName","lastName","middleName","fullName","email","pic"]}]}]}]}}).catch(D=>(V.error("Error getting Books"),{data:null})).then(D=>D);l&&(p(l.total),E(l.pages),R(l.page),A(l.results)),a(!1)},g=async()=>{o(!0);const{data:h}=await J.custom({url:"",method:"get",meta:{operation:"olibDashboardAnalytics",fields:["analytics"]}}).catch(y=>(V.error("Error fetching analytics"),{data:null})).then(y=>y);h&&x(h.analytics),o(!1)},S=async(h,y)=>{const{data:l}=await J.custom({url:"",method:"post",meta:{operation:"createBookRating",variables:{bookId:{value:y,type:"Int",required:!0},rating:{value:h,type:"Int",required:!0}},fields:["success","message",{userBook:["id",{book:["id","title","description","file","cover","price","created","updated","isActive","isPublic","averageRating","downloadable","canEdit","canDelete","canManage",{author:["id","firstName","lastName","middleName","fullName","email","pic"]}]}]}]}}).catch(D=>(console.log(D),{data:null})).then(D=>D);if(l){const D=v.map(B=>B.id===l.userBook.id?l.userBook:B);A(D)}},m=(h,y)=>e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Rated: "}),e.jsxs("span",{children:[[1,2,3,4,5].map(l=>e.jsx("span",{style:{marginRight:5},children:l<=h?e.jsx(le,{title:l,children:e.jsx("a",{onClick:()=>{S(l,y)},style:{display:"inline"},children:e.jsx(dn,{style:{color:"orange"}})})}):e.jsx(le,{title:l,children:e.jsx("a",{onClick:()=>{S(l,y)},style:{display:"inline"},children:e.jsx(un,{})})})})),e.jsx(De,{color:"green",children:h})]})]});return n.useEffect(()=>{g(),I(k,"")},[t.randKey]),e.jsxs(e.Fragment,{children:[e.jsx(ne,{children:e.jsxs(F,{container:!0,spacing:0,children:[e.jsx(F,{item:!0,xs:6,sm:6,md:3,children:e.jsx("a",{onClick:()=>b("/olib"),children:e.jsx(Se,{children:e.jsx(pt,{title:"Books To Read",value:c==null?void 0:c.my_books,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(ft,{})})})})}),e.jsx(F,{item:!0,xs:6,sm:6,md:3,children:e.jsx("a",{onClick:()=>b("/olib/books/public"),children:e.jsx(Se,{children:e.jsx(pt,{title:"Public Books",value:c==null?void 0:c.public_books,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(ft,{})})})})})]})}),e.jsx(Oe,{offsetTop:75,children:e.jsx(ne,{sx:{display:"flex",justifyContent:"center",mt:2},children:e.jsx(F,{container:!0,spacing:0,sx:{display:"flex",justifyContent:"center"},children:e.jsx(F,{item:!0,xs:12,sm:4,md:4,children:e.jsx(w,{layout:"vertical",form:f,onFinish:h=>{I(1,h.key)},children:e.jsx(w.Item,{name:"key",children:e.jsx(se,{size:"large",placeholder:"Search Book(s)...",prefix:e.jsx(de,{}),autoComplete:"off",allowClear:!0})})})})})})}),e.jsxs(Ue,{spinning:r,children:[e.jsxs(F,{container:!0,spacing:0,children:[v.length===0&&!r&&e.jsx(e.Fragment,{children:e.jsx(F,{item:!0,xs:12,sm:12,md:12,children:e.jsx(Ke,{description:"No Book Published"})})}),v.map(h=>e.jsx(F,{item:!0,xs:12,sm:12,md:6,children:e.jsx(Se,{hoverable:!0,bordered:!0,style:{margin:"2px"},type:"inner",actions:[e.jsx("span",{children:m(h.book.averageRating,h.book.id)}),e.jsxs("span",{style:{float:"right",marginRight:"10px",display:"flex"},children:[h.book.downloadable&&e.jsx(M,{icon:e.jsx(ln,{}),children:e.jsx("a",{href:h.book.file,target:"_blank",download:!0,children:"Download"})}),e.jsx(M,{style:{marginRight:"10px"},icon:e.jsx(gt,{}),onClick:()=>u(h),children:"Read"}),e.jsx(Tt,{trigger:["click"],overlay:e.jsxs(ke,{children:[e.jsx(ke.Item,{icon:e.jsx(gt,{}),onClick:()=>u(h),children:e.jsx("a",{rel:"noopener noreferrer",children:"Read"})}),e.jsx(ke.Item,{icon:e.jsx(cn,{}),onClick:()=>V("Under construction"),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Report"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:y=>y.preventDefault(),children:e.jsx(Rt,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})]})],children:e.jsxs(F,{container:!0,spacing:0,children:[e.jsx(F,{item:!0,xs:12,sm:12,md:4,sx:{backgroundSize:"cover",backgroundPosition:"center",backgroundImage:"url("+h.book.cover+")"},children:e.jsx(ne,{sx:{display:{xs:"block",md:"none"},height:100,width:"100%",backgroundSize:"cover",backgroundPosition:"center",backgroundImage:"url("+h.book.cover+")"}})}),e.jsx(F,{item:!0,xs:12,sm:12,md:8,children:e.jsx(ne,{style:{padding:"10px"},children:e.jsxs(ge,{direction:"vertical",children:[e.jsx("a",{children:e.jsx("h3",{children:h.book.title.length>50?h.book.title.substring(0,50)+"...":h.book.title})}),e.jsx("p",{children:h.book.description.replace(/(<([^>]+)>)/gi,"").length>100?h.book.description.replace(/(<([^>]+)>)/gi,"").substring(0,100)+"...":h.book.description.replace(/(<([^>]+)>)/gi,"")}),e.jsx("div",{children:e.jsx(ge,{children:e.jsx(le,{title:"Click to View Author Profile",children:e.jsxs("a",{children:[e.jsx(Be,{size:"small",src:h.book.author.pic}),e.jsx("span",{style:{marginLeft:"10px"},children:h.book.author.fullName})]})})})})]})})})]})})}))]}),e.jsx(X,{children:e.jsx(U,{span:24,style:{display:"flex",justifyContent:"center",marginTop:"10px",marginBottom:"20px"},children:e.jsx(We,{defaultCurrent:k,total:C,defaultPageSize:20,onChange:h=>{R(h),I(h,"")}})})})]}),e.jsx(Ge,{title:d==null?void 0:d.book.title,anchor:"right",width:"80vw",onClose:h=>T(h),open:L,children:e.jsx(jr,{book:d==null?void 0:d.book,randKey:Math.random()})})]})},br=()=>{const{push:t}=Y();return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10},children:e.jsxs(_,{children:[e.jsx(_.Item,{children:e.jsx("a",{onClick:()=>t("/olib"),children:"Home"})}),e.jsx(_.Item,{children:"Dashboard"})]})}),e.jsx(yr,{})]})},vr=t=>{const[r,a]=n.useState(!0),[i,o]=n.useState(!1),[c,x]=n.useState(0),[C,p]=n.useState(0),[j,E]=n.useState(1),[k,R]=n.useState(!1);n.useState(25),n.useState("");const[v,A]=n.useState([]);n.useState();const[d]=w.useForm();n.useState(!1),Y();const P=async(f,b="",u=25)=>{o(!0);const{data:I}=await J.custom({url:"",method:"get",meta:{operation:"booksAuthorsToAdd",variables:{page:{value:f,type:"Int",required:!0},key:{value:b,type:"String",required:!1},pageSize:{value:u,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","firstName","middleName","lastName","fullName","email","pic","isActive","created","updated","canDelete","canManage"]}]}}).catch(g=>(V.error("Error getting authors"),{data:null})).then(g=>g);I&&(x(I.total),p(I.pages),E(I.page),R(I.hasNext),A([...v,...I.results])),o(!1)},L=async f=>{const{data:b}=await J.custom({url:"",method:"post",meta:{operation:"addBooksAuthor",variables:{authorId:{value:f,type:"Int",required:!0}},fields:["success","message",{bookAuthor:["id",{user:["id","firstName","middleName","lastName","fullName","email","pic","isActive","created","updated","canDelete","canManage"]},"isActive","created","updated","canDelete","canManage"]}]}}).catch(u=>(V.error("Error Adding Author"),{data:null})).then(u=>u);b&&(b.success?(V.success(b.message),A(v.filter(u=>parseInt(u.id.toString())!==f)),t.onAdd(b.bookAuthor)):V.error(b.message)),o(!1)},T=k?e.jsx("div",{style:{textAlign:"center",marginTop:12,height:32,lineHeight:"32px"},children:e.jsx(M,{size:"large",onClick:()=>P(j,"",25),children:"loading more"})}):null;return n.useEffect(()=>{P(j,"",25),a(!1)},[t.randKey]),e.jsxs(e.Fragment,{children:[e.jsx(Oe,{offsetTop:90,children:e.jsx(X,{style:{display:"flex",justifyContent:"center"},children:e.jsx(U,{span:10,children:e.jsx(w,{layout:"vertical",form:d,onFinish:f=>{P(1,f.key,25)},children:e.jsx(w.Item,{name:"key",children:e.jsx(se,{size:"large",placeholder:"Search Bill(s)...",prefix:e.jsx(de,{}),autoComplete:"off",allowClear:!0})})})})})}),e.jsx("div",{style:{maxHeight:"80vh",overflowY:"auto",overflowX:"hidden"},children:e.jsx(Qe,{itemLayout:"horizontal",loadMore:T,dataSource:v,renderItem:f=>e.jsx(Qe.Item,{actions:[e.jsx(Je,{title:"Adding Books Author??",onConfirm:()=>L(parseInt(f.id.toString())),okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx(M,{icon:e.jsx(Ie,{}),size:"large"})})],children:e.jsx(hn,{avatar:!0,title:!1,loading:i,active:!0,children:e.jsx(Qe.Item.Meta,{avatar:e.jsx(Be,{src:f.pic}),title:e.jsx("a",{children:f.fullName}),description:e.jsx(e.Fragment,{children:e.jsx(De,{color:"green",children:f.email})})})})})})})]})},Sr=t=>{const[r,a]=n.useState(!1),[i,o]=n.useState(0),[c,x]=n.useState(0),[C,p]=n.useState(1),[j,E]=n.useState([]);n.useState(),n.useState(!1);const[k,R]=n.useState(!1),[v,A]=n.useState(!1),[d]=w.useForm();Y();const P=async(T,f="")=>{a(!0);const{data:b}=await J.custom({url:"",method:"get",meta:{operation:"vertedBooksPublishers",variables:{page:{value:T,type:"Int",required:!0},key:{value:f,type:"String",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{user:["id","firstName","lastName","middleName","fullName","email","pic"]},"canEdit","canDelete","canManage"]}]}}).catch(u=>(V.error("Error getting Books"),{data:null})).then(u=>u);b&&(o(b.total),x(b.pages),p(b.page),E(b.results)),a(!1)},L=async T=>{E([T,...j])};return n.useEffect(()=>{P(C,"")},[t.randKey]),e.jsxs(e.Fragment,{children:[e.jsxs(X,{style:{display:"flex",justifyContent:"center",marginTop:20},children:[e.jsx(U,{span:10,children:e.jsx(w,{layout:"vertical",form:d,children:e.jsx(w.Item,{name:"key",children:e.jsx(se,{size:"large",placeholder:"Search Book(s)...",prefix:e.jsx(de,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(U,{span:14,style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(M,{icon:e.jsx(Ie,{}),size:"large",onClick:()=>R(!0),children:"Add Authors"})})]}),e.jsx(Ue,{spinning:r,children:e.jsxs(X,{children:[j.length===0&&e.jsx(e.Fragment,{children:e.jsx(U,{span:24,children:e.jsx(Ke,{description:"No Book Published"})})}),j.map(T=>e.jsx(U,{span:6,children:e.jsx(Se,{hoverable:!0,bordered:!0,style:{margin:"2px"},bodyStyle:{minHeight:100,maxHeight:100},actions:[e.jsx(M,{disabled:!0,size:"large",children:"100 Books"}),e.jsx(le,{title:"View Authors Details",color:"green",children:e.jsx(M,{icon:e.jsx(pn,{}),size:"large",onClick:()=>A(!0)})}),e.jsx("span",{style:{background:"red"},children:T.canDelete&&e.jsx(Je,{title:"Delete the Author",okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx(M,{size:"large",icon:e.jsx(ut,{})})})})],children:e.jsx(X,{children:e.jsx(U,{span:24,style:{padding:"10px"},children:e.jsx(ge,{direction:"horizontal",children:e.jsxs("a",{children:[e.jsx(Be,{src:T.user.pic,size:"large"}),e.jsx("span",{style:{marginLeft:10},children:T.user.fullName})]})})})})})},T.id))]})}),e.jsx(X,{children:e.jsx(U,{span:24,style:{display:"flex",justifyContent:"center",marginTop:"10px",marginBottom:"20px"},children:e.jsx(We,{defaultCurrent:C,total:i})})}),e.jsx(Ge,{title:"Adding Authors",anchor:"right",width:"50vw",onClose:T=>R(T),open:k,children:e.jsx(vr,{randKey:Math.random(),onAdd:L})}),e.jsx(Ge,{title:"Author Details",width:"50vw",anchor:"right",onClose:T=>A(T),open:v,children:e.jsxs(e.Fragment,{children:[e.jsxs(te,{title:"Author Info",children:[e.jsx(te.Item,{label:"UserName",children:"Zhou Maomao"}),e.jsx(te.Item,{label:"Telephone",children:"1810000000"}),e.jsx(te.Item,{label:"Live",children:"Hangzhou, Zhejiang"}),e.jsx(te.Item,{label:"Remark",children:"empty"}),e.jsx(te.Item,{label:"Address",children:"No. 18, Wantang Road, Xihu District, Hangzhou, Zhejiang, China"})]}),e.jsxs(te,{title:"Author Company Info",children:[e.jsx(te.Item,{label:"UserName",children:"Zhou Maomao"}),e.jsx(te.Item,{label:"Telephone",children:"1810000000"}),e.jsx(te.Item,{label:"Live",children:"Hangzhou, Zhejiang"}),e.jsx(te.Item,{label:"Remark",children:"empty"}),e.jsx(te.Item,{label:"Address",children:"No. 18, Wantang Road, Xihu District, Hangzhou, Zhejiang, China"})]})]})})]})},kr=()=>{const{push:t}=Y();return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10},children:e.jsxs(_,{children:[e.jsx(_.Item,{children:e.jsx("a",{onClick:()=>t("/olib"),children:"Home"})}),e.jsx(_.Item,{children:"Books Authors"})]})}),e.jsx(Sr,{randKey:Math.random()})]})},Pr=t=>{const[r,a]=n.useState(!1),[i,o]=n.useState(0),[c,x]=n.useState(0),[C,p]=n.useState(1),[j,E]=n.useState(25),[k,R]=n.useState(""),[v,A]=n.useState([]),[d,P]=n.useState(),[L]=w.useForm(),[T,f]=n.useState(!1);Y();const b=async S=>{P(S),f(!0)},u=async(S,m="",h=25)=>{a(!0);const{data:y}=await J.custom({url:"",method:"get",meta:{operation:"myBooksOrders",variables:{page:{value:S,type:"Int",required:!0},key:{value:m,type:"String",required:!1},pageSize:{value:h,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","price","paymentDate","receiptNumber","isPaid",{book:["id","title","description","file","cover","price","created","updated","isActive","isPublic","hasPurchaseOrder","canEdit","canDelete","canManage",{author:["id","firstName","lastName","middleName","fullName","email","pic"]}]},{user:["id","firstName","middleName","lastName"]},{bill:["id","billNumber"]},"isActive","created","updated","canDelete","canManage"]}]}}).catch(l=>(V.error("Error getting Bills"),{data:null})).then(l=>l);y&&(o(y.total),x(y.pages),p(y.page),A(y.results)),a(!1)},I=async S=>{const{data:m}=await J.custom({url:"",method:"post",meta:{operation:"deleteBookOrder",variables:{id:{value:S,type:"Int",required:!0}},fields:["success","message"]}}).catch(h=>(V.error("Error deleting Order"),{data:null})).then(h=>h);m&&A(v.filter(h=>h.id!==S))},g=[{title:"Bill#",dataIndex:"billNumber",fixed:!0,render:(S,m,h)=>{var y;return e.jsx("span",{children:e.jsx("a",{children:(y=m==null?void 0:m.bill)==null?void 0:y.billNumber})})}},{title:"Book Title",dataIndex:"bookTitle",fixed:!0,render:(S,m,h)=>{var y;return e.jsx("span",{children:e.jsx("a",{children:(y=m==null?void 0:m.book)==null?void 0:y.title})})}},{title:"Bill Amount",dataIndex:"billAmount",fixed:!0,render:(S,m,h)=>e.jsxs("span",{children:[m.price," Tsh"]})},{title:"Paid",dataIndex:"isPaid",fixed:!0,render:(S,m,h)=>e.jsx("span",{children:m.isPaid?e.jsx(De,{color:"green",children:"Yes"}):e.jsx(De,{color:"red",children:"No"})})},{title:"Created",dataIndex:"created",render:(S,m,h)=>e.jsx(e.Fragment,{children:e.jsx("span",{children:e.jsx(fn,{date:new Date(m.created)})})})},{title:"Status",dataIndex:"isActive",render:(S,m,h)=>e.jsx("a",{children:m!=null&&m.isActive?e.jsx("span",{style:{color:"green"},children:"Active"}):e.jsx("span",{style:{color:"red"},children:"Inactive"})})},{title:"",dataIndex:"action",render:(S,m,h)=>e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end"},children:[!m.isPaid&&e.jsx(Je,{title:"Are you sure to delete this Order?",onConfirm:()=>I(m.id),okText:"Yes",cancelText:"No",disabled:!(m!=null&&m.canDelete),overlayStyle:{zIndex:9999},children:e.jsx(M,{icon:e.jsx(ut,{}),disabled:!(m!=null&&m.canDelete),size:"large"})}),m.isPaid&&e.jsx(le,{title:"Print Receipt",children:e.jsx(M,{icon:e.jsx(gn,{}),size:"large"})}),!m.isPaid&&e.jsx(le,{title:"View Order Details",placement:"topLeft",children:e.jsx(M,{icon:e.jsx(Ct,{}),size:"large",onClick:()=>b(m)})})]})}];return n.useEffect(()=>{u(C,"",25)},[t.randKey]),e.jsxs(e.Fragment,{children:[e.jsx(Oe,{offsetTop:75,children:e.jsx(X,{style:{display:"flex",justifyContent:"center",marginTop:20},children:e.jsx(U,{span:10,children:e.jsx(w,{layout:"vertical",form:L,onFinish:S=>{u(1,S.key,25)},children:e.jsx(w.Item,{name:"key",children:e.jsx(se,{size:"large",placeholder:"Search Bill(s)...",prefix:e.jsx(de,{}),autoComplete:"off",allowClear:!0})})})})})}),e.jsx(X,{children:e.jsx(U,{span:24,children:e.jsx(dt,{loading:r,columns:g,dataSource:v,pagination:{onChange:(S,m)=>{E(m),u(S,k,m)},total:i,pageSize:j,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0}})})}),e.jsx(Ne,{title:"Order Details & Payment",open:T,width:"50vw",onClose:S=>f(S),children:e.jsx(ht,{book:d==null?void 0:d.book})})]})},Er=()=>{const{push:t}=Y();return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10},children:e.jsxs(_,{children:[e.jsx(_.Item,{children:e.jsx("a",{onClick:()=>t("/olib"),children:"Home"})}),e.jsx(_.Item,{children:"Books Orders"})]})}),e.jsx(Pr,{})]})},kt=[".pdf"],Cr=t=>Array.isArray(t)?t:t==null?void 0:t.fileList,Tr=t=>{const[r,a]=n.useState(""),[i,o]=n.useState(!1),[c,x]=n.useState(!1),[C,p]=n.useState(!1),[j,E]=n.useState(""),[k]=w.useForm(),R=[{label:"Public (Free)",value:!0},{label:"Private (Payable or Rentable)",value:!1}],v=async d=>{o(!0);const{data:P}=await J.custom({url:"",method:"post",meta:{operation:"publishBook",variables:{file:{value:d.file,type:"Upload",required:!0},title:{value:d.title,type:"String",required:!0},description:{value:d.description,type:"String",required:!0},price:{value:d.price,type:"Float",required:!1},isPublic:{value:d.is_public,type:"Boolean",required:!0},downloadable:{value:d.downloadable,type:"Boolean",required:!1}},fields:["success","message"]}}).catch(L=>(V.error("Error creating publishing book"),{data:null})).then(L=>L);P&&(P.success?(V.success(P.message),t.onFinish()):V.error(P.message)),o(!1)},A=d=>(d=d.replace(/[-_]/g," "),d=d.replace(/.pdf/g,""),d=d.replace(/[.]/g," "),d=d.replace(/\s+/g," "),d=d.trim(),d);return e.jsx(e.Fragment,{children:e.jsx(Ue,{spinning:i,children:e.jsxs(w,{layout:"vertical",form:k,onFinish:d=>{d.price=d.price??0,d.downloadable=C,d.description=j,v(d)},requiredMark:!0,children:[e.jsx(w.Item,{label:"Pick a Book ("+kt.join()+")",children:e.jsx(w.Item,{name:"file",valuePropName:"fileList",getValueFromEvent:d=>{var L,T;a((L=d==null?void 0:d.file)==null?void 0:L.name);const P=(T=d==null?void 0:d.file)==null?void 0:T.name.split(".");return P.pop(),k.setFieldsValue({title:A(P.join("."))}),Cr(d)},noStyle:!0,rules:[{required:!0,type:"array",message:"Please upload Book file"}],children:e.jsxs(nt.Dragger,{name:"file",accept:kt.join(),multiple:!1,maxCount:1,beforeUpload:()=>!1,onRemove:()=>{a(""),k.setFieldsValue({title:""})},children:[e.jsx("p",{className:"ant-upload-drag-icon",children:e.jsx(rt,{})}),e.jsx("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"})]})})}),e.jsx(w.Item,{name:"title",label:"Book Title",initialValue:r,rules:[{required:!0,type:"string"}],children:e.jsx(se,{size:"large",placeholder:"Enter Book Title ..."})}),e.jsx(w.Item,{name:"is_public",label:"Availability",initialValue:!0,children:e.jsx(st.Group,{options:R,onChange:d=>{x(!d.target.value)},value:!0})}),c&&e.jsx(w.Item,{label:"Book Cost (Tsh)",name:"price",rules:[{required:c,type:"number",min:1e3,message:"Price must be greater than 1000"}],children:e.jsx(at,{style:{width:"50%"},size:"large"})}),e.jsx(w.Item,{name:"downloadable",valuePropName:"checked",children:e.jsx(ot,{onChange:d=>{p(d.target.checked)},children:"Downloadable"})}),e.jsxs("div",{style:{marginBottom:20},children:[e.jsx("h3",{children:"Description"}),e.jsx(it.CKEditor,{disabled:i,editor:lt,data:j,onReady:d=>{d.editing.view.change(P=>{P.setStyle("min-height","100px",d.editing.view.document.getRoot())})},onChange:(d,P)=>{const L=P.getData();E(L)},config:{toolbar:{items:["bold","italic","strikethrough","underline","code","subscript","superscript","removeFormat","|","bulletedList","numberedList","todoList","|","outdent","indent","|","-","fontSize","fontFamily","fontColor","fontBackgroundColor","highlight","|","alignment","|","EmojiPanel"],shouldNotGroupWhenFull:!0},fontFamily:{options:["default","Arial, Helvetica, sans-serif","Courier New, Courier, monospace","Georgia, serif","Lucida Sans Unicode, Lucida Grande, sans-serif","Tahoma, Geneva, sans-serif","Times New Roman, Times, serif","Trebuchet MS, Helvetica, sans-serif","Verdana, Geneva, sans-serif"],supportAllValues:!0},fontSize:{options:[10,12,14,"default",18,20,22],supportAllValues:!0}}})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(M,{type:"primary",size:"large",htmlType:"submit",loading:i,children:"Publish"})})]})})})},qe=[".pdf"],Pt=t=>Array.isArray(t)?t:t==null?void 0:t.fileList,Rr=t=>{var T,f,b,u,I,g,S,m,h,y;const[r,a]=n.useState(0),[i,o]=n.useState(""),[c,x]=n.useState(!1),[C,p]=n.useState(!1),[j,E]=n.useState(!1),[k,R]=n.useState(""),[v]=w.useForm(),[A]=w.useForm(),d=[{label:"Public (Free)",value:!0},{label:"Private (Payable or Rentable)",value:!1}],P=async l=>{x(!0);const{data:D}=await J.custom({url:"",method:"post",meta:{operation:"publishBook",variables:{file:{value:l.file,type:"Upload",required:!0},title:{value:l.title,type:"String",required:!0},description:{value:l.description,type:"String",required:!0},price:{value:l.price,type:"Float",required:!1},isPublic:{value:l.is_public,type:"Boolean",required:!0},downloadable:{value:l.downloadable,type:"Boolean",required:!1}},fields:["success","message"]}}).catch(B=>(V.error("Error creating publishing book"),{data:null})).then(B=>B);D&&(D.success?(V.success(D.message),t.onFinish()):V.error(D.message)),x(!1)},L=l=>(l=l.replace(/[-_]/g," "),l=l.replace(/.pdf/g,""),l=l.replace(/[.]/g," "),l=l.replace(/\s+/g," "),l=l.trim(),l);return e.jsxs(e.Fragment,{children:[e.jsxs(ne,{sx:{display:"flex",justifyContent:"flex-end"},children:[e.jsx(M,{onClick:()=>a(0),children:"Book Info"}),e.jsx(M,{onClick:()=>a(1),children:"Edit Book Basic Info"}),e.jsx(M,{onClick:()=>a(2),children:"Edit Book Cover Image"}),e.jsx(M,{onClick:()=>a(3),children:"Edit Book Descriptions"})]}),r===0&&e.jsx(e.Fragment,{children:e.jsxs(ne,{sx:{width:"100%"},children:[e.jsxs(Le,{variant:"h4",gutterBottom:!0,children:[e.jsx("b",{children:"Title"}),": ",(T=t.book)==null?void 0:T.title,e.jsx(ze,{})]}),e.jsxs(Le,{variant:"h5",gutterBottom:!0,children:[e.jsx("b",{children:"Availability"}),": ",(f=t.book)!=null&&f.isPublic?"Public":"Private",e.jsx(ze,{})]}),e.jsxs(Le,{variant:"h5",gutterBottom:!0,children:[e.jsx("b",{children:"Downloadable"}),": ",(b=t.book)!=null&&b.downloadable?"Yes":"No",e.jsx(ze,{})]}),e.jsxs(Le,{variant:"h5",gutterBottom:!0,children:[e.jsx("b",{children:"Price"}),": ",(u=t.book)==null?void 0:u.price," Tsh",e.jsx(ze,{})]}),e.jsxs(Le,{variant:"subtitle1",gutterBottom:!0,children:[e.jsx("b",{children:"Description"}),": ",(I=t.book)==null?void 0:I.description]})]})}),r===1&&e.jsxs(w,{layout:"vertical",form:A,onFinish:l=>{l.price=l.price??0,l.downloadable=j,l.description=k,P(l)},requiredMark:!0,initialValues:{title:(g=t.book)==null?void 0:g.title,is_public:(S=t.book)==null?void 0:S.isPublic,price:(m=t.book)==null?void 0:m.price,downloadable:(h=t.book)==null?void 0:h.downloadable},children:[e.jsx(w.Item,{name:"title",label:"Book Title",initialValue:i,rules:[{required:!0,type:"string"}],children:e.jsx(se,{size:"large",placeholder:"Enter Book Title ..."})}),e.jsx(w.Item,{name:"is_public",label:"Availability",initialValue:!0,children:e.jsx(st.Group,{options:d,onChange:l=>{p(!l.target.value)},value:!0})}),!((y=t.book)!=null&&y.isPublic)&&e.jsx(w.Item,{label:"Book Cost (Tsh)",name:"price",rules:[{required:C,type:"number",min:0}],children:e.jsx(at,{style:{width:"50%"},size:"large"})}),e.jsx(w.Item,{name:"downloadable",valuePropName:"checked",children:e.jsx(ot,{onChange:l=>{E(l.target.checked)},children:"Downloadable"})}),e.jsxs("div",{style:{marginBottom:20},children:[e.jsx("h3",{children:"Description"}),e.jsx(it.CKEditor,{disabled:c,editor:lt,data:k,onReady:l=>{l.editing.view.change(D=>{D.setStyle("min-height","100px",l.editing.view.document.getRoot())})},onChange:(l,D)=>{const B=D.getData();R(B)},config:{toolbar:{items:["bold","italic","strikethrough","underline","code","subscript","superscript","removeFormat","|","bulletedList","numberedList","todoList","|","outdent","indent","|","-","fontSize","fontFamily","fontColor","fontBackgroundColor","highlight","|","alignment","|","EmojiPanel"],shouldNotGroupWhenFull:!0},fontFamily:{options:["default","Arial, Helvetica, sans-serif","Courier New, Courier, monospace","Georgia, serif","Lucida Sans Unicode, Lucida Grande, sans-serif","Tahoma, Geneva, sans-serif","Times New Roman, Times, serif","Trebuchet MS, Helvetica, sans-serif","Verdana, Geneva, sans-serif"],supportAllValues:!0},fontSize:{options:[10,12,14,"default",18,20,22],supportAllValues:!0}}})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(M,{type:"primary",size:"large",htmlType:"submit",loading:c,children:"Publish"})})]}),r===2&&e.jsx(w,{layout:"vertical",form:v,onFinish:l=>{l.price=l.price??0,l.downloadable=j,l.description=k,P(l)},requiredMark:!0,children:e.jsx(w.Item,{label:"Pick a Book ("+qe.join()+")",children:e.jsx(w.Item,{name:"file",valuePropName:"fileList",getValueFromEvent:l=>{var B,Z;o((B=l==null?void 0:l.file)==null?void 0:B.name);const D=(Z=l==null?void 0:l.file)==null?void 0:Z.name.split(".");return D.pop(),v.setFieldsValue({title:L(D.join("."))}),Pt(l)},noStyle:!0,rules:[{required:!0,type:"array",message:"Please upload Book file"}],children:e.jsxs(nt.Dragger,{name:"file",accept:qe.join(),multiple:!1,maxCount:1,beforeUpload:()=>!1,onRemove:()=>{o(""),v.setFieldsValue({title:""})},children:[e.jsx("p",{className:"ant-upload-drag-icon",children:e.jsx(rt,{})}),e.jsx("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"})]})})})}),r===3&&e.jsxs(w,{layout:"vertical",form:v,onFinish:l=>{l.price=l.price??0,l.downloadable=j,l.description=k,P(l)},requiredMark:!0,children:[e.jsx(w.Item,{label:"Pick a Book ("+qe.join()+")",children:e.jsx(w.Item,{name:"file",valuePropName:"fileList",getValueFromEvent:l=>{var B,Z;o((B=l==null?void 0:l.file)==null?void 0:B.name);const D=(Z=l==null?void 0:l.file)==null?void 0:Z.name.split(".");return D.pop(),v.setFieldsValue({title:L(D.join("."))}),Pt(l)},noStyle:!0,rules:[{required:!0,type:"array",message:"Please upload Book file"}],children:e.jsxs(nt.Dragger,{name:"file",accept:qe.join(),multiple:!1,maxCount:1,beforeUpload:()=>!1,onRemove:()=>{o(""),v.setFieldsValue({title:""})},children:[e.jsx("p",{className:"ant-upload-drag-icon",children:e.jsx(rt,{})}),e.jsx("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"})]})})}),e.jsx(w.Item,{name:"title",label:"Book Title",initialValue:i,rules:[{required:!0,type:"string"}],children:e.jsx(se,{size:"large",placeholder:"Enter Book Title ..."})}),e.jsx(w.Item,{name:"is_public",label:"Availability",initialValue:!0,children:e.jsx(st.Group,{options:d,onChange:l=>{p(!l.target.value)},value:!0})}),C&&e.jsx(w.Item,{label:"Book Cost (Tsh)",name:"price",rules:[{required:C,type:"number",min:0}],children:e.jsx(at,{style:{width:"50%"},size:"large"})}),e.jsx(w.Item,{name:"downloadable",valuePropName:"checked",children:e.jsx(ot,{onChange:l=>{E(l.target.checked)},children:"Downloadable"})}),e.jsxs("div",{style:{marginBottom:20},children:[e.jsx("h3",{children:"Description"}),e.jsx(it.CKEditor,{disabled:c,editor:lt,data:k,onReady:l=>{l.editing.view.change(D=>{D.setStyle("min-height","100px",l.editing.view.document.getRoot())})},onChange:(l,D)=>{const B=D.getData();R(B)},config:{toolbar:{items:["bold","italic","strikethrough","underline","code","subscript","superscript","removeFormat","|","bulletedList","numberedList","todoList","|","outdent","indent","|","-","fontSize","fontFamily","fontColor","fontBackgroundColor","highlight","|","alignment","|","EmojiPanel"],shouldNotGroupWhenFull:!0},fontFamily:{options:["default","Arial, Helvetica, sans-serif","Courier New, Courier, monospace","Georgia, serif","Lucida Sans Unicode, Lucida Grande, sans-serif","Tahoma, Geneva, sans-serif","Times New Roman, Times, serif","Trebuchet MS, Helvetica, sans-serif","Verdana, Geneva, sans-serif"],supportAllValues:!0},fontSize:{options:[10,12,14,"default",18,20,22],supportAllValues:!0}}})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(M,{type:"primary",size:"large",htmlType:"submit",loading:c,children:"Publish"})})]})]})},wr=t=>{const[r,a]=n.useState(!1),[i,o]=n.useState(0),[c,x]=n.useState(0),[C,p]=n.useState(1),[j,E]=n.useState([]),[k,R]=n.useState(),[v]=w.useForm(),[A,d]=n.useState(!1),[P,L]=n.useState(!1),{push:T}=Y(),f=async g=>{R(g),L(!0)},b=async()=>{I(1,""),d(!1)},u=async g=>{const{data:S}=await J.custom({url:"",method:"post",meta:{operation:"deleteBook",variables:{bookId:{value:g,type:"Int",required:!0}},fields:["success","message"]}}).catch(()=>(V.error("Error deleting book"),{data:null})).then(m=>m);S&&(S.success?(V.success(S.message),E(j.filter(m=>m.id!==g))):V.error(S.message))},I=async(g,S="")=>{a(!0);const{data:m}=await J.custom({url:"",method:"get",meta:{operation:"publisherBooks",variables:{page:{value:g,type:"Int",required:!0},key:{value:S,type:"String",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","title","description","file","cover","price","downloadable","publisherCanAddToReadings","created","updated","isActive","isPublic","canEdit","canDelete","canManage",{author:["id","firstName","lastName","middleName","fullName","email","pic"]}]}]}}).catch(()=>(V.error("Error getting Books"),{data:null})).then(h=>h);m&&(o(m.total),x(m.pages),p(m.page),E(m.results)),a(!1)};return n.useEffect(()=>{I(C,"")},[]),e.jsxs(e.Fragment,{children:[e.jsxs(ne,{children:[e.jsx(M,{size:"large",style:{float:"right"},icon:e.jsx(Et,{}),onClick:()=>T("/olib/books/purchases"),children:"Purchases"}),e.jsx(M,{size:"large",style:{float:"right"},icon:e.jsx(Ie,{}),onClick:()=>d(!0),children:"Publish"})]}),e.jsx(F,{container:!0,spacing:0,sx:{display:"flex",justifyContent:"center"},children:e.jsx(F,{item:!0,xs:12,sm:12,md:4,lg:4,xl:4,children:e.jsx(w,{layout:"vertical",form:v,onFinish:g=>{I(1,g.key)},children:e.jsx(w.Item,{name:"key",children:e.jsx(se,{size:"large",placeholder:"Search Book(s)...",prefix:e.jsx(de,{}),autoComplete:"off",allowClear:!0})})})})}),e.jsxs(F,{container:!0,spacing:0,children:[j.length===0&&e.jsx(e.Fragment,{children:e.jsx(F,{item:!0,xs:12,sm:12,md:12,lg:12,xl:12,children:e.jsx(Ke,{description:"No Book Published"})})}),j.map(g=>e.jsx(F,{item:!0,xs:12,sm:12,md:6,lg:6,xl:6,children:e.jsx(Se,{hoverable:!0,bordered:!0,style:{margin:"2px"},bodyStyle:{minHeight:190,maxHeight:190},type:"inner",actions:[e.jsxs("span",{style:{fontSize:"18px"},children:[g.price," Tsh"]}),e.jsxs("span",{style:{float:"right",marginRight:"10px",display:"flex"},children:[e.jsx(M,{style:{marginRight:"10px"},icon:e.jsx(mt,{}),onClick:()=>f(g),children:"View"}),e.jsx(Tt,{trigger:["click"],overlay:e.jsxs(ke,{children:[e.jsx(ke.Item,{icon:e.jsx(mt,{}),onClick:()=>f(g),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"View"})}),e.jsx(ke.Item,{icon:e.jsx(ut,{}),children:e.jsx(Je,{title:"Are you sure to delete this Book?",onConfirm:()=>u(g.id),okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx("a",{rel:"noopener noreferrer",children:"Delete"})})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:S=>S.preventDefault(),children:e.jsx(Rt,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})]})],children:e.jsxs(F,{container:!0,spacing:0,children:[e.jsx(F,{item:!0,xs:12,sm:12,md:4,sx:{backgroundSize:"cover",backgroundPosition:"center",backgroundImage:"url("+g.cover+")"},children:e.jsx(ne,{sx:{display:{xs:"block",md:"none"},height:100,width:"100%",backgroundSize:"cover",backgroundPosition:"center",backgroundImage:"url("+g.cover+")"}})}),e.jsx(F,{item:!0,xs:12,sm:12,md:8,children:e.jsx(ne,{style:{padding:"10px"},children:e.jsxs(ge,{direction:"vertical",children:[e.jsx("a",{children:e.jsx("h3",{children:g.title.length>50?g.title.substring(0,50)+"...":g.title})}),e.jsx("p",{children:g.description.replace(/(<([^>]+)>)/gi,"").length>100?g.description.replace(/(<([^>]+)>)/gi,"").substring(0,100)+"...":g.description.replace(/(<([^>]+)>)/gi,"")}),e.jsx("div",{children:e.jsx(ge,{children:e.jsx(le,{title:"Click to View Author Profile",children:e.jsxs("a",{children:[e.jsx(Be,{size:"small",src:g.author.pic}),e.jsx("span",{style:{marginLeft:"10px"},children:g.author.fullName})]})})})})]})})})]})})}))]}),e.jsx(X,{children:e.jsx(U,{span:24,style:{display:"flex",justifyContent:"center",marginTop:"10px",marginBottom:"20px"},children:e.jsx(We,{defaultCurrent:C,total:c})})}),e.jsx(Ne,{title:"Publishing Book",open:A,width:"60vw",onClose:g=>d(g),children:e.jsx(Tr,{randKey:Math.random(),onFinish:b})}),e.jsx(Ge,{title:k==null?void 0:k.title,width:"80vw",anchor:"right",onClose:g=>L(g),open:P,children:e.jsx(Rr,{book:k})})]})},Ar=()=>{const{push:t}=Y();return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10},children:e.jsxs(_,{children:[e.jsx(_.Item,{children:e.jsx("a",{onClick:()=>t("/olib"),children:"Home"})}),e.jsx(_.Item,{children:"Publish Books"})]})}),e.jsx(wr,{})]})},Br=t=>{const{page:r}=t;return r==="PublishBooksPage"?e.jsx(Ar,{}):r==="OlibOrdersPage"?e.jsx(Er,{}):r==="OlibBooksAuthorsPage"?e.jsx(kr,{}):r==="OlibDashboardPage"?e.jsx(br,{}):r==="BooksPurchasesPage"?e.jsx(xr,{}):r==="BooksPurchasesDisbursementsPage"?e.jsx(gr,{}):r==="BooksPublicPage"?e.jsx(pr,{}):r==="BooksMarketPlacePage"?e.jsx(hr,{}):e.jsx("div",{children:"Page not found ..."})};export{Br as OlibPages};
