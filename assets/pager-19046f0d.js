import{r as a,ao as fe,dF as ht,bB as mt,j as e,c as h,R as Q,d as H,I as U,e as oe,N as me,S as ie,T as B,B as q,aA as Je,az as Ee,g as k,_ as d,aC as xe,b as M,P as ve,dG as he,h as ae,D as be,a2 as Z,a4 as Te,a as Me,E as xt,o as We,bg as gt,a3 as yt,a5 as W,b2 as Xe,dH as Qe,M as le,H as ke,an as G,ap as ce,aw as De,k as je,L as ue,ar as Oe,J as re,ak as Se,bf as Ze,l as et,dI as pt,aq as tt,aV as at,a6 as Le,cY as jt,dJ as ft,ab as st,X as nt,Y as de,$ as rt,dK as He,al as Ge,dL as bt,ay as St,dM as Ve}from"./index-0106a5d3.js";import{t as vt}from"./text_truncate-315d9efa.js";import{C as Tt}from"./index-94488d2f.js";var It=globalThis&&globalThis.__rest||function(t,u){var n={};for(var x in t)Object.prototype.hasOwnProperty.call(t,x)&&u.indexOf(x)<0&&(n[x]=t[x]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var T=0,x=Object.getOwnPropertySymbols(t);T<x.length;T++)u.indexOf(x[T])<0&&Object.prototype.propertyIsEnumerable.call(t,x[T])&&(n[x[T]]=t[x[T]]);return n};const{TimePicker:Ct,RangePicker:Et}=fe,kt=a.forwardRef((t,u)=>a.createElement(Et,Object.assign({},t,{picker:"time",mode:void 0,ref:u}))),Ae=a.forwardRef((t,u)=>{var{addon:n,renderExtraFooter:x}=t,T=It(t,["addon","renderExtraFooter"]);const y=a.useMemo(()=>{if(x)return x;if(n)return n},[n,x]);return a.createElement(Ct,Object.assign({},T,{mode:void 0,ref:u,renderExtraFooter:y}))}),lt=ht(Ae,"picker");Ae._InternalPanelDoNotUseOrYouWillBeFired=lt;Ae.RangePicker=kt;Ae._InternalPanelDoNotUseOrYouWillBeFired=lt;const Fe=Ae,At=mt(e.jsx("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check"),wt=t=>{a.useState();const[u,n]=a.useState([]),[x,T]=a.useState(0),[y,b]=a.useState(!0),[v,P]=a.useState(10),[N,s]=a.useState(""),[i]=h.useForm(),g=[{title:"Student",dataIndex:"student",fixed:!0,render:(F,w,f)=>e.jsx("span",{children:e.jsxs(ie,{direction:"vertical",children:[e.jsx("a",{children:w.member.fullName}),e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Reg#"}),":"," ",w.member.registrationNumber]})]})})},{title:"",dataIndex:"status",render:(F,w,f)=>e.jsxs("div",{style:{display:"flex",justifyContent:"end"},children:[e.jsx("span",{style:{margin:5},children:e.jsx(B,{title:"Take as Present",color:"green",children:e.jsx(q,{icon:e.jsx(Je,{style:{color:"green"}}),onClick:()=>A(w.id,t.event.id,1)})})}),e.jsx("span",{style:{margin:5},children:e.jsx(B,{title:"Take as Absent",color:"red",children:e.jsx(q,{icon:e.jsx(Ee,{style:{color:"red"}}),onClick:()=>A(w.id,t.event.id,2)})})})]})}],A=async(F,w,f)=>{const{data:p}=await k.custom({url:"",method:"post",meta:{operation:"takeAttendance",variables:{studentId:{value:F,type:"Int",required:!0},entryId:{value:w,type:"Int",required:!0},present:{value:f,type:"Int",required:!0}},fields:["success","message"]}}).catch(_=>({data:null})).then(_=>_);p&&p.success&&(d.success(p.message),D(1,"",10),t.onAdd()),b(!1)},D=async(F,w="",f=20)=>{b(!0);const{data:p}=await k.custom({url:"",method:"get",meta:{operation:"studentsToTakeAttendance",variables:{page:{value:F,type:"Int",required:!0},key:{value:w,type:"String",required:!1},pageSize:{value:f,type:"Int",required:!1},timetableEntryId:{value:t.event.id,type:"Int",required:!0}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{member:["id","firstName","middleName","lastName","fullName","registrationNumber"]}]}]}}).catch(_=>({data:null})).then(_=>_);p&&(T(p.total),n([...p.results])),b(!1)};return a.useEffect(()=>{D(1,"",10)},[t.randKey]),e.jsxs(e.Fragment,{children:[e.jsx(Q,{style:{marginTop:10},children:e.jsx(H,{span:24,children:e.jsx(h,{layout:"vertical",form:i,onFinish:F=>{s(F.key),u.length=0,D(1,F.key)},children:e.jsx(h.Item,{name:"key",children:e.jsx(U,{size:"large",placeholder:"Search ...",prefix:e.jsx(oe,{}),autoComplete:"off",allowClear:!0})})})})}),e.jsx(me,{loading:y,columns:g,dataSource:u,pagination:{onChange:(F,w)=>{P(w),D(F,N,w)},total:x,pageSize:v,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0,y:"68vh"}})]})},Nt=t=>{const[u,n]=a.useState([]),[x,T]=a.useState(0),[y,b]=a.useState(!0),[v,P]=a.useState(20),[N,s]=a.useState(""),[i]=h.useForm(),A=!xe.useBreakpoint().lg,D=[{title:"Student",dataIndex:"student",fixed:!0,render:(w,f,p)=>e.jsx("span",{children:e.jsxs(ie,{direction:"vertical",children:[e.jsx("a",{children:f.student.member.fullName}),e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Reg#:"}),e.jsx("span",{style:{marginLeft:10},children:f.student.member.registrationNumber})]})]})})},{title:"Status",dataIndex:"status",render:(w,f,p)=>e.jsx("span",{children:f.status===1?e.jsx("a",{children:e.jsx(M,{color:"green",children:f.statusDisplay})}):e.jsx("a",{children:e.jsx(M,{color:"red",children:f.statusDisplay})})})}],F=async(w,f="",p=20)=>{b(!0);const{data:_}=await k.custom({url:"",method:"get",meta:{operation:"schoolEducationLevelAttendancesByDate",variables:{page:{value:w,type:"Int",required:!0},key:{value:f,type:"String",required:!1},pageSize:{value:p,type:"Int",required:!1},timetableEntryId:{value:t.event.id,type:"Int",required:!0},date:{value:t.date.format("YYYY/MM/DD"),type:"String",required:!0}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{student:["id",{member:["id","firstName","middleName","lastName","fullName","registrationNumber"]}]},{entry:["id"]},{takenBy:["id"]},"status","statusDisplay","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(()=>(d.error("Error occured while fetching roles"),{data:null})).then(m=>m);_&&(T(_.total),n([..._.results])),b(!1)};return a.useEffect(()=>{F(1,"",20)},[t.randKey,t.date,t.event]),e.jsxs(e.Fragment,{children:[e.jsxs(Q,{style:{marginTop:10},children:[e.jsx(H,{span:A?24:16,children:e.jsx(h,{layout:"vertical",form:i,onFinish:w=>{s(w.key),u.length=0,F(1,w.key)},children:e.jsx(h.Item,{name:"key",children:e.jsx(U,{size:"large",placeholder:"Search ...",prefix:e.jsx(oe,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(H,{span:A?24:2,children:e.jsx(q,{icon:e.jsx(oe,{}),size:"large",onClick:()=>i.submit()})})]}),e.jsx(me,{loading:y,columns:D,dataSource:u,pagination:{onChange:(w,f)=>{P(f),F(w,N,f)},total:x,pageSize:v,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0,y:"calc(100vh - 470px)"}})]})},Ue=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],qt=t=>{var Y,J;const[u,n]=a.useState([]),[x,T]=a.useState(0),[y,b]=a.useState(!0),[v,P]=a.useState(20),[N,s]=a.useState(""),[i]=h.useForm(),A=!xe.useBreakpoint().lg,[D,F]=a.useState(!1),[w,f]=a.useState(!1),[p,_]=a.useState(!1),[m,z]=a.useState(),j=async V=>{z(V),_(!0)},o=async V=>{f(!1),F(V)},I=[{title:"Student",dataIndex:"student",fixed:!0,render:(V,O,R)=>e.jsx("span",{children:e.jsxs(ie,{direction:"vertical",children:[e.jsx("a",{children:O.student.member.fullName}),e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Reg#:"}),e.jsx("span",{style:{marginLeft:10},children:O.student.member.registrationNumber})]})]})})},{title:"Status",dataIndex:"status",render:(V,O,R)=>e.jsx("span",{children:O.status===1?e.jsx(Z,{title:"Are you sure to mark Absent?",onConfirm:()=>c(O.id,2),onCancel:()=>{},okText:"Absent",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx("a",{children:e.jsx(M,{color:"green",children:O.statusDisplay})})}):e.jsx(Z,{title:"Are you sure to mark as Present?",onConfirm:()=>c(O.id,1),onCancel:()=>{},okText:"Present",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx("a",{children:e.jsx(M,{color:"red",children:O.statusDisplay})})})})},{title:"",dataIndex:"status",render:(V,O,R)=>e.jsx(Z,{title:"Are you sure to delete this Attendance Entry?",onConfirm:()=>C(O.id),onCancel:()=>{},okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx(q,{icon:e.jsx(Te,{})})})}],r=async(V,O="",R=20)=>{b(!0);const{data:ee}=await k.custom({url:"",method:"get",meta:{operation:"schoolEducationLevelAttendances",variables:{page:{value:V,type:"Int",required:!0},key:{value:O,type:"String",required:!1},pageSize:{value:R,type:"Int",required:!1},timetableEntryId:{value:t.event.id,type:"Int",required:!0}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{student:["id",{member:["id","firstName","middleName","lastName","fullName","registrationNumber"]}]},{entry:["id"]},{takenBy:["id"]},"status","statusDisplay","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(()=>(d.error("Error occured while fetching roles"),{data:null})).then(Ie=>Ie);ee&&(T(ee.total),n([...ee.results])),b(!1)},C=async V=>{const{data:O}=await k.custom({url:"",method:"post",meta:{operation:"deleteStudentAttendance",variables:{attendanceId:{value:parseInt(V.toString()),type:"Int",required:!0}},fields:["success","message"]}}).catch(()=>(d.error("Error occured while deleting attendance entry"),{data:null})).then(R=>R);O&&(O.success?(d.success(O.message),n(u.filter(R=>R.id!==V))):d.error(O.message))},c=async(V,O)=>{const{data:R}=await k.custom({url:"",method:"post",meta:{operation:"updateStudentAttendance",variables:{attendanceId:{value:parseInt(V.toString()),type:"Int",required:!0},present:{value:O,type:"Int",required:!0}},fields:["success","message",{attendance:["id",{student:["id",{member:["id","firstName","middleName","lastName","fullName","registrationNumber"]}]},{entry:["id"]},{takenBy:["id"]},"status","statusDisplay","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(()=>(d.error("Error occured while updating attendance"),{data:null})).then(ee=>ee);R&&(R.success?(d.success(R.message),n(u.map(ee=>parseInt(ee.id.toString())===parseInt(R.attendance.id.toString())?R.attendance:ee))):d.error(R.message)),b(!1)},S=async()=>{r(1,"",20)};return a.useEffect(()=>{r(1,"",20)},[t.randKey]),e.jsxs(e.Fragment,{children:[e.jsxs(Q,{style:{marginTop:10},children:[e.jsx(H,{span:A?24:16,children:e.jsx(h,{layout:"vertical",form:i,onFinish:V=>{s(V.key),u.length=0,r(1,V.key)},children:e.jsx(h.Item,{name:"key",children:e.jsx(U,{disabled:w,size:"large",placeholder:"Search ...",prefix:e.jsx(oe,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(H,{span:A?24:2,children:e.jsx(q,{disabled:w,icon:e.jsx(oe,{}),size:"large",onClick:()=>i.submit()})}),t.event.canTakeAttendance&&e.jsx(H,{span:A?24:6,children:e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end"},children:[e.jsx(B,{title:"Start Taking Attendance",children:e.jsx(q,{icon:e.jsx(ve,{}),size:"large",onClick:()=>o(!0),children:"Take Attendance"})}),e.jsx(B,{title:"View Taken Attendances",children:e.jsx(q,{disabled:w,icon:e.jsx(he,{}),size:"large",onClick:()=>f(!0),children:"View Attendances"})})]})}),!t.event.canTakeAttendance&&e.jsx(H,{span:A?24:6,children:e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(B,{title:"View Taken Attendances",children:e.jsx(q,{disabled:w,icon:e.jsx(he,{}),size:"large",onClick:()=>f(!0),children:"View Attendances"})})})})]}),w?e.jsx(e.Fragment,{children:e.jsx("div",{style:{maxHeight:"60vh",overflowY:"auto"},children:e.jsx(Tt,{onSelect:V=>{var O;if(V<ae().endOf("day")){const R=Ue.indexOf((O=t==null?void 0:t.entry)==null?void 0:O.name)+1,ee=V.day();R===ee?j(V):d("No attendance taken on this day")}},disabledDate:V=>{var ee;const O=Ue.indexOf((ee=t==null?void 0:t.entry)==null?void 0:ee.name)+1,R=V.day();return V&&V>ae().endOf("day")||O!==R}})})}):e.jsx(me,{loading:y,columns:I,dataSource:u,pagination:{onChange:(V,O)=>{P(O),r(V,N,O)},total:x,pageSize:v,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0,y:"calc(100vh - 470px)"}}),e.jsx(be,{title:"Taking Attendance",width:"28vw",anchor:"right",onClose:V=>F(V),open:D,children:e.jsx(wt,{event:t.event,randKey:Math.random(),onAdd:S})}),e.jsx(be,{title:((Y=t.event)==null?void 0:Y.subject.name)+" - "+((J=t.event)==null?void 0:J.educationLevel.name)+" Attendance taken on "+(m==null?void 0:m.format("YYYY MMM, DD")),width:"50vw",anchor:"left",onClose:V=>_(V),open:p,children:e.jsx(Nt,{event:t.event,date:m,randKey:Math.random()})})]})},{TextArea:Ft}=U,Mt=t=>{const[u,n]=a.useState(!1),[x,T]=a.useState(!1),[y,b]=a.useState([]),[v,P]=a.useState(null),[N,s]=a.useState(null),[i]=h.useForm(),[g,A]=a.useState(!1),[D,F]=a.useState(!1),f=!xe.useBreakpoint().lg,p=(j,o)=>{P(o),s(j),A(!0)},_=async j=>{const{data:o}=await k.custom({url:"",method:"post",meta:{operation:"openTimetableEntry",variables:{entryId:{value:j,type:"Int",required:!0}},fields:["success","message"]}}).catch(()=>(d.error("Something Went Wrong ..."),{data:null})).then(I=>I);o&&(o.success?(d.success(o.message),z()):d.error(o.message))},m=async j=>{const{data:o}=await k.custom({url:"",method:"post",meta:{operation:"cancelTimetableEntry",variables:{entryId:{value:j.entryId,type:"Int",required:!0},reason:{value:j.reason,type:"String",required:!0},verify:{value:j.notify,type:"Boolean",required:!0}},fields:["success","message"]}}).catch(()=>(d.error("Something Went Wrong ..."),{data:null})).then(I=>I);o&&(o.success?(d.success(o.message),i.resetFields(),z()):d.error(o.message))},z=async()=>{n(!0);const{data:j}=await k.custom({url:"",method:"get",meta:{operation:"myWeeklyTimetableEntries",fields:["entries","hasTimetable"]}}).catch(()=>(d.error("Something Went Wrong ..."),{data:null})).then(o=>o);j&&(console.error("data",j),T(j.hasTimetable),b(j.entries)),n(!1)};return a.useEffect(()=>{z()},[]),e.jsxs(e.Fragment,{children:[e.jsxs(Me,{spinning:u,children:[!x&&!u&&e.jsx(e.Fragment,{children:e.jsx(Q,{align:"middle",style:{height:"80vh",display:"flex",justifyContent:"center"},children:e.jsx(xt,{description:e.jsx(e.Fragment,{children:e.jsx("span",{style:{fontSize:22},children:"You are not Connected to any published Timetable"})})})})}),x&&e.jsx(Q,{style:{overflowX:"auto",marginTop:f?65:0,marginLeft:10},wrap:!1,children:y.map(j=>e.jsxs("span",{style:{width:f?"100vw":"14.1vw",margin:"1px",padding:"0px"},children:[e.jsx(Q,{style:{display:"flex",justifyContent:"space-between",backgroundColor:"white"},children:e.jsxs("span",{style:{marginLeft:10,marginRight:10,display:"flex",justifyContent:"space-between",width:"100%",height:35,paddingTop:2},children:[e.jsx("span",{style:{fontSize:19,fontWeight:"bolder"},children:j.name}),e.jsx("span",{children:e.jsx(B,{title:"Bulk Processing of Action(s)",color:"red",placement:"left",children:e.jsx(q,{icon:e.jsx(Ee,{})})})})]})}),e.jsx("div",{style:{maxHeight:"83vh",overflowY:"auto",overflowX:"hidden",marginTop:5,marginRight:5},children:j.events.map(o=>e.jsx("div",{style:{backgroundColor:"white",paddingLeft:5},children:e.jsxs("div",{children:[e.jsxs("span",{style:{fontSize:18},children:[o.isTeacher&&e.jsx(e.Fragment,{children:e.jsxs("div",{style:{borderBottom:"1"},children:[e.jsx("span",{style:{marginLeft:5},children:e.jsx(B,{title:"View/Take Attendance",color:"green",children:e.jsx(q,{size:"small",onClick:()=>p(o,j),children:e.jsx(he,{})})})}),o.canCancell&&!o.isCancelled&&!o.isExam&&e.jsx("span",{style:{marginLeft:5},children:e.jsx(Z,{title:e.jsx(e.Fragment,{children:e.jsxs(ie,{direction:"vertical",children:[e.jsx("span",{children:"Are you sure to Cancel?"}),e.jsx("span",{style:{fontWeight:"bolder"},children:"Reason"}),e.jsx("span",{children:e.jsxs(h,{layout:"vertical",form:i,initialValues:{notify:!0},onFinish:I=>{I.entryId=o.id,m(I)},onFinishFailed:()=>{},autoComplete:"off",children:[e.jsx(h.Item,{name:"reason",rules:[{required:!0,message:"Please input your reason!"}],children:e.jsx(Ft,{rows:6,onChange:I=>{I.target.value.length>0?F(!0):F(!1)}})}),e.jsx(h.Item,{name:"notify",valuePropName:"checked",children:e.jsx(We,{children:"Notify Students"})})]})})]})}),onConfirm:()=>{i.submit()},onCancel:()=>{},okText:"Yes",cancelText:"No",okButtonProps:{disabled:!D},overlayStyle:{zIndex:9999},children:e.jsx(q,{size:"small",children:e.jsx(gt,{color:"red",style:{color:"red"}})})})}),e.jsx("span",{style:{float:"right"},children:e.jsx(B,{title:"Click to see all about this timetable Entry",color:"green",children:e.jsx(q,{icon:e.jsx(yt,{})})})})]})}),e.jsxs("span",{style:{display:"block"},children:[!o.advanced&&e.jsx(B,{overlayInnerStyle:{fontSize:19},title:"Subject: "+o.subject.name,color:"green",placement:"right",children:vt(o.subject.name,15)}),o.advanced&&e.jsx(B,{overlayInnerStyle:{fontSize:19},title:"Module: "+o.module.name,color:"green",placement:"right",children:o.module.code})]}),!o.advanced&&e.jsx(ie,{children:o.group&&e.jsx(e.Fragment,{children:e.jsx(M,{color:"orange",children:o.group.name})})})]}),e.jsxs("span",{style:{fontSize:18},children:[e.jsx(B,{title:"Venue: "+o.venue.name,color:"green",children:e.jsx(M,{color:"red",children:o.venue.name})}),e.jsx(B,{title:e.jsxs(e.Fragment,{children:[!o.advanced&&e.jsx(e.Fragment,{children:o.isExam?e.jsxs(W,{title:"Supervisor Informations",column:1,children:[e.jsxs(W.Item,{label:"Name",children:[o.supervisor.firstName," ",o.supervisor.middleName," ",o.supervisor.lastName]}),e.jsx(W.Item,{label:"Email",children:o.supervisor.email}),e.jsx(W.Item,{label:"Phone",children:o.supervisor.phone})]}):e.jsxs(W,{title:"Teacher Informations",column:1,children:[e.jsxs(W.Item,{label:"Name",children:[o.teacher.firstName," ",o.teacher.middleName," ",o.teacher.lastName]}),e.jsx(W.Item,{label:"Email",children:o.teacher.email}),e.jsx(W.Item,{label:"Phone",children:o.teacher.phone})]})}),o.advanced&&e.jsx(e.Fragment,{children:o.isExam?e.jsxs(W,{title:"Supervisor Informations",column:1,children:[e.jsxs(W.Item,{label:"Name",children:[o.supervisor.firstName," ",o.supervisor.middleName," ",o.supervisor.lastName]}),e.jsx(W.Item,{label:"Email",children:o.supervisor.email}),e.jsx(W.Item,{label:"Phone",children:o.supervisor.phone})]}):e.jsxs(W,{title:"Lecturer Informations",column:1,children:[e.jsxs(W.Item,{label:"Name",children:[o.lecturer.firstName," ",o.lecturer.middleName," ",o.lecturer.lastName]}),e.jsx(W.Item,{label:"Email",children:o.lecturer.email}),e.jsx(W.Item,{label:"Phone",children:o.lecturer.phone})]})})]}),color:"white",overlayInnerStyle:{color:"black"},children:e.jsx(q,{type:"primary",shape:"circle",icon:e.jsx(Xe,{})})})]}),o.isCancelled&&e.jsx("span",{children:e.jsxs(M,{color:"red",style:{fontSize:24,padding:10,marginTop:10},children:["Cancelled",o.isTeacher&&o.canCancell&&e.jsx(Z,{title:"Are you sure to Open?",onConfirm:()=>_(o.id),onCancel:()=>{},okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx(q,{style:{marginLeft:2},size:"small",children:"Re-open"})})]})}),e.jsxs(Qe,{children:[o.isExam&&e.jsx("p",{style:{fontSize:"18px"},children:ae(o.dueDate).format("YYYY MMM, DD")}),o.startAt," - ",o.endAt]})]})}))})]}))})]}),e.jsx(le,{title:e.jsx(e.Fragment,{children:e.jsxs(ie,{direction:"vertical",children:[e.jsxs("span",{children:[N==null?void 0:N.subject.name," - ",N==null?void 0:N.educationLevel.name," - Attendance",e.jsx("span",{style:{marginLeft:10},children:e.jsx(M,{color:"green",children:v==null?void 0:v.name})})]}),e.jsxs("span",{children:[N==null?void 0:N.startAt," - ",N==null?void 0:N.endAt]})]})}),width:"70vw",open:g,onClose:j=>A(j),children:e.jsx(qt,{event:N,entry:v,randKey:Math.random()})})]})},Dt=()=>(a.useEffect(()=>{document.title=ke.system_name+": Timetable Dashboard"},[]),e.jsx("div",{style:{marginTop:10},children:e.jsx(Mt,{})})),{Option:Ne}=G,qe="HH:mm",Lt=t=>{const[u,n]=a.useState(!1),[x,T]=a.useState(!0),[y,b]=a.useState([]),[v,P]=a.useState([]),[N,s]=a.useState([]),[i,g]=a.useState([]),A=()=>{n(!0)},D=m=>{t.form.setFieldsValue({teacher:void 0}),f(1,m)},F=async(m,z="",j=100)=>{const{data:o}=await k.custom({url:"",method:"get",meta:{operation:"schoolVenues",variables:{page:{value:m,type:"Int",required:!0},key:{value:z,type:"String",required:!1},pageSize:{value:j,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","code","created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(()=>(d.error("Error occured while loading Venues"),{data:null})).then(I=>I);o&&g(o.results)},w=async(m,z="",j=20)=>{var I;const{data:o}=await k.custom({url:"",method:"get",meta:{operation:"schoolEducationLevelSubjects",variables:{schoolEducationLevelId:{value:parseInt(((I=t.schoolTimetableEducationLevel)==null?void 0:I.schoolEducationLevel.id.toString())??"0")},page:{value:m,type:"Int",required:!0},key:{value:z,type:"String",required:!1},pageSize:{value:j,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{schoolSubject:[{subject:["id","name"]}]},"created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(r=>(d.error("Error occured while loading Subjects"),{data:null})).then(r=>r);o&&b(o.results)},f=async(m,z,j="",o=20)=>{T(!0);const{data:I}=await k.custom({url:"",method:"get",meta:{operation:"schoolEducationLevelSubjectTeachers",variables:{schoolEducationLevelSubjectId:{value:parseInt(z.toString()??"0")},page:{value:m,type:"Int",required:!0},key:{value:j,type:"String",required:!1},pageSize:{value:o,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{schoolMember:["id","registrationNumber",{user:["id","firstName","lastName","middleName","fullName"]}]},"created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(r=>(d.error("Error occured while loading Teachers"),{data:null})).then(r=>r);I&&P(I.results),T(!1)},p=async(m,z="",j=20)=>{var I;const{data:o}=await k.custom({url:"",method:"get",meta:{operation:"schoolEducationLevelGroups",variables:{schoolEducationLevelId:{value:parseInt(((I=t.schoolTimetableEducationLevel)==null?void 0:I.schoolEducationLevel.id.toString())??"0")},page:{value:m,type:"Int",required:!0},key:{value:z,type:"String",required:!1},pageSize:{value:j,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","description","created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(r=>(d.error("Error occured while loading Groups"),{data:null})).then(r=>r);o&&s(o.results)},_=async m=>{const{data:z}=await k.custom({url:"",method:"post",meta:{operation:"createTimetableEntry",variables:{subjectId:{value:m.subject_id,type:"Int",required:!0},teacherId:{value:m.teacher_id,type:"Int",required:!0},timetableId:{value:m.timetable_id,type:"Int",required:!0},groupId:{value:m.group_id,type:"Int",required:!1},venueId:{value:m.venue_id,type:"Int",required:!0},day:{value:m.day,type:"String",required:!0},startAt:{value:m.start_at,type:"String",required:!0},endAt:{value:m.end_at,type:"String",required:!0}},fields:["success","message"]}}).catch(j=>(d.error("Error occured while creating school timetable"),{data:null})).then(j=>j);z&&(z.success?(d.success(z.message),t.form.resetFields(),t.onFinish()):d.error(z.message))};return a.useEffect(()=>{p(1),F(1),w(1)},[t.randKey]),e.jsxs(e.Fragment,{children:[e.jsxs(h,{layout:"vertical",form:t.form,onFinish:m=>{var z;m.start_at=ae(m.start_at).format("HH:mm"),m.end_at=ae(m.end_at).format("HH:mm"),m.day=t.entry.name,m.timetable_id=parseInt(((z=t.schoolTimetableEducationLevel)==null?void 0:z.id.toString())??"0"),_(m)},requiredMark:!1,children:[e.jsx(h.Item,{name:"subject_id",label:"Subject",rules:[{required:!0,type:"integer",message:"Please Choose Subject"}],children:e.jsx(G,{size:"large",style:{width:"100%"},placeholder:"Please Choose Subject",allowClear:!0,showSearch:!0,onChange:D,dropdownStyle:{zIndex:9999},children:y.map(m=>e.jsx(Ne,{value:m.id,children:m.schoolSubject.subject.name},m.id))})}),e.jsx(h.Item,{name:"teacher_id",label:"Teacher",rules:[{required:!0,type:"integer",message:"Please Choose Teacher"}],children:e.jsx(G,{size:"large",loading:x,disabled:x,style:{width:"100%"},placeholder:"Please Choose Teacher",allowClear:!0,showSearch:!0,onChange:()=>{},dropdownStyle:{zIndex:9999},children:v.map(m=>e.jsxs(Ne,{value:m.id,children:[m.schoolMember.user.fullName,m.schoolMember.registrationNumber&&e.jsx("span",{style:{marginLeft:10},children:e.jsx(M,{color:"green",children:m.schoolMember.registrationNumber})})]},m.id))})}),e.jsx(h.Item,{name:"group_id",label:"Group",rules:[{required:!1,type:"integer",message:"Please Choose Groups"}],children:e.jsx(G,{size:"large",style:{width:"100%"},placeholder:"Please Choose Groups",allowClear:!0,showSearch:!0,onChange:()=>{},dropdownStyle:{zIndex:9999},children:N.map(m=>e.jsx(Ne,{value:parseInt(m.id.toString()),children:m.name},m.id))})}),e.jsx(h.Item,{name:"venue_id",label:"Venue",rules:[{required:!0,type:"integer",message:"Please Choose Venue"}],children:e.jsx(G,{size:"large",style:{width:"100%"},placeholder:"Please Choose Venue",allowClear:!0,showSearch:!0,onChange:()=>{},dropdownStyle:{zIndex:9999},children:i.map(m=>e.jsx(Ne,{value:parseInt(m.id.toString()),children:m.name},m.id))})}),e.jsxs(Q,{children:[e.jsx(H,{span:6,children:e.jsx(h.Item,{name:"start_at",label:e.jsx(e.Fragment,{children:e.jsxs(ie,{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:"Start At"}),e.jsx(q,{type:"link",onClick:()=>A(),children:"Check Slots"})]})}),initialValue:ce("07:00","HH:mm"),children:e.jsx(Fe,{size:"large",allowClear:!0,defaultValue:ce("07:00",qe),hourStep:1,minuteStep:45,format:qe,style:{width:"100%"},popupStyle:{zIndex:9999}})})}),e.jsx(H,{span:6,children:e.jsx(h.Item,{name:"end_at",label:e.jsx(e.Fragment,{children:e.jsxs(ie,{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:"End At"}),e.jsx(q,{type:"link",onClick:()=>A(),children:"Check Slots"})]})}),initialValue:ce("07:45","HH:mm"),children:e.jsx(Fe,{size:"large",allowClear:!0,defaultValue:ce("07:45",qe),hourStep:1,minuteStep:45,format:qe,inputReadOnly:!0,style:{width:"100%"},popupStyle:{zIndex:9999}})})})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(q,{type:"primary",size:"large",htmlType:"submit",disabled:!0,children:"Save"})})]}),e.jsx(be,{title:"Available Time Slots",anchor:"right",onClose:m=>n(m),open:u,children:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"Some contents..."}),e.jsx("p",{children:"Some contents..."}),e.jsx("p",{children:"Some contents..."})]})})]})},{Option:ye}=G,Re="HH:mm",Pt=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],$e=t=>{var L,E,X,se,pe,we,Ke,Be;const[u,n]=a.useState(!1),[x,T]=a.useState(!1),[y,b]=a.useState(!0),[v,P]=a.useState([]),[N,s]=a.useState([]),[i,g]=a.useState([]),[A,D]=a.useState([]),[F,w]=a.useState([]);a.useState(),a.useState();const[f,p]=a.useState([]);a.useState(!1),a.useState(!1);const[_,m]=a.useState("07:00"),[z,j]=a.useState("07:45");De();const[o,I]=a.useState([]),[r,C]=a.useState([]),[c,S]=a.useState([]),[Y]=h.useForm(),J=()=>{T(!0)},V=l=>{var K;t.form.setFieldsValue({teacher:void 0}),((K=t==null?void 0:t.schoolTimetable)==null?void 0:K.forExamination)===!0?ee(1):Ie(1,l)},O=async(l,K="",$=100)=>{const{data:te}=await k.custom({url:"",method:"get",meta:{operation:"schoolVenues",variables:{page:{value:l,type:"Int",required:!0},key:{value:K,type:"String",required:!1},pageSize:{value:$,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","code","created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(ne=>(d.error("Error occured while loading Venues"),{data:null})).then(ne=>ne);te&&w(te.results)},R=async(l,K="",$=20)=>{var ne;const{data:te}=await k.custom({url:"",method:"get",meta:{operation:"schoolEducationLevelSubjects",variables:{schoolEducationLevelId:{value:parseInt(((ne=t.schoolTimetableEducationLevel)==null?void 0:ne.schoolEducationLevel.id.toString())??"0")},page:{value:l,type:"Int",required:!0},key:{value:K,type:"String",required:!1},pageSize:{value:$,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{schoolSubject:[{subject:["id","name"]}]},"subjectType","subjectTypeDisplay","created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(ge=>(d.error("Error occured while loading Subjects"),{data:null})).then(ge=>ge);te&&P(te.results)},ee=async(l,K="",$=20)=>{b(!0);const{data:te}=await k.custom({url:"",method:"get",meta:{operation:"schoolMembers",variables:{page:{value:l,type:"Int",required:!0},key:{value:K,type:"String",required:!1},pageSize:{value:$,type:"Int",required:!1},rolesString:{value:["Teacher"],type:"[String]",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","registrationNumber","firstName","middleName","lastName","fullName","email","phone",{user:["id","firstName","lastName","middleName","fullName"]},"created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(ne=>(d.error("Error occured while loading Teachers"),{data:null})).then(ne=>ne);te&&g(te.results),b(!1)},Ie=async(l,K,$="",te=20)=>{b(!0);const{data:ne}=await k.custom({url:"",method:"get",meta:{operation:"schoolEducationLevelSubjectTeachers",variables:{schoolEducationLevelSubjectId:{value:parseInt(K.toString()??"0")},page:{value:l,type:"Int",required:!0},key:{value:$,type:"String",required:!1},pageSize:{value:te,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{schoolMember:["id","registrationNumber",{user:["id","firstName","lastName","middleName","fullName"]}]},"created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(ge=>(d.error("Error occured while loading Teachers"),{data:null})).then(ge=>ge);ne&&s(ne.results),b(!1)},Pe=async(l,K="",$=20)=>{var ne;const{data:te}=await k.custom({url:"",method:"get",meta:{operation:"schoolEducationLevelGroups",variables:{schoolEducationLevelId:{value:parseInt(((ne=t.schoolTimetableEducationLevel)==null?void 0:ne.schoolEducationLevel.id.toString())??"0")},page:{value:l,type:"Int",required:!0},key:{value:K,type:"String",required:!1},pageSize:{value:$,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","description","created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(ge=>(d.error("Error occured while loading Groups"),{data:null})).then(ge=>ge);te&&D(te.results)},ze=async l=>{n(!0);const{data:K}=await k.custom({url:"",method:"post",meta:{operation:"createTimetableEntry",variables:{advanced:{value:t.advanced,type:"Boolean",required:!1},moduleId:{value:l.module_id,type:"Int",required:!1},subjectId:{value:l.subject_id,type:"Int",required:!1},teacherId:{value:l.teacher_id,type:"Int",required:!1},timetableId:{value:l.timetable_id,type:"Int",required:!0},groupId:{value:l.group_id,type:"Int",required:!1},venueId:{value:l.venue_id,type:"Int",required:!0},day:{value:l.day,type:"String",required:!0},startAt:{value:l.start_at,type:"String",required:!0},endAt:{value:l.end_at,type:"String",required:!0},supervisorId:{value:l.supervisor_id,type:"Int",required:!1},dueDate:{value:l.due_date,type:"String",required:!1}},fields:["success","message"]}}).catch($=>(d.error("Error occured while creating school timetable"),{data:null})).then($=>$);n(!1),K&&(K.success?(d.success(K.message),p([]),t.form.resetFields(),t.onFinish()):p(K.message))},_e=async()=>{var $;const l=(($=t==null?void 0:t.studyCourse)==null?void 0:$.id)??"0",{data:K}=await k.custom({url:"",method:"get",meta:{operation:"timetableStudyCourseModules",variables:{timetableStudyCourseId:{value:parseInt(l.toString()),type:"Int",required:!0}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","code","created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(te=>(d.error("Something Went Wrong ..."),{data:null})).then(te=>te);K&&I(K.results)},Ce=async l=>{b(!0);const{data:K}=await k.custom({url:"",method:"get",meta:{operation:"moduleMembers",variables:{moduleId:{value:l,type:"Int",required:!0},memberType:{value:"Teacher",type:"String",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{module:["id"]},{schoolMember:["id","registrationNumber","firstName","middleName","lastName","email","phone",{user:["id","firstName","middleName","lastName","email","fullName","pic"]}]},"created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch($=>(d.error("Something Went Wrong ..."),{data:null})).then($=>$);b(!1),K&&S(K.results)};return a.useEffect(()=>{_e(),Pe(1),O(1),R(1)},[t.randKey]),e.jsxs(e.Fragment,{children:[((L=t==null?void 0:t.schoolTimetable)==null?void 0:L.forExamination)&&e.jsx("div",{style:{marginBottom:10},children:e.jsx(je,{type:"info",message:e.jsx(e.Fragment,{children:e.jsxs("p",{style:{fontSize:18},children:[e.jsx("b",{children:"Notice:"})," This timetable is for examination. You can only add entries for examination.",e.jsx("p",{style:{color:"red"},children:"Validation wont apply against Non-Examination Timetable"})," ","But it will be applied against Examination Timetable"]})})})}),e.jsx("div",{children:f.map(l=>e.jsx(je,{message:l,type:"error",style:{fontSize:18,marginBottom:"3px"},onClose:()=>{p([])},closable:!0}))}),e.jsxs(h,{layout:"vertical",form:Y,onFinish:l=>{var K,$;l.start_at=_,l.end_at=z,l.day=t.entry.name,t.advanced?l.timetable_id=parseInt(((K=t==null?void 0:t.studyCourse)==null?void 0:K.id.toString())??"0"):l.timetable_id=parseInt((($=t==null?void 0:t.schoolTimetableEducationLevel)==null?void 0:$.id.toString())??"0"),ze(l)},children:[t.advanced?e.jsx(h.Item,{name:"module_id",label:"Module",rules:[{required:!0,type:"integer",message:"Please Choose Module"}],children:e.jsx(G,{size:"large",style:{width:"100%"},placeholder:"Please Choose Module",allowClear:!0,showSearch:!0,onChange:l=>{Y.setFieldsValue({teacher_id:void 0}),Ce(l)},dropdownStyle:{zIndex:9999},children:o.map(l=>e.jsx(ye,{value:parseInt(l.id.toString()),children:l.name},l.id))})}):e.jsx(h.Item,{name:"subject_id",label:"Subject",rules:[{required:!0,type:"integer",message:"Please Choose Subject"}],children:e.jsx(G,{size:"large",style:{width:"100%"},placeholder:"Please Choose Subject",allowClear:!0,showSearch:!0,onChange:V,dropdownStyle:{zIndex:9999},children:v.map(l=>e.jsxs(ye,{value:l.id,children:[l.schoolSubject.subject.name,e.jsx(M,{style:{marginLeft:5},color:"green",children:l.subjectTypeDisplay})]},l.id))})}),!t.advanced&&e.jsx(e.Fragment,{children:(E=t==null?void 0:t.schoolTimetable)!=null&&E.forExamination?e.jsx(h.Item,{name:"supervisor_id",label:e.jsx(e.Fragment,{children:"Teachers Supervising"}),rules:[{required:(X=t==null?void 0:t.schoolTimetable)==null?void 0:X.forExamination,type:"integer",message:"Please Choose Supervisor"}],children:e.jsx(G,{size:"large",loading:y,disabled:y,style:{width:"100%"},placeholder:"Please Choose Teacher",allowClear:!0,showSearch:!0,onChange:()=>{},dropdownStyle:{zIndex:9999},children:i.map(l=>e.jsxs(ye,{value:parseInt(l.id.toString()),children:[l.user.fullName,l.registrationNumber&&e.jsx("span",{style:{marginLeft:10},children:e.jsx(M,{color:"green",children:l.registrationNumber})}),e.jsxs("p",{style:{marginTop:3},children:[e.jsx("span",{style:{color:"red"},children:"Email:"})," ",e.jsx(M,{children:l==null?void 0:l.email}),","," ",e.jsx("span",{style:{color:"red"},children:"Phone:"})," ",e.jsx(M,{children:l==null?void 0:l.phone})]})]},l.id))})}):e.jsx(h.Item,{name:"teacher_id",label:e.jsx(e.Fragment,{children:"Teacher"}),rules:[{required:!((se=t==null?void 0:t.schoolTimetable)!=null&&se.forExamination),type:"integer",message:"Please Choose Teacher"}],children:e.jsx(G,{size:"large",loading:y,disabled:y,style:{width:"100%"},placeholder:"Please Choose Teacher",allowClear:!0,showSearch:!0,onChange:()=>{},dropdownStyle:{zIndex:9999},children:N.map(l=>e.jsxs(ye,{value:l.id,children:[l.schoolMember.user.fullName,l.schoolMember.registrationNumber&&e.jsx("span",{style:{marginLeft:10},children:e.jsx(M,{color:"green",children:l.schoolMember.registrationNumber})})]},l.id))})})}),t.advanced&&e.jsx(e.Fragment,{children:(pe=t==null?void 0:t.schoolTimetable)!=null&&pe.forExamination?e.jsx(h.Item,{name:"supervisor_id",label:e.jsx(e.Fragment,{children:"Lecturer/Tutor Supervising"}),rules:[{required:(we=t==null?void 0:t.schoolTimetable)==null?void 0:we.forExamination,type:"integer",message:"Please Choose Supervisor"}],children:e.jsx(G,{size:"large",loading:y,disabled:y,style:{width:"100%"},placeholder:"Please Choose Lecturer/Tutor",allowClear:!0,showSearch:!0,onChange:()=>{},dropdownStyle:{zIndex:9999},children:r.map(l=>e.jsxs(ye,{value:parseInt(l.id.toString()),children:[l.user.fullName,l.registrationNumber&&e.jsx("span",{style:{marginLeft:10},children:e.jsx(M,{color:"green",children:l.registrationNumber})}),e.jsxs("p",{style:{marginTop:3},children:[e.jsx("span",{style:{color:"red"},children:"Email:"})," ",e.jsx(M,{children:l==null?void 0:l.email}),","," ",e.jsx("span",{style:{color:"red"},children:"Phone:"})," ",e.jsx(M,{children:l==null?void 0:l.phone})]})]},l.id))})}):e.jsx(h.Item,{name:"teacher_id",label:e.jsx(e.Fragment,{children:"Lecturer/Tutor"}),rules:[{required:!((Ke=t==null?void 0:t.schoolTimetable)!=null&&Ke.forExamination),type:"integer",message:"Please Choose Lecturer/Tutor"}],children:e.jsx(G,{size:"large",loading:y,disabled:y,style:{width:"100%"},placeholder:"Please Choose Lecturer/Tutor",allowClear:!0,showSearch:!0,onChange:()=>{},dropdownStyle:{zIndex:9999},children:c.map(l=>{var K;return e.jsxs(ye,{value:parseInt(l.schoolMember.id.toString()),children:[(K=l==null?void 0:l.schoolMember.user)==null?void 0:K.fullName,l.schoolMember.registrationNumber&&e.jsx("span",{style:{marginLeft:10},children:e.jsx(M,{color:"green",children:l.schoolMember.registrationNumber})})]},l.id)})})})}),!t.advanced&&e.jsx(h.Item,{name:"group_id",label:"Group",rules:[{required:!1,type:"integer",message:"Please Choose Groups"}],children:e.jsx(G,{size:"large",style:{width:"100%"},placeholder:"Please Choose Groups",allowClear:!0,showSearch:!0,onChange:()=>{},dropdownStyle:{zIndex:9999},children:A.map(l=>e.jsx(ye,{value:parseInt(l.id.toString()),children:l.name},l.id))})}),e.jsx(h.Item,{name:"venue_id",label:"Venue",rules:[{required:!0,type:"integer",message:"Please Choose Venue"}],children:e.jsx(G,{size:"large",style:{width:"100%"},placeholder:"Please Choose Venue",allowClear:!0,showSearch:!0,onChange:()=>{},dropdownStyle:{zIndex:9999},children:F.map(l=>e.jsx(ye,{value:parseInt(l.id.toString()),children:l.name},l.id))})}),e.jsxs(Q,{children:[((Be=t==null?void 0:t.schoolTimetable)==null?void 0:Be.forExamination)&&e.jsx(H,{span:8,children:e.jsx(h.Item,{name:"due_date",label:"Due Date",rules:[{required:!0,type:"object",message:"Please Choose Due Date"}],children:e.jsx(fe,{size:"large",style:{width:"100%"},placeholder:"Please Choose Due Date",disabledDate:l=>!(l.day()===Pt.indexOf(t.entry.name)+1),popupStyle:{zIndex:9999}})})}),e.jsx(H,{span:8,children:e.jsx(h.Item,{name:"start_at",rules:[{required:!0,type:"object",message:"Please Choose Start Time"}],label:e.jsx(e.Fragment,{children:e.jsxs(ie,{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:"Start At"}),e.jsx(q,{type:"link",onClick:()=>J(),children:"Check Slots"})]})}),initialValue:ce("07:00","HH:mm"),children:e.jsx(Fe,{allowClear:!0,hourStep:1,minuteStep:45,format:Re,defaultValue:ce("07:00","HH:mm"),style:{width:"100%"},size:"large",onChange:l=>{m((l==null?void 0:l.hour().toString())+":"+(l==null?void 0:l.minute().toString()))},popupStyle:{zIndex:9999}})})}),e.jsx(H,{span:8,children:e.jsx(h.Item,{name:"end_at",rules:[{required:!0,type:"object",message:"Please Choose End Time"}],label:e.jsx(e.Fragment,{children:e.jsxs(ie,{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:"End At"}),e.jsx(q,{type:"link",onClick:()=>J(),children:"Check Slots"})]})}),initialValue:ce("07:45","HH:mm"),children:e.jsx(Fe,{allowClear:!0,hourStep:1,minuteStep:45,format:Re,inputReadOnly:!0,defaultValue:ce("07:45","HH:mm"),style:{width:"100%"},size:"large",onChange:l=>{j((l==null?void 0:l.hour().toString())+":"+(l==null?void 0:l.minute().toString()))},popupStyle:{zIndex:9999}})})})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(q,{type:"primary",size:"large",htmlType:"submit",loading:u,disabled:u,children:"Save"})})]}),e.jsx(be,{title:"Available Time Slots",width:"30vw",anchor:"right",onClose:l=>T(l),open:x,children:e.jsx("span",{children:"Slot Schecker"})})]})},it=t=>{const[u,n]=a.useState(!1),[x,T]=a.useState(),[y,b]=a.useState([]),[v,P]=a.useState(),[N,s]=a.useState(!1),[i,g]=a.useState(!1),[A,D]=a.useState(!1),[F]=h.useForm();h.useForm();const w=De(),f=async(j,o)=>{P(j),T(o),g(!0)},p=async()=>{m()},_=async j=>{P(j),t.advanced?D(!0):s(!0)},m=async()=>{n(!0);const{data:j}=await k.custom({url:"",method:"get",meta:{operation:"weeklyTimetableEntries",variables:{schoolEducationLevelTimetableId:{value:parseInt(w.id),type:"Int",required:!0}},fields:["entries"]}}).catch(o=>(d.error("Something Went Wrong ..."),{data:null})).then(o=>o);j&&b(j.entries),n(!1)},z=async j=>{const{data:o}=await k.custom({url:"",method:"post",meta:{operation:"deleteTimetableEntry",variables:{timetableEntryId:{value:j,type:"Int",required:!0}},fields:["success","message"]}}).catch(I=>(d.error("Something Went Wrong ..."),{data:null})).then(I=>I);o&&(o.success?(d.success(o.message),m()):d.error(o.message)),n(!1)};return a.useEffect(()=>{m()},[]),e.jsxs(e.Fragment,{children:[e.jsx(Me,{spinning:u,children:e.jsx(Q,{style:{overflowX:"auto"},wrap:!1,children:y.map(j=>{var o,I;return e.jsxs("span",{style:{width:"14.1vw",margin:"1px",padding:"0px"},children:[e.jsxs(Q,{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{marginLeft:5},children:e.jsx("h2",{children:j.name})}),e.jsx("span",{style:{position:"relative",right:"0px",marginTop:8},children:e.jsx(B,{title:"Click to Start Scheduling for "+j.name,color:"green",placement:"left",children:e.jsx(q,{disabled:t.advanced?(o=t.studyCourse)==null?void 0:o.published:(I=t.schoolTimetableEducationLevel)==null?void 0:I.published,size:"small",icon:e.jsx(ve,{}),onClick:()=>_(j),children:"Add"})})})]}),e.jsx("div",{style:{maxHeight:"83vh",overflowY:"auto",overflowX:"hidden"},children:e.jsx(ue,{style:{margin:"0px",padding:"0px"},bordered:!0,dataSource:j.events,renderItem:r=>e.jsxs(e.Fragment,{children:[e.jsx(ue.Item,{children:e.jsxs(ie,{direction:"vertical",children:[e.jsxs("span",{style:{fontSize:18},children:[r.advanced?e.jsx(e.Fragment,{children:e.jsx(B,{title:r.module.name,color:"green",children:e.jsx(M,{color:"green",children:r.module.code})})}):e.jsx(e.Fragment,{children:r.subject.name}),!r.advanced&&e.jsxs(ie,{children:[e.jsx(M,{color:"green",style:{marginLeft:10},children:r.educationLevel.name}),r.group&&e.jsx(e.Fragment,{children:e.jsx(M,{color:"green",children:r.group.name})})]})]}),e.jsx("span",{style:{fontSize:18},children:e.jsxs(ie,{children:[e.jsx(M,{color:"green",children:r.venue.name}),e.jsx(Z,{title:"Are you sure to delete this Timetable Entry?",onConfirm:()=>z(r.id),onCancel:()=>{},okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx(q,{icon:e.jsx(Te,{})})}),e.jsx(q,{icon:e.jsx(Oe,{}),onClick:()=>f(j,r.id)}),e.jsx(B,{title:e.jsxs(e.Fragment,{children:[!r.advanced&&e.jsxs(e.Fragment,{children:[r.teacher.firstName&&e.jsxs(W,{title:"Teacher Informations",column:1,children:[e.jsxs(W.Item,{label:"Name",children:[r.teacher.firstName," ",r.teacher.middleName," ",r.teacher.lastName]}),e.jsx(W.Item,{label:"Email",children:r.teacher.email}),e.jsx(W.Item,{label:"Phone",children:r.teacher.phone})]}),r.supervisor.firstName&&e.jsxs(W,{title:"Exam Supervisor Informations",column:1,children:[e.jsxs(W.Item,{label:"Name",children:[r.supervisor.firstName," ",r.supervisor.middleName," ",r.supervisor.lastName]}),e.jsx(W.Item,{label:"Email",children:r.supervisor.email}),e.jsx(W.Item,{label:"Phone",children:r.supervisor.phone})]})]}),r.advanced&&e.jsxs(e.Fragment,{children:[r.lecturer.firstName&&e.jsxs(W,{title:"Lecturer Informations",column:1,children:[e.jsxs(W.Item,{label:"Name",children:[r.lecturer.firstName," ",r.lecturer.middleName," ",r.lecturer.lastName]}),e.jsx(W.Item,{label:"Email",children:r.lecturer.email}),e.jsx(W.Item,{label:"Phone",children:r.lecturer.phone})]}),r.supervisor.firstName&&e.jsxs(W,{title:"Exam Supervisor Informations",column:1,children:[e.jsxs(W.Item,{label:"Name",children:[r.supervisor.firstName," ",r.supervisor.middleName," ",r.supervisor.lastName]}),e.jsx(W.Item,{label:"Email",children:r.supervisor.email}),e.jsx(W.Item,{label:"Phone",children:r.supervisor.phone})]})]})]}),color:"white",overlayInnerStyle:{color:"black"},children:e.jsx(q,{type:"primary",shape:"circle",icon:e.jsx(Xe,{})})})]})})]})}),r.isExam&&e.jsx(ue.Item,{children:e.jsx("span",{style:{fontSize:18},children:ae(r.dueDate).format("YYYY MMM, DD")})}),e.jsxs(Qe,{children:[r.startAt," - ",r.endAt]})]})})})]})})})}),e.jsx(le,{title:(v==null?void 0:v.name)+" Scheduler",width:"45vw",open:N,onClose:j=>s(j),children:e.jsx($e,{advanced:t.advanced,schoolTimetable:t.schoolTimetable,schoolTimetableEducationLevel:t.schoolTimetableEducationLevel,randKey:Math.random(),form:F,entry:v,onFinish:p})}),e.jsx(le,{title:(v==null?void 0:v.name)+" Scheduler",width:"45vw",open:A,onClose:j=>D(j),children:e.jsx($e,{advanced:t.advanced,schoolTimetable:t.schoolTimetable,schoolTimetableEducationLevel:t.schoolTimetableEducationLevel,randKey:Math.random(),form:F,entry:v,onFinish:p,studyCourse:t.studyCourse})}),e.jsx(le,{title:e.jsxs(e.Fragment,{children:[e.jsxs("span",{children:[v==null?void 0:v.name," Scheduler"]}),e.jsx("span",{style:{marginLeft:10},children:e.jsx(M,{color:"green",children:"Editting"})})]}),width:"45vw",open:i,onClose:j=>g(j),children:e.jsx(Lt,{schoolTimetable:t.schoolTimetable,schoolTimetableEducationLevel:t.schoolTimetableEducationLevel,randKey:Math.random(),form:F,entry:v,onFinish:p})})]})},zt=()=>{var P,N,s,i,g;const[t,u]=a.useState(),[n,x]=a.useState(),T=De(),y=async(A,D)=>{const{data:F}=await k.custom({url:"",method:"post",meta:{operation:"publishUnpublishSchoolStudyCourseTimetable",variables:{schoolStudyCourseTimetableId:{value:A,type:"Int",required:!0},published:{value:D,type:"Boolean",required:!0}},fields:["success","message",{schoolStudyCourseTimetable:["id",{studyCourse:["id","year","semester","semesterDisplay","level","levelDisplay",{course:["id","name"]}]},"published","created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(w=>(d.error("Something Went Wrong ..."),{data:null})).then(w=>w);F&&(F.success?(x(F.schoolStudyCourseTimetable),d.success(F.message)):d.error(F.message))},b=async()=>{const{data:A}=await k.custom({url:"",method:"get",meta:{operation:"schoolTimetableStudyCourse",variables:{id:{value:parseInt(T.id),type:"Int",required:!0}},fields:["id",{studyCourse:["id","year","semester","semesterDisplay","level","levelDisplay",{course:["id","name"]}]},"published","created","updated","isActive","canEdit","canDelete","canManage"]}}).catch(D=>(d.error("Something Went Wrong ..."),{data:null})).then(D=>D);A&&x(A)},v=async()=>{const{data:A}=await k.custom({url:"",method:"get",meta:{operation:"schoolTimetable",variables:{id:{value:parseInt(T.tid),type:"Int",required:!0}},fields:["id","title","description",{school:["id"]},"forExamination","created","updated","isActive","canEdit","canDelete","canManage"]}}).catch(D=>(d.error("Something Went Wrong ..."),{data:null})).then(D=>D);A&&u(A)};return a.useEffect(()=>{document.title=ke.system_name+": Timetable Scheduler",v(),b()},[]),e.jsxs("div",{style:{marginTop:10},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(re,{children:[e.jsx(re.Item,{children:e.jsx(Se,{to:"/timetable",children:"Home"})}),e.jsx(re.Item,{children:e.jsxs(Se,{to:"/timetable/timetables",children:["Timetables - ",t==null?void 0:t.title]})}),e.jsxs(re.Item,{children:["Scheduler - ",(N=(P=n==null?void 0:n.studyCourse)==null?void 0:P.course)==null?void 0:N.name," -"," ",(s=n==null?void 0:n.studyCourse)==null?void 0:s.year," -"," ",(i=n==null?void 0:n.studyCourse)==null?void 0:i.semesterDisplay," -"," ",(g=n==null?void 0:n.studyCourse)==null?void 0:g.levelDisplay]})]}),e.jsxs("div",{children:[!(n!=null&&n.published)&&e.jsx(q,{size:"large",icon:e.jsx(Ee,{style:{color:"red"}}),onClick:()=>y(n==null?void 0:n.id,!0),children:"Not Published"}),(n==null?void 0:n.published)&&e.jsx(q,{size:"large",icon:e.jsx(Ze,{style:{color:"green"}}),onClick:()=>y(n==null?void 0:n.id,!1),children:"Published"})]})]}),e.jsx(it,{advanced:!0,schoolTimetable:t,studyCourse:n})]})},_t=t=>{const[u,n]=a.useState([]),[x,T]=a.useState(0),[y,b]=a.useState(20),[v,P]=a.useState(""),[N,s]=a.useState(!0),[i]=h.useForm(),A=!xe.useBreakpoint().lg,D=[{title:"Name",dataIndex:"name",fixed:!0,render:(f,p)=>e.jsxs("span",{children:[e.jsx("a",{children:p.educationLevel.name}),e.jsx("span",{style:{marginLeft:10},children:e.jsx(M,{color:"green",children:p.educationLevel.schoolType.name})})]})},{title:"",dataIndex:"action",render:(f,p)=>e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(Z,{title:"Are you sure to delete this task?",onConfirm:()=>F(p.id),onCancel:()=>{},okText:"Yes",cancelText:"No",disabled:!p.canManage,overlayStyle:{zIndex:9999},children:e.jsx(q,{icon:e.jsx(ve,{}),children:"Add"})})})}],F=async f=>{var _;const{data:p}=await k.custom({url:"",method:"post",meta:{operation:"createSchoolEducationLevelTimetable",variables:{schoolTimetableId:{value:parseInt(((_=t.schoolTimetable)==null?void 0:_.id.toString())??"0"),type:"Int",required:!0},schoolEducationLevelId:{value:parseInt(f.toString()),type:"Int",required:!0}},fields:["success","message",{schoolEducationLevelTimetable:["id",{schoolEducationLevel:["id",{educationLevel:["id","name"]}]},{schoolTimetable:["id"]},"isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(m=>(d.error("Something Went Wrong ..."),{data:null})).then(m=>m);p&&(p.success?(d.success(p.message),t.onAdd(p.schoolEducationLevelTimetable),n(u.filter(m=>m.id.toString()!==f.toString()))):d.error(p.message)),s(!1)},w=async(f,p="",_=20)=>{var z;const{data:m}=await k.custom({url:"",method:"get",meta:{operation:"timetableNotAssignedSchoolEducationLevels",variables:{schoolTimetableId:{value:parseInt(((z=t.schoolTimetable)==null?void 0:z.id.toString())??"0"),type:"Int",required:!0},page:{value:f,type:"Int",required:!0},key:{value:p,type:"String",required:!1},pageSize:{value:_,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{school:["id","name"]},{educationLevel:["id","name",{schoolType:["id","name","code"]}]},"isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(j=>(d.error("Something Went Wrong ..."),{data:null})).then(j=>j);m&&(T(m.total),n([...m.results])),s(!1)};return a.useEffect(()=>{w(1,"",20)},[t.randKey]),e.jsxs(e.Fragment,{children:[e.jsx(Q,{style:{marginTop:10},children:e.jsx(H,{span:A?24:20,children:e.jsx(h,{layout:"vertical",form:i,onFinish:f=>{P(f.key),u.length=0,w(1,f.key,y)},children:e.jsx(h.Item,{name:"key",children:e.jsx(U,{size:"large",placeholder:"Search ...",prefix:e.jsx(oe,{}),autoComplete:"off",allowClear:!0})})})})}),e.jsx(me,{loading:N,columns:D,dataSource:u,pagination:{onChange:(f,p)=>{b(p),w(f,v,p)},total:x,pageSize:y,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0}})]})},ot=t=>{var I,r;const[u,n]=a.useState([]),[x,T]=a.useState(1),[y,b]=a.useState(0),[v,P]=a.useState(!1),[N,s]=a.useState(!0),{push:i}=et(),[g]=h.useForm();h.useForm(),xe.useBreakpoint().lg;const[D,F]=a.useState(!1),w=async C=>{n([C,...u])},f=async C=>{const{data:c}=await k.custom({url:"",method:"post",meta:{operation:"synchronizeTimetableEducationLevels",variables:{timetableId:{value:parseInt(C),type:"Int",required:!0}},fields:["success","message"]}}).catch(S=>(d.error("Error in synchronizing Timetable Education Levels"),{data:null})).then(S=>S);c&&(c.success?(d(c.message),j(1,"")):d.error(c.message))},p=async C=>{const{data:c}=await k.custom({url:"",method:"post",meta:{operation:"deleteSchoolEducationLevelTimetable",variables:{schoolEducationLevelTimetableId:{value:parseInt(C.toString()),type:"Int",required:!0}},fields:["success","message"]}});c.success?(d.success(c.message),n(u.filter(S=>S.id!==C))):d.error(c.message)},_=async(C,c)=>{const{data:S}=await k.custom({url:"",method:"post",meta:{operation:"publishUnpublishSchoolEducationLevelTimetable",variables:{schoolEducationLevelTimetableId:{value:parseInt(C.toString()),type:"Int",required:!0},publish:{value:c,type:"Boolean",required:!0}},fields:["success","message",{schoolEducationLevelTimetable:["id",{schoolEducationLevel:["id",{educationLevel:["id","name"]}]},{schoolTimetable:["id"]},"hasEntries","published","isActive","created","updated","canEdit","canDelete","canManage"]}]}});S.success?(d.success(S.message),n(u.map(Y=>Y.id===S.schoolEducationLevelTimetable.id?S.schoolEducationLevelTimetable:Y))):d.error(S.message)},m=()=>{d("Canceled")},z=[{title:"Name",dataIndex:"name",fixed:!0,render:(C,c,S)=>e.jsx("span",{children:e.jsx("a",{children:c.schoolEducationLevel.educationLevel.name})})},{title:"Has Entries",dataIndex:"hasEntries",fixed:!0,render:(C,c,S)=>e.jsx("span",{children:c.hasEntries?e.jsx(e.Fragment,{children:e.jsx(M,{color:"green",children:"Yes"})}):e.jsx(e.Fragment,{children:e.jsx(M,{color:"red",children:"No"})})})},{title:"Created",dataIndex:"created",render:(C,c,S)=>e.jsx(e.Fragment,{children:e.jsx("span",{children:e.jsx(Le,{date:new Date(c.created)})})})},{title:"Status",dataIndex:"isActive",render:(C,c,S)=>e.jsx("a",{children:c!=null&&c.isActive?e.jsx("span",{style:{color:"green"},children:"Active"}):e.jsx("span",{style:{color:"red"},children:"Inactive"})})},{title:"Published",dataIndex:"published",render:(C,c,S)=>e.jsx("a",{children:c!=null&&c.published?e.jsx(Z,{title:"Are you sure to Un-publish?",onConfirm:()=>_(c.id,!1),onCancel:()=>{},okText:"Unpublish",cancelText:"No",okButtonProps:{disabled:!c.hasEntries},overlayStyle:{zIndex:9999},children:e.jsx(M,{color:"green",children:"Published"})}):e.jsx(Z,{title:"Are you sure to Publish?",onConfirm:()=>_(c.id,!0),onCancel:()=>{},okText:"Publish",cancelText:"No",okButtonProps:{disabled:!c.hasEntries},overlayStyle:{zIndex:9999},children:e.jsx(M,{color:"red",children:"Not Published"})})})},{title:"",dataIndex:"action",render:(C,c,S)=>e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end"},children:[e.jsx(B,{title:"Schedule",placement:"left",children:e.jsx(q,{icon:e.jsx(he,{}),disabled:!c.canManage,onClick:()=>{var Y;return i("/timetable/education/level/scheduler/"+((Y=t==null?void 0:t.schoolTimetable)==null?void 0:Y.id)+"/"+c.id)}})}),e.jsx(Z,{title:"Are you sure to delete this School Education Level Timetable?",onConfirm:()=>p(c==null?void 0:c.id),onCancel:()=>m,okText:"Yes",cancelText:"No",disabled:!(c!=null&&c.canDelete),overlayStyle:{zIndex:9999},children:e.jsx(q,{icon:e.jsx(Te,{}),disabled:!(c!=null&&c.canDelete)})})]})}],j=async(C,c="")=>{var Y;const{data:S}=await k.custom({url:"",method:"get",meta:{operation:"schoolTimetableEducationLevels",variables:{schoolTimetableId:{value:parseInt(((Y=t.schoolTimetable)==null?void 0:Y.id.toString())??"0"),type:"Int",required:!0},page:{value:C,type:"Int",required:!0},key:{value:c,type:"String",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{schoolEducationLevel:["id",{educationLevel:["id","name"]}]},{schoolTimetable:["id"]},"hasEntries","published","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(J=>(d.error("Failed loading School Timetable Education Levels"),{data:null})).then(J=>J);S&&(T(S.page),b(S.total),P(S.hasNext),n([...S.results])),s(!1)},o=async C=>{var S;const{data:c}=await k.custom({url:"",method:"post",meta:{operation:"publishUnpublishSchoolEducationLevelTimetables",variables:{timetableId:{value:parseInt(((S=t==null?void 0:t.schoolTimetable)==null?void 0:S.id.toString())??"0"),type:"Int",required:!0},publish:{value:C,type:"Boolean",required:!0}},fields:["success","message"]}});c.success?(d.success(c.message),u.length=0,n([]),j(1)):d.error(c.message)};return a.useEffect(()=>{j(x)},[t.randKey]),e.jsxs(e.Fragment,{children:[e.jsxs(Q,{style:{marginTop:10},children:[e.jsx(H,{span:12,children:e.jsx(h,{layout:"vertical",form:g,onFinish:C=>{T(1),u.length=0,j(1,C.key)},children:e.jsx(h.Item,{name:"key",children:e.jsx(U,{size:"large",placeholder:"Search ...",prefix:e.jsx(oe,{}),autoComplete:"off",allowClear:!0})})})}),e.jsxs(H,{span:12,style:{display:"flex",justifyContent:"flex-end"},children:[e.jsx(B,{title:"Click to Publish All timetables Listed Below",color:"green",children:e.jsx(q,{size:"large",icon:e.jsx(pt,{style:{color:"green"}}),onClick:()=>o(!0),children:"Publish All"})}),e.jsx(B,{title:"Click to Unpublish All Timetables listed Below",color:"red",children:e.jsx(q,{size:"large",icon:e.jsx(Ee,{style:{color:"red"}}),onClick:()=>o(!1),children:"Unpublish All"})}),e.jsx(q,{size:"large",icon:e.jsx(tt,{}),onClick:()=>F(!0),children:"Add"}),((I=t.schoolTimetable)==null?void 0:I.forExamination)&&e.jsx(B,{title:"Synchronization All Education Levels Related to Examination",placement:"top",color:"green",children:e.jsx(q,{size:"large",icon:e.jsx(at,{}),onClick:()=>{var C;return f((C=t.schoolTimetable)==null?void 0:C.id)},children:"Sync"})})]})]}),e.jsx(me,{loading:N,columns:z,dataSource:u,pagination:!1,scroll:{y:"60vh"}}),e.jsx(be,{title:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Adding School Education Levels to "}),e.jsx("span",{style:{marginLeft:10},children:e.jsx(M,{color:"green",children:(r=t.schoolTimetable)==null?void 0:r.title})})]}),width:"45vw",anchor:"right",onClose:C=>F(C),open:D,children:e.jsx(_t,{randKey:Math.random(),schoolTimetable:t.schoolTimetable,onAdd:w})})]})},Vt=()=>{const[t,u]=a.useState(),[n,x]=a.useState(),[T,y]=a.useState(!1),b=De(),v=async()=>{const{data:s}=await k.custom({url:"",method:"get",meta:{operation:"schoolTimetableEducationLevel",variables:{id:{value:parseInt(b.id),type:"Int",required:!0}},fields:["id",{schoolEducationLevel:["id",{educationLevel:["id","name"]}]},"created","updated","isActive","published","canEdit","canDelete","canManage"]}}).catch(i=>(d.error("Something Went Wrong ..."),{data:null})).then(i=>i);s&&x(s)},P=async()=>{const{data:s}=await k.custom({url:"",method:"get",meta:{operation:"schoolTimetable",variables:{id:{value:parseInt(b.tid),type:"Int",required:!0}},fields:["id","title","description",{school:["id"]},"forExamination","created","updated","isActive","isPublished","canEdit","canDelete","canManage"]}}).catch(i=>(d.error("Something Went Wrong ..."),{data:null})).then(i=>i);s&&u(s)},N=async(s,i)=>{const{data:g}=await k.custom({url:"",method:"post",meta:{operation:"publishUnpublishSchoolEducationLevelTimetable",variables:{schoolEducationLevelTimetableId:{value:parseInt(s.toString()),type:"Int",required:!0},publish:{value:i,type:"Boolean",required:!0}},fields:["success","message",{schoolEducationLevelTimetable:["id",{schoolEducationLevel:["id",{educationLevel:["id","name"]}]},{schoolTimetable:["id"]},"hasEntries","published","isActive","created","updated","canEdit","canDelete","canManage"]}]}});g.success?(d.success(g.message),x(g.schoolEducationLevelTimetable)):d.error(g.message)};return a.useEffect(()=>{document.title=ke.system_name+": School Timetable Education Level Scheduler",P(),v()},[]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginTop:10},children:[e.jsxs(re,{children:[e.jsx(re.Item,{children:e.jsx(Se,{to:"/timetable",children:"Home"})}),e.jsx(re.Item,{children:e.jsxs(Se,{to:"/timetable/timetables",children:["Timetables - ",t==null?void 0:t.title]})}),e.jsxs(re.Item,{children:["Scheduler -"," ",n==null?void 0:n.schoolEducationLevel.educationLevel.name]}),(n==null?void 0:n.published)&&e.jsx(e.Fragment,{children:e.jsx(M,{color:"red",style:{fontSize:16,padding:3},children:"To Continue Scheduling this Timetable, you first need to Unpublish"})})]}),e.jsxs("div",{style:{float:"right"},children:[(n==null?void 0:n.published)&&e.jsx(Z,{title:"Are you sure to Unpublish Timetable",placement:"left",onConfirm:()=>N(n==null?void 0:n.id,!1),onCancel:()=>{},okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx(q,{icon:e.jsx(jt,{style:{color:"red"}}),style:{float:"right"},children:"Unpublish"})}),!(n!=null&&n.published)&&e.jsx(e.Fragment,{children:e.jsx(Z,{title:"Are you sure to Publish Timetable",placement:"left",onConfirm:()=>N(n==null?void 0:n.id,!0),onCancel:()=>{},okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx(q,{icon:e.jsx(Ze,{style:{color:"green"}}),style:{float:"right"},children:"Publish"})})}),e.jsx(B,{title:"Click to Switch to Other Related Timetables, so as to continue scheduling",color:"green",placement:"left",children:e.jsx(q,{icon:e.jsx(ft,{style:{color:"green"}}),style:{float:"right"},onClick:()=>y(!0),children:"Switch"})})]}),e.jsx("div",{style:{marginTop:45},children:e.jsx(it,{advanced:!1,schoolTimetable:t,schoolTimetableEducationLevel:n})})]}),e.jsx(le,{title:"Timetable Switcher",width:"70vw",open:T,onClose:s=>y(s),children:e.jsx(ot,{schoolTimetable:t,randKey:Math.random()})})]})},{TextArea:Yt}=U,{Option:Wt}=G,Ot=t=>{const[u,n]=a.useState(!1),[x,T]=a.useState([]),[y,b]=a.useState(),v=s=>{b(s)},P=async(s=1,i="")=>{n(!0);const{data:g}=await k.custom({url:"",method:"get",meta:{operation:"schoolVenueTypes",variables:{page:{value:s,type:"Int",required:!0},key:{value:i,type:"String",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","isActive","created","updated","canEdit","canDelete","canManage"]}]}});T(g.results),n(!1)},N=async s=>{const{data:i}=await k.custom({url:"",method:"post",meta:{operation:"createSchoolVenue",variables:{name:{value:s.name,type:"String",required:!0},code:{value:s.code,type:"String",required:!0},schoolVenueTypeId:{value:parseInt(s.school_venue_type_id),type:"Int",required:!0},description:{value:s.description,type:"String",required:!1},capacity:{value:parseInt(s.capacity),type:"Int",required:!1},longitude:{value:s.longitude,type:"Float",required:!1},latitude:{value:s.latitude,type:"Float",required:!1}},fields:["success","message",{schoolVenue:["id","name","code","description",{schoolVenueType:["id","name"]},"capacity","latitude","longitude","created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(g=>(d.error("Error occured while creating school venue"),{data:null})).then(g=>g);i&&(i.success?(d.success(i.message),t.onFinish(i.schoolVenue),t.form.resetFields()):d.error(i.message))};return a.useEffect(()=>{P()},[t.randKey]),e.jsx(e.Fragment,{children:e.jsx(Me,{spinning:u,children:e.jsxs(h,{layout:"vertical",form:t.form,onFinish:s=>{s.school_venue_type_id=y,N(s)},children:[e.jsx(h.Item,{name:"name",label:"Name",rules:[{required:!0,type:"string",message:"Please input Name"}],children:e.jsx(U,{size:"large",placeholder:"Enter Name ..."})}),e.jsx(h.Item,{name:"code",label:"Code",rules:[{required:!0,type:"string",message:"Please input Code"}],children:e.jsx(U,{size:"large",placeholder:"Enter Code ..."})}),e.jsx(h.Item,{name:"capacity",label:"Capacity",children:e.jsx(st,{size:"large",min:0,defaultValue:45,style:{width:"100%"}})}),e.jsx(h.Item,{label:"School Type",rules:[{required:!0,type:"string",message:"Please choose School Type"}],children:e.jsx(G,{showSearch:!0,size:"large",placeholder:"Select a School Venue Type",optionFilterProp:"children",onChange:v,onSearch:s=>{},filterOption:(s,i)=>i.children.toLowerCase().includes(s.toLowerCase()),dropdownStyle:{zIndex:9999},children:x.map((s,i)=>e.jsx(Wt,{value:s.id,children:s.name}))})}),e.jsx(h.Item,{name:"latitude",label:"Latitude",rules:[{required:!1,type:"number",message:"Please input Latidue"}],children:e.jsx(U,{size:"large",placeholder:"Enter Latitude ..."})}),e.jsx(h.Item,{name:"longitude",label:"Longitude",rules:[{required:!1,type:"number",message:"Please input Longitude"}],children:e.jsx(U,{size:"large",placeholder:"Enter Longitude ..."})}),e.jsx(h.Item,{name:"description",label:"Description",rules:[{required:!1,type:"string",message:"Please input Description"}],children:e.jsx(Yt,{rows:4,maxLength:6})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(q,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})})},{TextArea:Kt}=U,{Option:Bt}=G,Ht=t=>{var s;const[u,n]=a.useState(!1),[x,T]=a.useState([]),[y,b]=a.useState(),v=i=>{b(i)},P=async(i=1,g="")=>{n(!0);const{data:A}=await k.custom({url:"",method:"get",meta:{operation:"schoolVenueTypes",variables:{page:{value:i,type:"Int",required:!0},key:{value:g,type:"String",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","isActive","created","updated","canEdit","canDelete","canManage"]}]}});T(A.results),n(!1)},N=async i=>{const{data:g}=await k.custom({url:"",method:"post",meta:{operation:"updateSchoolVenue",variables:{schoolVenueId:{value:parseInt(i.school_venue_id),type:"Int",required:!0},name:{value:i.name,type:"String",required:!0},code:{value:i.code,type:"String",required:!0},schoolVenueTypeId:{value:parseInt(i.school_venue_type_id),type:"Int",required:!0},description:{value:i.description,type:"String",required:!1},capacity:{value:parseInt(i.capacity),type:"Int",required:!1},longitude:{value:i.longitude,type:"Float",required:!1},latitude:{value:i.latitude,type:"Float",required:!1}},fields:["success","message",{schoolVenue:["id","name","code","description",{schoolVenueType:["id","name"]},"capacity","latitude","longitude","created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(A=>(d.error("Error occured while Updating school venue"),{data:null})).then(A=>A);g&&(g.success?(d.success(g.message),t.onFinish(g.schoolVenue),t.form.resetFields()):d.error(g.message))};return a.useEffect(()=>{var i,g,A,D,F,w,f,p;P(),t.form.setFieldsValue({name:(i=t.venue)==null?void 0:i.name,code:(g=t.venue)==null?void 0:g.code,capacity:(A=t.venue)==null?void 0:A.capacity,description:(D=t.venue)==null?void 0:D.description,school_venue_type_id:(F=t.venue)==null?void 0:F.schoolVenueType.id,longitude:(w=t.venue)==null?void 0:w.longitude,latitude:(f=t.venue)==null?void 0:f.latitude}),v((p=t.venue)==null?void 0:p.schoolVenueType.id)},[t.randKey]),e.jsx(e.Fragment,{children:e.jsx(Me,{spinning:u,children:e.jsxs(h,{layout:"vertical",form:t.form,onFinish:i=>{var g;i.school_venue_type_id=y,i.school_venue_id=(g=t.venue)==null?void 0:g.id,N(i)},requiredMark:!1,children:[e.jsx(h.Item,{name:"name",label:"Name",rules:[{required:!0,type:"string",message:"Please input Name"}],children:e.jsx(U,{size:"large",placeholder:"Enter Name ..."})}),e.jsx(h.Item,{name:"code",label:"Code",rules:[{required:!0,type:"string",message:"Please input Code"}],children:e.jsx(U,{size:"large",placeholder:"Enter Code ..."})}),e.jsx(h.Item,{name:"capacity",label:"Capacity",children:e.jsx(st,{min:0,defaultValue:45,style:{width:"100%"}})}),e.jsx(h.Item,{label:"School Type",rules:[{required:!0,type:"string",message:"Please choose School Type"}],children:e.jsx(G,{showSearch:!0,placeholder:"Select a School Venue Type",optionFilterProp:"children",onChange:v,defaultValue:(s=t.venue)==null?void 0:s.schoolVenueType.id,onSearch:i=>{},filterOption:(i,g)=>g.children.toLowerCase().includes(i.toLowerCase()),dropdownStyle:{zIndex:9999},children:x.map((i,g)=>e.jsx(Bt,{value:i.id,children:i.name}))})}),e.jsx(h.Item,{name:"latitude",label:"Latitude",rules:[{required:!1,type:"number",message:"Please input Latidue"}],children:e.jsx(U,{size:"large",placeholder:"Enter Latitude ..."})}),e.jsx(h.Item,{name:"longitude",label:"Longitude",rules:[{required:!1,type:"number",message:"Please input Longitude"}],children:e.jsx(U,{size:"large",placeholder:"Enter Longitude ..."})}),e.jsx(h.Item,{name:"description",label:"Description",rules:[{required:!1,type:"string",message:"Please input Description"}],children:e.jsx(Kt,{rows:4,maxLength:6})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(q,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})})},Gt=t=>{const[u,n]=a.useState(),[x,T]=a.useState([]),[y,b]=a.useState(0),[v,P]=a.useState(!0),[N,s]=a.useState(20),[i,g]=a.useState(""),[A]=h.useForm(),[D]=h.useForm(),w=!xe.useBreakpoint().lg,[f,p]=a.useState(!1),[_,m]=a.useState(!1),z=c=>{n(c),m(!0)},j=async c=>{const{data:S}=await k.custom({url:"",method:"post",meta:{operation:"deleteSchoolVenue",variables:{schoolVenueId:{value:c,type:"Int",required:!0}},fields:["success","message"]}}).catch(Y=>(d.error("Error occured while Deleting School Venue"),{data:null})).then(Y=>Y);S&&(S.success?(d.success(S.message),T(x.filter(Y=>Y.id.toString()!==c.toString()))):d.error(S.message))},o=[{title:"Name",dataIndex:"name",fixed:!0,render:(c,S,Y)=>e.jsx("span",{children:e.jsx("a",{children:S.name})})},{title:"Code",dataIndex:"code",render:(c,S,Y)=>e.jsx("span",{children:S.code})},{title:"Venue Type",dataIndex:"venue_type",render:(c,S,Y)=>{var J;return e.jsx("span",{children:e.jsx(M,{color:"green",children:(J=S==null?void 0:S.schoolVenueType)==null?void 0:J.name})})}},{title:"Capacity",dataIndex:"capacity",render:(c,S,Y)=>e.jsx("span",{children:S.capacity})},{title:"Date Created",dataIndex:"created",render:(c,S,Y)=>e.jsx(e.Fragment,{children:e.jsx("span",{children:e.jsx(Le,{date:new Date(S.created)})})})},{title:"Status",dataIndex:"isActive",render:(c,S,Y)=>e.jsx("span",{children:S!=null&&S.isActive?e.jsx("span",{style:{color:"green"},children:"Active"}):e.jsx("span",{style:{color:"red"},children:"Inactive"})})},{title:"",dataIndex:"action",render:(c,S,Y)=>e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(nt,{trigger:["click"],overlay:e.jsxs(de,{children:[e.jsx(de.Item,{icon:e.jsx(Te,{}),disabled:!S.canDelete,children:e.jsx(Z,{placement:"topLeft",title:`Are you sure you want to delete ${S.name} Venue?`,onConfirm:()=>j(parseInt(S.id)),okText:"Yes",cancelText:"No",children:e.jsx("a",{rel:"noopener noreferrer",children:"Delete"})})}),e.jsx(de.Item,{icon:e.jsx(Oe,{}),disabled:!S.canEdit,onClick:()=>z(S),children:e.jsx("a",{rel:"noopener noreferrer",children:"Edit"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:J=>J.preventDefault(),children:e.jsx(rt,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})})}],I=async c=>{T([c,...x]),D.resetFields()},r=async c=>{const S=x.findIndex(Y=>Y.id===c.id);x[S]=c,T([...x]),D.resetFields(),n(void 0),m(!1)},C=async(c,S="",Y=20)=>{P(!0);const{data:J}=await k.custom({url:"",method:"get",meta:{operation:"schoolVenues",variables:{page:{value:c,type:"Int",required:!0},key:{value:S,type:"String",required:!1},pageSize:{value:Y,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","code","capacity","description","latitude","longitude",{school:["id"]},{schoolVenueType:["id","name"]},"isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(V=>(d.error("Error occured while fetching roles"),{data:null})).then(V=>V);J&&(b(J.total),T([...J.results])),P(!1)};return a.useEffect(()=>{C(1,"",20)},[]),e.jsxs(e.Fragment,{children:[e.jsxs(Q,{style:{marginTop:10},children:[e.jsx(H,{span:w?24:10,children:e.jsx(h,{layout:"vertical",form:A,onFinish:c=>{g(c.key),x.length=0,C(1,c.key)},children:e.jsx(h.Item,{name:"key",children:e.jsx(U,{size:"large",placeholder:"Search ...",prefix:e.jsx(oe,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(H,{span:w?24:2,children:e.jsx(q,{icon:e.jsx(oe,{}),size:"large",onClick:()=>A.submit()})}),e.jsx(H,{span:w?24:12,children:e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(B,{title:"Register a New Venue/Class",children:e.jsx(q,{icon:e.jsx(ve,{}),size:"large",onClick:()=>p(!0),children:"Add Venue"})})})})]}),e.jsx(me,{loading:v,columns:o,dataSource:x,pagination:{onChange:(c,S)=>{s(S),C(c,i,S)},total:y,pageSize:N,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0}}),e.jsx(le,{title:"Register New Venue/Class",width:"30vw",open:f,onClose:c=>p(c),children:e.jsx(Ot,{randKey:Math.random(),form:D,onFinish:I})}),e.jsx(le,{title:"Edditing Venue/Class",width:"30vw",open:_,onClose:c=>m(c),children:e.jsx(Ht,{randKey:Math.random(),form:D,onFinish:r,venue:u})})]})},Ut=()=>(a.useEffect(()=>{document.title=ke.system_name+": School Venues"},[]),e.jsxs("div",{style:{marginTop:10},children:[e.jsxs(re,{children:[e.jsx(re.Item,{children:e.jsx(Se,{to:"/timetable",children:"Home"})}),e.jsx(re.Item,{children:"Venues/Classes"})]}),e.jsx(Gt,{})]})),{TextArea:Rt}=U,{Option:Ye}=G,dt=[];for(let t=2022;t<new Date().getFullYear()+3;t++)dt.push(e.jsx(Ye,{value:t,children:t.toString()},t.toString()));const $t=t=>{const[u,n]=a.useState(!1),[x,T]=a.useState([]),[y,b]=a.useState([]),v=async()=>{const{data:s}=await k.custom({url:"",method:"get",meta:{operation:"schoolExaminations",variables:{},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","created","updated","isActive","canEdit","canManage","canDelete"]}]}}).catch(i=>(d.error("Failed to get school Examinations"),{data:null})).then(i=>i);s&&T(s.results)},P=async()=>{const{data:s}=await k.custom({url:"",method:"get",meta:{operation:"schoolTypes",variables:{},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","code","created","updated","isActive","canEdit","canManage","canDelete"]}]}}).catch(i=>(d.error("Error occured while fetching school types"),{data:null})).then(i=>i);s&&b(s.results)},N=async s=>{const{data:i}=await k.custom({url:"",method:"post",meta:{operation:"createSchoolTimetable",variables:{title:{value:s.title,type:"String",required:!0},description:{value:s.description,type:"String",required:!1},startAt:{value:s.start_at,type:"DateTime",required:!0},endAt:{value:s.end_at,type:"DateTime",required:!0},year:{value:s.year,type:"Int",required:!0},timetableType:{value:parseInt(s.timetable_type),type:"Int",required:!0},forExamination:{value:s.for_examination,type:"Boolean",required:!1},schoolExaminationId:{value:parseInt(s.school_examination_id),type:"Int",required:!1}},fields:["success","message",{schoolTimetable:["id","title","description","startAt","endAt","timetableType","year","forExamination",{timetableSchoolType:["id","name","code"]},{school:["id","name"]},{schoolExamination:["id","name"]},"created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(g=>(d.error("Error occured while creating school timetable"),{data:null})).then(g=>g);i&&(i.success?(d.success(i.message),t.onFinish(i.schoolTimetable),t.form.resetFields()):d.error(i.message))};return a.useEffect(()=>{v(),P()},[t.randKey]),e.jsx(e.Fragment,{children:e.jsxs(h,{layout:"vertical",form:t.form,onFinish:s=>{s.for_examination=u,s.year?s.year=parseInt(s.year):s.year=new Date().getFullYear(),N(s)},children:[e.jsx(h.Item,{name:"timetable_type",label:"Timetable Type",rules:[{required:!0,type:"string",message:"Please select Timetable Type"}],children:e.jsx(G,{size:"large",style:{width:"100%"},placeholder:"Please Timetable Type ...",dropdownStyle:{zIndex:9999},children:y.map(s=>e.jsx(Ye,{value:s.id,children:s.name},s.id))})}),e.jsx(h.Item,{name:"title",label:"Title",rules:[{required:!0,type:"string",message:"Please input Title"}],children:e.jsx(U,{size:"large",placeholder:"Enter Title ..."})}),e.jsx(h.Item,{name:"year",label:"Academic Year",children:e.jsx(G,{size:"large",style:{width:"100%"},placeholder:"Please Select Year",defaultValue:new Date().getFullYear(),dropdownStyle:{zIndex:9999},children:dt})}),e.jsx(h.Item,{name:"description",label:"Description",rules:[{required:!1,type:"string",message:"Please input Description"}],children:e.jsx(Rt,{rows:4})}),e.jsxs(Q,{children:[e.jsx(H,{span:12,children:e.jsx(h.Item,{name:"start_at",label:"Start At",rules:[{required:!0,type:"date",message:"Please input Start At Date"}],children:e.jsx(fe,{style:{width:"100%"},disabledDate:s=>{const i=ae().format("YYYY-MM-DD");return s&&s<ae(i,"YYYY-MM-DD")},popupStyle:{zIndex:9999}})})}),e.jsx(H,{span:12,children:e.jsx(h.Item,{name:"end_at",label:"End At",rules:[{required:!0,type:"date",message:"Please input End At Date"}],children:e.jsx(fe,{style:{width:"100%"},disabledDate:s=>{const i=ae().format("YYYY-MM-DD");return s&&s<ae(i,"YYYY-MM-DD")},popupStyle:{zIndex:9999}})})})]}),e.jsx(h.Item,{name:"for_examination",valuePropName:"checked",children:e.jsx(We,{onChange:s=>{s.target.checked?n(!0):n(!1)},children:"For Examination"})}),u&&e.jsx(h.Item,{name:"school_examination_id",label:"Examination",rules:[{required:u,type:"string",message:"Please select Examination"}],children:e.jsx(G,{size:"large",style:{width:"100%"},placeholder:"Please Choose Examination ...",dropdownStyle:{zIndex:9999},children:x==null?void 0:x.map(s=>e.jsx(Ye,{value:s.id.toString(),children:s.name},s.id))})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(q,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},{Option:ct}=G,{TextArea:Jt}=U,ut=[];for(let t=2022;t<new Date().getFullYear()+3;t++)ut.push(e.jsx(ct,{value:t,children:t.toString()},t.toString()));const Xt=t=>{const[u,n]=a.useState([]),x=async()=>{const{data:y}=await k.custom({url:"",method:"get",meta:{operation:"schoolTypes",variables:{},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","code","created","updated","isActive","canEdit","canManage","canDelete"]}]}}).catch(b=>(d.error("Error occured while fetching school types"),{data:null})).then(b=>b);y&&n(y.results)},T=async y=>{const{data:b}=await k.custom({url:"",method:"post",meta:{operation:"updateSchoolTimetable",variables:{schoolTimetableId:{value:parseInt(y.school_timetable_id),type:"Int",required:!0},title:{value:y.title,type:"String",required:!0},description:{value:y.description,type:"String",required:!1},startAt:{value:y.start_at,type:"DateTime",required:!0},endAt:{value:y.end_at,type:"DateTime",required:!0},year:{value:y.year,type:"Int",required:!0},timetableType:{value:parseInt(y.timetable_type),type:"Int",required:!0},forExamination:{value:y.for_examination,type:"Boolean",required:!1}},fields:["success","message",{schoolTimetable:["id","title","description","startAt","endAt","timetableType","year","forExamination",{timetableSchoolType:["id","name","code"]},{school:["id","name"]},{schoolExamination:["id","name"]},"created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(v=>(d.error("Error occured while creating school timetable"),{data:null})).then(v=>v);b&&(b.success?(d.success(b.message),t.onFinish(b.schoolTimetable),t.form.resetFields()):d.error(b.message))};return a.useEffect(()=>{var y,b,v,P,N,s,i,g;x(),t.form.setFieldsValue({title:(y=t==null?void 0:t.schoolTimetable)==null?void 0:y.title,description:(b=t==null?void 0:t.schoolTimetable)==null?void 0:b.description,start_at:ce((v=t==null?void 0:t.schoolTimetable)==null?void 0:v.startAt),end_at:ce((P=t==null?void 0:t.schoolTimetable)==null?void 0:P.endAt),timetable_type:(s=(N=t==null?void 0:t.schoolTimetable)==null?void 0:N.timetableSchoolType)==null?void 0:s.id,year:(i=t==null?void 0:t.schoolTimetable)==null?void 0:i.year,for_examination:(g=t==null?void 0:t.schoolTimetable)==null?void 0:g.forExamination})},[t.randKey]),e.jsx(e.Fragment,{children:e.jsxs(h,{layout:"vertical",form:t.form,onFinish:y=>{var b;y.school_timetable_id=(b=t.schoolTimetable)==null?void 0:b.id,T(y)},children:[e.jsx(h.Item,{name:"timetable_type",label:"Timetable Type",children:e.jsx(G,{size:"large",style:{width:"100%"},placeholder:"Please Timetable Type ...",disabled:!0,dropdownStyle:{zIndex:9999},children:u.map(y=>e.jsx(ct,{value:y.id,children:y.name},y.id))})}),e.jsx(h.Item,{name:"title",label:"Title",rules:[{required:!0,type:"string",message:"Please input Title"}],children:e.jsx(U,{size:"large",placeholder:"Enter Title ..."})}),e.jsx(h.Item,{name:"year",label:"Academic Year",children:e.jsx(G,{size:"large",style:{width:"100%"},placeholder:"Please Select Year",defaultValue:new Date().getFullYear(),dropdownStyle:{zIndex:9999},children:ut})}),e.jsx(h.Item,{name:"description",label:"Description",rules:[{required:!1,type:"string",message:"Please input Description"}],children:e.jsx(Jt,{rows:4,maxLength:6})}),e.jsxs(Q,{children:[e.jsx(H,{span:12,children:e.jsx(h.Item,{name:"start_at",label:"Start At",rules:[{required:!0,type:"date",message:"Please input Start At Date"}],children:e.jsx(fe,{style:{width:"100%"},disabledDate:y=>{var v;const b=ae((v=t.schoolTimetable)==null?void 0:v.startAt).format("YYYY-MM-DD");return y&&y<ae(b,"YYYY-MM-DD")},popupStyle:{zIndex:9999}})})}),e.jsx(H,{span:12,children:e.jsx(h.Item,{name:"end_at",label:"End At",rules:[{required:!0,type:"date",message:"Please input End At Date"}],children:e.jsx(fe,{style:{width:"100%"},disabledDate:y=>{var v;const b=ae((v=t.schoolTimetable)==null?void 0:v.startAt).format("YYYY-MM-DD");return y&&y<ae(b,"YYYY-MM-DD")},popupStyle:{zIndex:9999}})})})]}),e.jsx(h.Item,{name:"for_examination",valuePropName:"checked",children:e.jsx(We,{disabled:!0,children:"For Examination"})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(q,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},Qt=t=>{const[u,n]=a.useState([]),[x,T]=a.useState(0),[y,b]=a.useState(20),[v,P]=a.useState(""),[N,s]=a.useState(!0),[i]=h.useForm(),A=!xe.useBreakpoint().lg,D=[{title:"Name",dataIndex:"name",fixed:!0,render:(f,p)=>e.jsx("span",{children:p.course.name})},{title:"Year",dataIndex:"year",fixed:!0,render:(f,p)=>e.jsx("span",{children:p.year})},{title:"Semester",dataIndex:"Semester",fixed:!0,render:(f,p)=>e.jsx("span",{children:p.semesterDisplay})},{title:"",dataIndex:"action",render:(f,p)=>e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(Z,{title:"Are you sure to delete this task?",onConfirm:()=>F(p.id),onCancel:()=>{},okText:"Yes",cancelText:"No",disabled:!p.canManage,overlayStyle:{zIndex:9999},children:e.jsx(q,{icon:e.jsx(ve,{}),children:"Add"})})})}],F=async f=>{var _;const{data:p}=await k.custom({url:"",method:"post",meta:{operation:"createTimetableStudyCourse",variables:{schoolTimetableId:{value:parseInt(((_=t.schoolTimetable)==null?void 0:_.id.toString())??"0"),type:"Int",required:!0},studyCourseId:{value:parseInt(f.toString()),type:"Int",required:!0}},fields:["success","message",{timetableStudyCourse:["id",{studyCourse:["id",{course:["id","name"]},"semester","semesterDisplay","year","created","updated","isActive"]},{schoolTimetable:["id"]},"hasEntries","published","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(m=>(d.error("Something Went Wrong ..."),{data:null})).then(m=>m);p&&(p.success?(d.success(p.message),t.onAdd(p.timetableStudyCourse),n(u.filter(m=>m.id.toString()!==f.toString()))):d.error(p.message)),s(!1)},w=async(f,p="",_=20)=>{var z;const{data:m}=await k.custom({url:"",method:"get",meta:{operation:"schoolTimetableStudyCoursesToAdd",variables:{schoolTimetableId:{value:parseInt(((z=t.schoolTimetable)==null?void 0:z.id.toString())??"0"),type:"Int",required:!0},page:{value:f,type:"Int",required:!0},key:{value:p,type:"String",required:!1},pageSize:{value:_,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{course:["id","name"]},"year","semester","semesterDisplay","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(j=>(d.error("Something Went Wrong ..."),{data:null})).then(j=>j);m&&(T(m.total),n([...m.results])),s(!1)};return a.useEffect(()=>{w(1,"",20)},[t.randKey]),e.jsxs(e.Fragment,{children:[e.jsx(Q,{style:{marginTop:10},children:e.jsx(H,{span:A?24:20,children:e.jsx(h,{layout:"vertical",form:i,onFinish:f=>{P(f.key),u.length=0,w(1,f.key,y)},children:e.jsx(h.Item,{name:"key",children:e.jsx(U,{size:"large",placeholder:"Search ...",prefix:e.jsx(oe,{}),autoComplete:"off",allowClear:!0})})})})}),e.jsx(me,{loading:N,columns:D,dataSource:u,pagination:{onChange:(f,p)=>{b(p),w(f,v,p)},total:x,pageSize:y,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0}})]})},Zt=t=>{var o;const[u,n]=a.useState([]),[x,T]=a.useState(1),[y,b]=a.useState(0),[v,P]=a.useState(!1),[N,s]=a.useState(!0),{push:i}=et(),[g]=h.useForm();h.useForm(),xe.useBreakpoint().lg;const[D,F]=a.useState(!1),w=async I=>{n([I,...u])},f=async I=>{const{data:r}=await k.custom({url:"",method:"post",meta:{operation:"deleteTimetableStudyCourse",variables:{id:{value:parseInt(I.toString()),type:"Int",required:!0}},fields:["success","message"]}});r.success?(d.success(r.message),n(u.filter(C=>C.id!==I))):d.error(r.message)},p=async(I,r)=>{const{data:C}=await k.custom({url:"",method:"post",meta:{operation:"publishUnpublishSchoolStudyCourseTimetable",variables:{schoolStudyCourseTimetableId:{value:parseInt(I.toString()),type:"Int",required:!0},published:{value:r,type:"Boolean",required:!0}},fields:["success","message",{schoolStudyCourseTimetable:["id",{studyCourse:["id",{course:["id","name"]},"semester","semesterDisplay","year","created","updated","isActive"]},{schoolTimetable:["id"]},"hasEntries","published","isActive","created","updated","canEdit","canDelete","canManage"]}]}});C.success?(d.success(C.message),n(u.map(c=>c.id===C.schoolStudyCourseTimetable.id?C.schoolStudyCourseTimetable:c))):d.error(C.message)},_=()=>{d("Canceled")},m=[{title:"Name",dataIndex:"name",fixed:!0,render:(I,r,C)=>e.jsx("span",{children:e.jsx("a",{children:r.studyCourse.course.name})})},{title:"Year",dataIndex:"year",fixed:!0,render:(I,r,C)=>e.jsx("span",{children:r.studyCourse.year})},{title:"Semester",dataIndex:"Semester",fixed:!0,render:(I,r,C)=>e.jsx("span",{children:r.studyCourse.semesterDisplay})},{title:"Has Entries",dataIndex:"hasEntries",fixed:!0,render:(I,r,C)=>e.jsx("span",{children:r.hasEntries?e.jsx(e.Fragment,{children:e.jsx(M,{color:"green",children:"Yes"})}):e.jsx(e.Fragment,{children:e.jsx(M,{color:"red",children:"No"})})})},{title:"Created",dataIndex:"created",render:(I,r,C)=>e.jsx(e.Fragment,{children:e.jsx("span",{children:e.jsx(Le,{date:new Date(r.created)})})})},{title:"Status",dataIndex:"isActive",render:(I,r,C)=>e.jsx("a",{children:r!=null&&r.isActive?e.jsx("span",{style:{color:"green"},children:"Active"}):e.jsx("span",{style:{color:"red"},children:"Inactive"})})},{title:"Published",dataIndex:"published",render:(I,r,C)=>e.jsx("a",{children:r!=null&&r.published?e.jsx(Z,{title:"Are you sure to Un-publish?",onConfirm:()=>p(r.id,!1),onCancel:()=>{},okText:"Unpublish",cancelText:"No",okButtonProps:{disabled:!r.hasEntries},overlayStyle:{zIndex:9999},children:e.jsx(M,{color:"green",children:"Published"})}):e.jsx(Z,{title:"Are you sure to Publish?",onConfirm:()=>p(r.id,!0),onCancel:()=>{},okText:"Publish",cancelText:"No",okButtonProps:{disabled:!r.hasEntries},overlayStyle:{zIndex:9999},children:e.jsx(M,{color:"red",children:"Not Published"})})})},{title:"",dataIndex:"action",render:(I,r,C)=>e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end"},children:[e.jsx(B,{title:"Schedule",placement:"left",children:e.jsx(q,{icon:e.jsx(he,{}),disabled:!r.canManage,onClick:()=>{var c;return i("/timetable/study/course/scheduler/"+((c=t==null?void 0:t.schoolTimetable)==null?void 0:c.id)+"/"+r.id)}})}),e.jsx(Z,{title:"Are you sure to delete this Timetable Study Course?",onConfirm:()=>f(r==null?void 0:r.id),onCancel:()=>_,okText:"Yes",cancelText:"No",disabled:!(r!=null&&r.canDelete),overlayStyle:{zIndex:9999},children:e.jsx(q,{icon:e.jsx(Te,{}),disabled:!(r!=null&&r.canDelete)})})]})}],z=async(I,r="")=>{var c;const{data:C}=await k.custom({url:"",method:"get",meta:{operation:"schoolTimetableStudyCourses",variables:{schoolTimetableId:{value:parseInt(((c=t.schoolTimetable)==null?void 0:c.id.toString())??"0"),type:"Int",required:!0},page:{value:I,type:"Int",required:!0},key:{value:r,type:"String",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{studyCourse:["id",{course:["id","name"]},"semester","semesterDisplay","year","created","updated","isActive"]},{schoolTimetable:["id"]},"hasEntries","published","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(S=>(d.error("Failed loading School Timetable Education Levels"),{data:null})).then(S=>S);C&&(T(C.page),b(C.total),P(C.hasNext),n([...C.results])),s(!1)},j=async I=>{var C;const{data:r}=await k.custom({url:"",method:"post",meta:{operation:"publishUnpublishAllSchoolStudyCourseTimetables",variables:{schoolTimetableId:{value:parseInt(((C=t.schoolTimetable)==null?void 0:C.id.toString())??"0"),type:"Int",required:!0},published:{value:I,type:"Boolean",required:!0}},fields:["success","message"]}}).catch(c=>(d.error("Failed to publish/unpublish all study courses"),{data:null})).then(c=>c);r&&(r.success?(d.success(r.message),z(1)):d.error(r.message))};return a.useEffect(()=>{z(x)},[t.randKey]),e.jsxs(e.Fragment,{children:[e.jsxs(Q,{style:{marginTop:10},children:[e.jsx(H,{span:12,children:e.jsx(h,{layout:"vertical",form:g,onFinish:I=>{T(1),u.length=0,z(1,I.key)},children:e.jsx(h.Item,{name:"key",children:e.jsx(U,{size:"large",placeholder:"Search ...",prefix:e.jsx(oe,{}),autoComplete:"off",allowClear:!0})})})}),e.jsxs(H,{span:12,style:{display:"flex",justifyContent:"flex-end"},children:[e.jsx(B,{title:"Click to Publish All Timetables",color:"green",children:e.jsx(q,{size:"large",icon:e.jsx(Je,{style:{color:"green"}}),onClick:()=>j(!0),children:"Publish All"})}),e.jsx(B,{title:"Click to Unpublish All Timetables",color:"red",children:e.jsx(q,{size:"large",icon:e.jsx(Ee,{style:{color:"red"}}),onClick:()=>j(!1),children:"Unpublish All"})}),e.jsx(B,{title:"Auto Generate Timetable",color:"red",children:e.jsx(q,{size:"large",icon:e.jsx(at,{style:{color:"red"}}),onClick:()=>t.autoGenerate(),children:"Auto Generate"})}),e.jsx(q,{size:"large",icon:e.jsx(tt,{}),onClick:()=>F(!0),children:"Add"})]})]}),e.jsx(me,{loading:N,columns:m,dataSource:u,pagination:!1,scroll:{y:"60vh"}}),e.jsx(be,{title:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Adding Study Courses to "}),e.jsx("span",{style:{marginLeft:10},children:e.jsx(M,{color:"green",children:(o=t.schoolTimetable)==null?void 0:o.title})})]}),width:"45vw",anchor:"right",onClose:I=>F(I),open:D,children:e.jsx(Qt,{randKey:Math.random(),schoolTimetable:t.schoolTimetable,onAdd:w})})]})},ea=t=>{const[u,n]=a.useState([]),[x,T]=a.useState({}),[y,b]=a.useState([]),v=async()=>{var i;const{data:s}=await k.custom({url:"",method:"post",meta:{operation:"uniTimetableAutoScheduler",variables:{schoolTimetableId:{value:parseInt(((i=t.schoolTimetable)==null?void 0:i.id.toString())??"0"),type:"Int",required:!0}},fields:["success","message"]}}).catch(()=>(d.error("Something Went Wrong ..."),{data:null})).then(g=>g);s&&(s.success?d.success(s.message):d.error(s.message))},P=async()=>{var i;const{data:s}=await k.custom({url:"",method:"get",meta:{operation:"autoTimetableSchedulerValidityCheck",variables:{timetableId:{value:parseInt(((i=t.schoolTimetable)==null?void 0:i.id.toString())??"0"),type:"Int",required:!0}},fields:["data"]}}).catch(g=>(d.error("Something Went Wrong ..."),{data:null})).then(g=>g);s&&(T(s.data),n(s.data.validities.map(g=>({title:e.jsxs(e.Fragment,{children:[e.jsx(B,{title:"Course Name",children:g.name}),"- ",e.jsx(B,{title:"Maximum Number of Students",children:e.jsxs(M,{color:"green",children:[g.maxStudents," Max Students"]})}),!g.capacityFit&&e.jsxs(M,{color:"red",children:["No available Venue with capacity of ",g.maxStudents," Students for this course"]})]}),key:"sc-"+g.id,icon:e.jsx(Ve,{}),children:g.modules.length>0?g.modules.map(A=>({title:e.jsxs(e.Fragment,{children:[e.jsxs(B,{title:"Module Name",children:[A.name,e.jsx(M,{color:"green",children:A.code})]}),e.jsx(B,{title:"Number of Periods per Week",children:e.jsxs(M,{color:"green",children:[A.periodsPerWeek," Periods/Week"]})})]}),key:"sc-"+g.id+"-"+A.id,icon:e.jsx(Ve,{}),children:A.teachers.length>0?A.teachers.map(D=>({title:e.jsxs(e.Fragment,{children:[D.fullName," - ",e.jsx(M,{color:"green",children:D.phone})," ",e.jsx(M,{color:"blue",children:D.email})]}),key:"sc-"+g.id+"-"+A.id+"-"+D.id})):[{title:e.jsx(e.Fragment,{children:e.jsx(M,{color:"red",children:"No available Teacher for this course"})}),key:"sc-"+g.id+"-"+A.id+"-0"}]})):[{title:"No Module Found",key:"sc-"+g.id+"-0",icon:e.jsx(Ve,{})}]}))),b(s.data.map(g=>"sc-"+g.id)))},N=[{key:"1",label:"Validity Check Summary",children:e.jsxs("div",{style:{maxHeight:"70vh",minHeight:"70vh",overflowY:"auto",overflowX:"hidden"},children:[x.canGenerate&&e.jsx(je,{message:"Timetable can be generated, no errors found",type:"success"}),!x.canGenerate&&e.jsxs(e.Fragment,{children:[e.jsx(je,{message:"Timetable can't be generated, please fix the errors highlited",type:"error"}),e.jsx(ue,{bordered:!0,dataSource:x.issues,renderItem:s=>e.jsx(ue.Item,{children:e.jsx(ue.Item.Meta,{avatar:e.jsx(He,{style:{color:"red"}}),title:e.jsx(Ge.Text,{children:s})})})})]})]})},{key:"2",label:"Validity Check Details Tree",children:e.jsxs("div",{style:{maxHeight:"70vh",minHeight:"70vh",overflowY:"auto",overflowX:"hidden"},children:[u.length>0&&e.jsx(bt,{showLine:!0,showIcon:!0,autoExpandParent:!0,expandedKeys:y,onExpand:s=>{b(s)},treeData:u}),u.length<=0&&e.jsx(je,{message:"No Data Found",type:"error"})]})},{key:"3",label:"Venues",children:e.jsxs("div",{style:{maxHeight:"70vh",minHeight:"70vh",overflowY:"auto",overflowX:"hidden"},children:[x.venues&&e.jsx(ue,{bordered:!0,dataSource:x.venues,renderItem:s=>e.jsx(ue.Item,{children:e.jsx(ue.Item.Meta,{avatar:s.capacity>0?e.jsx(At,{style:{color:"green"}}):e.jsx(He,{style:{color:"red"}}),title:e.jsxs(Ge.Text,{children:[s.name,e.jsxs(M,{color:"green",style:{marginLeft:"10px"},children:[s.capacity," Max Students"]})]})})})}),!x.venues&&e.jsx(je,{message:"No Venue Registered",type:"error"})]})}];return a.useEffect(()=>{P()},[t.randKey]),e.jsx("div",{style:{maxHeight:"80vh",minHeight:"80vh",overflowY:"auto",overflowX:"hidden"},children:e.jsx(St,{defaultActiveKey:"1",items:N,onChange:s=>{console.log(s)},tabBarExtraContent:e.jsxs(e.Fragment,{children:[x.canGenerate&&e.jsx(q,{type:"default",onClick:()=>v(),children:"Generate Timetable"}),!x.canGenerate&&e.jsx(je,{message:"Timetable can't be generated, please fix the errors highlited",type:"error"})]})})})},ta=t=>{const[u,n]=a.useState(),[x,T]=a.useState([]),[y,b]=a.useState(0),[v,P]=a.useState(!0),[N,s]=a.useState(20),[i,g]=a.useState(""),[A]=h.useForm(),[D]=h.useForm(),[F]=h.useForm(),f=!xe.useBreakpoint().lg,[p,_]=a.useState(!1),[m,z]=a.useState(!1),[j,o]=a.useState(!1),[I,r]=a.useState(!1),[C,c]=a.useState(!1),[S,Y]=a.useState(!1),J=L=>{n(L),Y(!0)},V=L=>{n(L),c(!0)},O=L=>{n(L),r(!0)},R=L=>{n(L),o(!0)},ee=L=>{n(L),z(!0)},Ie=async L=>{const{data:E}=await k.custom({url:"",method:"post",meta:{operation:"deleteSchoolTimetable",variables:{schoolTimetableId:{value:L,type:"Int",required:!0}},fields:["success","message"]}}).catch(()=>(d.error("Error occured while Deleting School Venue"),{data:null})).then(X=>X);E&&(E.success?(d.success(E.message),T(x.filter(X=>X.id.toString()!==L.toString()))):d.error(E.message))},Pe=[{title:"Title",dataIndex:"title",fixed:!0,render:(L,E,X)=>{var se;return e.jsx("span",{children:e.jsxs("a",{children:[E.title,E.forExamination&&e.jsx(M,{color:"red",style:{marginLeft:10},children:(se=E==null?void 0:E.schoolExamination)==null?void 0:se.name})]})})}},{title:"Examination",dataIndex:"examination",fixed:!0,render:(L,E,X)=>e.jsx("span",{children:e.jsx("a",{children:E.forExamination?e.jsx(M,{color:"green",children:"Yes"}):e.jsx(M,{color:"red",children:"No"})})})},{title:"Year",dataIndex:"year",fixed:!0,render:(L,E,X)=>e.jsx("span",{children:e.jsx("a",{children:E.year})})},{title:"Timetable Type",dataIndex:"Timetable Type",fixed:!0,render:(L,E,X)=>{var se;return e.jsx("span",{children:e.jsx("a",{children:(se=E==null?void 0:E.timetableSchoolType)==null?void 0:se.name})})}},{title:"Start AT",dataIndex:"startAt",fixed:!0,render:(L,E,X)=>e.jsx("span",{children:ae(new Date(E.startAt)).format("MMM Do Y")})},{title:"End At",dataIndex:"endAt",fixed:!0,render:(L,E,X)=>e.jsx("span",{children:ae(new Date(E.endAt)).format("MMM Do Y")})},{title:"Date Created",dataIndex:"created",render:(L,E,X)=>e.jsx(e.Fragment,{children:e.jsx("span",{children:e.jsx(Le,{date:new Date(E.created)})})})},{title:"Status",dataIndex:"isActive",render:(L,E,X)=>e.jsx("a",{children:E!=null&&E.isActive?e.jsx("span",{style:{color:"green"},children:"Active"}):e.jsx("span",{style:{color:"red"},children:"Inactive"})})},{title:"",dataIndex:"action",render:(L,E,X)=>{var se,pe;return e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(nt,{trigger:["click"],overlay:e.jsxs(de,{children:[e.jsx(de.Item,{icon:e.jsx(Te,{}),disabled:!E.canDelete,children:e.jsx(Z,{placement:"topLeft",title:`Are you sure you want to delete ${E.name} Timetable?`,onConfirm:()=>Ie(parseInt(E.id)),okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx("a",{rel:"noopener noreferrer",children:"Delete"})})}),e.jsx(de.Item,{icon:e.jsx(Oe,{}),disabled:!E.canEdit,onClick:()=>ee(E),children:e.jsx("a",{rel:"noopener noreferrer",children:"Edit"})}),["pr","osc","asc","	tert"].includes((se=E==null?void 0:E.timetableSchoolType)==null?void 0:se.code)&&e.jsx(de.Item,{icon:e.jsx(he,{}),disabled:!E.canManage,onClick:()=>R(E),children:e.jsx("a",{rel:"noopener noreferrer",children:"Scheduler"})}),["uni","poly","col","ous"].includes((pe=E==null?void 0:E.timetableSchoolType)==null?void 0:pe.code)&&e.jsx(de.Item,{icon:e.jsx(he,{}),disabled:!E.canManage,onClick:()=>O(E),children:e.jsx("a",{rel:"noopener noreferrer",children:"Scheduler"})}),e.jsx(de.Item,{icon:e.jsx(he,{}),disabled:!E.canManage,onClick:()=>J(E),children:e.jsx("a",{rel:"noopener noreferrer",children:"Auto Generate"})}),e.jsx(de.Item,{icon:e.jsx(he,{}),disabled:!E.canManage,onClick:()=>V(E),children:e.jsx("a",{rel:"noopener noreferrer",children:"Schedules Drafts"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:we=>we.preventDefault(),children:e.jsx(rt,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})})}}],ze=async L=>{T([L,...x]),D.resetFields()},_e=async L=>{const E=x.findIndex(X=>X.id===L.id);x[E]=L,T([...x]),F.resetFields(),n(void 0),z(!1)},Ce=async(L,E="",X=20)=>{P(!0);const{data:se}=await k.custom({url:"",method:"get",meta:{operation:"schoolTimetables",variables:{page:{value:L,type:"Int",required:!0},key:{value:E,type:"String",required:!1},pageSize:{value:X,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","title","description","isPublished","startAt","endAt","timetableType","timetableTypeDisplay","year","forExamination",{timetableSchoolType:["id","name","code"]},{school:["id"]},{author:["id","firstName","middleName","lastName","fullName"]},{schoolExamination:["id","name"]},"isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(()=>(d.error("Error occured while fetching roles"),{data:null})).then(pe=>pe);se&&(b(se.total),T([...se.results])),P(!1)};return a.useEffect(()=>{Ce(1,"",20)},[]),e.jsxs(e.Fragment,{children:[e.jsxs(Q,{style:{marginTop:10},children:[e.jsx(H,{span:f?24:10,children:e.jsx(h,{layout:"vertical",form:A,onFinish:L=>{g(L.key),x.length=0,Ce(1,L.key)},children:e.jsx(h.Item,{name:"key",children:e.jsx(U,{size:"large",placeholder:"Search ...",prefix:e.jsx(oe,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(H,{span:f?24:2,children:e.jsx(q,{icon:e.jsx(oe,{}),size:"large",onClick:()=>A.submit()})}),e.jsx(H,{span:f?24:12,children:e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(B,{title:"Register a New Venue/Class",children:e.jsx(q,{icon:e.jsx(ve,{}),size:"large",onClick:()=>_(!0),children:"Add Timetable"})})})})]}),e.jsx(me,{loading:v,columns:Pe,dataSource:x,pagination:{onChange:(L,E)=>{s(E),Ce(L,i,E)},total:y,pageSize:N,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0}}),e.jsx(le,{title:"Creating New School Timetable",width:"30vw",open:p,onClose:L=>_(L),children:e.jsx($t,{randKey:Math.random(),form:D,onFinish:ze})}),e.jsx(le,{title:"Edditing School Timetable",width:"30vw",open:m,onClose:L=>z(L),children:e.jsx(Xt,{randKey:Math.random(),form:F,onFinish:_e,schoolTimetable:u})}),e.jsx(le,{title:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"School Timetable Education Levels"}),e.jsx("span",{style:{marginLeft:10},children:e.jsx(M,{color:"green",children:u==null?void 0:u.title})})]}),width:"60vw",open:j,onClose:L=>o(L),children:e.jsx(ot,{schoolTimetable:u,randKey:Math.random()})}),e.jsx(le,{title:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Timetable Study Courses"}),e.jsx("span",{style:{marginLeft:10},children:e.jsx(M,{color:"green",children:u==null?void 0:u.title})})]}),width:"80vw",open:I,onClose:L=>r(L),children:e.jsx(Zt,{schoolTimetable:u,randKey:Math.random(),autoGenerate:()=>{Y(!0)}})}),e.jsx(le,{title:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Timetables Schedules Drafts"}),e.jsx("span",{style:{marginLeft:10},children:e.jsx(M,{color:"green",children:u==null?void 0:u.title})})]}),width:"90vw",open:C,onClose:L=>c(L),children:e.jsx(e.Fragment,{children:"Drafts"})}),e.jsx(le,{title:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Timetable Auto Generation"}),e.jsx("span",{style:{marginLeft:10},children:e.jsx(M,{color:"green",children:u==null?void 0:u.title})})]}),width:"60vw",open:S,onClose:L=>Y(L),children:e.jsx(ea,{schoolTimetable:u,randKey:Math.random()})})]})},aa=()=>(a.useEffect(()=>{document.title=ke.system_name+": School Timetables"},[]),e.jsxs("div",{style:{marginTop:10},children:[e.jsxs(re,{children:[e.jsx(re.Item,{children:e.jsx(Se,{to:"/timetable",children:"Home"})}),e.jsx(re.Item,{children:"Timetables"})]}),e.jsx(ta,{})]})),la=t=>{const{page:u}=t;return u==="SchoolTimetablesPage"?e.jsx(aa,{}):u==="SchoolVenuesPage"?e.jsx(Ut,{}):u==="SchoolTimetableEducationLevelSchedulerPage"?e.jsx(Vt,{}):u==="SchoolTimetableStudyCourseSchedulerPage"?e.jsx(zt,{}):u==="TimetableDashboardPage"?e.jsx(Dt,{}):e.jsx("div",{children:"Page not found ..."})};export{la as TimetablePages};
