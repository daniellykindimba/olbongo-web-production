import{r as n,q as ee,F as j,j as e,s as U,C as g,I as O,S as $,B as E,E as ce,a3 as fe,dM as Pe,u as M,A as ve,bA as De,T as B,x as Z,au as te,G as v,H as x,y as ie,aV as X,t as xe,Q as H,U as W,as as he,bg as qe,dN as ze,dO as Ae,X as le,Y as T,a7 as oe,bE as Se,a4 as je,dP as Te,$ as de,D as J,ap as pe,aq as ge,dQ as be,bt as P,v as ue,ay as me,bw as Le,z as Ke,O as _e,aD as Oe,V as Ve,ab as Re,ac as He,aJ as Ne}from"./index-6e39ecf9.js";import{T as ye}from"./Table-27df87c1.js";import{B as C}from"./Breadcrumb-23e6902d.js";import"./index-7e11c79c.js";const Be=()=>{const[a,o]=n.useState([]),[r,s]=n.useState(!1),[m,t]=n.useState(!1),[u,i]=n.useState(20),[c,y]=n.useState(0),[L,D]=n.useState(1);n.useState(""),ee();const[V]=j.useForm(),K=async(b,w,S=20)=>{s(!0);const{data:I}=await v.custom({url:"",method:"get",meta:{operation:"messagesDispatches",variables:{page:{value:b,type:"Int",required:!0},key:{value:w,type:"String",required:!1},pageSize:{value:S,type:"Int",required:!1}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","receipientPhoneNumber","carrier",{channelMessage:["id","message",{channel:["id","name","code"]}]},{receipient:["id","firstName"]},"isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(z=>(x.error("Error fetching Recently Messages Dispatched"),{data:null})).then(z=>z);I&&(y(I.total),D(I.page+1),o([...a,...I.results])),s(!1),t(!1)},Y=b=>{b.currentTarget.scrollHeight-b.currentTarget.scrollTop===window.innerHeight/1.4&&K(L,"",20)};return n.useEffect(()=>{K(L,"",20)},[]),e.jsx(e.Fragment,{children:e.jsxs(U,{children:[e.jsx(g,{children:e.jsx("span",{style:{fontSize:16,fontWeight:"bolder"},children:"Recently Dispatched Messages"})}),e.jsx(g,{span:20,style:{height:45},children:e.jsx(j,{layout:"vertical",form:V,onFinish:b=>{t(!0),K(L,b.key,u)},children:e.jsx(j.Item,{name:"key",children:e.jsx(O,{size:"large",disabled:m,placeholder:"Search Phone Number(s)...",prefix:e.jsx($,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(g,{span:4,style:{display:"flex",justifyContent:"flex-start",height:45},children:e.jsx(E,{size:"large",icon:e.jsx($,{}),onClick:()=>{V.submit()},loading:m||r,disabled:m||r})}),e.jsxs(g,{span:24,children:[a.length===0&&e.jsx(ce,{image:"/images/nodata.png",imageStyle:{height:160},description:e.jsx("span",{style:{fontSize:16},children:"No recently dispatched message ..."})}),e.jsx(fe,{style:{paddingRight:10},children:e.jsx(Pe,{data:a,height:window.innerHeight/1.4,itemHeight:47,itemKey:"phoneNumber",onScroll:Y,children:b=>{var w,S;return e.jsx(M,{children:e.jsx(fe.Item,{children:e.jsx(fe.Item.Meta,{avatar:e.jsx(ve,{icon:e.jsx(De,{})}),title:e.jsxs("a",{children:[b.receipientPhoneNumber,e.jsxs("span",{style:{marginLeft:5},children:[e.jsx(B,{color:"green",children:(S=(w=b==null?void 0:b.channelMessage)==null?void 0:w.channel)==null?void 0:S.name}),b.carrier&&e.jsx(B,{color:"red",children:b.carrier})]})]}),description:e.jsx(e.Fragment,{children:e.jsxs(Z,{direction:"vertical",children:[e.jsx("span",{children:b.channelMessage.message.length>100?b.channelMessage.message.substring(0,100)+"...":b.channelMessage.message}),e.jsxs("span",{children:[e.jsx("b",{children:"Dispatched"}),":"," ",te(b.created).format("lll")]})]})})})},b.receipientPhoneNumber)})}})})]})]})})},Ye=a=>{const[o,r]=n.useState([]);n.useState();const[s,m]=n.useState(!1),[t,u]=n.useState(!1),[i,c]=n.useState(20),[y,L]=n.useState(0),[D,V]=n.useState("");ee();const[K]=j.useForm(),Y=async(w,S,I=20)=>{m(!0);const{data:z}=await v.custom({url:"",method:"get",meta:{operation:"channelMessageDispatches",variables:{page:{value:w,type:"Int",required:!0},key:{value:S,type:"String",required:!1},pageSize:{value:I,type:"Int",required:!1},filterType:{value:a.filterType,type:"String",required:!0},messageId:{value:a.messageId,type:"Int",required:!0}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","receipientPhoneNumber","status","statusColor","carrier","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(_=>(x.error("Error fetching Dispatches"),{data:null})).then(_=>_);z&&(L(z.total),r(z.results)),m(!1),u(!1)},b=[{title:"Phone Number",dataIndex:"phoneNumber",key:"phoneNumber",render:(w,S,I)=>e.jsx("a",{onClick:()=>{},children:S.receipientPhoneNumber})},{title:"Carrier",dataIndex:"carrier",key:"carrier",render:(w,S,I)=>e.jsx(B,{color:"green",children:S.carrier})},{title:"Created",dataIndex:"created",key:"created",render:(w,S,I)=>e.jsx(ie,{title:te(S.created).format("Y-mm-d hh:mm:ss"),children:e.jsx("span",{children:te(S.created).format("Y-mm-d hh:mm:ss")})})},{title:"Status",dataIndex:"status",key:"status",render:(w,S,I)=>e.jsx(B,{color:S.statusColor,children:S.status})},{title:"",dataIndex:"Action",key:"action",render:(w,S,I)=>e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"}})}];return n.useEffect(()=>{Y(1,"",20)},[a.randKey,a.filterType]),e.jsxs(e.Fragment,{children:[e.jsx(U,{children:e.jsx(g,{span:24,children:e.jsx(j,{layout:"vertical",form:K,onFinish:w=>{u(!0),Y(0,w.key,i)},children:e.jsx(j.Item,{name:"key",children:e.jsx(O,{size:"large",disabled:t,placeholder:"Search Phone Number(s)...",prefix:e.jsx($,{}),autoComplete:"off",allowClear:!0})})})})}),e.jsx(ye,{loading:s,columns:b,dataSource:o,pagination:{onChange:(w,S)=>{c(S),Y(w,D,S)},total:y,pageSize:i,position:["bottomCenter"],showQuickJumper:!0},scroll:{x:!0,y:"40vh"}})]})},Ue=["receipients","delivered","notdelivered","failed"],We=["All Receipients","All Delivered","All Not Delivered","All Failed"],we=a=>{var c;X(),ee();const[o,r]=n.useState(!1),[s,m]=n.useState(),[t,u]=n.useState("receipients"),i=async()=>{var L;r(!0);const{data:y}=await v.custom({url:"",method:"get",meta:{operation:"channelMessageDispatchAnalytics",variables:{messageId:{value:(L=a.channelMessage)==null?void 0:L.id,type:"Int",required:!0}},fields:["analytics"]}}).catch(D=>(x.error("Error fetching Message Dispatch analytics"),{data:null})).then(D=>D);y&&m(y.analytics),r(!1)};return n.useEffect(()=>{i()},[a.randKey]),e.jsx(e.Fragment,{children:e.jsxs(xe,{spinning:o,children:[e.jsxs(U,{style:{display:"flex",justifyContent:"center",marginTop:2},children:[e.jsx(g,{span:6,children:e.jsx("a",{onClick:()=>u("receipients"),children:e.jsx(M,{children:e.jsx(H,{title:"Total Receipients",value:s==null?void 0:s.total_receipients,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:6,children:e.jsx("a",{onClick:()=>u("delivered"),children:e.jsx(M,{children:e.jsx(H,{title:"Delivered",value:s==null?void 0:s.total_delivered,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:6,children:e.jsx("a",{onClick:()=>u("notdelivered"),children:e.jsx(M,{children:e.jsx(H,{title:"Not Delievered",value:s==null?void 0:s.total_not_delivered,precision:0,valueStyle:{color:"#5E0321"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:6,children:e.jsx("a",{onClick:()=>u("failed"),children:e.jsx(M,{children:e.jsx(H,{title:"Failed",value:s==null?void 0:s.total_failed,precision:0,valueStyle:{color:"#700107"},prefix:e.jsx(W,{})})})})})]}),e.jsxs("div",{style:{marginTop:2},children:[e.jsx("h3",{children:We[Ue.indexOf(t)]}),e.jsx(Ye,{randKey:Math.random(),filterType:t,messageId:(c=a.channelMessage)==null?void 0:c.id})]})]})})},{TextArea:$e}=O,Qe=a=>{const[o,r]=n.useState([]),s=async(i=1,c=25,y="")=>{const{data:L}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannels",variables:{page:{value:i,type:"Int",required:!0},pageSize:{value:c,type:"Int",required:!0},key:{value:y,type:"String",required:!1}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","name","code"]}]}}).catch(D=>(x.error("Error fetching Channels"),{data:null})).then(D=>D);L&&r(L.results)},m=async i=>{const{data:c}=await v.custom({url:"",method:"post",meta:{operation:"createNjiwaChannelMessage",variables:{channelId:{value:parseInt(i.channel),type:"Int",required:!0},message:{value:i.message,type:"String",required:!1}},fields:["success","message",{njiwaChannelMessage:["id","message",{channel:["id","name","code"]},{creator:["id","firstName","middleName","lastName","fullName"]},"messageCount","dispatched","created","updated","isActive","canDelete","canEdit","canManage"]}]}}).catch(y=>(x.error("Error creating channel message"),{data:null})).then(y=>y);c&&(c.success?(x.success(c.message),a.onFinish(c.njiwaChannelMessage)):x.error(c.message))},t=i=>{},u=i=>{};return n.useEffect(()=>{s()},[a.randKey]),e.jsx(e.Fragment,{children:e.jsxs(j,{layout:"vertical",form:a.form,onFinish:i=>{m(i)},requiredMark:!0,children:[e.jsx(j.Item,{name:"message",label:"Message",rules:[{required:!0,type:"string",message:"Please input Message"}],children:e.jsx($e,{rows:4})}),e.jsx(j.Item,{name:"channel",label:"Channel",rules:[{required:!0,type:"number",message:"Please Choose Channel ..."}],children:e.jsx(he,{size:"large",showSearch:!0,placeholder:"Select a Channel ...",optionFilterProp:"children",onChange:t,onSearch:u,filterOption:(i,c)=>((c==null?void 0:c.label)??"").toLowerCase().includes(i.toLowerCase()),options:o.map(i=>({value:i.id,label:i.name+" --> "+i.code})),dropdownStyle:{zIndex:9999}})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(E,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},Ie=a=>{const[o,r]=n.useState([]),[s,m]=n.useState(),[t,u]=n.useState(!1),[i,c]=n.useState(!1),[y,L]=n.useState(20);n.useState(""),ee(),j.useForm();const[D]=j.useForm(),[V,K]=n.useState(!1),[Y,b]=n.useState(!1),w=async l=>{m(l),K(!0)},S=async l=>{const{data:N}=await v.custom({url:"",method:"post",meta:{operation:"deleteNjiwaChannelMessage",variables:{id:{value:l,type:"Int",required:!0}},fields:["success","message"]}});N.success?(x.success(N.message),r(o.filter(F=>F.id.toString()!==l.toString()))):x.error(N.message)},I=async l=>{const{data:N}=await v.custom({url:"",method:"post",meta:{operation:"dispatchChannelMessage",variables:{channelMessageId:{value:l,type:"Int",required:!0}},fields:["success","message",{channelMessage:["id","message",{channel:["id","name","code"]},{creator:["id","firstName","middleName","lastName","fullName"]},"messageCount","dispatched","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(F=>(x.error(F.message),{data:null})).then(F=>F);N&&(N.success?(r(o.map(F=>F.id===N.channelMessage.id?N.channelMessage:F)),x.success(N.message)):x.error(N.message))},z=l=>{pe.confirm({title:"Deleting Njiwa Channel Message",icon:e.jsx(ge,{}),content:"Are you sure ...",okText:"Delete",cancelText:"Cancel",onOk:()=>S(parseInt(l.toString()))})},_=async(l,N,F=20)=>{u(!0);const{data:G}=await v.custom({url:"",method:"get",meta:{operation:"njiwaChannelsMessages",variables:{page:{value:l,type:"Int",required:!0},key:{value:N,type:"String",required:!1},pageSize:{value:F,type:"Int",required:!0}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","message",{channel:["id","name","code"]},{creator:["id","firstName","middleName","lastName","fullName"]},"messageCount","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(se=>({data:null})).then(se=>se);G&&r(G.results),u(!1),c(!1)},R=async l=>{r([l,...o]),b(!1)};return n.useEffect(()=>{_(1,"",20)},[]),e.jsxs(e.Fragment,{children:[e.jsxs(U,{children:[e.jsx(g,{span:14,children:e.jsx(j,{layout:"vertical",form:D,onFinish:l=>{c(!0),_(0,l.key,y)},children:e.jsx(j.Item,{name:"key",children:e.jsx(O,{size:"large",disabled:i,placeholder:"Search Channel Message(s)...",prefix:e.jsx($,{}),autoComplete:"off",autoFocus:!0,allowClear:!0})})})}),e.jsx(g,{span:6,style:{display:"flex",justifyContent:"flex-start"},children:e.jsx(E,{size:"large",icon:e.jsx($,{}),onClick:()=>{D.submit()},loading:i||t,disabled:i||t})}),e.jsx(g,{span:4,style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(ie,{title:"Click to Create Message",placement:"top",color:"green",children:e.jsx(E,{size:"large",icon:e.jsx(qe,{}),onClick:()=>{b(!0)},loading:i||t,disabled:i||t,style:{marginRight:30}})})})]}),e.jsx(xe,{spinning:t,children:e.jsx("div",{style:{maxHeight:a.dash?"69vh":"",overflowY:"auto"},children:e.jsxs(U,{align:"top",children:[o.length===0&&!t&&e.jsx(g,{span:24,style:{display:"flex",justifyContent:"center"},children:e.jsx(ce,{image:"/images/nodata.png",imageStyle:{height:160},description:e.jsx("span",{style:{fontSize:16},children:"No Message Found ..."})})}),o.map(l=>{var N;return e.jsx(g,{span:24,children:e.jsxs(M,{hoverable:l.isActive,style:{marginRight:10,marginBottom:3},children:[e.jsxs(Z,{style:{right:0,position:"absolute"},children:[l.dispatched?e.jsx(e.Fragment,{children:e.jsx(ie,{title:"Dispatched",placement:"top",color:"green",children:e.jsx(ze,{style:{color:"green"}})})}):e.jsx(e.Fragment,{children:e.jsx(ie,{title:"Not Dispatched",placement:"top",color:"red",children:e.jsx(Ae,{style:{color:"red"}})})}),e.jsx(le,{trigger:["click"],overlay:e.jsxs(T,{children:[e.jsx(T.Item,{icon:e.jsx(oe,{}),onClick:()=>{z(l.id)},disabled:!(l!=null&&l.canDelete),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Delete"})}),!l.dispatched&&e.jsx(T.Item,{icon:e.jsx(Se,{}),disabled:!(l!=null&&l.canDelete),children:e.jsx(je,{title:"Are you sure to Start Sending/Dispatching SMS?",onConfirm:()=>I(l.id),onCancel:()=>{},okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Dispatch"})})}),e.jsx(T.Item,{icon:e.jsx(Te,{}),disabled:!(l!=null&&l.canDelete),onClick:()=>w(l),children:e.jsx("a",{rel:"noopener noreferrer",children:"Dispatch Report"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:F=>F.preventDefault(),children:e.jsx(de,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})]}),e.jsxs(Z,{direction:"vertical",style:{width:"100%",justifyContent:"center"},onClick:()=>{},children:[e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Created By:"}),e.jsx("span",{style:{marginLeft:5},children:(N=l==null?void 0:l.creator)==null?void 0:N.fullName})]}),e.jsx("span",{children:l.message}),e.jsxs(Z,{direction:"horizontal",children:[e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Created On:"}),e.jsx("span",{style:{marginLeft:5},children:te(l.created).format("YYYY/MM/DD HH:MM")})]}),e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Channel:"}),e.jsxs("span",{style:{marginLeft:5},children:[l==null?void 0:l.channel.name,e.jsx("span",{style:{marginLeft:10},children:e.jsx(B,{color:"green",children:l==null?void 0:l.channel.code})})]})]}),e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Message Count:"}),e.jsx("span",{style:{marginLeft:5},children:e.jsx(B,{color:"green",children:l==null?void 0:l.messageCount})})]})]})]})]})})})]})})}),e.jsx(J,{title:"Dispatch Report",width:"50vw",open:V,onClose:l=>K(l),children:e.jsx(we,{randKey:Math.random(),channelMessage:s})}),e.jsx(J,{title:"Creating Message",open:Y,width:"40vw",onClose:l=>b(l),children:e.jsx(Qe,{onFinish:R})})]})},Je=a=>{const[o,r]=n.useState(!1),[s,m]=n.useState(),{push:t}=ee(),u=async()=>{r(!0);const{data:i}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolAnalytic",fields:["analytics"]}}).catch(c=>(x.error("Error fetching analytics"),{data:null})).then(c=>c);i&&m(i.analytics),r(!1)};return n.useEffect(()=>{u()},[a.randKey]),e.jsxs(e.Fragment,{children:[e.jsxs(U,{style:{display:"flex",justifyContent:"center"},children:[e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>{},children:e.jsx(M,{children:e.jsx(H,{title:"Balances (Units)",value:s==null?void 0:s.balances,precision:0,valueStyle:{color:"#3f8600"}})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>t("/njiwa/channels"),children:e.jsx(M,{children:e.jsx(H,{title:"Channels",value:s==null?void 0:s.channels,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>t("/njiwa/contacts/phonenumbers"),children:e.jsx(M,{children:e.jsx(H,{title:"Phone Numbers",value:s==null?void 0:s.phone_numbers,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>t("/njiwa/contacts/emails"),children:e.jsx(M,{children:e.jsx(H,{title:"Emails",value:s==null?void 0:s.emails,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>t("/njiwa/messages"),children:e.jsx(M,{children:e.jsx(H,{title:"Messages",value:s==null?void 0:s.messages,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>t("/njiwa/messages/sent"),children:e.jsx(M,{children:e.jsx(H,{title:"Pending Messages",value:s==null?void 0:s.sent_messages,precision:0,valueStyle:{color:"#770622"},prefix:e.jsx(be,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>t("/njiwa/messages/sent"),children:e.jsx(M,{children:e.jsx(H,{title:"Sent Messages",value:s==null?void 0:s.sent_messages,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>t("/njiwa/messages/failed"),children:e.jsx(M,{children:e.jsx(H,{title:"Failed Messages",value:s==null?void 0:s.failed_messages,precision:0,valueStyle:{color:"#861400"},prefix:e.jsx(be,{})})})})})]}),e.jsxs(U,{children:[e.jsx(g,{span:12,children:e.jsxs("div",{style:{marginTop:20},children:[e.jsx("span",{style:{fontSize:16,fontWeight:"bolder"},children:"Messages"}),e.jsx(Ie,{dash:!0})]})}),e.jsx(g,{span:12,children:e.jsx("div",{style:{marginTop:20},children:e.jsx(Be,{})})})]})]})},Ge=()=>e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa",children:"Home"})}),e.jsx("span",{children:"Channels"})]})}),e.jsx(Je,{})]}),Xe=()=>e.jsx(Ge,{}),{TextArea:Ze}=O,Fe=a=>{const o=async r=>{const{data:s}=await v.custom({url:"",method:"post",meta:{operation:"createNjiwaChannel",variables:{name:{value:r.name,type:"String",required:!0},description:{value:r.description,type:"String",required:!1}},fields:["success","message",{njiwaChannel:["id","name","description","code","icon","created","updated","isActive","canDelete","canEdit","canManage"]}]}}).catch(m=>(x.error("Error creating channel"),{data:null})).then(m=>m);s&&(s.success?(x.success(s.message),a.onFinish(s.njiwaChannel)):x.error(s.message))};return n.useEffect(()=>{},[a.randKey]),e.jsx(e.Fragment,{children:e.jsxs(j,{layout:"vertical",form:a.form,onFinish:r=>{o(r)},requiredMark:!0,children:[e.jsx(j.Item,{name:"name",label:"Name",rules:[{required:!0,type:"string",message:"Please input Channel Name ..."}],children:e.jsx(O,{size:"large",placeholder:"Enter Channel Name ..."})}),e.jsx(j.Item,{name:"description",label:"Description",rules:[{required:!1,type:"string",message:"Please input Description"}],children:e.jsx(Ze,{rows:4})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(E,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},{TextArea:es}=O,ss=a=>{const o=async r=>{var m;const{data:s}=await v.custom({url:"",method:"post",meta:{operation:"updateNjiwaChannel",variables:{channelId:{value:(m=a.channel)==null?void 0:m.id,type:"Int",required:!0},name:{value:r.name,type:"String",required:!0},description:{value:r.description,type:"String",required:!1}},fields:["success","message",{njiwaChannel:["id","name","description","code","icon","created","updated","isActive","canDelete","canEdit","canManage"]}]}}).catch(t=>(x.error("Error Updating channel"),{data:null})).then(t=>t);s&&(s.success?(x.success(s.message),a.onFinish(s.njiwaChannel)):x.error(s.message))};return n.useEffect(()=>{var r,s;a.form.setFieldsValue({name:(r=a.channel)==null?void 0:r.name,description:(s=a.channel)==null?void 0:s.description})},[a.randKey]),e.jsx(e.Fragment,{children:e.jsxs(j,{layout:"vertical",form:a.form,onFinish:r=>{o(r)},requiredMark:!0,autoComplete:"off",children:[e.jsx(j.Item,{name:"name",label:"Name",rules:[{required:!0,type:"string",message:"Please input Channel Name"}],children:e.jsx(O,{size:"large",placeholder:"Enter Channel Name ..."})}),e.jsx(j.Item,{name:"description",label:"Description",rules:[{required:!1,type:"string",message:"Please input Description"}],children:e.jsx(es,{rows:4,maxLength:6})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(E,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},ts=a=>{const[o,r]=n.useState([]),[s,m]=n.useState(),[t,u]=n.useState(!1),[i,c]=n.useState(!1),[y,L]=n.useState(0),[D,V]=n.useState(1),[K,Y]=n.useState(30),[b,w]=n.useState(""),{push:S}=ee(),[I,z]=n.useState(!1),[_,R]=n.useState(!1),[l]=j.useForm(),[N]=j.useForm(),[F]=j.useForm(),G=d=>{V(d),q(d,b,K)},se=d=>{m(d),R(!0)},ne=()=>{z(!0)},re=async d=>{r([d,...o]),l.resetFields(),z(!1)},ae=async d=>{const h=o.findIndex(f=>f.id===d.id);o[h]=d,r([...o]),N.resetFields(),R(!1)},p=async d=>{const{data:h}=await v.custom({url:"",method:"post",meta:{operation:"deleteNjiwaChannel",variables:{channelId:{value:d,type:"Int",required:!0}},fields:["success","message"]}}).catch(f=>(x.error(f.message),{data:null})).then(f=>f);h&&(h.success?(x.success(h.message),r(o.filter(f=>f.id.toString()!==d.toString()))):x.error(h.message))},k=d=>{pe.confirm({title:e.jsxs(e.Fragment,{children:["Deleting ",d.name," Channel"]}),icon:e.jsx(ge,{}),content:"Are you sure ...",okText:"Yes",cancelText:"Cancel",onOk:()=>p(parseInt(d.id.toString()))})},q=async(d,h,f=20)=>{u(!0);const{data:A}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannels",variables:{page:{value:d,type:"Int",required:!0},key:{value:h,type:"String",required:!1},pageSize:{value:f,type:"Int",required:!0}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","name","code","description","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(Q=>(x.error("Error fetching channels"),{data:null})).then(Q=>Q);A&&(L(A.total),r(A.results)),u(!1),c(!1)};return n.useEffect(()=>{q(1,b,K)},[a.randKey]),e.jsxs(e.Fragment,{children:[e.jsxs(U,{children:[e.jsx(g,{span:14,children:e.jsx(j,{layout:"vertical",form:F,onFinish:d=>{w(d.key),c(!0),q(0,d.key,K)},children:e.jsx(j.Item,{name:"key",children:e.jsx(O,{size:"large",disabled:i,placeholder:"Search Channel(s)...",prefix:e.jsx($,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(g,{span:6,style:{display:"flex",justifyContent:"flex-start"},children:e.jsx(E,{size:"large",icon:e.jsx($,{}),onClick:()=>{F.submit()},loading:i||t,disabled:i||t})}),e.jsx(g,{span:4,style:{display:"flex",justifyContent:"flex-end"},children:e.jsxs(E,{size:"large",disabled:t||i,onClick:()=>{l.resetFields(),ne()},children:[e.jsx(ue,{}),"Create Channel"]})})]}),e.jsxs(xe,{spinning:t,size:"large",children:[e.jsxs(U,{align:"top",children:[o.length===0&&!t&&e.jsx(g,{span:24,style:{display:"flex",justifyContent:"center"},children:e.jsx(ce,{image:"/images/nodata.png",imageStyle:{height:160},description:e.jsx("span",{style:{fontSize:16},children:"No Communication Channel Found ..."}),children:e.jsx(E,{type:"primary",onClick:()=>{l.resetFields(),ne()},children:"Create Channel Now"})})}),o.map(d=>e.jsx(g,{span:4,children:e.jsxs(M,{hoverable:d.isActive,style:{marginRight:10},children:[e.jsx(Z,{style:{right:0,position:"absolute"},children:e.jsx(le,{trigger:["click"],overlay:e.jsxs(T,{children:[e.jsx(T.Item,{icon:e.jsx(me,{}),onClick:()=>{se(d)},disabled:!(d!=null&&d.canDelete),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Edit"})}),e.jsx(T.Item,{icon:e.jsx(oe,{}),onClick:()=>{k(d)},disabled:!(d!=null&&d.canDelete),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Delete"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:h=>h.preventDefault(),children:e.jsx(de,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})}),e.jsx("a",{onClick:()=>S("/njiwa/channel/"+d.id+"/"+d.name),children:e.jsxs(Z,{direction:"vertical",align:"center",style:{width:"100%",justifyContent:"center"},onClick:()=>{},children:[e.jsx(ve,{size:{xs:24,sm:32,md:40,lg:40,xl:40,xxl:80},icon:e.jsx(Le,{}),src:d.icon}),e.jsx(ie,{title:d.name,children:d.name.length>10?d.name.substring(0,10)+"...":d.name}),e.jsx("span",{children:e.jsx(B,{color:"green",children:d.code})})]})})]})}))]}),o.length>0&&e.jsx(U,{style:{display:"flex",justifyContent:"center"},children:e.jsx("span",{style:{marginTop:20},children:e.jsx(Ke,{showQuickJumper:!0,showTotal:(d,h)=>`Total ${d} Channels`,defaultCurrent:D,total:y,pageSize:K,onChange:G,showSizeChanger:!0,onShowSizeChange:(d,h)=>{Y(h),q(d,b,h)},disabled:t||i})})})]}),e.jsx(J,{title:"Create Njiwa Channel",width:"40vw",open:I,onClose:d=>z(d),children:e.jsx(Fe,{form:l,randKey:Math.random(),onFinish:re})}),e.jsx(J,{title:"Edit "+(s==null?void 0:s.name)+" Channel",width:"40vw",open:_,onClose:d=>R(d),children:e.jsx(ss,{form:N,randKey:Math.random(),onFinish:ae,channel:s})})]})},ns=()=>e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:5,marginBottom:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa",children:"Home"})}),e.jsx("span",{children:"Channels"})]})}),e.jsx(ts,{randKey:Math.random()})]}),as=()=>e.jsx(ns,{}),rs=a=>(n.useEffect(()=>{},[a.randKey]),e.jsx(e.Fragment,{children:e.jsx("p",{children:"Channel Emails"})})),is=a=>{const[o,r]=n.useState(!1),[s,m]=n.useState(),t=X(),u=async()=>{r(!0);const{data:i}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannel",variables:{channelId:{value:parseInt(t.channelId),type:"Int",required:!0}},fields:["id","name","description","code","isActive","created","updated","canEdit","canDelete","canManage"]}}).catch(c=>(x.error("Error fetching channel"),{data:null})).then(c=>c);i&&m(i),r(!1)};return n.useEffect(()=>{u()},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:5,marginBottom:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa",children:"Home"})}),e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa/channels",children:"Channels"})}),e.jsx(C.Item,{children:e.jsxs(P,{to:"/njiwa/channel/"+(s==null?void 0:s.id)+"/"+(s==null?void 0:s.name),children:[s==null?void 0:s.name,e.jsx("span",{style:{marginLeft:10},children:e.jsx(B,{color:"green",children:s==null?void 0:s.code})})]})}),e.jsx("span",{children:"Emails"})]})}),e.jsx(rs,{randKey:Math.random(),channel:s})]})},ls=()=>e.jsx(is,{}),os=a=>(n.useEffect(()=>{},[a.randKey]),e.jsx(e.Fragment,{children:e.jsx("p",{children:"Channel Failed Messages"})})),ds=a=>{const[o,r]=n.useState(!1),[s,m]=n.useState(),t=X(),u=async()=>{r(!0);const{data:i}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannel",variables:{channelId:{value:parseInt(t.channelId),type:"Int",required:!0}},fields:["id","name","description","code","isActive","created","updated","canEdit","canDelete","canManage"]}}).catch(c=>(x.error("Error fetching channel"),{data:null})).then(c=>c);i&&m(i),r(!1)};return n.useEffect(()=>{u()},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa",children:"Home"})}),e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa/channels",children:"Channels"})}),e.jsx(C.Item,{children:e.jsxs(P,{to:"/njiwa/channel/"+(s==null?void 0:s.id)+"/"+(s==null?void 0:s.name),children:[s==null?void 0:s.name,e.jsx("span",{style:{marginLeft:10},children:e.jsx(B,{color:"green",children:s==null?void 0:s.code})})]})}),e.jsx(C.Item,{children:"Messages"}),e.jsx("span",{children:"Failed"})]})}),e.jsx(os,{randKey:Math.random(),channel:s})]})},cs=()=>e.jsx(ds,{}),{TextArea:hs}=O,us=a=>{const o=X(),r=async s=>{const{data:m}=await v.custom({url:"",method:"post",meta:{operation:"createNjiwaChannelMessage",variables:{channelId:{value:parseInt(o.channelId),type:"Int",required:!0},message:{value:s.message,type:"String",required:!1}},fields:["success","message",{njiwaChannelMessage:["id","message",{channel:["id","name","code"]},{creator:["id","firstName","middleName","lastName","fullName"]},"messageCount","created","updated","isActive","canDelete","canEdit","canManage"]}]}}).catch(t=>(x.error("Error creating channel message"),{data:null})).then(t=>t);m&&(m.success?(x.success(m.message),a.onFinish(m.njiwaChannelMessage)):x.error(m.message))};return n.useEffect(()=>{},[a.randKey]),e.jsx(e.Fragment,{children:e.jsxs(j,{layout:"vertical",form:a.form,onFinish:s=>{r(s)},requiredMark:!0,children:[e.jsx(j.Item,{name:"message",label:"Message",rules:[{required:!0,type:"string",message:"Please input Message"}],children:e.jsx(hs,{rows:4})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(E,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},{TextArea:ms}=O,xs=a=>{X();const o=async r=>{const{data:s}=await v.custom({url:"",method:"post",meta:{operation:"updateNjiwaChannelMessage",variables:{channelMessageId:{value:r.channel_message_id,type:"Int",required:!0},message:{value:r.message,type:"String",required:!1}},fields:["success","message",{njiwaChannelMessage:["id","message",{channel:["id","name","code"]},{creator:["id","firstName","middleName","lastName","fullName"]},"created","updated","isActive","canDelete","canEdit","canManage"]}]}}).catch(m=>(x.error("Error creating channel message"),{data:null})).then(m=>m);s&&(s.success?(x.success(s.message),a.onFinish(s.njiwaChannelMessage)):x.error(s.message))};return n.useEffect(()=>{var r;a.form.setFieldsValue({message:(r=a==null?void 0:a.channelMessage)==null?void 0:r.message})},[a.randKey]),e.jsx(e.Fragment,{children:e.jsxs(j,{layout:"vertical",form:a.form,onFinish:r=>{var s;r.channel_message_id=(s=a.channelMessage)==null?void 0:s.id,o(r)},requiredMark:!0,children:[e.jsx(j.Item,{name:"message",label:"Message",rules:[{required:!0,type:"string",message:"Please input Message"}],children:e.jsx(ms,{rows:4})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(E,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},js=a=>{const[o,r]=n.useState([]),[s,m]=n.useState(),[t,u]=n.useState(!1),[i,c]=n.useState(!1),[y,L]=n.useState(20);n.useState(""),ee();const[D,V]=n.useState(!1),[K,Y]=n.useState(!1),[b,w]=n.useState(!1),[S]=j.useForm(),[I]=j.useForm(),[z]=j.useForm(),_=X(),R=p=>{m(p),w(!0)},l=p=>{m(p),Y(!0)},N=()=>{V(!0)},F=async p=>{r([p,...o]),S.resetFields(),V(!1)},G=async p=>{r(o.map(k=>k.id.toString()===p.id.toString()?p:k)),I.resetFields(),Y(!1)},se=async p=>{const{data:k}=await v.custom({url:"",method:"post",meta:{operation:"deleteNjiwaChannelMessage",variables:{channelMessageId:{value:p,type:"Int",required:!0}},fields:["success","message"]}});k.success?(x.success(k.message),r(o.filter(q=>q.id.toString()!==p.toString()))):x.error(k.message)},ne=async p=>{x("dispatching");const{data:k}=await v.custom({url:"",method:"post",meta:{operation:"dispatchChannelMessage",variables:{channelMessageId:{value:p,type:"Int",required:!0}},fields:["success","message"]}}).catch(q=>(x.error(q.message),{data:null})).then(q=>q);k&&(k.success?x.success(k.message):x.error(k.message))},re=p=>{pe.confirm({title:"Deleting Njiwa Channel Message",icon:e.jsx(ge,{}),content:"Are you sure ...",okText:"Delete",cancelText:"Cancel",onOk:()=>se(parseInt(p.toString()))})},ae=async(p,k,q=20)=>{const{data:d}=await v.custom({url:"",method:"get",meta:{operation:"njiwaChannelMessages",variables:{page:{value:p,type:"Int",required:!0},key:{value:k,type:"String",required:!1},pageSize:{value:q,type:"Int",required:!1},channelId:{value:parseInt(_.channelId),type:"Int",required:!0}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","message",{channel:["id","name","code"]},{creator:["id","firstName","middleName","lastName","fullName"]},"messageCount","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(h=>(x.error("Failed to fetch Channel Messages"),{data:null})).then(h=>h);d&&r(d.results),u(!1),c(!1)};return n.useEffect(()=>{ae(1,"",20)},[a.randKey]),e.jsxs(e.Fragment,{children:[e.jsxs(U,{children:[e.jsx(g,{span:14,children:e.jsx(j,{layout:"vertical",form:z,onFinish:p=>{c(!0),ae(0,p.key,y)},children:e.jsx(j.Item,{name:"key",children:e.jsx(O,{size:"large",disabled:i,placeholder:"Search Channel Message(s)...",prefix:e.jsx($,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(g,{span:6,style:{display:"flex",justifyContent:"flex-start"},children:e.jsx(E,{size:"large",icon:e.jsx($,{}),onClick:()=>{z.submit()},loading:i||t,disabled:i||t})}),e.jsx(g,{span:4,style:{display:"flex",justifyContent:"flex-end"},children:e.jsxs(E,{size:"large",disabled:t||i,onClick:()=>{S.resetFields(),N()},children:[e.jsx(ue,{}),"Create Message"]})})]}),e.jsx(xe,{spinning:t,children:e.jsxs(U,{align:"top",children:[o.length===0&&!t&&e.jsx(g,{span:24,style:{display:"flex",justifyContent:"center"},children:e.jsx(ce,{image:"/images/nodata.png",imageStyle:{height:160},description:e.jsx("span",{style:{fontSize:16},children:"No Communication Channel Found ..."}),children:e.jsx(E,{type:"primary",onClick:()=>{S.resetFields(),N()},children:"Create Message"})})}),o.map(p=>{var k;return e.jsx(g,{span:24,children:e.jsxs(M,{hoverable:p.isActive,style:{marginRight:10},children:[e.jsx(Z,{style:{right:0,position:"absolute"},children:e.jsx(le,{trigger:["click"],overlay:e.jsxs(T,{children:[e.jsx(T.Item,{icon:e.jsx(me,{}),onClick:()=>{l(p)},disabled:!(p!=null&&p.canDelete),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Edit"})}),e.jsx(T.Item,{icon:e.jsx(oe,{}),onClick:()=>{re(p.id)},disabled:!(p!=null&&p.canDelete),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Delete"})}),e.jsx(T.Item,{icon:e.jsx(Se,{}),disabled:!(p!=null&&p.canDelete),children:e.jsx(je,{title:"Are you sure to Start Sending/Dispatching SMS?",onConfirm:()=>ne(p.id),onCancel:()=>{},okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Dispatch"})})}),e.jsx(T.Item,{icon:e.jsx(_e,{}),onClick:()=>{R(p)},disabled:!(p!=null&&p.canDelete),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Dispatch Report"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:q=>q.preventDefault(),children:e.jsx(de,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})}),e.jsxs(Z,{direction:"vertical",style:{width:"100%",justifyContent:"center"},onClick:()=>{},children:[e.jsx("span",{children:p.message}),e.jsxs(Z,{direction:"horizontal",children:[e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Created On:"}),e.jsx("span",{style:{marginLeft:5},children:te(p.created).format("YYYY/MM/DD HH:MM")})]}),e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Created By:"}),e.jsx("span",{style:{marginLeft:5},children:(k=p==null?void 0:p.creator)==null?void 0:k.fullName})]}),e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Channel:"}),e.jsx("span",{style:{marginLeft:5},children:p==null?void 0:p.channel.name})]}),e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Message Count:"}),e.jsx("span",{style:{marginLeft:5},children:e.jsx(B,{color:"green",children:p==null?void 0:p.messageCount})})]})]})]})]})})})]})}),e.jsx(J,{title:"Create Njiwa Channel Message",width:"40vw",open:D,onClose:p=>V(p),children:e.jsx(us,{form:S,randKey:Math.random(),onFinish:F})}),e.jsx(J,{title:"Edit Njiwa Channel Message",width:"40vw",open:K,onClose:p=>Y(p),children:e.jsx(xs,{form:I,randKey:Math.random(),onFinish:G,channelMessage:s})}),e.jsx(J,{title:"Dispatch Report",width:"50vw",open:b,onClose:p=>w(p),children:e.jsx(we,{randKey:Math.random(),channelMessage:s})})]})},ps=a=>{const[o,r]=n.useState(!1),[s,m]=n.useState(),t=X(),u=async()=>{r(!0);const{data:i}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannel",variables:{channelId:{value:parseInt(t.channelId),type:"Int",required:!0}},fields:["id","name","description","code","isActive","created","updated","canEdit","canDelete","canManage"]}}).catch(c=>(x.error("Error fetching channel"),{data:null})).then(c=>c);i&&m(i),r(!1)};return n.useEffect(()=>{u()},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa",children:"Home"})}),e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa/channels",children:"Channels"})}),e.jsx(C.Item,{children:e.jsxs(P,{to:"/njiwa/channel/"+(s==null?void 0:s.id)+"/"+(s==null?void 0:s.name),children:[s==null?void 0:s.name,e.jsx("span",{style:{marginLeft:10},children:e.jsx(B,{color:"green",children:s==null?void 0:s.code})})]})}),e.jsx("span",{children:"Messages"})]})}),e.jsx(js,{randKey:Math.random(),channel:s})]})},gs=()=>e.jsx(ps,{}),fs=a=>{const o=X(),{push:r}=ee(),[s,m]=n.useState(!1),[t,u]=n.useState(),i=async()=>{m(!0);const{data:c}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannelAnalytic",variables:{channelId:{value:parseInt(o.channelId),type:"Int",required:!0}},fields:["analytics"]}}).catch(y=>(x.error("Error fetching analytics"),{data:null})).then(y=>y);c&&u(c.analytics),m(!1)};return n.useEffect(()=>{i()},[a.randKey]),e.jsx(e.Fragment,{children:e.jsxs(U,{style:{display:"flex",justifyContent:"center",marginTop:10},children:[e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>{var c,y;return r("/njiwa/channel/"+((c=a.channel)==null?void 0:c.id)+"/"+((y=a.channel)==null?void 0:y.name)+"/phonenumbers")},children:e.jsx(M,{children:e.jsx(H,{title:"Phone Numbers",value:t==null?void 0:t.phone_numbers,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>{},children:e.jsx(M,{children:e.jsx(H,{title:"Emails",value:t==null?void 0:t.emails_addresses,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>{var c,y;return r("/njiwa/channel/"+((c=a.channel)==null?void 0:c.id)+"/"+((y=a.channel)==null?void 0:y.name)+"/messages")},children:e.jsx(M,{children:e.jsx(H,{title:"Messages",value:t==null?void 0:t.messages,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>{},children:e.jsx(M,{children:e.jsx(H,{title:"Pending Messages",value:t==null?void 0:t.pending_messages,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>{},children:e.jsx(M,{children:e.jsx(H,{title:"Sent Messages",value:t==null?void 0:t.sent_messages,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>{},children:e.jsx(M,{children:e.jsx(H,{title:"Failed Messages",value:t==null?void 0:t.failed_messages,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})})]})})},ys=a=>{const[o,r]=n.useState(!1),[s,m]=n.useState(),t=X(),u=async()=>{r(!0);const{data:i}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannel",variables:{channelId:{value:parseInt(t.channelId),type:"Int",required:!0}},fields:["id","name","description","code","isActive","created","updated","canEdit","canDelete","canManage"]}}).catch(c=>(x.error("Error fetching channel"),{data:null})).then(c=>c);i&&m(i),r(!1)};return n.useEffect(()=>{u()},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa",children:"Home"})}),e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa/channels",children:"Channels"})}),e.jsxs("span",{children:[s==null?void 0:s.name,e.jsx("span",{style:{marginLeft:10},children:e.jsx(B,{color:"green",children:s==null?void 0:s.code})})]})]})}),e.jsx(fs,{randKey:Math.random(),channel:s})]})},Cs=()=>e.jsx(ys,{}),{Option:bs}=he,ke=a=>{const[o,r]=n.useState([]),s=async t=>{const{data:u}=await v.custom({url:"",method:"post",meta:{operation:"createNjiwaChannelsPhoneNumber",variables:{phoneNumber:{value:t.phoneNumber,type:"String",required:!0},name:{value:t.name,type:"String",required:!1},channels:{value:t.channels,type:"[Int]",required:!0}},fields:["success","message"]}}).catch(i=>(x.error("Error creating channels phone number"),{data:null})).then(i=>i);u&&(u.success?(x.success(u.message),a.onFinish(u.njiwaChannel)):x.error(u.message))},m=async(t,u,i=20)=>{const{data:c}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannels",variables:{page:{value:t,type:"Int",required:!0},key:{value:u,type:"String",required:!1},pageSize:{value:i,type:"Int",required:!0}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","name","code","description","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(y=>(x.error("Error fetching channels"),{data:null})).then(y=>y);c&&r(c.results)};return n.useEffect(()=>{m(1,"",50)},[a.randKey]),e.jsx(e.Fragment,{children:e.jsxs(j,{layout:"vertical",form:a.form,onFinish:t=>{t.channels=t.channels.map(u=>parseInt(u)),s(t)},requiredMark:!0,autoComplete:"off",children:[e.jsx(j.Item,{name:"phoneNumber",label:"Phone Number",rules:[{required:!0,type:"string",message:"Please input Phone Number"}],children:e.jsx(O,{size:"large",placeholder:"Enter Phone Number ..."})}),e.jsx(j.Item,{name:"name",label:"Full Name",rules:[{required:!1,type:"string",message:"Please input Full Name"}],children:e.jsx(O,{size:"large",placeholder:"Enter Full Name ..."})}),e.jsx(j.Item,{name:"channels",label:"Channels",rules:[{required:!0,type:"array",message:"Please select Channel(s)..."}],children:e.jsx(he,{size:"large",mode:"multiple",allowClear:!0,style:{width:"100%"},placeholder:"Please select",defaultValue:[],dropdownStyle:{zIndex:9999},children:o.map(t=>e.jsxs(bs,{value:t.id,children:[t.name,e.jsx("span",{style:{marginLeft:5},children:e.jsx(B,{color:"green",children:t.code})})]},t.id))})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(E,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},Ee=a=>{const o=async r=>{var m;const{data:s}=await v.custom({url:"",method:"post",meta:{operation:"updateNjiwaPhoneNumber",variables:{phoneNumberId:{value:(m=a.phoneNumber)==null?void 0:m.id,type:"Int",required:!0},phoneNumber:{value:r.phoneNumber,type:"String",required:!0},name:{value:r.name,type:"String",required:!1}},fields:["success","message",{phoneNumber:["id","name","phoneNumber","countryCode",{carrier:["id","name"]},{user:["id","fullName","firstName","lastName"]},{owner:["id","fullName","firstName","lastName"]},"isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(t=>(x.error("Error Updating Phone number"),{data:null})).then(t=>t);s&&(s.success?(x.success(s.message),a.onFinish(s.phoneNumber)):x.error(s.message))};return n.useEffect(()=>{var r,s;a.form.setFieldsValue({phoneNumber:(r=a.phoneNumber)==null?void 0:r.phoneNumber,name:(s=a.phoneNumber)==null?void 0:s.name})},[a.randKey]),e.jsx(e.Fragment,{children:e.jsxs(j,{layout:"vertical",form:a.form,onFinish:r=>{o(r)},requiredMark:!0,autoComplete:"off",children:[e.jsx(j.Item,{name:"phoneNumber",label:"Phone Number",rules:[{required:!0,type:"string",message:"Please input Phone Number"}],children:e.jsx(O,{size:"large",placeholder:"Enter Phone Number ..."})}),e.jsx(j.Item,{name:"name",label:"Full Name",rules:[{required:!1,type:"string",message:"Please input Full Name"}],children:e.jsx(O,{size:"large",placeholder:"Enter Full Name ..."})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(E,{type:"primary",size:"large",htmlType:"submit",children:"Update"})})]})})},{Option:vs}=he,Ss=a=>Array.isArray(a)?a:a==null?void 0:a.fileList,Me=a=>{const[o,r]=n.useState([]),s=async t=>{const{data:u}=await v.custom({url:"",method:"post",meta:{operation:"uploadNjiwaChannelsPhoneNumbers",variables:{channels:{value:t.channels,type:"[Int]",required:!0},file:{value:t.file,type:"Upload",required:!0}},fields:["success","message"]}}).catch(i=>(x.error("Error creating channels phone number"),{data:null})).then(i=>i);u&&(u.success?(x.success(u.message),a.onFinish(u.njiwaChannel)):x.error(u.message))},m=async(t,u,i=20)=>{const{data:c}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannels",variables:{page:{value:t,type:"Int",required:!0},key:{value:u,type:"String",required:!1},pageSize:{value:i,type:"Int",required:!0}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","name","code","description","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(y=>(x.error("Error fetching channels"),{data:null})).then(y=>y);c&&r(c.results)};return n.useEffect(()=>{m(1,"",50)},[a.randKey]),e.jsxs(e.Fragment,{children:[e.jsx("span",{children:e.jsxs("a",{target:"_blank",href:Oe.base_url+"/static/templates/njiwa_channels_phone_numbers_template.xlsx",rel:"noreferrer",children:["Download Excel Template ",e.jsx(Ve,{})]})}),e.jsxs(j,{layout:"vertical",form:a.form,onFinish:t=>{t.channels=t.channels.map(u=>parseInt(u)),s(t)},requiredMark:!0,autoComplete:"off",children:[e.jsx(j.Item,{label:"Contacts File(Excel)",children:e.jsx(j.Item,{name:"file",valuePropName:"fileList",getValueFromEvent:Ss,noStyle:!0,rules:[{required:!0,type:"array",message:"Please upload students excel file"}],children:e.jsxs(Re.Dragger,{name:"file",accept:".xls, .xlsx",multiple:!1,beforeUpload:()=>!1,children:[e.jsx("p",{className:"ant-upload-drag-icon",children:e.jsx(He,{})}),e.jsx("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"}),e.jsx("p",{className:"ant-upload-hint",children:"Support for a single or bulk upload."})]})})}),e.jsx(j.Item,{name:"channels",label:"Channels",rules:[{required:!0,type:"array",message:"Please select Channel(s)..."}],children:e.jsx(he,{size:"large",mode:"multiple",allowClear:!0,style:{width:"100%"},placeholder:"Please select",defaultValue:[],dropdownStyle:{zIndex:9999},children:o.map(t=>e.jsxs(vs,{value:t.id,children:[t.name,e.jsx("span",{style:{marginLeft:5},children:e.jsx(B,{color:"green",children:t.code})})]},t.id))})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(E,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})]})},Ns=a=>{const[o,r]=n.useState([]),[s,m]=n.useState(),[t,u]=n.useState(!1),[i,c]=n.useState(!1),[y,L]=n.useState(20),[D,V]=n.useState(0),[K,Y]=n.useState("");ee();const[b,w]=n.useState(!1),[S,I]=n.useState(!1),[z,_]=n.useState(!1),[R]=j.useForm(),[l]=j.useForm(),[N]=j.useForm(),[F]=j.useForm(),G=X(),se=h=>{m(h),I(!0)},ne=()=>{w(!0)},re=async()=>{q(1,"",20),w(!1),R.resetFields()},ae=async h=>{r(o.map(f=>f.id.toString()===h.id.toString()?h:f)),l.resetFields(),I(!1)},p=async()=>{q(1,"",20),N.resetFields(),_(!1)},k=async h=>{const{data:f}=await v.custom({url:"",method:"post",meta:{operation:"deleteNjiwaChannel",variables:{id:{value:h,type:"Int",required:!0}},fields:["success","message"]}});f.success?(x.success(f.message),r(o.filter(A=>A.id.toString()!==h.toString()))):x.error(f.message)},q=async(h,f,A=20)=>{u(!0);const{data:Q}=await v.custom({url:"",method:"get",meta:{operation:"njiwaChannelPhoneNumbers",variables:{page:{value:h,type:"Int",required:!0},key:{value:f,type:"String",required:!1},pageSize:{value:A,type:"Int",required:!1},channelId:{value:parseInt(G.channelId),type:"Int",required:!0}},fields:["pages","total","page","hasNext","hasPrev",{results:["id",{phoneContact:["id","name","phoneNumber","countryCode",{carrier:["id","name"]},{user:["id","fullName","firstName","lastName"]},{owner:["id","fullName","firstName","lastName"]}]},"isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(Ce=>(x.error("Error fetching phone numbers"),{data:null})).then(Ce=>Ce);Q&&(V(Q.total),r(Q.results)),u(!1),c(!1)},d=[{title:"Phone Number",dataIndex:"phoneNumber",key:"phoneNumber",render:(h,f,A)=>e.jsx("a",{onClick:()=>{},children:f.phoneContact.phoneNumber})},{title:"Full Name",dataIndex:"fullName",key:"name",render:(h,f,A)=>e.jsx("span",{children:f.phoneContact.name})},{title:"Carrier",dataIndex:"carrier",key:"carrier",render:(h,f,A)=>{var Q;return e.jsx(B,{color:"green",children:(Q=f.phoneContact.carrier)==null?void 0:Q.name})}},{title:"Created",dataIndex:"created",key:"created",render:(h,f,A)=>e.jsx(ie,{title:te(f.created).format("Y-mm-d hh:mm:ss"),children:e.jsx("span",{children:te(f.created).format("Y-mm-d hh:mm:ss")})})},{title:"",dataIndex:"Action",key:"action",render:(h,f,A)=>e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(le,{trigger:["click"],overlay:e.jsxs(T,{children:[e.jsx(T.Item,{disabled:!f.canDelete,icon:e.jsx(oe,{}),onClick:()=>{},children:e.jsx(je,{placement:"topLeft",title:"Deleting Phone Number",onConfirm:()=>k(parseInt(f.id)),okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Delete"})})}),e.jsx(T.Item,{disabled:!f.canEdit,icon:e.jsx(me,{}),onClick:()=>se(f),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Edit"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:Q=>Q.preventDefault(),children:e.jsx(de,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})})}];return n.useEffect(()=>{q(1,"",20)},[]),e.jsxs(e.Fragment,{children:[e.jsxs(U,{children:[e.jsx(g,{span:8,children:e.jsx(j,{layout:"vertical",form:F,onFinish:h=>{c(!0),q(0,h.key,y)},children:e.jsx(j.Item,{name:"key",children:e.jsx(O,{size:"large",disabled:i,placeholder:"Search Phone Number(s)...",prefix:e.jsx($,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(g,{span:6,style:{display:"flex",justifyContent:"flex-start"},children:e.jsx(E,{size:"large",icon:e.jsx($,{}),onClick:()=>{F.submit()},loading:i||t,disabled:i||t})}),e.jsxs(g,{span:10,style:{display:"flex",justifyContent:"flex-end"},children:[e.jsx(E,{size:"large",disabled:t||i,onClick:()=>{R.resetFields(),ne()},icon:e.jsx(ue,{}),children:"Add Phone Number"}),e.jsx(E,{size:"large",disabled:t||i,onClick:()=>_(!0),icon:e.jsx(Ne,{}),children:"Upload Phone Numbers"})]})]}),e.jsx(ye,{loading:t,columns:d,dataSource:o,pagination:{onChange:(h,f)=>{L(f),q(h,K,f)},total:D,pageSize:y,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0}}),e.jsx(J,{title:"Adding Phone Number",width:"40vw",open:b,onCancel:h=>w(h),children:e.jsx(ke,{form:R,onFinish:re,randKey:Math.random()})}),e.jsx(J,{title:"Editting Phone Number",width:"40vw",open:S,onClose:h=>I(h),children:e.jsx(Ee,{form:l,onFinish:ae,randKey:Math.random()})}),e.jsx(J,{title:"Uploading Phone Numbers",width:"40vw",open:z,onClose:h=>_(h),children:e.jsx(Me,{form:N,onFinish:p,randKey:Math.random()})})]})},ws=a=>{const[o,r]=n.useState(!1),[s,m]=n.useState(),t=X(),u=async()=>{r(!0);const{data:i}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannel",variables:{channelId:{value:parseInt(t.channelId),type:"Int",required:!0}},fields:["id","name","description","code","isActive","created","updated","canEdit","canDelete","canManage"]}}).catch(c=>(x.error("Error fetching channel"),{data:null})).then(c=>c);i&&m(i),r(!1)};return n.useEffect(()=>{u()},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa",children:"Home"})}),e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa/channels",children:"Channels"})}),e.jsx(C.Item,{children:e.jsxs(P,{to:"/njiwa/channel/"+(s==null?void 0:s.id)+"/"+(s==null?void 0:s.name),children:[s==null?void 0:s.name,e.jsx("span",{style:{marginLeft:10},children:e.jsx(B,{color:"green",children:s==null?void 0:s.code})})]})}),e.jsx("span",{children:"Phone Numbers"})]})}),e.jsx(Ns,{randKey:Math.random(),channel:s})]})},Is=()=>e.jsx(ws,{}),Fs=a=>(n.useEffect(()=>{},[a.randKey]),e.jsx(e.Fragment,{children:e.jsx("p",{children:"Channel Sent Messages"})})),ks=a=>{const[o,r]=n.useState(!1),[s,m]=n.useState(),t=X(),u=async()=>{r(!0);const{data:i}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannel",variables:{channelId:{value:parseInt(t.channelId),type:"Int",required:!0}},fields:["id","name","description","code","isActive","created","updated","canEdit","canDelete","canManage"]}}).catch(c=>(x.error("Error fetching channel"),{data:null})).then(c=>c);i&&m(i),r(!1)};return n.useEffect(()=>{u()},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa",children:"Home"})}),e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa/channels",children:"Channels"})}),e.jsx(C.Item,{children:e.jsxs(P,{to:"/njiwa/channel/"+(s==null?void 0:s.id)+"/"+(s==null?void 0:s.name),children:[s==null?void 0:s.name,e.jsx("span",{style:{marginLeft:10},children:e.jsx(B,{color:"green",children:s==null?void 0:s.code})})]})}),e.jsx(C.Item,{children:"Messages"}),e.jsx("span",{children:"Sent"})]})}),e.jsx(Fs,{randKey:Math.random(),channel:s})]})},Es=()=>e.jsx(ks,{}),Ms=a=>{const[o,r]=n.useState([]),[s,m]=n.useState(),[t,u]=n.useState(!1),[i,c]=n.useState(!1),[y,L]=n.useState(20);n.useState(""),ee();const[D,V]=n.useState(!1),[K,Y]=n.useState(!1),[b]=j.useForm();j.useForm();const[w]=j.useForm(),S=l=>{m(l),Y(!0)},I=()=>{V(!0)},z=async l=>{const{data:N}=await v.custom({url:"",method:"post",meta:{operation:"deleteNjiwaChannel",variables:{id:{value:l,type:"Int",required:!0}},fields:["success","message"]}});N.success?(x.success(N.message),r(o.filter(F=>F.id.toString()!==l.toString()))):x.error(N.message)},_=l=>{pe.confirm({title:"Deleting Njiwa Email Address",icon:e.jsx(ge,{}),content:"Are you sure ...",okText:"Delete",cancelText:"Cancel",onOk:()=>z(parseInt(l.toString()))})},R=async(l,N,F=20)=>{const{data:G}=await v.custom({url:"",method:"get",meta:{operation:"njiwaChannels",variables:{control:{value:!0,type:"Boolean",required:!0}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","name","icon","description","isActive","created","updated","canEdit","canDelete","canManage"]}]}});r(G.results),u(!1),c(!1)};return n.useEffect(()=>{R(1,"",20)},[]),e.jsxs(e.Fragment,{children:[e.jsxs(U,{children:[e.jsx(g,{span:14,children:e.jsx(j,{layout:"vertical",form:w,onFinish:l=>{c(!0),R(0,l.key,y)},children:e.jsx(j.Item,{name:"key",children:e.jsx(O,{size:"large",disabled:i,placeholder:"Search Channel(s)...",prefix:e.jsx($,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(g,{span:6,style:{display:"flex",justifyContent:"flex-start"},children:e.jsx(E,{size:"large",icon:e.jsx($,{}),onClick:()=>{w.submit()},loading:i||t,disabled:i||t})}),e.jsx(g,{span:4,style:{display:"flex",justifyContent:"flex-end"},children:e.jsxs(E,{size:"large",disabled:t||i,onClick:()=>{},children:[e.jsx(ue,{}),"Add Email Address"]})})]}),e.jsxs(U,{align:"top",children:[o.length===0&&e.jsx(g,{span:24,style:{display:"flex",justifyContent:"center"},children:e.jsx(ce,{image:"images/nodata.png",imageStyle:{height:160},description:e.jsx("span",{style:{fontSize:16},children:"No Communication Channel Found ..."}),children:e.jsx(E,{type:"primary",onClick:()=>{b.resetFields(),I()},children:"Create Email Address Now"})})}),o.map(l=>e.jsx(g,{span:4,children:e.jsxs(M,{hoverable:l.isActive,style:{marginRight:10},children:[e.jsx(Z,{style:{right:0,position:"absolute"},children:e.jsx(le,{trigger:["click"],overlay:e.jsxs(T,{children:[e.jsx(T.Item,{icon:e.jsx(me,{}),onClick:()=>{S(l)},disabled:!(l!=null&&l.canDelete),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Edit"})}),e.jsx(T.Item,{icon:e.jsx(oe,{}),onClick:()=>{_(l.id)},disabled:!(l!=null&&l.canDelete),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Delete"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:N=>N.preventDefault(),children:e.jsx(de,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})}),e.jsx(Z,{direction:"vertical",align:"center",style:{width:"100%",justifyContent:"center"},onClick:()=>{},children:l.emailAddress})]})}))]}),e.jsx(J,{title:"Create Njiwa Email Address",width:"40vw",open:D,onClose:l=>V(l),children:e.jsx(Fe,{})})]})},Ps=()=>e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa",children:"Home"})}),e.jsx("span",{children:"Emails Addresses"})]})}),e.jsx(Ms,{})]}),Ds=()=>e.jsx(Ps,{}),qs=()=>e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa",children:"Home"})}),e.jsx("span",{children:"Messages"})]})}),e.jsx(Ie,{})]}),zs=()=>e.jsx(qs,{}),As=a=>(n.useEffect(()=>{},[]),e.jsx(e.Fragment,{children:e.jsx("span",{children:"Settings"})})),Ts=()=>e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa",children:"Home"})}),e.jsx("span",{children:"Settings"})]})}),e.jsx(As,{})]}),Ls=()=>e.jsx(Ts,{}),Ks=a=>{const[o,r]=n.useState([]),[s,m]=n.useState(),[t,u]=n.useState(!1),[i,c]=n.useState(!1),[y,L]=n.useState(20),[D,V]=n.useState(0),[K,Y]=n.useState("");ee();const[b,w]=n.useState(!1),[S,I]=n.useState(!1),[z,_]=n.useState(!1),[R]=j.useForm(),[l]=j.useForm(),[N]=j.useForm(),[F]=j.useForm(),G=d=>{m(d),I(!0)},se=()=>{w(!0)},ne=async()=>{k(1,"",20),w(!1),R.resetFields()},re=async d=>{r(o.map(h=>h.id.toString()===d.id.toString()?d:h)),l.resetFields(),I(!1)},ae=async()=>{k(1,"",20),N.resetFields(),_(!1)},p=async d=>{const{data:h}=await v.custom({url:"",method:"post",meta:{operation:"deleteNjiwaChannel",variables:{id:{value:d,type:"Int",required:!0}},fields:["success","message"]}});h.success?(x.success(h.message),r(o.filter(f=>f.id.toString()!==d.toString()))):x.error(h.message)},k=async(d,h,f=20)=>{u(!0);const{data:A}=await v.custom({url:"",method:"get",meta:{operation:"njiwaChannelsPhoneContacts",variables:{page:{value:d,type:"Int",required:!0},key:{value:h,type:"String",required:!1},pageSize:{value:f,type:"Int",required:!1}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","name","phoneNumber","countryCode",{carrier:["id","name"]},{user:["id","fullName","firstName","lastName"]},{owner:["id","fullName","firstName","lastName"]},"isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(Q=>(x.error("Error fetching phone numbers"),{data:null})).then(Q=>Q);A&&(V(A.total),r(A.results)),u(!1),c(!1)},q=[{title:"Phone Number",dataIndex:"phoneNumber",key:"phoneNumber",render:(d,h,f)=>e.jsx("a",{onClick:()=>{},children:h.phoneNumber})},{title:"Full Name",dataIndex:"fullName",key:"name",render:(d,h,f)=>e.jsx("span",{children:h.name})},{title:"Carrier",dataIndex:"carrier",key:"carrier",render:(d,h,f)=>{var A;return e.jsx(B,{color:"green",children:(A=h.carrier)==null?void 0:A.name})}},{title:"Created",dataIndex:"created",key:"created",render:(d,h,f)=>e.jsx(ie,{title:te(h.created).format("Y-mm-d hh:mm:ss"),children:e.jsx("span",{children:te(h.created).format("Y-mm-d hh:mm:ss")})})},{title:"",dataIndex:"Action",key:"action",render:(d,h,f)=>e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(le,{trigger:["click"],overlay:e.jsxs(T,{children:[e.jsx(T.Item,{disabled:!h.canDelete,icon:e.jsx(oe,{}),onClick:()=>{},children:e.jsx(je,{placement:"topLeft",title:"Deleting Phone Number",onConfirm:()=>p(parseInt(h.id)),okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Delete"})})}),e.jsx(T.Item,{disabled:!h.canEdit,icon:e.jsx(me,{}),onClick:()=>G(h),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Edit"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:A=>A.preventDefault(),children:e.jsx(de,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})})}];return n.useEffect(()=>{k(1,"",20)},[]),e.jsxs(e.Fragment,{children:[e.jsxs(U,{children:[e.jsx(g,{span:8,children:e.jsx(j,{layout:"vertical",form:F,onFinish:d=>{c(!0),k(0,d.key,y)},children:e.jsx(j.Item,{name:"key",children:e.jsx(O,{size:"large",disabled:i,placeholder:"Search Phone Number(s)...",prefix:e.jsx($,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(g,{span:6,style:{display:"flex",justifyContent:"flex-start"},children:e.jsx(E,{size:"large",icon:e.jsx($,{}),onClick:()=>{F.submit()},loading:i||t,disabled:i||t})}),e.jsxs(g,{span:10,style:{display:"flex",justifyContent:"flex-end"},children:[e.jsx(E,{size:"large",disabled:t||i,onClick:()=>{R.resetFields(),se()},icon:e.jsx(ue,{}),children:"Add Phone Number"}),e.jsx(E,{size:"large",disabled:t||i,onClick:()=>_(!0),icon:e.jsx(Ne,{}),children:"Upload Phone Numbers"})]})]}),e.jsx(ye,{loading:t,columns:q,dataSource:o,pagination:{onChange:(d,h)=>{L(h),k(d,K,h)},total:D,pageSize:y,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0}}),e.jsx(J,{title:"Adding Phone Number",width:"40vw",open:b,onClose:d=>w(d),children:e.jsx(ke,{form:R,onFinish:ne,randKey:Math.random()})}),e.jsx(J,{title:"Editting Phone Number",width:"40vw",open:S,onClose:d=>I(d),children:e.jsx(Ee,{phoneNumber:s,form:l,onFinish:re,randKey:Math.random()})}),e.jsx(J,{title:"Uploading Phone Numbers",width:"40vw",open:z,onClose:d=>_(d),children:e.jsx(Me,{form:N,onFinish:ae,randKey:Math.random()})})]})},_s=()=>e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa",children:"Home"})}),e.jsx("span",{children:"Phone Numbers"})]})}),e.jsx(Ks,{})]}),Os=()=>e.jsx(_s,{}),Ys=a=>{const{page:o}=a;return o==="PhoneNumbersPage"?e.jsx(Os,{}):o==="NjiwaSettingsPage"?e.jsx(Ls,{}):o==="MessagesPage"?e.jsx(zs,{}):o==="EmailsPage"?e.jsx(Ds,{}):o==="ChannelSentMessagesPage"?e.jsx(Es,{}):o==="ChannelPhoneNumbersPage"?e.jsx(Is,{}):o==="ChannelPage"?e.jsx(Cs,{}):o==="ChannelMessagesPage"?e.jsx(gs,{}):o==="ChannelFailedMessagesPage"?e.jsx(cs,{}):o==="ChannelEmailsPage"?e.jsx(ls,{}):o==="ChannelsPage"?e.jsx(as,{}):o==="NjiwaDashboardPage"?e.jsx(Xe,{}):e.jsx("div",{children:"Page not found ..."})};export{Ys as NjiwaPages};
