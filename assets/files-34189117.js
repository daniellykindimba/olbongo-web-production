import{bF as ue,bG as me,bD as ge,bH as Se,bR as K,w as M,bt as H,r,bC as fe,b4 as he,j as e,bP as oe,bQ as xe,ch as ye,aT as v,aW as re,aP as P,a1 as V,aY as we,cl as _,g as A,cT as ie,_ as w,cz as ze,F as Te,af as Z,av as I,hI as ke,hJ as Be,c as Re,u as $e,B as ne,P as Oe}from"./index-3f04361d.js";import{F as Ie}from"./file_item_component-df3ee82e.js";import{U as Me,a as Ue}from"./upload_folder-ae6f9119.js";import{D as We}from"./index-175890ae.js";import{f as Ne}from"./data_objects-54e2a4fd.js";import{F as Le}from"./files_component-250e296a.js";import{a as Ee}from"./index.esm-b130f790.js";import{G as ve}from"./index-5989b58d.js";import{C as je}from"./index-2ac5d61b.js";import{P as de}from"./index-f2761152.js";import{A as Pe}from"./index-cf6a1b0b.js";import{U as ee}from"./UploadOutlined-9d0e8003.js";import{F as De}from"./FolderOutlined-9b7df1a3.js";import{S as ce}from"./SearchOutlined-ca526dda.js";import{F as Ge}from"./FolderOpenOutlined-6fe92a4c.js";import"./index-7257294e.js";import"./defineProperty-70760e04.js";import"./pdf_document_viewer-d887b6d5.js";import"./SecurityScanOutlined-7fd5068a.js";import"./index-9f7d3fdf.js";import"./EditOutlined-401a1613.js";import"./transButton-953f01b7.js";import"./index-464f1c81.js";import"./index-a638a95e.js";import"./index-094fff42.js";import"./index-926c2b48.js";import"./index-d173ba39.js";import"./Image-6bd0bf5e.js";import"./DialogWrap-baa689d5.js";import"./ZoomOutOutlined-4d40b3b9.js";import"./index-0a6ac51b.js";import"./fade-4604162d.js";import"./DeleteOutlined-dd5d4858.js";import"./DeleteOutlined-25685737.js";import"./DownloadOutlined-f5329528.js";import"./DownloadOutlined-6cd35f11.js";import"./InfoCircleOutlined-95ab394c.js";import"./MoreOutlined-d3af1bd1.js";import"./SaveOutlined-da5df35c.js";import"./index-367510e2.js";import"./InfoCircleFilled-cf97344e.js";import"./InfoCircleFilled-baaa675e.js";import"./index-a3665076.js";import"./Upload-875c30fd.js";import"./InboxOutlined-dcbb37bd.js";import"./index-39a814b8.js";import"./useNotification-c00c2ab5.js";import"./index-a52eff82.js";import"./localeData-ee81be6c.js";import"./SinglePicker-8226d477.js";import"./index-983365c0.js";import"./useMutateObserver-f4657bd8.js";import"./index-ee5ddf71.js";import"./InputNumber-baf1c013.js";import"./Rate-7f164c2b.js";import"./index-74485df2.js";import"./index-0f874ea4.js";import"./ActionButton-1fdd8a6f.js";import"./SmileOutlined-ba261cab.js";import"./ExclamationCircleOutlined-dc1ce38f.js";import"./iconBase-aff00a5a.js";import"./Skeleton-4286ac29.js";import"./DotChartOutlined-f39c986e.js";function Ae(t){return me("MuiToggleButton",t)}const qe=ue("MuiToggleButton",["root","disabled","selected","standard","primary","secondary","sizeSmall","sizeMedium","sizeLarge"]),pe=qe,He=["children","className","color","disabled","disableFocusRipple","fullWidth","onChange","onClick","selected","size","value"],_e=t=>{const{classes:o,fullWidth:l,selected:d,disabled:x,size:y,color:z}=t,m={root:["root",d&&"selected",x&&"disabled",l&&"fullWidth",`size${K(y)}`,z]};return xe(m,Ae,o)},Ve=ge(Se,{name:"MuiToggleButton",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:l}=t;return[o.root,o[`size${K(l.size)}`]]}})(({theme:t,ownerState:o})=>{let l=o.color==="standard"?t.palette.text.primary:t.palette[o.color].main,d;return t.vars&&(l=o.color==="standard"?t.vars.palette.text.primary:t.vars.palette[o.color].main,d=o.color==="standard"?t.vars.palette.text.primaryChannel:t.vars.palette[o.color].mainChannel),M({},t.typography.button,{borderRadius:(t.vars||t).shape.borderRadius,padding:11,border:`1px solid ${(t.vars||t).palette.divider}`,color:(t.vars||t).palette.action.active},o.fullWidth&&{width:"100%"},{[`&.${pe.disabled}`]:{color:(t.vars||t).palette.action.disabled,border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`},"&:hover":{textDecoration:"none",backgroundColor:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:H(t.palette.text.primary,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${pe.selected}`]:{color:l,backgroundColor:t.vars?`rgba(${d} / ${t.vars.palette.action.selectedOpacity})`:H(l,t.palette.action.selectedOpacity),"&:hover":{backgroundColor:t.vars?`rgba(${d} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:H(l,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${d} / ${t.vars.palette.action.selectedOpacity})`:H(l,t.palette.action.selectedOpacity)}}}},o.size==="small"&&{padding:7,fontSize:t.typography.pxToRem(13)},o.size==="large"&&{padding:15,fontSize:t.typography.pxToRem(15)})}),Ke=r.forwardRef(function(o,l){const d=fe({props:o,name:"MuiToggleButton"}),{children:x,className:y,color:z="standard",disabled:m=!1,disableFocusRipple:T=!1,fullWidth:h=!1,onChange:j,onClick:k,selected:U,size:p="medium",value:b}=d,F=he(d,He),g=M({},d,{color:z,disabled:m,disableFocusRipple:T,fullWidth:h,size:p}),C=_e(g),W=i=>{k&&(k(i,b),i.defaultPrevented)||j&&j(i,b)};return e.jsx(Ve,M({className:oe(C.root,y),disabled:m,focusRipple:!T,ref:l,onClick:W,onChange:j,value:b,ownerState:g,"aria-pressed":U},F,{children:x}))}),te=Ke;function Ye(t,o){return o===void 0||t===void 0?!1:Array.isArray(o)?o.indexOf(t)>=0:t===o}function Je(t){return me("MuiToggleButtonGroup",t)}const Qe=ue("MuiToggleButtonGroup",["root","selected","vertical","disabled","grouped","groupedHorizontal","groupedVertical"]),$=Qe,Xe=["children","className","color","disabled","exclusive","fullWidth","onChange","orientation","size","value"],Ze=t=>{const{classes:o,orientation:l,fullWidth:d,disabled:x}=t,y={root:["root",l==="vertical"&&"vertical",d&&"fullWidth"],grouped:["grouped",`grouped${K(l)}`,x&&"disabled"]};return xe(y,Je,o)},et=ge("div",{name:"MuiToggleButtonGroup",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:l}=t;return[{[`& .${$.grouped}`]:o.grouped},{[`& .${$.grouped}`]:o[`grouped${K(l.orientation)}`]},o.root,l.orientation==="vertical"&&o.vertical,l.fullWidth&&o.fullWidth]}})(({ownerState:t,theme:o})=>M({display:"inline-flex",borderRadius:(o.vars||o).shape.borderRadius},t.orientation==="vertical"&&{flexDirection:"column"},t.fullWidth&&{width:"100%"},{[`& .${$.grouped}`]:M({},t.orientation==="horizontal"?{"&:not(:first-of-type)":{marginLeft:-1,borderLeft:"1px solid transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0},"&:not(:last-of-type)":{borderTopRightRadius:0,borderBottomRightRadius:0},[`&.${$.selected} + .${$.grouped}.${$.selected}`]:{borderLeft:0,marginLeft:0}}:{"&:not(:first-of-type)":{marginTop:-1,borderTop:"1px solid transparent",borderTopLeftRadius:0,borderTopRightRadius:0},"&:not(:last-of-type)":{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`&.${$.selected} + .${$.grouped}.${$.selected}`]:{borderTop:0,marginTop:0}})})),tt=r.forwardRef(function(o,l){const d=fe({props:o,name:"MuiToggleButtonGroup"}),{children:x,className:y,color:z="standard",disabled:m=!1,exclusive:T=!1,fullWidth:h=!1,onChange:j,orientation:k="horizontal",size:U="medium",value:p}=d,b=he(d,Xe),F=M({},d,{disabled:m,fullWidth:h,orientation:k,size:U}),g=Ze(F),C=(i,B)=>{if(!j)return;const O=p&&p.indexOf(B);let R;p&&O>=0?(R=p.slice(),R.splice(O,1)):R=p?p.concat(B):[B],j(i,R)},W=(i,B)=>{j&&j(i,p===B?null:B)};return e.jsx(et,M({role:"group",className:oe(g.root,y),ref:l,ownerState:F},b,{children:r.Children.map(x,i=>r.isValidElement(i)?r.cloneElement(i,{className:oe(g.grouped,i.props.className),onChange:T?W:C,selected:i.props.selected===void 0?Ye(i.props.value,p):i.props.selected,size:i.props.size||U,fullWidth:h,color:i.props.color||z,disabled:i.props.disabled||m}):null)}))}),ot=tt,rt=ye(e.jsx("path",{d:"m9.17 6 2 2H20v10H4V6h5.17M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"}),"FolderOutlined"),st=ye(e.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),"SearchOutlined"),at=()=>{const[t,o]=r.useState(""),[l,d]=r.useState(10),[x,y]=r.useState(0),[z,m]=r.useState(0),[T,h]=r.useState(1),[j,k]=r.useState(!1),[U,p]=r.useState(!1),[b,F]=r.useState([]),[g,C]=r.useState(null);r.useState(!1),r.useState(!1);const[W,i]=r.useState(!1),O=!ve.useBreakpoint().lg,[R]=v.useForm(),[q]=v.useForm(),D=async s=>{const{data:n}=await A.custom({url:"",method:"post",meta:{operation:"deleteFolder",variables:{folderId:{value:parseInt(s.id.toString()),type:"Int",required:!0}},fields:["success","message"]}}).catch(()=>(w.remove(),w.error("Error deleting folder"),{data:null})).then(u=>u);if(n){w.success(n.message);const u=b.filter(c=>c.id!==s.id);F(u)}},Y=async(s,n)=>{const{data:u}=await A.custom({url:"",method:"post",meta:{operation:"renameFolder",variables:{folderId:{value:parseInt(s.id.toString()),type:"Int",required:!0},name:{value:n,type:"String",required:!0}},fields:["success","message",{folder:["id","name","totalFiles","totalSize","canDelete","canEdit","canManage","isActive","created","updated",{author:ie}]}]}}).catch(()=>(w.remove(),w.error("Error renaming folder"),{data:null})).then(c=>c);if(u){w.success(u.message);const c=b.map(f=>f.id===s.id?u.folder:f);F(c)}},N=async(s,n="",u=25)=>{p(!0);const{data:c}=await A.custom({url:"",method:"get",meta:{operation:"myFolders",variables:{page:{value:s,type:"Int",required:!0},key:{value:n,type:"String",required:!1},pageSize:{value:u,type:"Int",required:!0}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","totalFiles","totalSize","canDelete","canEdit","canManage","isActive","created","updated",{author:ie}]}]}}).catch(f=>(w.remove(),w.error("Error getting files"),console.error(f),{data:null})).then(f=>f);c&&(y(c.total),m(c.pages),h(c.page),k(c.hasNext),F(c.results)),p(!1)},G=s=>{C(s)},se=s=>{C(s)},J=s=>{C(s),i(!0)},Q=[{title:"Name",dataIndex:"name",key:"name",render:(s,n)=>e.jsx(ze,{to:"/odrive/folder/"+n.id+"/"+n.name+"/files",children:e.jsx("a",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5,cursor:"pointer",color:"#333",transition:"all 0.3s"},children:[e.jsx(rt,{}),s]})})})},{title:"Total Files",dataIndex:"totalFiles",key:"totalFiles"},{title:"Total Size",dataIndex:"totalSize",key:"totalSize"},{title:"",key:"action",render:(s,n)=>e.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end"},children:e.jsxs(Te,{gap:"small",wrap:"wrap",children:[e.jsx(Z,{title:"Share folder",children:e.jsx(I,{type:"primary",shape:"circle",icon:e.jsx(Ee,{}),size:"small",onClick:()=>{J(n)}})}),e.jsx(Z,{title:"Delete folder",children:e.jsx(de,{title:"Are you sure you want to delete this folder?",description:"This action cannot be undone, all files in this folder will be deleted too.",onConfirm:()=>{D(n)},okText:"Yes",cancelText:"No",children:e.jsx(I,{type:"primary",shape:"circle",icon:e.jsx(ke,{}),size:"small",onClick:()=>{G(n)}})})}),e.jsx(Z,{title:"Rename folder",children:e.jsx(de,{title:"Are you sure you want to rename this folder?",description:e.jsx(v,{form:q,initialValues:{name:g==null?void 0:g.name},onFinish:u=>{console.log(u),Y(n,u.name)},children:e.jsx(v.Item,{name:"name",children:e.jsx(V,{placeholder:"Enter new folder name"})})}),onConfirm:()=>{q.submit()},okText:"Yes",cancelText:"No",onOpenChange:u=>{u||C(null)},children:e.jsx(I,{type:"primary",shape:"circle",icon:e.jsx(Be,{}),size:"small",onClick:()=>{se(n)}})})})]})})}];return r.useEffect(()=>{N(T,t,l)},[]),e.jsxs("div",{style:{marginTop:5},children:[e.jsx("div",{style:{paddingTop:10,paddingBottom:0},children:e.jsx(re,{children:e.jsx(P,{span:O?24:12,children:e.jsx(v,{layout:"vertical",form:R,onFinish:s=>{o(s.key),N(1,s.key,l)},children:e.jsx(v.Item,{name:"key",children:e.jsx(V,{size:"large",placeholder:"Search folder(s)...",prefix:e.jsx(st,{}),autoComplete:"off",allowClear:!0})})})})})}),e.jsx(we,{dataSource:b,columns:Q,pagination:{total:x,current:T,pageSize:l,showSizeChanger:!0,onChange:(s,n)=>{N(s,t,n||25)},onShowSizeChange:(s,n)=>{N(s,t,n||25)}}}),e.jsx(_,{title:"Share File",open:W,onClose:s=>i(s),width:O?"100vw":"50vw",children:e.jsx(je,{title:"Click Copy icon to copy share link",children:"sharing folder"})})]})},ho=t=>{const[o,l]=r.useState(!1),[d,x]=r.useState([]),[y,z]=r.useState(!0),[m,T]=r.useState(1),[h,j]=r.useState(t.min?5:20),[k]=v.useForm();v.useForm();const[U,p]=r.useState(0),[b,F]=r.useState(0),[g,C]=r.useState(""),[W,i]=r.useState(!0),{push:B}=Re(),[O,R]=r.useState(!1),[q,D]=r.useState(!1),[Y,N]=r.useState(!1),[G,se]=r.useState(),[J,Q]=r.useState(!1),[s,n]=r.useState("files"),c=!ve.useBreakpoint().lg,f=$e(),ae=()=>{R(!0)},le=a=>{x([...a,...d])},L=async(a,S="",Fe=25)=>{z(!0);const{data:E}=await A.custom({url:"",method:"get",meta:{operation:"files",variables:{page:{value:a,type:"Int",required:!0},key:{value:S,type:"String",required:!1},pageSize:{value:Fe,type:"Int",required:!0},folder:{value:f.folder,type:"String",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:Ne}]}}).catch(X=>(console.error(X),w.error("Error getting files"),{data:null})).then(X=>X);E&&(F(E.total),p(E.pages),T(E.page),i(E.hasNext),x(E.results)),z(!1)},be=(a,S)=>{j(S),L(m,g,S)},Ce=async()=>{const{data:a}=await A.custom({url:"",method:"get",meta:{operation:"odriveAuthorization",variables:{},fields:["auth"]}}).catch(()=>(w.error("Error getting Odrive Authorization"),{data:null})).then(S=>S);a&&l(a.auth.upload_files)};return r.useEffect(()=>{Ce(),L(m,g,h),f.folder&&n("files")},[f]),e.jsxs(e.Fragment,{children:[!t.min&&e.jsx(Pe,{offsetTop:63,children:e.jsxs(re,{children:[c&&e.jsxs(e.Fragment,{children:[e.jsxs(P,{span:24,style:{display:"flex",justifyContent:"flex-end",marginBottom:10},children:[e.jsx(I,{size:"large",icon:e.jsx(ee,{}),disabled:!o,onClick:()=>ae(),children:"Upload File(s)"}),e.jsx(I,{size:"large",icon:e.jsx(De,{}),disabled:!o,onClick:()=>D(!0),children:"Upload Folder"})]}),e.jsx(P,{span:24,children:e.jsx(je,{bodyStyle:{paddingTop:10,paddingBottom:0},children:e.jsx(v,{layout:"vertical",form:k,onFinish:a=>{C(a.key),L(1,a.key,h)},children:e.jsx(v.Item,{name:"key",children:e.jsx(V,{size:"large",placeholder:"Search file(s)...",prefix:e.jsx(ce,{}),autoComplete:"off",allowClear:!0})})})})})]}),!c&&e.jsxs(e.Fragment,{children:[e.jsx(P,{span:12,children:!t.min&&e.jsx(ne,{sx:{display:"flex",justifyContent:"flex-start",alignItems:"center"},children:e.jsxs(ot,{color:"primary",value:f.folder?"folderOpen":s,exclusive:!0,onChange:(a,S)=>{S!==null&&(n(S),S==="files"&&L(1,g,h),f.folder&&B("/odrive"))},"aria-label":"Alignment",sx:{display:"flex",justifyContent:"flex-start",alignItems:"center"},children:[e.jsx(te,{value:"files",sx:{"&.Mui-selected":{backgroundColor:"red",color:"white",fontWeight:"bold","&:hover":{backgroundColor:"red",color:"white",fontWeight:"bold"}},fontWeight:"bold"},children:"Files"}),e.jsx(te,{value:"folders",sx:{"&.Mui-selected":{backgroundColor:"red",color:"white",fontWeight:"bold","&:hover":{backgroundColor:"red",color:"white",fontWeight:"bold"}},fontWeight:"bold"},children:"Folders"}),f.folder&&e.jsxs(te,{disabled:!0,value:"folderOpen",sx:{"&.Mui-selected":{backgroundColor:"red",color:"white",fontWeight:"bold","&:hover":{backgroundColor:"red",color:"white",fontWeight:"bold"}},fontWeight:"bold"},children:[e.jsx(Ge,{}),e.jsx("span",{style:{marginLeft:"3px"},children:f.name})]})]})})}),s==="files"&&e.jsxs(P,{span:12,style:{display:"flex",justifyContent:"flex-end"},children:[e.jsx(I,{size:"large",icon:e.jsx(ee,{}),disabled:!o,onClick:()=>ae(),children:"Upload File(s)"}),e.jsx(I,{size:"large",icon:e.jsx(ee,{}),disabled:!o,onClick:()=>D(!0),children:"Upload Folder"})]})]})]})}),s==="files"&&e.jsxs("div",{style:{marginTop:5},children:[!t.min&&e.jsx("div",{style:{paddingTop:10,paddingBottom:0},children:e.jsx(re,{children:e.jsx(P,{span:c?24:12,children:e.jsx(v,{layout:"vertical",form:k,onFinish:a=>{C(a.key),L(1,a.key,h)},children:e.jsx(v.Item,{name:"key",children:e.jsx(V,{size:"large",placeholder:"Search file(s)...",prefix:e.jsx(ce,{}),autoComplete:"off",allowClear:!0})})})})})}),e.jsx(ne,{sx:{maxHeight:"calc(100vh - 280px)",overflowY:"auto"},children:e.jsx("div",{style:{marginTop:t.min?0:20},children:e.jsx(Le,{showDrive:!0,loading:y,data:d,min:t.min??!1})})}),!t.min&&e.jsx(e.Fragment,{children:!y&&d.length>0&&e.jsx("div",{style:{display:"flex",justifyContent:"center",marginBottom:10,marginTop:20},children:e.jsx(Oe,{showSizeChanger:!0,showQuickJumper:!0,defaultCurrent:m,current:m,total:b,pageSize:h,onShowSizeChange:be,onChange:a=>L(a,g,h)})})})]}),s==="folders"&&e.jsx(e.Fragment,{children:e.jsx(at,{})}),e.jsx(_,{title:"Uploading Files",open:O,onClose:a=>R(a),width:c?"100vw":"50vw",children:e.jsx(Me,{onFinish:a=>le(a),mode:"file"})}),e.jsx(_,{title:"Uploading Folder",open:q,onClose:a=>D(a),width:c?"100vw":"50vw",children:e.jsx(Ue,{onFinish:a=>le(a),mode:"file"})}),e.jsx(We,{title:"File Informations",anchor:"right",width:c?"100vw":"35vw",onClose:a=>N(a),open:Y,noOverFlow:!0,children:e.jsx(Ie,{id:G==null?void 0:G.id})}),e.jsx(_,{title:"Share File",open:J,onClose:a=>Q(a),width:c?"100vw":"50vw",children:e.jsx("span",{})})]})};export{ho as Files};
