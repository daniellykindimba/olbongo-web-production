import{r as a,av as ye,cl as it,F as u,j as e,y as X,z as B,I as $,S as le,v as re,x as R,B as F,cm as Ue,aR as Se,J as k,K as o,be as de,T as z,t as fe,cn as ge,aw as te,a2 as pe,a6 as Z,a9 as be,s as Ee,E as ot,ag as Fe,bI as dt,a8 as ct,aa as O,bA as Re,co as $e,H as ie,au as U,ax as oe,aW as ke,bk as We,a5 as we,az as Me,as as je,bH as Ge,q as Je,cp as ut,ay as Qe,bt as ht,ab as Ae,c2 as mt,cq as xt,af as Xe,Z as Ze,$ as me,a1 as et}from"./index-31db8264.js";import{t as gt}from"./text_truncate-315d9efa.js";import{T as ce}from"./Table-4bc46886.js";import{C as yt}from"./index-b5649ce2.js";import{B as ne}from"./Breadcrumb-ccef1239.js";import"./Tree-723158fa.js";import"./index-2728af24.js";var pt=globalThis&&globalThis.__rest||function(t,m){var r={};for(var p in t)Object.prototype.hasOwnProperty.call(t,p)&&m.indexOf(p)<0&&(r[p]=t[p]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var C=0,p=Object.getOwnPropertySymbols(t);C<p.length;C++)m.indexOf(p[C])<0&&Object.prototype.propertyIsEnumerable.call(t,p[C])&&(r[p[C]]=t[p[C]]);return r};const{TimePicker:jt,RangePicker:ft}=ye,bt=a.forwardRef((t,m)=>a.createElement(ft,Object.assign({},t,{picker:"time",mode:void 0,ref:m}))),ve=a.forwardRef((t,m)=>{var{addon:r,renderExtraFooter:p}=t,C=pt(t,["addon","renderExtraFooter"]);const g=a.useMemo(()=>{if(p)return p;if(r)return r},[r,p]);return a.createElement(jt,Object.assign({},C,{mode:void 0,ref:m,renderExtraFooter:g}))}),tt=it(ve,"picker");ve._InternalPanelDoNotUseOrYouWillBeFired=tt;ve.RangePicker=bt;ve._InternalPanelDoNotUseOrYouWillBeFired=tt;const Ce=ve,St=t=>{a.useState();const[m,r]=a.useState([]),[p,C]=a.useState(0),[g,b]=a.useState(!0),[v,P]=a.useState(10),[w,l]=a.useState(""),[d]=u.useForm(),I=[{title:"Student",dataIndex:"student",fixed:!0,render:(N,E,j)=>e.jsx("span",{children:e.jsxs(re,{direction:"vertical",children:[e.jsx("a",{children:E.member.fullName}),e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Reg#"}),":"," ",E.member.registrationNumber]})]})})},{title:"",dataIndex:"status",render:(N,E,j)=>e.jsxs("div",{style:{display:"flex",justifyContent:"end"},children:[e.jsx("span",{style:{margin:5},children:e.jsx(R,{title:"Take as Present",color:"green",children:e.jsx(F,{icon:e.jsx(Ue,{style:{color:"green"}}),onClick:()=>M(E.id,t.event.id,1)})})}),e.jsx("span",{style:{margin:5},children:e.jsx(R,{title:"Take as Absent",color:"red",children:e.jsx(F,{icon:e.jsx(Se,{style:{color:"red"}}),onClick:()=>M(E.id,t.event.id,2)})})})]})}],M=async(N,E,j)=>{const{data:x}=await k.custom({url:"",method:"post",meta:{operation:"takeAttendance",variables:{studentId:{value:N,type:"Int",required:!0},entryId:{value:E,type:"Int",required:!0},present:{value:j,type:"Int",required:!0}},fields:["success","message"]}}).catch(_=>({data:null})).then(_=>_);x&&x.success&&(o.success(x.message),L(1,"",10),t.onAdd()),b(!1)},L=async(N,E="",j=20)=>{b(!0);const{data:x}=await k.custom({url:"",method:"get",meta:{operation:"studentsToTakeAttendance",variables:{page:{value:N,type:"Int",required:!0},key:{value:E,type:"String",required:!1},pageSize:{value:j,type:"Int",required:!1},timetableEntryId:{value:t.event.id,type:"Int",required:!0}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{member:["id","firstName","middleName","lastName","fullName","registrationNumber"]}]}]}}).catch(_=>({data:null})).then(_=>_);x&&(C(x.total),r([...x.results])),b(!1)};return a.useEffect(()=>{L(1,"",10)},[t.randKey]),e.jsxs(e.Fragment,{children:[e.jsx(X,{style:{marginTop:10},children:e.jsx(B,{span:24,children:e.jsx(u,{layout:"vertical",form:d,onFinish:N=>{l(N.key),m.length=0,L(1,N.key)},children:e.jsx(u.Item,{name:"key",children:e.jsx($,{size:"large",placeholder:"Search ...",prefix:e.jsx(le,{}),autoComplete:"off",allowClear:!0})})})})}),e.jsx(ce,{loading:g,columns:I,dataSource:m,pagination:{onChange:(N,E)=>{P(E),L(N,w,E)},total:p,pageSize:v,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0,y:"68vh"}})]})},vt=t=>{const[m,r]=a.useState([]),[p,C]=a.useState(0),[g,b]=a.useState(!0),[v,P]=a.useState(20),[w,l]=a.useState(""),[d]=u.useForm(),M=!de.useBreakpoint().lg,L=[{title:"Student",dataIndex:"student",fixed:!0,render:(E,j,x)=>e.jsx("span",{children:e.jsxs(re,{direction:"vertical",children:[e.jsx("a",{children:j.student.member.fullName}),e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Reg#:"}),e.jsx("span",{style:{marginLeft:10},children:j.student.member.registrationNumber})]})]})})},{title:"Status",dataIndex:"status",render:(E,j,x)=>e.jsx("span",{children:j.status===1?e.jsx("a",{children:e.jsx(z,{color:"green",children:j.statusDisplay})}):e.jsx("a",{children:e.jsx(z,{color:"red",children:j.statusDisplay})})})}],N=async(E,j="",x=20)=>{b(!0);const{data:_}=await k.custom({url:"",method:"get",meta:{operation:"schoolEducationLevelAttendancesByDate",variables:{page:{value:E,type:"Int",required:!0},key:{value:j,type:"String",required:!1},pageSize:{value:x,type:"Int",required:!1},timetableEntryId:{value:t.event.id,type:"Int",required:!0},date:{value:t.date.format("YYYY/MM/DD"),type:"String",required:!0}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{student:["id",{member:["id","firstName","middleName","lastName","fullName","registrationNumber"]}]},{entry:["id"]},{takenBy:["id"]},"status","statusDisplay","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(()=>(o.error("Error occured while fetching roles"),{data:null})).then(h=>h);_&&(C(_.total),r([..._.results])),b(!1)};return a.useEffect(()=>{N(1,"",20)},[t.randKey,t.date,t.event]),e.jsxs(e.Fragment,{children:[e.jsxs(X,{style:{marginTop:10},children:[e.jsx(B,{span:M?24:16,children:e.jsx(u,{layout:"vertical",form:d,onFinish:E=>{l(E.key),m.length=0,N(1,E.key)},children:e.jsx(u.Item,{name:"key",children:e.jsx($,{size:"large",placeholder:"Search ...",prefix:e.jsx(le,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(B,{span:M?24:2,children:e.jsx(F,{icon:e.jsx(le,{}),size:"large",onClick:()=>d.submit()})})]}),e.jsx(ce,{loading:g,columns:L,dataSource:m,pagination:{onChange:(E,j)=>{P(j),N(E,w,j)},total:p,pageSize:v,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0,y:"calc(100vh - 470px)"}})]})},Ke=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Tt=t=>{var Y,J;const[m,r]=a.useState([]),[p,C]=a.useState(0),[g,b]=a.useState(!0),[v,P]=a.useState(20),[w,l]=a.useState(""),[d]=u.useForm(),M=!de.useBreakpoint().lg,[L,N]=a.useState(!1),[E,j]=a.useState(!1),[x,_]=a.useState(!1),[h,D]=a.useState(),y=async V=>{D(V),_(!0)},i=async V=>{j(!1),N(V)},S=[{title:"Student",dataIndex:"student",fixed:!0,render:(V,W,H)=>e.jsx("span",{children:e.jsxs(re,{direction:"vertical",children:[e.jsx("a",{children:W.student.member.fullName}),e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Reg#:"}),e.jsx("span",{style:{marginLeft:10},children:W.student.member.registrationNumber})]})]})})},{title:"Status",dataIndex:"status",render:(V,W,H)=>e.jsx("span",{children:W.status===1?e.jsx(Z,{title:"Are you sure to mark Absent?",onConfirm:()=>c(W.id,2),onCancel:()=>{},okText:"Absent",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx("a",{children:e.jsx(z,{color:"green",children:W.statusDisplay})})}):e.jsx(Z,{title:"Are you sure to mark as Present?",onConfirm:()=>c(W.id,1),onCancel:()=>{},okText:"Present",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx("a",{children:e.jsx(z,{color:"red",children:W.statusDisplay})})})})},{title:"",dataIndex:"status",render:(V,W,H)=>e.jsx(Z,{title:"Are you sure to delete this Attendance Entry?",onConfirm:()=>T(W.id),onCancel:()=>{},okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx(F,{icon:e.jsx(be,{})})})}],s=async(V,W="",H=20)=>{b(!0);const{data:q}=await k.custom({url:"",method:"get",meta:{operation:"schoolEducationLevelAttendances",variables:{page:{value:V,type:"Int",required:!0},key:{value:W,type:"String",required:!1},pageSize:{value:H,type:"Int",required:!1},timetableEntryId:{value:t.event.id,type:"Int",required:!0}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{student:["id",{member:["id","firstName","middleName","lastName","fullName","registrationNumber"]}]},{entry:["id"]},{takenBy:["id"]},"status","statusDisplay","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(()=>(o.error("Error occured while fetching roles"),{data:null})).then(A=>A);q&&(C(q.total),r([...q.results])),b(!1)},T=async V=>{const{data:W}=await k.custom({url:"",method:"post",meta:{operation:"deleteStudentAttendance",variables:{attendanceId:{value:parseInt(V.toString()),type:"Int",required:!0}},fields:["success","message"]}}).catch(()=>(o.error("Error occured while deleting attendance entry"),{data:null})).then(H=>H);W&&(W.success?(o.success(W.message),r(m.filter(H=>H.id!==V))):o.error(W.message))},c=async(V,W)=>{const{data:H}=await k.custom({url:"",method:"post",meta:{operation:"updateStudentAttendance",variables:{attendanceId:{value:parseInt(V.toString()),type:"Int",required:!0},present:{value:W,type:"Int",required:!0}},fields:["success","message",{attendance:["id",{student:["id",{member:["id","firstName","middleName","lastName","fullName","registrationNumber"]}]},{entry:["id"]},{takenBy:["id"]},"status","statusDisplay","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(()=>(o.error("Error occured while updating attendance"),{data:null})).then(q=>q);H&&(H.success?(o.success(H.message),r(m.map(q=>parseInt(q.id.toString())===parseInt(H.attendance.id.toString())?H.attendance:q))):o.error(H.message)),b(!1)},f=async()=>{s(1,"",20)};return a.useEffect(()=>{s(1,"",20)},[t.randKey]),e.jsxs(e.Fragment,{children:[e.jsxs(X,{style:{marginTop:10},children:[e.jsx(B,{span:M?24:16,children:e.jsx(u,{layout:"vertical",form:d,onFinish:V=>{l(V.key),m.length=0,s(1,V.key)},children:e.jsx(u.Item,{name:"key",children:e.jsx($,{disabled:E,size:"large",placeholder:"Search ...",prefix:e.jsx(le,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(B,{span:M?24:2,children:e.jsx(F,{disabled:E,icon:e.jsx(le,{}),size:"large",onClick:()=>d.submit()})}),t.event.canTakeAttendance&&e.jsx(B,{span:M?24:6,children:e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end"},children:[e.jsx(R,{title:"Start Taking Attendance",children:e.jsx(F,{icon:e.jsx(fe,{}),size:"large",onClick:()=>i(!0),children:"Take Attendance"})}),e.jsx(R,{title:"View Taken Attendances",children:e.jsx(F,{disabled:E,icon:e.jsx(ge,{}),size:"large",onClick:()=>j(!0),children:"View Attendances"})})]})}),!t.event.canTakeAttendance&&e.jsx(B,{span:M?24:6,children:e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(R,{title:"View Taken Attendances",children:e.jsx(F,{disabled:E,icon:e.jsx(ge,{}),size:"large",onClick:()=>j(!0),children:"View Attendances"})})})})]}),E?e.jsx(e.Fragment,{children:e.jsx("div",{style:{maxHeight:"60vh",overflowY:"auto"},children:e.jsx(yt,{onSelect:V=>{var W;if(V<te().endOf("day")){const H=Ke.indexOf((W=t==null?void 0:t.entry)==null?void 0:W.name)+1,q=V.day();H===q?y(V):o("No attendance taken on this day")}},disabledDate:V=>{var q;const W=Ke.indexOf((q=t==null?void 0:t.entry)==null?void 0:q.name)+1,H=V.day();return V&&V>te().endOf("day")||W!==H}})})}):e.jsx(ce,{loading:g,columns:S,dataSource:m,pagination:{onChange:(V,W)=>{P(W),s(V,w,W)},total:p,pageSize:v,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0,y:"calc(100vh - 470px)"}}),e.jsx(pe,{title:"Taking Attendance",width:"28vw",anchor:"right",onClose:V=>N(V),open:L,children:e.jsx(St,{event:t.event,randKey:Math.random(),onAdd:f})}),e.jsx(pe,{title:((Y=t.event)==null?void 0:Y.subject.name)+" - "+((J=t.event)==null?void 0:J.educationLevel.name)+" Attendance taken on "+(h==null?void 0:h.format("YYYY MMM, DD")),width:"50vw",anchor:"left",onClose:V=>_(V),open:x,children:e.jsx(vt,{event:t.event,date:h,randKey:Math.random()})})]})},{TextArea:It}=$,Ct=t=>{const[m,r]=a.useState(!1),[p,C]=a.useState(!1),[g,b]=a.useState([]),[v,P]=a.useState(null),[w,l]=a.useState(null),[d]=u.useForm(),[I,M]=a.useState(!1),[L,N]=a.useState(!1),j=!de.useBreakpoint().lg,x=(y,i)=>{P(i),l(y),M(!0)},_=async y=>{const{data:i}=await k.custom({url:"",method:"post",meta:{operation:"openTimetableEntry",variables:{entryId:{value:y,type:"Int",required:!0}},fields:["success","message"]}}).catch(S=>(o.error("Something Went Wrong ..."),{data:null})).then(S=>S);i&&(i.success?(o.success(i.message),D()):o.error(i.message))},h=async y=>{const{data:i}=await k.custom({url:"",method:"post",meta:{operation:"cancelTimetableEntry",variables:{entryId:{value:y.entryId,type:"Int",required:!0},reason:{value:y.reason,type:"String",required:!0},verify:{value:y.notify,type:"Boolean",required:!0}},fields:["success","message"]}}).catch(S=>(o.error("Something Went Wrong ..."),{data:null})).then(S=>S);i&&(i.success?(o.success(i.message),d.resetFields(),D()):o.error(i.message))},D=async()=>{r(!0);const{data:y}=await k.custom({url:"",method:"get",meta:{operation:"myWeeklyTimetableEntries",fields:["entries","hasTimetable"]}}).catch(i=>(o.error("Something Went Wrong ..."),{data:null})).then(i=>i);y&&(C(y.hasTimetable),b(y.entries)),r(!1)};return a.useEffect(()=>{D()},[]),e.jsxs(e.Fragment,{children:[e.jsxs(Ee,{spinning:m,children:[!p&&!m&&e.jsx(e.Fragment,{children:e.jsx(X,{align:"middle",style:{height:"80vh",display:"flex",justifyContent:"center"},children:e.jsx(ot,{description:e.jsx(e.Fragment,{children:e.jsx("span",{style:{fontSize:22},children:"You are not Connected to any published Timetable"})})})})}),p&&e.jsx(X,{style:{overflowX:"auto",marginTop:j?65:0,marginLeft:10},wrap:!1,children:g.map(y=>e.jsxs("span",{style:{width:j?"100vw":"14.1vw",margin:"1px",padding:"0px"},children:[e.jsx(X,{style:{display:"flex",justifyContent:"space-between",backgroundColor:"white"},children:e.jsxs("span",{style:{marginLeft:10,marginRight:10,display:"flex",justifyContent:"space-between",width:"100%",height:35,paddingTop:2},children:[e.jsx("span",{style:{fontSize:19,fontWeight:"bolder"},children:y.name}),e.jsx("span",{children:e.jsx(R,{title:"Bulk Processing of Action(s)",color:"red",placement:"left",children:e.jsx(F,{icon:e.jsx(Se,{})})})})]})}),e.jsx("div",{style:{maxHeight:"83vh",overflowY:"auto",overflowX:"hidden",marginTop:5,marginRight:5},children:y.events.map(i=>e.jsx("div",{style:{backgroundColor:"white",paddingLeft:5},children:e.jsxs("div",{children:[e.jsxs("span",{style:{fontSize:18},children:[i.isTeacher&&e.jsx(e.Fragment,{children:e.jsxs("div",{style:{borderBottom:"1"},children:[e.jsx("span",{style:{marginLeft:5},children:e.jsx(R,{title:"View/Take Attendance",color:"green",children:e.jsx(F,{size:"small",onClick:()=>x(i,y),children:e.jsx(ge,{})})})}),i.canCancell&&!i.isCancelled&&!i.isExam&&e.jsx("span",{style:{marginLeft:5},children:e.jsx(Z,{title:e.jsx(e.Fragment,{children:e.jsxs(re,{direction:"vertical",children:[e.jsx("span",{children:"Are you sure to Cancel?"}),e.jsx("span",{style:{fontWeight:"bolder"},children:"Reason"}),e.jsx("span",{children:e.jsxs(u,{layout:"vertical",form:d,initialValues:{notify:!0},onFinish:S=>{S.entryId=i.id,h(S)},onFinishFailed:()=>{},autoComplete:"off",children:[e.jsx(u.Item,{name:"reason",rules:[{required:!0,message:"Please input your reason!"}],children:e.jsx(It,{rows:6,onChange:S=>{S.target.value.length>0?N(!0):N(!1)}})}),e.jsx(u.Item,{name:"notify",valuePropName:"checked",children:e.jsx(Fe,{children:"Notify Students"})})]})})]})}),onConfirm:()=>{d.submit()},onCancel:()=>{},okText:"Yes",cancelText:"No",okButtonProps:{disabled:!L},overlayStyle:{zIndex:9999},children:e.jsx(F,{size:"small",children:e.jsx(dt,{color:"red",style:{color:"red"}})})})}),e.jsx("span",{style:{float:"right"},children:e.jsx(R,{title:"Click to see all about this timetable Entry",color:"green",children:e.jsx(F,{icon:e.jsx(ct,{})})})})]})}),e.jsxs("span",{style:{display:"block"},children:[!i.advanced&&e.jsx(R,{overlayInnerStyle:{fontSize:19},title:"Subject: "+i.subject.name,color:"green",placement:"right",children:gt(i.subject.name,15)}),i.advanced&&e.jsx(R,{overlayInnerStyle:{fontSize:19},title:"Module: "+i.module.name,color:"green",placement:"right",children:i.module.code})]}),!i.advanced&&e.jsx(re,{children:i.group&&e.jsx(e.Fragment,{children:e.jsx(z,{color:"orange",children:i.group.name})})})]}),e.jsxs("span",{style:{fontSize:18},children:[e.jsx(R,{title:"Venue: "+i.venue.name,color:"green",children:e.jsx(z,{color:"red",children:i.venue.name})}),e.jsx(R,{title:e.jsxs(e.Fragment,{children:[!i.advanced&&e.jsx(e.Fragment,{children:i.isExam?e.jsxs(O,{title:"Supervisor Informations",column:1,children:[e.jsxs(O.Item,{label:"Name",children:[i.supervisor.firstName," ",i.supervisor.middleName," ",i.supervisor.lastName]}),e.jsx(O.Item,{label:"Email",children:i.supervisor.email}),e.jsx(O.Item,{label:"Phone",children:i.supervisor.phone})]}):e.jsxs(O,{title:"Teacher Informations",column:1,children:[e.jsxs(O.Item,{label:"Name",children:[i.teacher.firstName," ",i.teacher.middleName," ",i.teacher.lastName]}),e.jsx(O.Item,{label:"Email",children:i.teacher.email}),e.jsx(O.Item,{label:"Phone",children:i.teacher.phone})]})}),i.advanced&&e.jsx(e.Fragment,{children:i.isExam?e.jsxs(O,{title:"Supervisor Informations",column:1,children:[e.jsxs(O.Item,{label:"Name",children:[i.supervisor.firstName," ",i.supervisor.middleName," ",i.supervisor.lastName]}),e.jsx(O.Item,{label:"Email",children:i.supervisor.email}),e.jsx(O.Item,{label:"Phone",children:i.supervisor.phone})]}):e.jsxs(O,{title:"Lecturer Informations",column:1,children:[e.jsxs(O.Item,{label:"Name",children:[i.lecturer.firstName," ",i.lecturer.middleName," ",i.lecturer.lastName]}),e.jsx(O.Item,{label:"Email",children:i.lecturer.email}),e.jsx(O.Item,{label:"Phone",children:i.lecturer.phone})]})})]}),color:"white",overlayInnerStyle:{color:"black"},children:e.jsx(F,{type:"primary",shape:"circle",icon:e.jsx(Re,{})})})]}),i.isCancelled&&e.jsx("span",{children:e.jsxs(z,{color:"red",style:{fontSize:24,padding:10,marginTop:10},children:["Cancelled",i.isTeacher&&i.canCancell&&e.jsx(Z,{title:"Are you sure to Open?",onConfirm:()=>_(i.id),onCancel:()=>{},okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx(F,{style:{marginLeft:2},size:"small",children:"Re-open"})})]})}),e.jsxs($e,{children:[i.isExam&&e.jsx("p",{style:{fontSize:"18px"},children:te(i.dueDate).format("YYYY MMM, DD")}),i.startAt," - ",i.endAt]})]})}))})]}))})]}),e.jsx(ie,{title:e.jsx(e.Fragment,{children:e.jsxs(re,{direction:"vertical",children:[e.jsxs("span",{children:[w==null?void 0:w.subject.name," - ",w==null?void 0:w.educationLevel.name," - Attendance",e.jsx("span",{style:{marginLeft:10},children:e.jsx(z,{color:"green",children:v==null?void 0:v.name})})]}),e.jsxs("span",{children:[w==null?void 0:w.startAt," - ",w==null?void 0:w.endAt]})]})}),width:"70vw",open:I,onClose:y=>M(y),children:e.jsx(Tt,{event:w,entry:v,randKey:Math.random()})})]})},Et=()=>e.jsx("div",{style:{marginTop:10},children:e.jsx(Ct,{})}),kt=()=>e.jsx(e.Fragment,{children:e.jsx(Et,{})}),{Option:Te}=U,Ie="HH:mm",At=t=>{const[m,r]=a.useState(!1),[p,C]=a.useState(!0),[g,b]=a.useState([]),[v,P]=a.useState([]),[w,l]=a.useState([]),[d,I]=a.useState([]),M=()=>{r(!0)},L=h=>{t.form.setFieldsValue({teacher:void 0}),j(1,h)},N=async(h,D="",y=100)=>{const{data:i}=await k.custom({url:"",method:"get",meta:{operation:"schoolVenues",variables:{page:{value:h,type:"Int",required:!0},key:{value:D,type:"String",required:!1},pageSize:{value:y,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","code","created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(()=>(o.error("Error occured while loading Venues"),{data:null})).then(S=>S);i&&I(i.results)},E=async(h,D="",y=20)=>{var S;const{data:i}=await k.custom({url:"",method:"get",meta:{operation:"schoolEducationLevelSubjects",variables:{schoolEducationLevelId:{value:parseInt(((S=t.schoolTimetableEducationLevel)==null?void 0:S.schoolEducationLevel.id.toString())??"0")},page:{value:h,type:"Int",required:!0},key:{value:D,type:"String",required:!1},pageSize:{value:y,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{schoolSubject:[{subject:["id","name"]}]},"created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(s=>(o.error("Error occured while loading Subjects"),{data:null})).then(s=>s);i&&b(i.results)},j=async(h,D,y="",i=20)=>{C(!0);const{data:S}=await k.custom({url:"",method:"get",meta:{operation:"schoolEducationLevelSubjectTeachers",variables:{schoolEducationLevelSubjectId:{value:parseInt(D.toString()??"0")},page:{value:h,type:"Int",required:!0},key:{value:y,type:"String",required:!1},pageSize:{value:i,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{schoolMember:["id","registrationNumber",{user:["id","firstName","lastName","middleName","fullName"]}]},"created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(s=>(o.error("Error occured while loading Teachers"),{data:null})).then(s=>s);S&&P(S.results),C(!1)},x=async(h,D="",y=20)=>{var S;const{data:i}=await k.custom({url:"",method:"get",meta:{operation:"schoolEducationLevelGroups",variables:{schoolEducationLevelId:{value:parseInt(((S=t.schoolTimetableEducationLevel)==null?void 0:S.schoolEducationLevel.id.toString())??"0")},page:{value:h,type:"Int",required:!0},key:{value:D,type:"String",required:!1},pageSize:{value:y,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","description","created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(s=>(o.error("Error occured while loading Groups"),{data:null})).then(s=>s);i&&l(i.results)},_=async h=>{const{data:D}=await k.custom({url:"",method:"post",meta:{operation:"createTimetableEntry",variables:{subjectId:{value:h.subject_id,type:"Int",required:!0},teacherId:{value:h.teacher_id,type:"Int",required:!0},timetableId:{value:h.timetable_id,type:"Int",required:!0},groupId:{value:h.group_id,type:"Int",required:!1},venueId:{value:h.venue_id,type:"Int",required:!0},day:{value:h.day,type:"String",required:!0},startAt:{value:h.start_at,type:"String",required:!0},endAt:{value:h.end_at,type:"String",required:!0}},fields:["success","message"]}}).catch(y=>(o.error("Error occured while creating school timetable"),{data:null})).then(y=>y);D&&(D.success?(o.success(D.message),t.form.resetFields(),t.onFinish()):o.error(D.message))};return a.useEffect(()=>{x(1),N(1),E(1)},[t.randKey]),e.jsxs(e.Fragment,{children:[e.jsxs(u,{layout:"vertical",form:t.form,onFinish:h=>{var D;h.start_at=te(h.start_at).format("HH:mm"),h.end_at=te(h.end_at).format("HH:mm"),h.day=t.entry.name,h.timetable_id=parseInt(((D=t.schoolTimetableEducationLevel)==null?void 0:D.id.toString())??"0"),_(h)},requiredMark:!1,children:[e.jsx(u.Item,{name:"subject_id",label:"Subject",rules:[{required:!0,type:"integer",message:"Please Choose Subject"}],children:e.jsx(U,{size:"large",style:{width:"100%"},placeholder:"Please Choose Subject",allowClear:!0,showSearch:!0,onChange:L,dropdownStyle:{zIndex:9999},children:g.map(h=>e.jsx(Te,{value:h.id,children:h.schoolSubject.subject.name},h.id))})}),e.jsx(u.Item,{name:"teacher_id",label:"Teacher",rules:[{required:!0,type:"integer",message:"Please Choose Teacher"}],children:e.jsx(U,{size:"large",loading:p,disabled:p,style:{width:"100%"},placeholder:"Please Choose Teacher",allowClear:!0,showSearch:!0,onChange:()=>{},dropdownStyle:{zIndex:9999},children:v.map(h=>e.jsxs(Te,{value:h.id,children:[h.schoolMember.user.fullName,h.schoolMember.registrationNumber&&e.jsx("span",{style:{marginLeft:10},children:e.jsx(z,{color:"green",children:h.schoolMember.registrationNumber})})]},h.id))})}),e.jsx(u.Item,{name:"group_id",label:"Group",rules:[{required:!1,type:"integer",message:"Please Choose Groups"}],children:e.jsx(U,{size:"large",style:{width:"100%"},placeholder:"Please Choose Groups",allowClear:!0,showSearch:!0,onChange:()=>{},dropdownStyle:{zIndex:9999},children:w.map(h=>e.jsx(Te,{value:parseInt(h.id.toString()),children:h.name},h.id))})}),e.jsx(u.Item,{name:"venue_id",label:"Venue",rules:[{required:!0,type:"integer",message:"Please Choose Venue"}],children:e.jsx(U,{size:"large",style:{width:"100%"},placeholder:"Please Choose Venue",allowClear:!0,showSearch:!0,onChange:()=>{},dropdownStyle:{zIndex:9999},children:d.map(h=>e.jsx(Te,{value:parseInt(h.id.toString()),children:h.name},h.id))})}),e.jsxs(X,{children:[e.jsx(B,{span:6,children:e.jsx(u.Item,{name:"start_at",label:e.jsx(e.Fragment,{children:e.jsxs(re,{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:"Start At"}),e.jsx(F,{type:"link",onClick:()=>M(),children:"Check Slots"})]})}),initialValue:oe("07:00","HH:mm"),children:e.jsx(Ce,{size:"large",allowClear:!0,defaultValue:oe("07:00",Ie),hourStep:1,minuteStep:45,format:Ie,style:{width:"100%"},popupStyle:{zIndex:9999}})})}),e.jsx(B,{span:6,children:e.jsx(u.Item,{name:"end_at",label:e.jsx(e.Fragment,{children:e.jsxs(re,{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:"End At"}),e.jsx(F,{type:"link",onClick:()=>M(),children:"Check Slots"})]})}),initialValue:oe("07:45","HH:mm"),children:e.jsx(Ce,{size:"large",allowClear:!0,defaultValue:oe("07:45",Ie),hourStep:1,minuteStep:45,format:Ie,inputReadOnly:!0,style:{width:"100%"},popupStyle:{zIndex:9999}})})})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(F,{type:"primary",size:"large",htmlType:"submit",disabled:!0,children:"Save"})})]}),e.jsx(pe,{title:"Available Time Slots",anchor:"right",onClose:h=>r(h),open:m,children:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"Some contents..."}),e.jsx("p",{children:"Some contents..."}),e.jsx("p",{children:"Some contents..."})]})})]})},{Option:he}=U,Be="HH:mm",qt=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],He=t=>{var Le,De,Pe,ze,_e,Ve,Ye,Oe;const[m,r]=a.useState(!1),[p,C]=a.useState(!1),[g,b]=a.useState(!0),[v,P]=a.useState([]),[w,l]=a.useState([]),[d,I]=a.useState([]),[M,L]=a.useState([]),[N,E]=a.useState([]);a.useState(),a.useState();const[j,x]=a.useState([]);a.useState(!1),a.useState(!1);const[_,h]=a.useState("07:00"),[D,y]=a.useState("07:45");ke();const[i,S]=a.useState([]),[s,T]=a.useState([]),[c,f]=a.useState([]),[Y]=u.useForm(),J=()=>{C(!0)},V=n=>{var K;t.form.setFieldsValue({teacher:void 0}),((K=t==null?void 0:t.schoolTimetable)==null?void 0:K.forExamination)===!0?q(1):A(1,n)},W=async(n,K="",G=100)=>{const{data:ee}=await k.custom({url:"",method:"get",meta:{operation:"schoolVenues",variables:{page:{value:n,type:"Int",required:!0},key:{value:K,type:"String",required:!1},pageSize:{value:G,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","code","created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(se=>(o.error("Error occured while loading Venues"),{data:null})).then(se=>se);ee&&E(ee.results)},H=async(n,K="",G=20)=>{var se;const{data:ee}=await k.custom({url:"",method:"get",meta:{operation:"schoolEducationLevelSubjects",variables:{schoolEducationLevelId:{value:parseInt(((se=t.schoolTimetableEducationLevel)==null?void 0:se.schoolEducationLevel.id.toString())??"0")},page:{value:n,type:"Int",required:!0},key:{value:K,type:"String",required:!1},pageSize:{value:G,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{schoolSubject:[{subject:["id","name"]}]},"subjectType","subjectTypeDisplay","created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(ue=>(o.error("Error occured while loading Subjects"),{data:null})).then(ue=>ue);ee&&P(ee.results)},q=async(n,K="",G=20)=>{b(!0);const{data:ee}=await k.custom({url:"",method:"get",meta:{operation:"schoolMembers",variables:{page:{value:n,type:"Int",required:!0},key:{value:K,type:"String",required:!1},pageSize:{value:G,type:"Int",required:!1},rolesString:{value:["Teacher"],type:"[String]",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","registrationNumber","firstName","middleName","lastName","fullName","email","phone",{user:["id","firstName","lastName","middleName","fullName"]},"created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(se=>(o.error("Error occured while loading Teachers"),{data:null})).then(se=>se);ee&&I(ee.results),b(!1)},A=async(n,K,G="",ee=20)=>{b(!0);const{data:se}=await k.custom({url:"",method:"get",meta:{operation:"schoolEducationLevelSubjectTeachers",variables:{schoolEducationLevelSubjectId:{value:parseInt(K.toString()??"0")},page:{value:n,type:"Int",required:!0},key:{value:G,type:"String",required:!1},pageSize:{value:ee,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{schoolMember:["id","registrationNumber",{user:["id","firstName","lastName","middleName","fullName"]}]},"created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(ue=>(o.error("Error occured while loading Teachers"),{data:null})).then(ue=>ue);se&&l(se.results),b(!1)},Q=async(n,K="",G=20)=>{var se;const{data:ee}=await k.custom({url:"",method:"get",meta:{operation:"schoolEducationLevelGroups",variables:{schoolEducationLevelId:{value:parseInt(((se=t.schoolTimetableEducationLevel)==null?void 0:se.schoolEducationLevel.id.toString())??"0")},page:{value:n,type:"Int",required:!0},key:{value:K,type:"String",required:!1},pageSize:{value:G,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","description","created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(ue=>(o.error("Error occured while loading Groups"),{data:null})).then(ue=>ue);ee&&L(ee.results)},ae=async n=>{r(!0);const{data:K}=await k.custom({url:"",method:"post",meta:{operation:"createTimetableEntry",variables:{advanced:{value:t.advanced,type:"Boolean",required:!1},moduleId:{value:n.module_id,type:"Int",required:!1},subjectId:{value:n.subject_id,type:"Int",required:!1},teacherId:{value:n.teacher_id,type:"Int",required:!1},timetableId:{value:n.timetable_id,type:"Int",required:!0},groupId:{value:n.group_id,type:"Int",required:!1},venueId:{value:n.venue_id,type:"Int",required:!0},day:{value:n.day,type:"String",required:!0},startAt:{value:n.start_at,type:"String",required:!0},endAt:{value:n.end_at,type:"String",required:!0},supervisorId:{value:n.supervisor_id,type:"Int",required:!1},dueDate:{value:n.due_date,type:"String",required:!1}},fields:["success","message"]}}).catch(G=>(o.error("Error occured while creating school timetable"),{data:null})).then(G=>G);r(!1),K&&(K.success?(o.success(K.message),x([]),t.form.resetFields(),t.onFinish()):x(K.message))},xe=async()=>{var G;const n=((G=t==null?void 0:t.studyCourse)==null?void 0:G.id)??"0",{data:K}=await k.custom({url:"",method:"get",meta:{operation:"timetableStudyCourseModules",variables:{timetableStudyCourseId:{value:parseInt(n.toString()),type:"Int",required:!0}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","code","created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(ee=>(o.error("Something Went Wrong ..."),{data:null})).then(ee=>ee);K&&S(K.results)},qe=async n=>{b(!0);const{data:K}=await k.custom({url:"",method:"get",meta:{operation:"moduleMembers",variables:{moduleId:{value:n,type:"Int",required:!0},memberType:{value:"Teacher",type:"String",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{module:["id"]},{schoolMember:["id","registrationNumber","firstName","middleName","lastName","email","phone",{user:["id","firstName","middleName","lastName","email","fullName","pic"]}]},"created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(G=>(o.error("Something Went Wrong ..."),{data:null})).then(G=>G);b(!1),K&&f(K.results)};return a.useEffect(()=>{xe(),Q(1),W(1),H(1)},[t.randKey]),e.jsxs(e.Fragment,{children:[((Le=t==null?void 0:t.schoolTimetable)==null?void 0:Le.forExamination)&&e.jsx("div",{style:{marginBottom:10},children:e.jsx(We,{type:"info",message:e.jsx(e.Fragment,{children:e.jsxs("p",{style:{fontSize:18},children:[e.jsx("b",{children:"Notice:"})," This timetable is for examination. You can only add entries for examination.",e.jsx("p",{style:{color:"red"},children:"Validation wont apply against Non-Examination Timetable"})," ","But it will be applied against Examination Timetable"]})})})}),e.jsx("div",{children:j.map(n=>e.jsx(We,{message:n,type:"error",style:{fontSize:18,marginBottom:"3px"},onClose:()=>{x([])},closable:!0}))}),e.jsxs(u,{layout:"vertical",form:Y,onFinish:n=>{var K,G;n.start_at=_,n.end_at=D,n.day=t.entry.name,t.advanced?n.timetable_id=parseInt(((K=t==null?void 0:t.studyCourse)==null?void 0:K.id.toString())??"0"):n.timetable_id=parseInt(((G=t==null?void 0:t.schoolTimetableEducationLevel)==null?void 0:G.id.toString())??"0"),ae(n)},children:[t.advanced?e.jsx(u.Item,{name:"module_id",label:"Module",rules:[{required:!0,type:"integer",message:"Please Choose Module"}],children:e.jsx(U,{size:"large",style:{width:"100%"},placeholder:"Please Choose Module",allowClear:!0,showSearch:!0,onChange:n=>{Y.setFieldsValue({teacher_id:void 0}),qe(n)},dropdownStyle:{zIndex:9999},children:i.map(n=>e.jsx(he,{value:parseInt(n.id.toString()),children:n.name},n.id))})}):e.jsx(u.Item,{name:"subject_id",label:"Subject",rules:[{required:!0,type:"integer",message:"Please Choose Subject"}],children:e.jsx(U,{size:"large",style:{width:"100%"},placeholder:"Please Choose Subject",allowClear:!0,showSearch:!0,onChange:V,dropdownStyle:{zIndex:9999},children:v.map(n=>e.jsxs(he,{value:n.id,children:[n.schoolSubject.subject.name,e.jsx(z,{style:{marginLeft:5},color:"green",children:n.subjectTypeDisplay})]},n.id))})}),!t.advanced&&e.jsx(e.Fragment,{children:(De=t==null?void 0:t.schoolTimetable)!=null&&De.forExamination?e.jsx(u.Item,{name:"supervisor_id",label:e.jsx(e.Fragment,{children:"Teachers Supervising"}),rules:[{required:(Pe=t==null?void 0:t.schoolTimetable)==null?void 0:Pe.forExamination,type:"integer",message:"Please Choose Supervisor"}],children:e.jsx(U,{size:"large",loading:g,disabled:g,style:{width:"100%"},placeholder:"Please Choose Teacher",allowClear:!0,showSearch:!0,onChange:()=>{},dropdownStyle:{zIndex:9999},children:d.map(n=>e.jsxs(he,{value:parseInt(n.id.toString()),children:[n.user.fullName,n.registrationNumber&&e.jsx("span",{style:{marginLeft:10},children:e.jsx(z,{color:"green",children:n.registrationNumber})}),e.jsxs("p",{style:{marginTop:3},children:[e.jsx("span",{style:{color:"red"},children:"Email:"})," ",e.jsx(z,{children:n==null?void 0:n.email}),","," ",e.jsx("span",{style:{color:"red"},children:"Phone:"})," ",e.jsx(z,{children:n==null?void 0:n.phone})]})]},n.id))})}):e.jsx(u.Item,{name:"teacher_id",label:e.jsx(e.Fragment,{children:"Teacher"}),rules:[{required:!((ze=t==null?void 0:t.schoolTimetable)!=null&&ze.forExamination),type:"integer",message:"Please Choose Teacher"}],children:e.jsx(U,{size:"large",loading:g,disabled:g,style:{width:"100%"},placeholder:"Please Choose Teacher",allowClear:!0,showSearch:!0,onChange:()=>{},dropdownStyle:{zIndex:9999},children:w.map(n=>e.jsxs(he,{value:n.id,children:[n.schoolMember.user.fullName,n.schoolMember.registrationNumber&&e.jsx("span",{style:{marginLeft:10},children:e.jsx(z,{color:"green",children:n.schoolMember.registrationNumber})})]},n.id))})})}),t.advanced&&e.jsx(e.Fragment,{children:(_e=t==null?void 0:t.schoolTimetable)!=null&&_e.forExamination?e.jsx(u.Item,{name:"supervisor_id",label:e.jsx(e.Fragment,{children:"Lecturer/Tutor Supervising"}),rules:[{required:(Ve=t==null?void 0:t.schoolTimetable)==null?void 0:Ve.forExamination,type:"integer",message:"Please Choose Supervisor"}],children:e.jsx(U,{size:"large",loading:g,disabled:g,style:{width:"100%"},placeholder:"Please Choose Lecturer/Tutor",allowClear:!0,showSearch:!0,onChange:()=>{},dropdownStyle:{zIndex:9999},children:s.map(n=>e.jsxs(he,{value:parseInt(n.id.toString()),children:[n.user.fullName,n.registrationNumber&&e.jsx("span",{style:{marginLeft:10},children:e.jsx(z,{color:"green",children:n.registrationNumber})}),e.jsxs("p",{style:{marginTop:3},children:[e.jsx("span",{style:{color:"red"},children:"Email:"})," ",e.jsx(z,{children:n==null?void 0:n.email}),","," ",e.jsx("span",{style:{color:"red"},children:"Phone:"})," ",e.jsx(z,{children:n==null?void 0:n.phone})]})]},n.id))})}):e.jsx(u.Item,{name:"teacher_id",label:e.jsx(e.Fragment,{children:"Lecturer/Tutor"}),rules:[{required:!((Ye=t==null?void 0:t.schoolTimetable)!=null&&Ye.forExamination),type:"integer",message:"Please Choose Lecturer/Tutor"}],children:e.jsx(U,{size:"large",loading:g,disabled:g,style:{width:"100%"},placeholder:"Please Choose Lecturer/Tutor",allowClear:!0,showSearch:!0,onChange:()=>{},dropdownStyle:{zIndex:9999},children:c.map(n=>{var K;return e.jsxs(he,{value:parseInt(n.schoolMember.id.toString()),children:[(K=n==null?void 0:n.schoolMember.user)==null?void 0:K.fullName,n.schoolMember.registrationNumber&&e.jsx("span",{style:{marginLeft:10},children:e.jsx(z,{color:"green",children:n.schoolMember.registrationNumber})})]},n.id)})})})}),!t.advanced&&e.jsx(u.Item,{name:"group_id",label:"Group",rules:[{required:!1,type:"integer",message:"Please Choose Groups"}],children:e.jsx(U,{size:"large",style:{width:"100%"},placeholder:"Please Choose Groups",allowClear:!0,showSearch:!0,onChange:()=>{},dropdownStyle:{zIndex:9999},children:M.map(n=>e.jsx(he,{value:parseInt(n.id.toString()),children:n.name},n.id))})}),e.jsx(u.Item,{name:"venue_id",label:"Venue",rules:[{required:!0,type:"integer",message:"Please Choose Venue"}],children:e.jsx(U,{size:"large",style:{width:"100%"},placeholder:"Please Choose Venue",allowClear:!0,showSearch:!0,onChange:()=>{},dropdownStyle:{zIndex:9999},children:N.map(n=>e.jsx(he,{value:parseInt(n.id.toString()),children:n.name},n.id))})}),e.jsxs(X,{children:[((Oe=t==null?void 0:t.schoolTimetable)==null?void 0:Oe.forExamination)&&e.jsx(B,{span:8,children:e.jsx(u.Item,{name:"due_date",label:"Due Date",rules:[{required:!0,type:"object",message:"Please Choose Due Date"}],children:e.jsx(ye,{size:"large",style:{width:"100%"},placeholder:"Please Choose Due Date",disabledDate:n=>!(n.day()===qt.indexOf(t.entry.name)+1),popupStyle:{zIndex:9999}})})}),e.jsx(B,{span:8,children:e.jsx(u.Item,{name:"start_at",rules:[{required:!0,type:"object",message:"Please Choose Start Time"}],label:e.jsx(e.Fragment,{children:e.jsxs(re,{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:"Start At"}),e.jsx(F,{type:"link",onClick:()=>J(),children:"Check Slots"})]})}),initialValue:oe("07:00","HH:mm"),children:e.jsx(Ce,{allowClear:!0,hourStep:1,minuteStep:45,format:Be,defaultValue:oe("07:00","HH:mm"),style:{width:"100%"},size:"large",onChange:n=>{h((n==null?void 0:n.hour().toString())+":"+(n==null?void 0:n.minute().toString()))},popupStyle:{zIndex:9999}})})}),e.jsx(B,{span:8,children:e.jsx(u.Item,{name:"end_at",rules:[{required:!0,type:"object",message:"Please Choose End Time"}],label:e.jsx(e.Fragment,{children:e.jsxs(re,{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:"End At"}),e.jsx(F,{type:"link",onClick:()=>J(),children:"Check Slots"})]})}),initialValue:oe("07:45","HH:mm"),children:e.jsx(Ce,{allowClear:!0,hourStep:1,minuteStep:45,format:Be,inputReadOnly:!0,defaultValue:oe("07:45","HH:mm"),style:{width:"100%"},size:"large",onChange:n=>{y((n==null?void 0:n.hour().toString())+":"+(n==null?void 0:n.minute().toString()))},popupStyle:{zIndex:9999}})})})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(F,{type:"primary",size:"large",htmlType:"submit",loading:m,disabled:m,children:"Save"})})]}),e.jsx(pe,{title:"Available Time Slots",width:"30vw",anchor:"right",onClose:n=>C(n),open:p,children:e.jsx("span",{children:"Slot Schecker"})})]})},at=t=>{const[m,r]=a.useState(!1),[p,C]=a.useState(),[g,b]=a.useState([]),[v,P]=a.useState(),[w,l]=a.useState(!1),[d,I]=a.useState(!1),[M,L]=a.useState(!1),[N]=u.useForm();u.useForm();const E=ke(),j=async(y,i)=>{P(y),C(i),I(!0)},x=async()=>{h()},_=async y=>{P(y),t.advanced?L(!0):l(!0)},h=async()=>{r(!0);const{data:y}=await k.custom({url:"",method:"get",meta:{operation:"weeklyTimetableEntries",variables:{schoolEducationLevelTimetableId:{value:parseInt(E.id),type:"Int",required:!0}},fields:["entries"]}}).catch(i=>(o.error("Something Went Wrong ..."),{data:null})).then(i=>i);y&&b(y.entries),r(!1)},D=async y=>{const{data:i}=await k.custom({url:"",method:"post",meta:{operation:"deleteTimetableEntry",variables:{timetableEntryId:{value:y,type:"Int",required:!0}},fields:["success","message"]}}).catch(S=>(o.error("Something Went Wrong ..."),{data:null})).then(S=>S);i&&(i.success?(o.success(i.message),h()):o.error(i.message)),r(!1)};return a.useEffect(()=>{h()},[]),e.jsxs(e.Fragment,{children:[e.jsx(Ee,{spinning:m,children:e.jsx(X,{style:{overflowX:"auto"},wrap:!1,children:g.map(y=>{var i,S;return e.jsxs("span",{style:{width:"14.1vw",margin:"1px",padding:"0px"},children:[e.jsxs(X,{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{marginLeft:5},children:e.jsx("h2",{children:y.name})}),e.jsx("span",{style:{position:"relative",right:"0px",marginTop:8},children:e.jsx(R,{title:"Click to Start Scheduling for "+y.name,color:"green",placement:"left",children:e.jsx(F,{disabled:t.advanced?(i=t.studyCourse)==null?void 0:i.published:(S=t.schoolTimetableEducationLevel)==null?void 0:S.published,size:"small",icon:e.jsx(fe,{}),onClick:()=>_(y),children:"Add"})})})]}),e.jsx("div",{style:{maxHeight:"83vh",overflowY:"auto",overflowX:"hidden"},children:e.jsx(we,{style:{margin:"0px",padding:"0px"},bordered:!0,dataSource:y.events,renderItem:s=>e.jsxs(e.Fragment,{children:[e.jsx(we.Item,{children:e.jsxs(re,{direction:"vertical",children:[e.jsxs("span",{style:{fontSize:18},children:[s.advanced?e.jsx(e.Fragment,{children:e.jsx(R,{title:s.module.name,color:"green",children:e.jsx(z,{color:"green",children:s.module.code})})}):e.jsx(e.Fragment,{children:s.subject.name}),!s.advanced&&e.jsxs(re,{children:[e.jsx(z,{color:"green",style:{marginLeft:10},children:s.educationLevel.name}),s.group&&e.jsx(e.Fragment,{children:e.jsx(z,{color:"green",children:s.group.name})})]})]}),e.jsx("span",{style:{fontSize:18},children:e.jsxs(re,{children:[e.jsx(z,{color:"green",children:s.venue.name}),e.jsx(Z,{title:"Are you sure to delete this Timetable Entry?",onConfirm:()=>D(s.id),onCancel:()=>{},okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx(F,{icon:e.jsx(be,{})})}),e.jsx(F,{icon:e.jsx(Me,{}),onClick:()=>j(y,s.id)}),e.jsx(R,{title:e.jsxs(e.Fragment,{children:[!s.advanced&&e.jsxs(e.Fragment,{children:[s.teacher.firstName&&e.jsxs(O,{title:"Teacher Informations",column:1,children:[e.jsxs(O.Item,{label:"Name",children:[s.teacher.firstName," ",s.teacher.middleName," ",s.teacher.lastName]}),e.jsx(O.Item,{label:"Email",children:s.teacher.email}),e.jsx(O.Item,{label:"Phone",children:s.teacher.phone})]}),s.supervisor.firstName&&e.jsxs(O,{title:"Exam Supervisor Informations",column:1,children:[e.jsxs(O.Item,{label:"Name",children:[s.supervisor.firstName," ",s.supervisor.middleName," ",s.supervisor.lastName]}),e.jsx(O.Item,{label:"Email",children:s.supervisor.email}),e.jsx(O.Item,{label:"Phone",children:s.supervisor.phone})]})]}),s.advanced&&e.jsxs(e.Fragment,{children:[s.lecturer.firstName&&e.jsxs(O,{title:"Lecturer Informations",column:1,children:[e.jsxs(O.Item,{label:"Name",children:[s.lecturer.firstName," ",s.lecturer.middleName," ",s.lecturer.lastName]}),e.jsx(O.Item,{label:"Email",children:s.lecturer.email}),e.jsx(O.Item,{label:"Phone",children:s.lecturer.phone})]}),s.supervisor.firstName&&e.jsxs(O,{title:"Exam Supervisor Informations",column:1,children:[e.jsxs(O.Item,{label:"Name",children:[s.supervisor.firstName," ",s.supervisor.middleName," ",s.supervisor.lastName]}),e.jsx(O.Item,{label:"Email",children:s.supervisor.email}),e.jsx(O.Item,{label:"Phone",children:s.supervisor.phone})]})]})]}),color:"white",overlayInnerStyle:{color:"black"},children:e.jsx(F,{type:"primary",shape:"circle",icon:e.jsx(Re,{})})})]})})]})}),s.isExam&&e.jsx(we.Item,{children:e.jsx("span",{style:{fontSize:18},children:te(s.dueDate).format("YYYY MMM, DD")})}),e.jsxs($e,{children:[s.startAt," - ",s.endAt]})]})})})]})})})}),e.jsx(ie,{title:(v==null?void 0:v.name)+" Scheduler",width:"45vw",open:w,onClose:y=>l(y),children:e.jsx(He,{advanced:t.advanced,schoolTimetable:t.schoolTimetable,schoolTimetableEducationLevel:t.schoolTimetableEducationLevel,randKey:Math.random(),form:N,entry:v,onFinish:x})}),e.jsx(ie,{title:(v==null?void 0:v.name)+" Scheduler",width:"45vw",open:M,onClose:y=>L(y),children:e.jsx(He,{advanced:t.advanced,schoolTimetable:t.schoolTimetable,schoolTimetableEducationLevel:t.schoolTimetableEducationLevel,randKey:Math.random(),form:N,entry:v,onFinish:x,studyCourse:t.studyCourse})}),e.jsx(ie,{title:e.jsxs(e.Fragment,{children:[e.jsxs("span",{children:[v==null?void 0:v.name," Scheduler"]}),e.jsx("span",{style:{marginLeft:10},children:e.jsx(z,{color:"green",children:"Editting"})})]}),width:"45vw",open:d,onClose:y=>I(y),children:e.jsx(At,{schoolTimetable:t.schoolTimetable,schoolTimetableEducationLevel:t.schoolTimetableEducationLevel,randKey:Math.random(),form:N,entry:v,onFinish:x})})]})},wt=()=>{var P,w,l,d,I;const[t,m]=a.useState(),[r,p]=a.useState(),C=ke(),g=async(M,L)=>{const{data:N}=await k.custom({url:"",method:"post",meta:{operation:"publishUnpublishSchoolStudyCourseTimetable",variables:{schoolStudyCourseTimetableId:{value:M,type:"Int",required:!0},published:{value:L,type:"Boolean",required:!0}},fields:["success","message",{schoolStudyCourseTimetable:["id",{studyCourse:["id","year","semester","semesterDisplay","level","levelDisplay",{course:["id","name"]}]},"published","created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(E=>(o.error("Something Went Wrong ..."),{data:null})).then(E=>E);N&&(N.success?(p(N.schoolStudyCourseTimetable),o.success(N.message)):o.error(N.message))},b=async()=>{const{data:M}=await k.custom({url:"",method:"get",meta:{operation:"schoolTimetableStudyCourse",variables:{id:{value:parseInt(C.id),type:"Int",required:!0}},fields:["id",{studyCourse:["id","year","semester","semesterDisplay","level","levelDisplay",{course:["id","name"]}]},"published","created","updated","isActive","canEdit","canDelete","canManage"]}}).catch(L=>(o.error("Something Went Wrong ..."),{data:null})).then(L=>L);M&&p(M)},v=async()=>{const{data:M}=await k.custom({url:"",method:"get",meta:{operation:"schoolTimetable",variables:{id:{value:parseInt(C.tid),type:"Int",required:!0}},fields:["id","title","description",{school:["id"]},"forExamination","created","updated","isActive","canEdit","canDelete","canManage"]}}).catch(L=>(o.error("Something Went Wrong ..."),{data:null})).then(L=>L);M&&m(M)};return a.useEffect(()=>{v(),b()},[]),e.jsxs("div",{style:{marginTop:10},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(ne,{children:[e.jsx(ne.Item,{children:e.jsx(je,{to:"/timetable",children:"Home"})}),e.jsx(ne.Item,{children:e.jsxs(je,{to:"/timetable/timetables",children:["Timetables - ",t==null?void 0:t.title]})}),e.jsxs(ne.Item,{children:["Scheduler - ",(w=(P=r==null?void 0:r.studyCourse)==null?void 0:P.course)==null?void 0:w.name," -"," ",(l=r==null?void 0:r.studyCourse)==null?void 0:l.year," -"," ",(d=r==null?void 0:r.studyCourse)==null?void 0:d.semesterDisplay," -"," ",(I=r==null?void 0:r.studyCourse)==null?void 0:I.levelDisplay]})]}),e.jsxs("div",{children:[!(r!=null&&r.published)&&e.jsx(F,{size:"large",icon:e.jsx(Se,{style:{color:"red"}}),onClick:()=>g(r==null?void 0:r.id,!0),children:"Not Published"}),(r==null?void 0:r.published)&&e.jsx(F,{size:"large",icon:e.jsx(Ge,{style:{color:"green"}}),onClick:()=>g(r==null?void 0:r.id,!1),children:"Published"})]})]}),e.jsx(at,{advanced:!0,schoolTimetable:t,studyCourse:r})]})},Nt=()=>e.jsx(e.Fragment,{children:e.jsx(wt,{})}),Ft=t=>{const[m,r]=a.useState([]),[p,C]=a.useState(0),[g,b]=a.useState(20),[v,P]=a.useState(""),[w,l]=a.useState(!0),[d]=u.useForm(),M=!de.useBreakpoint().lg,L=[{title:"Name",dataIndex:"name",fixed:!0,render:(j,x)=>e.jsxs("span",{children:[e.jsx("a",{children:x.educationLevel.name}),e.jsx("span",{style:{marginLeft:10},children:e.jsx(z,{color:"green",children:x.educationLevel.schoolType.name})})]})},{title:"",dataIndex:"action",render:(j,x)=>e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(Z,{title:"Are you sure to delete this task?",onConfirm:()=>N(x.id),onCancel:()=>{},okText:"Yes",cancelText:"No",disabled:!x.canManage,overlayStyle:{zIndex:9999},children:e.jsx(F,{icon:e.jsx(fe,{}),children:"Add"})})})}],N=async j=>{var _;const{data:x}=await k.custom({url:"",method:"post",meta:{operation:"createSchoolEducationLevelTimetable",variables:{schoolTimetableId:{value:parseInt(((_=t.schoolTimetable)==null?void 0:_.id.toString())??"0"),type:"Int",required:!0},schoolEducationLevelId:{value:parseInt(j.toString()),type:"Int",required:!0}},fields:["success","message",{schoolEducationLevelTimetable:["id",{schoolEducationLevel:["id",{educationLevel:["id","name"]}]},{schoolTimetable:["id"]},"isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(h=>(o.error("Something Went Wrong ..."),{data:null})).then(h=>h);x&&(x.success?(o.success(x.message),t.onAdd(x.schoolEducationLevelTimetable),r(m.filter(h=>h.id.toString()!==j.toString()))):o.error(x.message)),l(!1)},E=async(j,x="",_=20)=>{var D;const{data:h}=await k.custom({url:"",method:"get",meta:{operation:"timetableNotAssignedSchoolEducationLevels",variables:{schoolTimetableId:{value:parseInt(((D=t.schoolTimetable)==null?void 0:D.id.toString())??"0"),type:"Int",required:!0},page:{value:j,type:"Int",required:!0},key:{value:x,type:"String",required:!1},pageSize:{value:_,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{school:["id","name"]},{educationLevel:["id","name",{schoolType:["id","name","code"]}]},"isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(y=>(o.error("Something Went Wrong ..."),{data:null})).then(y=>y);h&&(C(h.total),r([...h.results])),l(!1)};return a.useEffect(()=>{E(1,"",20)},[t.randKey]),e.jsxs(e.Fragment,{children:[e.jsx(X,{style:{marginTop:10},children:e.jsx(B,{span:M?24:20,children:e.jsx(u,{layout:"vertical",form:d,onFinish:j=>{P(j.key),m.length=0,E(1,j.key,g)},children:e.jsx(u.Item,{name:"key",children:e.jsx($,{size:"large",placeholder:"Search ...",prefix:e.jsx(le,{}),autoComplete:"off",allowClear:!0})})})})}),e.jsx(ce,{loading:w,columns:L,dataSource:m,pagination:{onChange:(j,x)=>{b(x),E(j,v,x)},total:p,pageSize:g,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0}})]})},st=t=>{var S,s;const[m,r]=a.useState([]),[p,C]=a.useState(1),[g,b]=a.useState(0),[v,P]=a.useState(!1),[w,l]=a.useState(!0),{push:d}=Je(),[I]=u.useForm();u.useForm(),de.useBreakpoint().lg;const[L,N]=a.useState(!1),E=async T=>{r([T,...m])},j=async T=>{const{data:c}=await k.custom({url:"",method:"post",meta:{operation:"synchronizeTimetableEducationLevels",variables:{timetableId:{value:parseInt(T),type:"Int",required:!0}},fields:["success","message"]}}).catch(f=>(o.error("Error in synchronizing Timetable Education Levels"),{data:null})).then(f=>f);c&&(c.success?(o(c.message),y(1,"")):o.error(c.message))},x=async T=>{const{data:c}=await k.custom({url:"",method:"post",meta:{operation:"deleteSchoolEducationLevelTimetable",variables:{schoolEducationLevelTimetableId:{value:parseInt(T.toString()),type:"Int",required:!0}},fields:["success","message"]}});c.success?(o.success(c.message),r(m.filter(f=>f.id!==T))):o.error(c.message)},_=async(T,c)=>{const{data:f}=await k.custom({url:"",method:"post",meta:{operation:"publishUnpublishSchoolEducationLevelTimetable",variables:{schoolEducationLevelTimetableId:{value:parseInt(T.toString()),type:"Int",required:!0},publish:{value:c,type:"Boolean",required:!0}},fields:["success","message",{schoolEducationLevelTimetable:["id",{schoolEducationLevel:["id",{educationLevel:["id","name"]}]},{schoolTimetable:["id"]},"hasEntries","published","isActive","created","updated","canEdit","canDelete","canManage"]}]}});f.success?(o.success(f.message),r(m.map(Y=>Y.id===f.schoolEducationLevelTimetable.id?f.schoolEducationLevelTimetable:Y))):o.error(f.message)},h=()=>{o("Canceled")},D=[{title:"Name",dataIndex:"name",fixed:!0,render:(T,c,f)=>e.jsx("span",{children:e.jsx("a",{children:c.schoolEducationLevel.educationLevel.name})})},{title:"Has Entries",dataIndex:"hasEntries",fixed:!0,render:(T,c,f)=>e.jsx("span",{children:c.hasEntries?e.jsx(e.Fragment,{children:e.jsx(z,{color:"green",children:"Yes"})}):e.jsx(e.Fragment,{children:e.jsx(z,{color:"red",children:"No"})})})},{title:"Created",dataIndex:"created",render:(T,c,f)=>e.jsx(e.Fragment,{children:e.jsx("span",{children:e.jsx(Ae,{date:new Date(c.created)})})})},{title:"Status",dataIndex:"isActive",render:(T,c,f)=>e.jsx("a",{children:c!=null&&c.isActive?e.jsx("span",{style:{color:"green"},children:"Active"}):e.jsx("span",{style:{color:"red"},children:"Inactive"})})},{title:"Published",dataIndex:"published",render:(T,c,f)=>e.jsx("a",{children:c!=null&&c.published?e.jsx(Z,{title:"Are you sure to Un-publish?",onConfirm:()=>_(c.id,!1),onCancel:()=>{},okText:"Unpublish",cancelText:"No",okButtonProps:{disabled:!c.hasEntries},overlayStyle:{zIndex:9999},children:e.jsx(z,{color:"green",children:"Published"})}):e.jsx(Z,{title:"Are you sure to Publish?",onConfirm:()=>_(c.id,!0),onCancel:()=>{},okText:"Publish",cancelText:"No",okButtonProps:{disabled:!c.hasEntries},overlayStyle:{zIndex:9999},children:e.jsx(z,{color:"red",children:"Not Published"})})})},{title:"",dataIndex:"action",render:(T,c,f)=>e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end"},children:[e.jsx(R,{title:"Schedule",placement:"left",children:e.jsx(F,{icon:e.jsx(ge,{}),disabled:!c.canManage,onClick:()=>{var Y;return d("/timetable/education/level/scheduler/"+((Y=t==null?void 0:t.schoolTimetable)==null?void 0:Y.id)+"/"+c.id)}})}),e.jsx(Z,{title:"Are you sure to delete this School Education Level Timetable?",onConfirm:()=>x(c==null?void 0:c.id),onCancel:()=>h,okText:"Yes",cancelText:"No",disabled:!(c!=null&&c.canDelete),overlayStyle:{zIndex:9999},children:e.jsx(F,{icon:e.jsx(be,{}),disabled:!(c!=null&&c.canDelete)})})]})}],y=async(T,c="")=>{var Y;const{data:f}=await k.custom({url:"",method:"get",meta:{operation:"schoolTimetableEducationLevels",variables:{schoolTimetableId:{value:parseInt(((Y=t.schoolTimetable)==null?void 0:Y.id.toString())??"0"),type:"Int",required:!0},page:{value:T,type:"Int",required:!0},key:{value:c,type:"String",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{schoolEducationLevel:["id",{educationLevel:["id","name"]}]},{schoolTimetable:["id"]},"hasEntries","published","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(J=>(o.error("Failed loading School Timetable Education Levels"),{data:null})).then(J=>J);f&&(C(f.page),b(f.total),P(f.hasNext),r([...f.results])),l(!1)},i=async T=>{var f;const{data:c}=await k.custom({url:"",method:"post",meta:{operation:"publishUnpublishSchoolEducationLevelTimetables",variables:{timetableId:{value:parseInt(((f=t==null?void 0:t.schoolTimetable)==null?void 0:f.id.toString())??"0"),type:"Int",required:!0},publish:{value:T,type:"Boolean",required:!0}},fields:["success","message"]}});c.success?(o.success(c.message),m.length=0,r([]),y(1)):o.error(c.message)};return a.useEffect(()=>{y(p)},[t.randKey]),e.jsxs(e.Fragment,{children:[e.jsxs(X,{style:{marginTop:10},children:[e.jsx(B,{span:12,children:e.jsx(u,{layout:"vertical",form:I,onFinish:T=>{C(1),m.length=0,y(1,T.key)},children:e.jsx(u.Item,{name:"key",children:e.jsx($,{size:"large",placeholder:"Search ...",prefix:e.jsx(le,{}),autoComplete:"off",allowClear:!0})})})}),e.jsxs(B,{span:12,style:{display:"flex",justifyContent:"flex-end"},children:[e.jsx(R,{title:"Click to Publish All timetables Listed Below",color:"green",children:e.jsx(F,{size:"large",icon:e.jsx(ut,{style:{color:"green"}}),onClick:()=>i(!0),children:"Publish All"})}),e.jsx(R,{title:"Click to Unpublish All Timetables listed Below",color:"red",children:e.jsx(F,{size:"large",icon:e.jsx(Se,{style:{color:"red"}}),onClick:()=>i(!1),children:"Unpublish All"})}),e.jsx(F,{size:"large",icon:e.jsx(Qe,{}),onClick:()=>N(!0),children:"Add"}),((S=t.schoolTimetable)==null?void 0:S.forExamination)&&e.jsx(R,{title:"Synchronization All Education Levels Related to Examination",placement:"top",color:"green",children:e.jsx(F,{size:"large",icon:e.jsx(ht,{}),onClick:()=>{var T;return j((T=t.schoolTimetable)==null?void 0:T.id)},children:"Sync"})})]})]}),e.jsx(ce,{loading:w,columns:D,dataSource:m,pagination:!1,scroll:{y:"60vh"}}),e.jsx(pe,{title:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Adding School Education Levels to "}),e.jsx("span",{style:{marginLeft:10},children:e.jsx(z,{color:"green",children:(s=t.schoolTimetable)==null?void 0:s.title})})]}),width:"45vw",anchor:"right",onClose:T=>N(T),open:L,children:e.jsx(Ft,{randKey:Math.random(),schoolTimetable:t.schoolTimetable,onAdd:E})})]})},Mt=()=>{const[t,m]=a.useState(),[r,p]=a.useState(),[C,g]=a.useState(!1),b=ke(),v=async()=>{const{data:l}=await k.custom({url:"",method:"get",meta:{operation:"schoolTimetableEducationLevel",variables:{id:{value:parseInt(b.id),type:"Int",required:!0}},fields:["id",{schoolEducationLevel:["id",{educationLevel:["id","name"]}]},"created","updated","isActive","published","canEdit","canDelete","canManage"]}}).catch(d=>(o.error("Something Went Wrong ..."),{data:null})).then(d=>d);l&&p(l)},P=async()=>{const{data:l}=await k.custom({url:"",method:"get",meta:{operation:"schoolTimetable",variables:{id:{value:parseInt(b.tid),type:"Int",required:!0}},fields:["id","title","description",{school:["id"]},"forExamination","created","updated","isActive","isPublished","canEdit","canDelete","canManage"]}}).catch(d=>(o.error("Something Went Wrong ..."),{data:null})).then(d=>d);l&&m(l)},w=async(l,d)=>{const{data:I}=await k.custom({url:"",method:"post",meta:{operation:"publishUnpublishSchoolEducationLevelTimetable",variables:{schoolEducationLevelTimetableId:{value:parseInt(l.toString()),type:"Int",required:!0},publish:{value:d,type:"Boolean",required:!0}},fields:["success","message",{schoolEducationLevelTimetable:["id",{schoolEducationLevel:["id",{educationLevel:["id","name"]}]},{schoolTimetable:["id"]},"hasEntries","published","isActive","created","updated","canEdit","canDelete","canManage"]}]}});I.success?(o.success(I.message),p(I.schoolEducationLevelTimetable)):o.error(I.message)};return a.useEffect(()=>{P(),v()},[]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginTop:10},children:[e.jsxs(ne,{children:[e.jsx(ne.Item,{children:e.jsx(je,{to:"/timetable",children:"Home"})}),e.jsx(ne.Item,{children:e.jsxs(je,{to:"/timetable/timetables",children:["Timetables - ",t==null?void 0:t.title]})}),e.jsxs(ne.Item,{children:["Scheduler -"," ",r==null?void 0:r.schoolEducationLevel.educationLevel.name]}),(r==null?void 0:r.published)&&e.jsx(e.Fragment,{children:e.jsx(z,{color:"red",style:{fontSize:16,padding:3},children:"To Continue Scheduling this Timetable, you first need to Unpublish"})})]}),e.jsxs("div",{style:{float:"right"},children:[(r==null?void 0:r.published)&&e.jsx(Z,{title:"Are you sure to Unpublish Timetable",placement:"left",onConfirm:()=>w(r==null?void 0:r.id,!1),onCancel:()=>{},okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx(F,{icon:e.jsx(mt,{style:{color:"red"}}),style:{float:"right"},children:"Unpublish"})}),!(r!=null&&r.published)&&e.jsx(e.Fragment,{children:e.jsx(Z,{title:"Are you sure to Publish Timetable",placement:"left",onConfirm:()=>w(r==null?void 0:r.id,!0),onCancel:()=>{},okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx(F,{icon:e.jsx(Ge,{style:{color:"green"}}),style:{float:"right"},children:"Publish"})})}),e.jsx(R,{title:"Click to Switch to Other Related Timetables, so as to continue scheduling",color:"green",placement:"left",children:e.jsx(F,{icon:e.jsx(xt,{style:{color:"green"}}),style:{float:"right"},onClick:()=>g(!0),children:"Switch"})})]}),e.jsx("div",{style:{marginTop:45},children:e.jsx(at,{advanced:!1,schoolTimetable:t,schoolTimetableEducationLevel:r})})]}),e.jsx(ie,{title:"Timetable Switcher",width:"70vw",open:C,onClose:l=>g(l),children:e.jsx(st,{schoolTimetable:t,randKey:Math.random()})})]})},Lt=()=>e.jsx(e.Fragment,{children:e.jsx(Mt,{})}),{TextArea:Dt}=$,{Option:Pt}=U,zt=t=>{const[m,r]=a.useState(!1),[p,C]=a.useState([]),[g,b]=a.useState(),v=l=>{b(l)},P=async(l=1,d="")=>{r(!0);const{data:I}=await k.custom({url:"",method:"get",meta:{operation:"schoolVenueTypes",variables:{page:{value:l,type:"Int",required:!0},key:{value:d,type:"String",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","isActive","created","updated","canEdit","canDelete","canManage"]}]}});C(I.results),r(!1)},w=async l=>{const{data:d}=await k.custom({url:"",method:"post",meta:{operation:"createSchoolVenue",variables:{name:{value:l.name,type:"String",required:!0},code:{value:l.code,type:"String",required:!0},schoolVenueTypeId:{value:parseInt(l.school_venue_type_id),type:"Int",required:!0},description:{value:l.description,type:"String",required:!1},capacity:{value:parseInt(l.capacity),type:"Int",required:!1},longitude:{value:l.longitude,type:"Float",required:!1},latitude:{value:l.latitude,type:"Float",required:!1}},fields:["success","message",{schoolVenue:["id","name","code","description",{schoolVenueType:["id","name"]},"capacity","latitude","longitude","created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(I=>(o.error("Error occured while creating school venue"),{data:null})).then(I=>I);d&&(d.success?(o.success(d.message),t.onFinish(d.schoolVenue),t.form.resetFields()):o.error(d.message))};return a.useEffect(()=>{P()},[t.randKey]),e.jsx(e.Fragment,{children:e.jsx(Ee,{spinning:m,children:e.jsxs(u,{layout:"vertical",form:t.form,onFinish:l=>{l.school_venue_type_id=g,w(l)},children:[e.jsx(u.Item,{name:"name",label:"Name",rules:[{required:!0,type:"string",message:"Please input Name"}],children:e.jsx($,{size:"large",placeholder:"Enter Name ..."})}),e.jsx(u.Item,{name:"code",label:"Code",rules:[{required:!0,type:"string",message:"Please input Code"}],children:e.jsx($,{size:"large",placeholder:"Enter Code ..."})}),e.jsx(u.Item,{name:"capacity",label:"Capacity",children:e.jsx(Xe,{size:"large",min:0,defaultValue:45,style:{width:"100%"}})}),e.jsx(u.Item,{label:"School Type",rules:[{required:!0,type:"string",message:"Please choose School Type"}],children:e.jsx(U,{showSearch:!0,size:"large",placeholder:"Select a School Venue Type",optionFilterProp:"children",onChange:v,onSearch:l=>{},filterOption:(l,d)=>d.children.toLowerCase().includes(l.toLowerCase()),dropdownStyle:{zIndex:9999},children:p.map((l,d)=>e.jsx(Pt,{value:l.id,children:l.name}))})}),e.jsx(u.Item,{name:"latitude",label:"Latitude",rules:[{required:!1,type:"number",message:"Please input Latidue"}],children:e.jsx($,{size:"large",placeholder:"Enter Latitude ..."})}),e.jsx(u.Item,{name:"longitude",label:"Longitude",rules:[{required:!1,type:"number",message:"Please input Longitude"}],children:e.jsx($,{size:"large",placeholder:"Enter Longitude ..."})}),e.jsx(u.Item,{name:"description",label:"Description",rules:[{required:!1,type:"string",message:"Please input Description"}],children:e.jsx(Dt,{rows:4,maxLength:6})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(F,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})})},{TextArea:_t}=$,{Option:Vt}=U,Yt=t=>{var l;const[m,r]=a.useState(!1),[p,C]=a.useState([]),[g,b]=a.useState(),v=d=>{b(d)},P=async(d=1,I="")=>{r(!0);const{data:M}=await k.custom({url:"",method:"get",meta:{operation:"schoolVenueTypes",variables:{page:{value:d,type:"Int",required:!0},key:{value:I,type:"String",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","isActive","created","updated","canEdit","canDelete","canManage"]}]}});C(M.results),r(!1)},w=async d=>{const{data:I}=await k.custom({url:"",method:"post",meta:{operation:"updateSchoolVenue",variables:{schoolVenueId:{value:parseInt(d.school_venue_id),type:"Int",required:!0},name:{value:d.name,type:"String",required:!0},code:{value:d.code,type:"String",required:!0},schoolVenueTypeId:{value:parseInt(d.school_venue_type_id),type:"Int",required:!0},description:{value:d.description,type:"String",required:!1},capacity:{value:parseInt(d.capacity),type:"Int",required:!1},longitude:{value:d.longitude,type:"Float",required:!1},latitude:{value:d.latitude,type:"Float",required:!1}},fields:["success","message",{schoolVenue:["id","name","code","description",{schoolVenueType:["id","name"]},"capacity","latitude","longitude","created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(M=>(o.error("Error occured while Updating school venue"),{data:null})).then(M=>M);I&&(I.success?(o.success(I.message),t.onFinish(I.schoolVenue),t.form.resetFields()):o.error(I.message))};return a.useEffect(()=>{var d,I,M,L,N,E,j,x;P(),t.form.setFieldsValue({name:(d=t.venue)==null?void 0:d.name,code:(I=t.venue)==null?void 0:I.code,capacity:(M=t.venue)==null?void 0:M.capacity,description:(L=t.venue)==null?void 0:L.description,school_venue_type_id:(N=t.venue)==null?void 0:N.schoolVenueType.id,longitude:(E=t.venue)==null?void 0:E.longitude,latitude:(j=t.venue)==null?void 0:j.latitude}),v((x=t.venue)==null?void 0:x.schoolVenueType.id)},[t.randKey]),e.jsx(e.Fragment,{children:e.jsx(Ee,{spinning:m,children:e.jsxs(u,{layout:"vertical",form:t.form,onFinish:d=>{var I;d.school_venue_type_id=g,d.school_venue_id=(I=t.venue)==null?void 0:I.id,w(d)},requiredMark:!1,children:[e.jsx(u.Item,{name:"name",label:"Name",rules:[{required:!0,type:"string",message:"Please input Name"}],children:e.jsx($,{size:"large",placeholder:"Enter Name ..."})}),e.jsx(u.Item,{name:"code",label:"Code",rules:[{required:!0,type:"string",message:"Please input Code"}],children:e.jsx($,{size:"large",placeholder:"Enter Code ..."})}),e.jsx(u.Item,{name:"capacity",label:"Capacity",children:e.jsx(Xe,{min:0,defaultValue:45,style:{width:"100%"}})}),e.jsx(u.Item,{label:"School Type",rules:[{required:!0,type:"string",message:"Please choose School Type"}],children:e.jsx(U,{showSearch:!0,placeholder:"Select a School Venue Type",optionFilterProp:"children",onChange:v,defaultValue:(l=t.venue)==null?void 0:l.schoolVenueType.id,onSearch:d=>{},filterOption:(d,I)=>I.children.toLowerCase().includes(d.toLowerCase()),dropdownStyle:{zIndex:9999},children:p.map((d,I)=>e.jsx(Vt,{value:d.id,children:d.name}))})}),e.jsx(u.Item,{name:"latitude",label:"Latitude",rules:[{required:!1,type:"number",message:"Please input Latidue"}],children:e.jsx($,{size:"large",placeholder:"Enter Latitude ..."})}),e.jsx(u.Item,{name:"longitude",label:"Longitude",rules:[{required:!1,type:"number",message:"Please input Longitude"}],children:e.jsx($,{size:"large",placeholder:"Enter Longitude ..."})}),e.jsx(u.Item,{name:"description",label:"Description",rules:[{required:!1,type:"string",message:"Please input Description"}],children:e.jsx(_t,{rows:4,maxLength:6})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(F,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})})},Ot=t=>{const[m,r]=a.useState(),[p,C]=a.useState([]),[g,b]=a.useState(0),[v,P]=a.useState(!0),[w,l]=a.useState(20),[d,I]=a.useState(""),[M]=u.useForm(),[L]=u.useForm(),E=!de.useBreakpoint().lg,[j,x]=a.useState(!1),[_,h]=a.useState(!1),D=c=>{r(c),h(!0)},y=async c=>{const{data:f}=await k.custom({url:"",method:"post",meta:{operation:"deleteSchoolVenue",variables:{schoolVenueId:{value:c,type:"Int",required:!0}},fields:["success","message"]}}).catch(Y=>(o.error("Error occured while Deleting School Venue"),{data:null})).then(Y=>Y);f&&(f.success?(o.success(f.message),C(p.filter(Y=>Y.id.toString()!==c.toString()))):o.error(f.message))},i=[{title:"Name",dataIndex:"name",fixed:!0,render:(c,f,Y)=>e.jsx("span",{children:e.jsx("a",{children:f.name})})},{title:"Code",dataIndex:"code",render:(c,f,Y)=>e.jsx("span",{children:f.code})},{title:"Venue Type",dataIndex:"venue_type",render:(c,f,Y)=>{var J;return e.jsx("span",{children:e.jsx(z,{color:"green",children:(J=f==null?void 0:f.schoolVenueType)==null?void 0:J.name})})}},{title:"Capacity",dataIndex:"capacity",render:(c,f,Y)=>e.jsx("span",{children:f.capacity})},{title:"Date Created",dataIndex:"created",render:(c,f,Y)=>e.jsx(e.Fragment,{children:e.jsx("span",{children:e.jsx(Ae,{date:new Date(f.created)})})})},{title:"Status",dataIndex:"isActive",render:(c,f,Y)=>e.jsx("span",{children:f!=null&&f.isActive?e.jsx("span",{style:{color:"green"},children:"Active"}):e.jsx("span",{style:{color:"red"},children:"Inactive"})})},{title:"",dataIndex:"action",render:(c,f,Y)=>e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(Ze,{trigger:["click"],overlay:e.jsxs(me,{children:[e.jsx(me.Item,{icon:e.jsx(be,{}),disabled:!f.canDelete,children:e.jsx(Z,{placement:"topLeft",title:`Are you sure you want to delete ${f.name} Venue?`,onConfirm:()=>y(parseInt(f.id)),okText:"Yes",cancelText:"No",children:e.jsx("a",{rel:"noopener noreferrer",children:"Delete"})})}),e.jsx(me.Item,{icon:e.jsx(Me,{}),disabled:!f.canEdit,onClick:()=>D(f),children:e.jsx("a",{rel:"noopener noreferrer",children:"Edit"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:J=>J.preventDefault(),children:e.jsx(et,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})})}],S=async c=>{C([c,...p]),L.resetFields()},s=async c=>{const f=p.findIndex(Y=>Y.id===c.id);p[f]=c,C([...p]),L.resetFields(),r(void 0),h(!1)},T=async(c,f="",Y=20)=>{P(!0);const{data:J}=await k.custom({url:"",method:"get",meta:{operation:"schoolVenues",variables:{page:{value:c,type:"Int",required:!0},key:{value:f,type:"String",required:!1},pageSize:{value:Y,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","code","capacity","description","latitude","longitude",{school:["id"]},{schoolVenueType:["id","name"]},"isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(V=>(o.error("Error occured while fetching roles"),{data:null})).then(V=>V);J&&(b(J.total),C([...J.results])),P(!1)};return a.useEffect(()=>{T(1,"",20)},[]),e.jsxs(e.Fragment,{children:[e.jsxs(X,{style:{marginTop:10},children:[e.jsx(B,{span:E?24:10,children:e.jsx(u,{layout:"vertical",form:M,onFinish:c=>{I(c.key),p.length=0,T(1,c.key)},children:e.jsx(u.Item,{name:"key",children:e.jsx($,{size:"large",placeholder:"Search ...",prefix:e.jsx(le,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(B,{span:E?24:2,children:e.jsx(F,{icon:e.jsx(le,{}),size:"large",onClick:()=>M.submit()})}),e.jsx(B,{span:E?24:12,children:e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(R,{title:"Register a New Venue/Class",children:e.jsx(F,{icon:e.jsx(fe,{}),size:"large",onClick:()=>x(!0),children:"Add Venue"})})})})]}),e.jsx(ce,{loading:v,columns:i,dataSource:p,pagination:{onChange:(c,f)=>{l(f),T(c,d,f)},total:g,pageSize:w,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0}}),e.jsx(ie,{title:"Register New Venue/Class",width:"30vw",open:j,onClose:c=>x(c),children:e.jsx(zt,{randKey:Math.random(),form:L,onFinish:S})}),e.jsx(ie,{title:"Edditing Venue/Class",width:"30vw",open:_,onClose:c=>h(c),children:e.jsx(Yt,{randKey:Math.random(),form:L,onFinish:s,venue:m})})]})},Wt=()=>e.jsxs("div",{style:{marginTop:10},children:[e.jsxs(ne,{children:[e.jsx(ne.Item,{children:e.jsx(je,{to:"/timetable",children:"Home"})}),e.jsx(ne.Item,{children:"Venues/Classes"})]}),e.jsx(Ot,{})]}),Kt=()=>e.jsx(e.Fragment,{children:e.jsx(Wt,{})}),{TextArea:Bt}=$,{Option:Ne}=U,nt=[];for(let t=2022;t<new Date().getFullYear()+3;t++)nt.push(e.jsx(Ne,{value:t,children:t.toString()},t.toString()));const Ht=t=>{const[m,r]=a.useState(!1),[p,C]=a.useState([]),[g,b]=a.useState([]),v=async()=>{const{data:l}=await k.custom({url:"",method:"get",meta:{operation:"schoolExaminations",variables:{},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","created","updated","isActive","canEdit","canManage","canDelete"]}]}}).catch(d=>(o.error("Failed to get school Examinations"),{data:null})).then(d=>d);l&&C(l.results)},P=async()=>{const{data:l}=await k.custom({url:"",method:"get",meta:{operation:"schoolTypes",variables:{},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","code","created","updated","isActive","canEdit","canManage","canDelete"]}]}}).catch(d=>(o.error("Error occured while fetching school types"),{data:null})).then(d=>d);l&&b(l.results)},w=async l=>{const{data:d}=await k.custom({url:"",method:"post",meta:{operation:"createSchoolTimetable",variables:{title:{value:l.title,type:"String",required:!0},description:{value:l.description,type:"String",required:!1},startAt:{value:l.start_at,type:"DateTime",required:!0},endAt:{value:l.end_at,type:"DateTime",required:!0},year:{value:l.year,type:"Int",required:!0},timetableType:{value:parseInt(l.timetable_type),type:"Int",required:!0},forExamination:{value:l.for_examination,type:"Boolean",required:!1},schoolExaminationId:{value:parseInt(l.school_examination_id),type:"Int",required:!1}},fields:["success","message",{schoolTimetable:["id","title","description","startAt","endAt","timetableType","year","forExamination",{timetableSchoolType:["id","name","code"]},{school:["id","name"]},{schoolExamination:["id","name"]},"created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(I=>(o.error("Error occured while creating school timetable"),{data:null})).then(I=>I);d&&(d.success?(o.success(d.message),t.onFinish(d.schoolTimetable),t.form.resetFields()):o.error(d.message))};return a.useEffect(()=>{v(),P()},[t.randKey]),e.jsx(e.Fragment,{children:e.jsxs(u,{layout:"vertical",form:t.form,onFinish:l=>{l.for_examination=m,l.year?l.year=parseInt(l.year):l.year=new Date().getFullYear(),w(l)},children:[e.jsx(u.Item,{name:"timetable_type",label:"Timetable Type",rules:[{required:!0,type:"string",message:"Please select Timetable Type"}],children:e.jsx(U,{size:"large",style:{width:"100%"},placeholder:"Please Timetable Type ...",dropdownStyle:{zIndex:9999},children:g.map(l=>e.jsx(Ne,{value:l.id,children:l.name},l.id))})}),e.jsx(u.Item,{name:"title",label:"Title",rules:[{required:!0,type:"string",message:"Please input Title"}],children:e.jsx($,{size:"large",placeholder:"Enter Title ..."})}),e.jsx(u.Item,{name:"year",label:"Academic Year",children:e.jsx(U,{size:"large",style:{width:"100%"},placeholder:"Please Select Year",defaultValue:new Date().getFullYear(),dropdownStyle:{zIndex:9999},children:nt})}),e.jsx(u.Item,{name:"description",label:"Description",rules:[{required:!1,type:"string",message:"Please input Description"}],children:e.jsx(Bt,{rows:4})}),e.jsxs(X,{children:[e.jsx(B,{span:12,children:e.jsx(u.Item,{name:"start_at",label:"Start At",rules:[{required:!0,type:"date",message:"Please input Start At Date"}],children:e.jsx(ye,{style:{width:"100%"},disabledDate:l=>{const d=te().format("YYYY-MM-DD");return l&&l<te(d,"YYYY-MM-DD")},popupStyle:{zIndex:9999}})})}),e.jsx(B,{span:12,children:e.jsx(u.Item,{name:"end_at",label:"End At",rules:[{required:!0,type:"date",message:"Please input End At Date"}],children:e.jsx(ye,{style:{width:"100%"},disabledDate:l=>{const d=te().format("YYYY-MM-DD");return l&&l<te(d,"YYYY-MM-DD")},popupStyle:{zIndex:9999}})})})]}),e.jsx(u.Item,{name:"for_examination",valuePropName:"checked",children:e.jsx(Fe,{onChange:l=>{l.target.checked?r(!0):r(!1)},children:"For Examination"})}),m&&e.jsx(u.Item,{name:"school_examination_id",label:"Examination",rules:[{required:m,type:"string",message:"Please select Examination"}],children:e.jsx(U,{size:"large",style:{width:"100%"},placeholder:"Please Choose Examination ...",dropdownStyle:{zIndex:9999},children:p==null?void 0:p.map(l=>e.jsx(Ne,{value:l.id.toString(),children:l.name},l.id))})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(F,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},{Option:rt}=U,{TextArea:Ut}=$,lt=[];for(let t=2022;t<new Date().getFullYear()+3;t++)lt.push(e.jsx(rt,{value:t,children:t.toString()},t.toString()));const Rt=t=>{const[m,r]=a.useState([]),p=async()=>{const{data:g}=await k.custom({url:"",method:"get",meta:{operation:"schoolTypes",variables:{},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","code","created","updated","isActive","canEdit","canManage","canDelete"]}]}}).catch(b=>(o.error("Error occured while fetching school types"),{data:null})).then(b=>b);g&&r(g.results)},C=async g=>{const{data:b}=await k.custom({url:"",method:"post",meta:{operation:"updateSchoolTimetable",variables:{schoolTimetableId:{value:parseInt(g.school_timetable_id),type:"Int",required:!0},title:{value:g.title,type:"String",required:!0},description:{value:g.description,type:"String",required:!1},startAt:{value:g.start_at,type:"DateTime",required:!0},endAt:{value:g.end_at,type:"DateTime",required:!0},year:{value:g.year,type:"Int",required:!0},timetableType:{value:parseInt(g.timetable_type),type:"Int",required:!0},forExamination:{value:g.for_examination,type:"Boolean",required:!1}},fields:["success","message",{schoolTimetable:["id","title","description","startAt","endAt","timetableType","year","forExamination",{timetableSchoolType:["id","name","code"]},{school:["id","name"]},{schoolExamination:["id","name"]},"created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch(v=>(o.error("Error occured while creating school timetable"),{data:null})).then(v=>v);b&&(b.success?(o.success(b.message),t.onFinish(b.schoolTimetable),t.form.resetFields()):o.error(b.message))};return a.useEffect(()=>{var g,b,v,P,w,l,d,I;p(),t.form.setFieldsValue({title:(g=t==null?void 0:t.schoolTimetable)==null?void 0:g.title,description:(b=t==null?void 0:t.schoolTimetable)==null?void 0:b.description,start_at:oe((v=t==null?void 0:t.schoolTimetable)==null?void 0:v.startAt),end_at:oe((P=t==null?void 0:t.schoolTimetable)==null?void 0:P.endAt),timetable_type:(l=(w=t==null?void 0:t.schoolTimetable)==null?void 0:w.timetableSchoolType)==null?void 0:l.id,year:(d=t==null?void 0:t.schoolTimetable)==null?void 0:d.year,for_examination:(I=t==null?void 0:t.schoolTimetable)==null?void 0:I.forExamination})},[t.randKey]),e.jsx(e.Fragment,{children:e.jsxs(u,{layout:"vertical",form:t.form,onFinish:g=>{var b;g.school_timetable_id=(b=t.schoolTimetable)==null?void 0:b.id,C(g)},children:[e.jsx(u.Item,{name:"timetable_type",label:"Timetable Type",children:e.jsx(U,{size:"large",style:{width:"100%"},placeholder:"Please Timetable Type ...",disabled:!0,dropdownStyle:{zIndex:9999},children:m.map(g=>e.jsx(rt,{value:g.id,children:g.name},g.id))})}),e.jsx(u.Item,{name:"title",label:"Title",rules:[{required:!0,type:"string",message:"Please input Title"}],children:e.jsx($,{size:"large",placeholder:"Enter Title ..."})}),e.jsx(u.Item,{name:"year",label:"Academic Year",children:e.jsx(U,{size:"large",style:{width:"100%"},placeholder:"Please Select Year",defaultValue:new Date().getFullYear(),dropdownStyle:{zIndex:9999},children:lt})}),e.jsx(u.Item,{name:"description",label:"Description",rules:[{required:!1,type:"string",message:"Please input Description"}],children:e.jsx(Ut,{rows:4,maxLength:6})}),e.jsxs(X,{children:[e.jsx(B,{span:12,children:e.jsx(u.Item,{name:"start_at",label:"Start At",rules:[{required:!0,type:"date",message:"Please input Start At Date"}],children:e.jsx(ye,{style:{width:"100%"},disabledDate:g=>{var v;const b=te((v=t.schoolTimetable)==null?void 0:v.startAt).format("YYYY-MM-DD");return g&&g<te(b,"YYYY-MM-DD")},popupStyle:{zIndex:9999}})})}),e.jsx(B,{span:12,children:e.jsx(u.Item,{name:"end_at",label:"End At",rules:[{required:!0,type:"date",message:"Please input End At Date"}],children:e.jsx(ye,{style:{width:"100%"},disabledDate:g=>{var v;const b=te((v=t.schoolTimetable)==null?void 0:v.startAt).format("YYYY-MM-DD");return g&&g<te(b,"YYYY-MM-DD")},popupStyle:{zIndex:9999}})})})]}),e.jsx(u.Item,{name:"for_examination",valuePropName:"checked",children:e.jsx(Fe,{disabled:!0,children:"For Examination"})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(F,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},$t=t=>{const[m,r]=a.useState([]),[p,C]=a.useState(0),[g,b]=a.useState(20),[v,P]=a.useState(""),[w,l]=a.useState(!0),[d]=u.useForm(),M=!de.useBreakpoint().lg,L=[{title:"Name",dataIndex:"name",fixed:!0,render:(j,x)=>e.jsx("span",{children:x.course.name})},{title:"Year",dataIndex:"year",fixed:!0,render:(j,x)=>e.jsx("span",{children:x.year})},{title:"Semester",dataIndex:"Semester",fixed:!0,render:(j,x)=>e.jsx("span",{children:x.semesterDisplay})},{title:"",dataIndex:"action",render:(j,x)=>e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(Z,{title:"Are you sure to delete this task?",onConfirm:()=>N(x.id),onCancel:()=>{},okText:"Yes",cancelText:"No",disabled:!x.canManage,overlayStyle:{zIndex:9999},children:e.jsx(F,{icon:e.jsx(fe,{}),children:"Add"})})})}],N=async j=>{var _;const{data:x}=await k.custom({url:"",method:"post",meta:{operation:"createTimetableStudyCourse",variables:{schoolTimetableId:{value:parseInt(((_=t.schoolTimetable)==null?void 0:_.id.toString())??"0"),type:"Int",required:!0},studyCourseId:{value:parseInt(j.toString()),type:"Int",required:!0}},fields:["success","message",{timetableStudyCourse:["id",{studyCourse:["id",{course:["id","name"]},"semester","semesterDisplay","year","created","updated","isActive"]},{schoolTimetable:["id"]},"hasEntries","published","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(h=>(o.error("Something Went Wrong ..."),{data:null})).then(h=>h);x&&(x.success?(o.success(x.message),t.onAdd(x.timetableStudyCourse),r(m.filter(h=>h.id.toString()!==j.toString()))):o.error(x.message)),l(!1)},E=async(j,x="",_=20)=>{var D;const{data:h}=await k.custom({url:"",method:"get",meta:{operation:"schoolTimetableStudyCoursesToAdd",variables:{schoolTimetableId:{value:parseInt(((D=t.schoolTimetable)==null?void 0:D.id.toString())??"0"),type:"Int",required:!0},page:{value:j,type:"Int",required:!0},key:{value:x,type:"String",required:!1},pageSize:{value:_,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{course:["id","name"]},"year","semester","semesterDisplay","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(y=>(o.error("Something Went Wrong ..."),{data:null})).then(y=>y);h&&(C(h.total),r([...h.results])),l(!1)};return a.useEffect(()=>{E(1,"",20)},[t.randKey]),e.jsxs(e.Fragment,{children:[e.jsx(X,{style:{marginTop:10},children:e.jsx(B,{span:M?24:20,children:e.jsx(u,{layout:"vertical",form:d,onFinish:j=>{P(j.key),m.length=0,E(1,j.key,g)},children:e.jsx(u.Item,{name:"key",children:e.jsx($,{size:"large",placeholder:"Search ...",prefix:e.jsx(le,{}),autoComplete:"off",allowClear:!0})})})})}),e.jsx(ce,{loading:w,columns:L,dataSource:m,pagination:{onChange:(j,x)=>{b(x),E(j,v,x)},total:p,pageSize:g,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0}})]})},Gt=t=>{var i;const[m,r]=a.useState([]),[p,C]=a.useState(1),[g,b]=a.useState(0),[v,P]=a.useState(!1),[w,l]=a.useState(!0),{push:d}=Je(),[I]=u.useForm();u.useForm(),de.useBreakpoint().lg;const[L,N]=a.useState(!1),E=async S=>{r([S,...m])},j=async S=>{const{data:s}=await k.custom({url:"",method:"post",meta:{operation:"deleteTimetableStudyCourse",variables:{id:{value:parseInt(S.toString()),type:"Int",required:!0}},fields:["success","message"]}});s.success?(o.success(s.message),r(m.filter(T=>T.id!==S))):o.error(s.message)},x=async(S,s)=>{const{data:T}=await k.custom({url:"",method:"post",meta:{operation:"publishUnpublishSchoolStudyCourseTimetable",variables:{schoolStudyCourseTimetableId:{value:parseInt(S.toString()),type:"Int",required:!0},published:{value:s,type:"Boolean",required:!0}},fields:["success","message",{schoolStudyCourseTimetable:["id",{studyCourse:["id",{course:["id","name"]},"semester","semesterDisplay","year","created","updated","isActive"]},{schoolTimetable:["id"]},"hasEntries","published","isActive","created","updated","canEdit","canDelete","canManage"]}]}});T.success?(o.success(T.message),r(m.map(c=>c.id===T.schoolStudyCourseTimetable.id?T.schoolStudyCourseTimetable:c))):o.error(T.message)},_=()=>{o("Canceled")},h=[{title:"Name",dataIndex:"name",fixed:!0,render:(S,s,T)=>e.jsx("span",{children:e.jsx("a",{children:s.studyCourse.course.name})})},{title:"Year",dataIndex:"year",fixed:!0,render:(S,s,T)=>e.jsx("span",{children:s.studyCourse.year})},{title:"Semester",dataIndex:"Semester",fixed:!0,render:(S,s,T)=>e.jsx("span",{children:s.studyCourse.semesterDisplay})},{title:"Has Entries",dataIndex:"hasEntries",fixed:!0,render:(S,s,T)=>e.jsx("span",{children:s.hasEntries?e.jsx(e.Fragment,{children:e.jsx(z,{color:"green",children:"Yes"})}):e.jsx(e.Fragment,{children:e.jsx(z,{color:"red",children:"No"})})})},{title:"Created",dataIndex:"created",render:(S,s,T)=>e.jsx(e.Fragment,{children:e.jsx("span",{children:e.jsx(Ae,{date:new Date(s.created)})})})},{title:"Status",dataIndex:"isActive",render:(S,s,T)=>e.jsx("a",{children:s!=null&&s.isActive?e.jsx("span",{style:{color:"green"},children:"Active"}):e.jsx("span",{style:{color:"red"},children:"Inactive"})})},{title:"Published",dataIndex:"published",render:(S,s,T)=>e.jsx("a",{children:s!=null&&s.published?e.jsx(Z,{title:"Are you sure to Un-publish?",onConfirm:()=>x(s.id,!1),onCancel:()=>{},okText:"Unpublish",cancelText:"No",okButtonProps:{disabled:!s.hasEntries},overlayStyle:{zIndex:9999},children:e.jsx(z,{color:"green",children:"Published"})}):e.jsx(Z,{title:"Are you sure to Publish?",onConfirm:()=>x(s.id,!0),onCancel:()=>{},okText:"Publish",cancelText:"No",okButtonProps:{disabled:!s.hasEntries},overlayStyle:{zIndex:9999},children:e.jsx(z,{color:"red",children:"Not Published"})})})},{title:"",dataIndex:"action",render:(S,s,T)=>e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end"},children:[e.jsx(R,{title:"Schedule",placement:"left",children:e.jsx(F,{icon:e.jsx(ge,{}),disabled:!s.canManage,onClick:()=>{var c;return d("/timetable/study/course/scheduler/"+((c=t==null?void 0:t.schoolTimetable)==null?void 0:c.id)+"/"+s.id)}})}),e.jsx(Z,{title:"Are you sure to delete this Timetable Study Course?",onConfirm:()=>j(s==null?void 0:s.id),onCancel:()=>_,okText:"Yes",cancelText:"No",disabled:!(s!=null&&s.canDelete),overlayStyle:{zIndex:9999},children:e.jsx(F,{icon:e.jsx(be,{}),disabled:!(s!=null&&s.canDelete)})})]})}],D=async(S,s="")=>{var c;const{data:T}=await k.custom({url:"",method:"get",meta:{operation:"schoolTimetableStudyCourses",variables:{schoolTimetableId:{value:parseInt(((c=t.schoolTimetable)==null?void 0:c.id.toString())??"0"),type:"Int",required:!0},page:{value:S,type:"Int",required:!0},key:{value:s,type:"String",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{studyCourse:["id",{course:["id","name"]},"semester","semesterDisplay","year","created","updated","isActive"]},{schoolTimetable:["id"]},"hasEntries","published","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(f=>(o.error("Failed loading School Timetable Education Levels"),{data:null})).then(f=>f);T&&(C(T.page),b(T.total),P(T.hasNext),r([...T.results])),l(!1)},y=async S=>{var T;const{data:s}=await k.custom({url:"",method:"post",meta:{operation:"publishUnpublishAllSchoolStudyCourseTimetables",variables:{schoolTimetableId:{value:parseInt(((T=t.schoolTimetable)==null?void 0:T.id.toString())??"0"),type:"Int",required:!0},published:{value:S,type:"Boolean",required:!0}},fields:["success","message"]}}).catch(c=>(o.error("Failed to publish/unpublish all study courses"),{data:null})).then(c=>c);s&&(s.success?(o.success(s.message),D(1)):o.error(s.message))};return a.useEffect(()=>{D(p)},[t.randKey]),e.jsxs(e.Fragment,{children:[e.jsxs(X,{style:{marginTop:10},children:[e.jsx(B,{span:12,children:e.jsx(u,{layout:"vertical",form:I,onFinish:S=>{C(1),m.length=0,D(1,S.key)},children:e.jsx(u.Item,{name:"key",children:e.jsx($,{size:"large",placeholder:"Search ...",prefix:e.jsx(le,{}),autoComplete:"off",allowClear:!0})})})}),e.jsxs(B,{span:12,style:{display:"flex",justifyContent:"flex-end"},children:[e.jsx(R,{title:"Click to Publish All Timetables",color:"green",children:e.jsx(F,{size:"large",icon:e.jsx(Ue,{style:{color:"green"}}),onClick:()=>y(!0),children:"Publish All"})}),e.jsx(R,{title:"Click to Unpublish All Timetables",color:"red",children:e.jsx(F,{size:"large",icon:e.jsx(Se,{style:{color:"red"}}),onClick:()=>y(!1),children:"Unpublish All"})}),e.jsx(F,{size:"large",icon:e.jsx(Qe,{}),onClick:()=>N(!0),children:"Add"})]})]}),e.jsx(ce,{loading:w,columns:h,dataSource:m,pagination:!1,scroll:{y:"60vh"}}),e.jsx(pe,{title:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Adding Study Courses to "}),e.jsx("span",{style:{marginLeft:10},children:e.jsx(z,{color:"green",children:(i=t.schoolTimetable)==null?void 0:i.title})})]}),width:"45vw",anchor:"right",onClose:S=>N(S),open:L,children:e.jsx($t,{randKey:Math.random(),schoolTimetable:t.schoolTimetable,onAdd:E})})]})},Jt=t=>{const[m,r]=a.useState(),[p,C]=a.useState([]),[g,b]=a.useState(0),[v,P]=a.useState(!0),[w,l]=a.useState(20),[d,I]=a.useState(""),[M]=u.useForm(),[L]=u.useForm(),[N]=u.useForm(),j=!de.useBreakpoint().lg,[x,_]=a.useState(!1),[h,D]=a.useState(!1),[y,i]=a.useState(!1),[S,s]=a.useState(!1),T=q=>{r(q),s(!0)},c=q=>{r(q),i(!0)},f=q=>{r(q),D(!0)},Y=async q=>{const{data:A}=await k.custom({url:"",method:"post",meta:{operation:"deleteSchoolTimetable",variables:{schoolTimetableId:{value:q,type:"Int",required:!0}},fields:["success","message"]}}).catch(Q=>(o.error("Error occured while Deleting School Venue"),{data:null})).then(Q=>Q);A&&(A.success?(o.success(A.message),C(p.filter(Q=>Q.id.toString()!==q.toString()))):o.error(A.message))},J=[{title:"Title",dataIndex:"title",fixed:!0,render:(q,A,Q)=>{var ae;return e.jsx("span",{children:e.jsxs("a",{children:[A.title,A.forExamination&&e.jsx(z,{color:"red",style:{marginLeft:10},children:(ae=A==null?void 0:A.schoolExamination)==null?void 0:ae.name})]})})}},{title:"Examination",dataIndex:"examination",fixed:!0,render:(q,A,Q)=>e.jsx("span",{children:e.jsx("a",{children:A.forExamination?e.jsx(z,{color:"green",children:"Yes"}):e.jsx(z,{color:"red",children:"No"})})})},{title:"Year",dataIndex:"year",fixed:!0,render:(q,A,Q)=>e.jsx("span",{children:e.jsx("a",{children:A.year})})},{title:"Timetable Type",dataIndex:"Timetable Type",fixed:!0,render:(q,A,Q)=>{var ae;return e.jsx("span",{children:e.jsx("a",{children:(ae=A==null?void 0:A.timetableSchoolType)==null?void 0:ae.name})})}},{title:"Start AT",dataIndex:"startAt",fixed:!0,render:(q,A,Q)=>e.jsx("span",{children:te(new Date(A.startAt)).format("MMM Do Y")})},{title:"End At",dataIndex:"endAt",fixed:!0,render:(q,A,Q)=>e.jsx("span",{children:te(new Date(A.endAt)).format("MMM Do Y")})},{title:"Date Created",dataIndex:"created",render:(q,A,Q)=>e.jsx(e.Fragment,{children:e.jsx("span",{children:e.jsx(Ae,{date:new Date(A.created)})})})},{title:"Status",dataIndex:"isActive",render:(q,A,Q)=>e.jsx("a",{children:A!=null&&A.isActive?e.jsx("span",{style:{color:"green"},children:"Active"}):e.jsx("span",{style:{color:"red"},children:"Inactive"})})},{title:"",dataIndex:"action",render:(q,A,Q)=>{var ae,xe;return e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(Ze,{trigger:["click"],overlay:e.jsxs(me,{children:[e.jsx(me.Item,{icon:e.jsx(be,{}),disabled:!A.canDelete,children:e.jsx(Z,{placement:"topLeft",title:`Are you sure you want to delete ${A.name} Timetable?`,onConfirm:()=>Y(parseInt(A.id)),okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx("a",{rel:"noopener noreferrer",children:"Delete"})})}),e.jsx(me.Item,{icon:e.jsx(Me,{}),disabled:!A.canEdit,onClick:()=>f(A),children:e.jsx("a",{rel:"noopener noreferrer",children:"Edit"})}),["pr","osc","asc","	tert"].includes((ae=A==null?void 0:A.timetableSchoolType)==null?void 0:ae.code)&&e.jsx(me.Item,{icon:e.jsx(ge,{}),disabled:!A.canManage,onClick:()=>c(A),children:e.jsx("a",{rel:"noopener noreferrer",children:"Scheduler"})}),["uni","poly","col","ous"].includes((xe=A==null?void 0:A.timetableSchoolType)==null?void 0:xe.code)&&e.jsx(me.Item,{icon:e.jsx(ge,{}),disabled:!A.canManage,onClick:()=>T(A),children:e.jsx("a",{rel:"noopener noreferrer",children:"Scheduler"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:qe=>qe.preventDefault(),children:e.jsx(et,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})})}}],V=async q=>{C([q,...p]),L.resetFields()},W=async q=>{const A=p.findIndex(Q=>Q.id===q.id);p[A]=q,C([...p]),N.resetFields(),r(void 0),D(!1)},H=async(q,A="",Q=20)=>{P(!0);const{data:ae}=await k.custom({url:"",method:"get",meta:{operation:"schoolTimetables",variables:{page:{value:q,type:"Int",required:!0},key:{value:A,type:"String",required:!1},pageSize:{value:Q,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","title","description","isPublished","startAt","endAt","timetableType","timetableTypeDisplay","year","forExamination",{timetableSchoolType:["id","name","code"]},{school:["id"]},{author:["id","firstName","middleName","lastName","fullName"]},{schoolExamination:["id","name"]},"isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(xe=>(o.error("Error occured while fetching roles"),{data:null})).then(xe=>xe);ae&&(b(ae.total),C([...ae.results])),P(!1)};return a.useEffect(()=>{H(1,"",20)},[]),e.jsxs(e.Fragment,{children:[e.jsxs(X,{style:{marginTop:10},children:[e.jsx(B,{span:j?24:10,children:e.jsx(u,{layout:"vertical",form:M,onFinish:q=>{I(q.key),p.length=0,H(1,q.key)},children:e.jsx(u.Item,{name:"key",children:e.jsx($,{size:"large",placeholder:"Search ...",prefix:e.jsx(le,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(B,{span:j?24:2,children:e.jsx(F,{icon:e.jsx(le,{}),size:"large",onClick:()=>M.submit()})}),e.jsx(B,{span:j?24:12,children:e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(R,{title:"Register a New Venue/Class",children:e.jsx(F,{icon:e.jsx(fe,{}),size:"large",onClick:()=>_(!0),children:"Add Timetable"})})})})]}),e.jsx(ce,{loading:v,columns:J,dataSource:p,pagination:{onChange:(q,A)=>{l(A),H(q,d,A)},total:g,pageSize:w,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0}}),e.jsx(ie,{title:"Creating New School Timetable",width:"30vw",open:x,onClose:q=>_(q),children:e.jsx(Ht,{randKey:Math.random(),form:L,onFinish:V})}),e.jsx(ie,{title:"Edditing School Timetable",width:"30vw",open:h,onClose:q=>D(q),children:e.jsx(Rt,{randKey:Math.random(),form:N,onFinish:W,schoolTimetable:m})}),e.jsx(ie,{title:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"School Timetable Education Levels"}),e.jsx("span",{style:{marginLeft:10},children:e.jsx(z,{color:"green",children:m==null?void 0:m.title})})]}),width:"60vw",open:y,onClose:q=>i(q),children:e.jsx(st,{schoolTimetable:m,randKey:Math.random()})}),e.jsx(ie,{title:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Timetable Study Courses"}),e.jsx("span",{style:{marginLeft:10},children:e.jsx(z,{color:"green",children:m==null?void 0:m.title})})]}),width:"80vw",open:S,onClose:q=>s(q),children:e.jsx(Gt,{schoolTimetable:m,randKey:Math.random()})})]})},Qt=()=>e.jsxs("div",{style:{marginTop:10},children:[e.jsxs(ne,{children:[e.jsx(ne.Item,{children:e.jsx(je,{to:"/timetable",children:"Home"})}),e.jsx(ne.Item,{children:"Timetables"})]}),e.jsx(Jt,{})]}),Xt=()=>e.jsx(e.Fragment,{children:e.jsx(Qt,{})}),la=t=>{const{page:m}=t;return m==="SchoolTimetablesPage"?e.jsx(Xt,{}):m==="SchoolVenuesPage"?e.jsx(Kt,{}):m==="SchoolTimetableEducationLevelSchedulerPage"?e.jsx(Lt,{}):m==="SchoolTimetableStudyCourseSchedulerPage"?e.jsx(Nt,{}):m==="TimetableDashboardPage"?e.jsx(kt,{}):e.jsx("div",{children:"Page not found ..."})};export{la as TimetablePages};
