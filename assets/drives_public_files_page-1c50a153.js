import{r as a,F as x,q as L,bw as N,j as e,s as y,y as R,z as H,I as U,S as Y,a5 as j,Z as $,$ as i,a9 as G,X as J,aD as K,K as n,ea as W,a0 as X,a1 as Z,A as Q,ab as V,a2 as ee,a_ as te,ar as d,as as F,J as p,a$ as se,eb as re,au as ae}from"./index-96b6a8d9.js";import{I as ne}from"./index.es-444552bf.js";import{B as g}from"./Breadcrumb-249d9435.js";const le=oe=>{const[o,c]=a.useState([]),[k,b]=a.useState(!0),[f,I]=a.useState(1),[S,w]=a.useState(0),[C,D]=a.useState(!0),[ce,P]=a.useState(0),[O]=x.useForm();L();const[M,m]=a.useState(!1),[u,A]=a.useState(),v=!N.useBreakpoint().lg,T=t=>{A(t),m(!0)},q=async t=>{const{data:s}=await p.custom({url:"",method:"post",meta:{operation:"deleteFile",variables:{id:{value:t,type:"Int",required:!0}},fields:["success","message"]}}).catch(()=>(n.error("Error while deleting file"),{data:null})).then(r=>r);s&&(s.success?(n.success(s.message),c(o.filter(r=>r.id!==t))):n.error(s.message)),d.destroyAll()},E=t=>{d.confirm({title:"Confirm",icon:e.jsx(F,{}),content:"Deleting File ....",okText:"Delete",cancelText:"Cancel",onOk:()=>q(t)})},_=async t=>{const{data:s}=await p.custom({url:"",method:"post",meta:{operation:"makeFilePrivatePublic",variables:{id:{value:t,type:"Int",required:!0},private:{value:!1,type:"Boolean",required:!0}},fields:["success","message"]}}).catch(()=>(n.error("Error while changing file privacy"),{data:null})).then(r=>r);s&&(s.success?(n.success(s.message),c(o.filter(r=>r.id!==t))):n.error(s.message)),d.destroyAll()},z=t=>{d.confirm({title:"Confirm",icon:e.jsx(F,{}),content:"Making File Private ....",okText:"Make Private",cancelText:"Cancel",onOk:()=>_(t)})},h=async(t,s="",r=!1)=>{const{data:l}=await p.custom({url:"",method:"get",meta:{operation:"publicFiles",variables:{page:{value:t,type:"Int",required:!0},key:{value:s,type:"String",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:se}]}}).catch(()=>(n.error("Error while fetching files"),{data:null})).then(B=>B);l&&(w(l.total),P(l.pages),D(l.hasNext),I(l.page),(s.length>0||s.length===0&&r)&&c(l.results),l.results.length>0&&!r&&c(o.concat(l.results))),b(!1)};return a.useEffect(()=>{h(f)},[]),k?e.jsx(e.Fragment,{children:e.jsx("div",{style:{display:"flex",justifyContent:"center"},children:e.jsx(y,{})})}):e.jsxs(e.Fragment,{children:[e.jsx(R,{children:e.jsx(H,{span:v?24:20,children:e.jsx(x,{layout:"vertical",form:O,onFinish:t=>h(0,t.key,!0),children:e.jsx(x.Item,{name:"key",children:e.jsx(U,{size:"large",placeholder:"Search file(s)...",prefix:e.jsx(Y,{}),autoComplete:"off",allowClear:!0})})})})}),e.jsx(ne,{dataLength:S,next:()=>h(f),hasMore:C,loader:e.jsx(e.Fragment,{children:e.jsx("div",{style:{display:"flex",justifyContent:"center"},children:e.jsx(y,{})})}),endMessage:e.jsx("p",{style:{textAlign:"center",display:o.length>0?"block":"none"},children:e.jsx("b",{children:"Yay! You have seen it all"})}),children:e.jsx(j,{itemLayout:"horizontal",dataSource:o,renderItem:t=>e.jsx("div",{style:{background:"white",marginBottom:5,paddingTop:10,paddingLeft:10},children:e.jsx(j.Item,{actions:[e.jsx($,{trigger:["click"],overlay:e.jsxs(i,{children:[t.canDelete?e.jsx(i.Item,{disabled:!t.canDelete,icon:e.jsx(G,{}),onClick:()=>E(t.id),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Delete"})}):e.jsx(e.Fragment,{}),e.jsx(i.Item,{icon:e.jsx(J,{}),children:e.jsx("a",{target:"_blank",href:t.file,rel:"noopener noreferrer",download:!0,children:"Download"})}),e.jsx(i.Item,{icon:e.jsx(K,{}),onClick:()=>n("under construction"),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Share"})}),t.isPublic&&t.isAuthor?e.jsx(i.Item,{icon:e.jsx(W,{}),onClick:()=>z(t.id),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Make Private"})}):e.jsx(e.Fragment,{}),e.jsx(i.Item,{icon:e.jsx(X,{}),onClick:()=>n("Under construction"),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Report"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:s=>s.preventDefault(),children:e.jsx(Z,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})],children:e.jsx(j.Item.Meta,{avatar:e.jsx(Q,{src:t.icon}),title:e.jsx("a",{onClick:()=>T(t),children:t.title}),description:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:t.description}),e.jsxs("p",{children:[e.jsx("span",{style:{color:"orange"},children:t.size})," |",e.jsx(V,{date:new Date(t.created),locale:"en-US"})]})]})})})})})}),e.jsx(ee,{title:"File Informations",anchor:"right",width:v?"100vw":"35vw",onClose:t=>m(t),open:M,children:e.jsx(te,{id:u==null?void 0:u.id})})]})},ie=()=>e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:10,marginBottom:10},children:e.jsxs(g,{children:[e.jsxs(g.Item,{children:[e.jsx(re,{}),e.jsx(ae,{to:"/odrive",children:"Home"})]}),e.jsx(g.Item,{children:"Public Files"})]})}),e.jsx(le,{})]}),je=()=>e.jsx(ie,{});export{je as DrivesPublicFilesPage};
