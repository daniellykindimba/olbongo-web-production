import{r as t,bL as se,aC as j,aM as e,aG as Y,ay as g,M as O,cF as $,ae as E,aB as he,dc as De,d2 as qe,aJ as U,aH as ee,bP as ne,bJ as v,bK as x,aI as Ce,$ as le,cP as Z,ac as je,dd as W,S as ue,c$ as ze,de as Ae,df as Te,aA as oe,aD as T,bV as de,d7 as Se,dg as Le,cy as ce,bI as Q,cI as pe,dh as ve,bT as G,aw as C,c8 as P,co as me,bU as xe,bM as _e,aE as Ke,cq as Oe,cw as Ve,bQ as Re,cJ as we}from"./index-bf2a13da.js";import{L as ye}from"./index-8b58fb29.js";import{C as M}from"./index-992621f0.js";import{A as Ne}from"./index-aff90bba.js";import{S as H}from"./index-7bd0f27e.js";import{P as ge}from"./index-6044adfe.js";import{M as fe}from"./index-f25bf269.js";import{U as He}from"./index-0cd66826.js";import"./Skeleton-3baadd7d.js";import"./index-ffbe86f1.js";import"./ActionButton-fe9a6812.js";import"./InfoCircleFilled-d635786d.js";import"./DialogWrap-9ba665d9.js";import"./index-e25aa918.js";import"./fade-0b1d8e26.js";import"./Upload-73adfd1a.js";const Ue=()=>{const[a,o]=t.useState([]),[r,s]=t.useState(!1),[m,n]=t.useState(!1),[u,i]=t.useState(20),[c,y]=t.useState(0),[L,D]=t.useState(1);t.useState(""),se();const[V]=j.useForm(),_=async(b,N,S=20)=>{s(!0);const{data:I}=await v.custom({url:"",method:"get",meta:{operation:"messagesDispatches",variables:{page:{value:b,type:"Int",required:!0},key:{value:N,type:"String",required:!1},pageSize:{value:S,type:"Int",required:!1}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","receipientPhoneNumber","carrier",{channelMessage:["id","message",{channel:["id","name","code"]}]},{receipient:["id","firstName"]},"isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(z=>(x.error("Error fetching Recently Messages Dispatched"),{data:null})).then(z=>z);I&&(y(I.total),D(I.page+1),o([...a,...I.results])),s(!1),n(!1)},B=b=>{b.currentTarget.scrollHeight-b.currentTarget.scrollTop===window.innerHeight/1.4&&_(L,"",20)};return t.useEffect(()=>{_(L,"",20)},[]),e.jsx(e.Fragment,{children:e.jsxs(Y,{children:[e.jsx(g,{children:e.jsx("span",{style:{fontSize:16,fontWeight:"bolder"},children:"Recently Dispatched Messages"})}),e.jsx(g,{span:20,style:{height:45},children:e.jsx(j,{layout:"vertical",form:V,onFinish:b=>{n(!0),_(L,b.key,u)},children:e.jsx(j.Item,{name:"key",children:e.jsx(O,{size:"large",disabled:m,placeholder:"Search Phone Number(s)...",prefix:e.jsx($,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(g,{span:4,style:{display:"flex",justifyContent:"flex-start",height:45},children:e.jsx(E,{size:"large",icon:e.jsx($,{}),onClick:()=>{V.submit()},loading:m||r,disabled:m||r})}),e.jsxs(g,{span:24,children:[a.length===0&&e.jsx(he,{image:"/images/nodata.png",imageStyle:{height:160},description:e.jsx("span",{style:{fontSize:16},children:"No recently dispatched message ..."})}),e.jsx(ye,{style:{paddingRight:10},children:e.jsx(De,{data:a,height:window.innerHeight/1.4,itemHeight:47,itemKey:"phoneNumber",onScroll:B,children:b=>{var N,S;return e.jsx(M,{children:e.jsx(ye.Item,{children:e.jsx(ye.Item.Meta,{avatar:e.jsx(Ne,{icon:e.jsx(qe,{})}),title:e.jsxs("a",{children:[b.receipientPhoneNumber,e.jsxs("span",{style:{marginLeft:5},children:[e.jsx(U,{color:"green",children:(S=(N=b==null?void 0:b.channelMessage)==null?void 0:N.channel)==null?void 0:S.name}),b.carrier&&e.jsx(U,{color:"red",children:b.carrier})]})]}),description:e.jsx(e.Fragment,{children:e.jsxs(ee,{direction:"vertical",children:[e.jsx("span",{children:b.channelMessage.message.length>100?b.channelMessage.message.substring(0,100)+"...":b.channelMessage.message}),e.jsxs("span",{children:[e.jsx("b",{children:"Dispatched"}),":"," ",ne(b.created).format("lll")]})]})})})},b.receipientPhoneNumber)})}})})]})]})})},Be=a=>{const[o,r]=t.useState([]);t.useState();const[s,m]=t.useState(!1),[n,u]=t.useState(!1),[i,c]=t.useState(20),[y,L]=t.useState(0),[D,V]=t.useState("");se();const[_]=j.useForm(),B=async(N,S,I=20)=>{m(!0);const{data:z}=await v.custom({url:"",method:"get",meta:{operation:"channelMessageDispatches",variables:{page:{value:N,type:"Int",required:!0},key:{value:S,type:"String",required:!1},pageSize:{value:I,type:"Int",required:!1},filterType:{value:a.filterType,type:"String",required:!0},messageId:{value:a.messageId,type:"Int",required:!0}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","receipientPhoneNumber","status","statusColor","carrier","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(K=>(x.error("Error fetching Dispatches"),{data:null})).then(K=>K);z&&(L(z.total),r(z.results)),m(!1),u(!1)},b=[{title:"Phone Number",dataIndex:"phoneNumber",key:"phoneNumber",render:(N,S,I)=>e.jsx("a",{onClick:()=>{},children:S.receipientPhoneNumber})},{title:"Carrier",dataIndex:"carrier",key:"carrier",render:(N,S,I)=>e.jsx(U,{color:"green",children:S.carrier})},{title:"Created",dataIndex:"created",key:"created",render:(N,S,I)=>e.jsx(le,{title:ne(S.created).format("Y-mm-d hh:mm:ss"),children:e.jsx("span",{children:ne(S.created).format("Y-mm-d hh:mm:ss")})})},{title:"Status",dataIndex:"status",key:"status",render:(N,S,I)=>e.jsx(U,{color:S.statusColor,children:S.status})},{title:"",dataIndex:"Action",key:"action",render:(N,S,I)=>e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"}})}];return t.useEffect(()=>{B(1,"",20)},[a.randKey,a.filterType]),e.jsxs(e.Fragment,{children:[e.jsx(Y,{children:e.jsx(g,{span:24,children:e.jsx(j,{layout:"vertical",form:_,onFinish:N=>{u(!0),B(0,N.key,i)},children:e.jsx(j.Item,{name:"key",children:e.jsx(O,{size:"large",disabled:n,placeholder:"Search Phone Number(s)...",prefix:e.jsx($,{}),autoComplete:"off",allowClear:!0})})})})}),e.jsx(Ce,{loading:s,columns:b,dataSource:o,pagination:{onChange:(N,S)=>{c(S),B(N,D,S)},total:y,pageSize:i,position:["bottomCenter"],showQuickJumper:!0},scroll:{x:!0,y:"40vh"}})]})},Ye=["receipients","delivered","notdelivered","failed"],We=["All Receipients","All Delivered","All Not Delivered","All Failed"],Ie=a=>{var c;Z(),se();const[o,r]=t.useState(!1),[s,m]=t.useState(),[n,u]=t.useState("receipients"),i=async()=>{var L;r(!0);const{data:y}=await v.custom({url:"",method:"get",meta:{operation:"channelMessageDispatchAnalytics",variables:{messageId:{value:(L=a.channelMessage)==null?void 0:L.id,type:"Int",required:!0}},fields:["analytics"]}}).catch(D=>(x.error("Error fetching Message Dispatch analytics"),{data:null})).then(D=>D);y&&m(y.analytics),r(!1)};return t.useEffect(()=>{i()},[a.randKey]),e.jsx(e.Fragment,{children:e.jsxs(je,{spinning:o,children:[e.jsxs(Y,{style:{display:"flex",justifyContent:"center",marginTop:2},children:[e.jsx(g,{span:6,children:e.jsx("a",{onClick:()=>u("receipients"),children:e.jsx(M,{children:e.jsx(H,{title:"Total Receipients",value:s==null?void 0:s.total_receipients,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:6,children:e.jsx("a",{onClick:()=>u("delivered"),children:e.jsx(M,{children:e.jsx(H,{title:"Delivered",value:s==null?void 0:s.total_delivered,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:6,children:e.jsx("a",{onClick:()=>u("notdelivered"),children:e.jsx(M,{children:e.jsx(H,{title:"Not Delievered",value:s==null?void 0:s.total_not_delivered,precision:0,valueStyle:{color:"#5E0321"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:6,children:e.jsx("a",{onClick:()=>u("failed"),children:e.jsx(M,{children:e.jsx(H,{title:"Failed",value:s==null?void 0:s.total_failed,precision:0,valueStyle:{color:"#700107"},prefix:e.jsx(W,{})})})})})]}),e.jsxs("div",{style:{marginTop:2},children:[e.jsx("h3",{children:We[Ye.indexOf(n)]}),e.jsx(Be,{randKey:Math.random(),filterType:n,messageId:(c=a.channelMessage)==null?void 0:c.id})]})]})})},{TextArea:$e}=O,Je=a=>{const[o,r]=t.useState([]),s=async(i=1,c=25,y="")=>{const{data:L}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannels",variables:{page:{value:i,type:"Int",required:!0},pageSize:{value:c,type:"Int",required:!0},key:{value:y,type:"String",required:!1}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","name","code"]}]}}).catch(D=>(x.error("Error fetching Channels"),{data:null})).then(D=>D);L&&r(L.results)},m=async i=>{const{data:c}=await v.custom({url:"",method:"post",meta:{operation:"createNjiwaChannelMessage",variables:{channelId:{value:parseInt(i.channel),type:"Int",required:!0},message:{value:i.message,type:"String",required:!1}},fields:["success","message",{njiwaChannelMessage:["id","message",{channel:["id","name","code"]},{creator:["id","firstName","middleName","lastName","fullName"]},"messageCount","dispatched","created","updated","isActive","canDelete","canEdit","canManage"]}]}}).catch(y=>(x.error("Error creating channel message"),{data:null})).then(y=>y);c&&(c.success?(x.success(c.message),a.onFinish(c.njiwaChannelMessage)):x.error(c.message))},n=i=>{},u=i=>{};return t.useEffect(()=>{s()},[a.randKey]),e.jsx(e.Fragment,{children:e.jsxs(j,{layout:"vertical",form:a.form,onFinish:i=>{m(i)},requiredMark:!0,children:[e.jsx(j.Item,{name:"message",label:"Message",rules:[{required:!0,type:"string",message:"Please input Message"}],children:e.jsx($e,{rows:4})}),e.jsx(j.Item,{name:"channel",label:"Channel",rules:[{required:!0,type:"number",message:"Please Choose Channel ..."}],children:e.jsx(ue,{size:"large",showSearch:!0,placeholder:"Select a Channel ...",optionFilterProp:"children",onChange:n,onSearch:u,filterOption:(i,c)=>((c==null?void 0:c.label)??"").toLowerCase().includes(i.toLowerCase()),options:o.map(i=>({value:i.id,label:i.name+" --> "+i.code})),dropdownStyle:{zIndex:9999}})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(E,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},Fe=a=>{const[o,r]=t.useState([]),[s,m]=t.useState(),[n,u]=t.useState(!1),[i,c]=t.useState(!1),[y,L]=t.useState(20);t.useState(""),se(),j.useForm();const[D]=j.useForm(),[V,_]=t.useState(!1),[B,b]=t.useState(!1),N=async l=>{m(l),_(!0)},S=async l=>{const{data:w}=await v.custom({url:"",method:"post",meta:{operation:"deleteNjiwaChannelMessage",variables:{id:{value:l,type:"Int",required:!0}},fields:["success","message"]}});w.success?(x.success(w.message),r(o.filter(F=>F.id.toString()!==l.toString()))):x.error(w.message)},I=async l=>{const{data:w}=await v.custom({url:"",method:"post",meta:{operation:"dispatchChannelMessage",variables:{channelMessageId:{value:l,type:"Int",required:!0}},fields:["success","message",{channelMessage:["id","message",{channel:["id","name","code"]},{creator:["id","firstName","middleName","lastName","fullName"]},"messageCount","dispatched","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(F=>(x.error(F.message),{data:null})).then(F=>F);w&&(w.success?(r(o.map(F=>F.id===w.channelMessage.id?w.channelMessage:F)),x.success(w.message)):x.error(w.message))},z=l=>{fe.confirm({title:"Deleting Njiwa Channel Message",icon:e.jsx(pe,{}),content:"Are you sure ...",okText:"Delete",cancelText:"Cancel",onOk:()=>S(parseInt(l.toString()))})},K=async(l,w,F=20)=>{u(!0);const{data:X}=await v.custom({url:"",method:"get",meta:{operation:"njiwaChannelsMessages",variables:{page:{value:l,type:"Int",required:!0},key:{value:w,type:"String",required:!1},pageSize:{value:F,type:"Int",required:!0}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","message",{channel:["id","name","code"]},{creator:["id","firstName","middleName","lastName","fullName"]},"messageCount","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(te=>({data:null})).then(te=>te);X&&r(X.results),u(!1),c(!1)},R=async l=>{r([l,...o]),b(!1)};return t.useEffect(()=>{K(1,"",20)},[]),e.jsxs(e.Fragment,{children:[e.jsxs(Y,{children:[e.jsx(g,{span:14,children:e.jsx(j,{layout:"vertical",form:D,onFinish:l=>{c(!0),K(0,l.key,y)},children:e.jsx(j.Item,{name:"key",children:e.jsx(O,{size:"large",disabled:i,placeholder:"Search Channel Message(s)...",prefix:e.jsx($,{}),autoComplete:"off",autoFocus:!0,allowClear:!0})})})}),e.jsx(g,{span:6,style:{display:"flex",justifyContent:"flex-start"},children:e.jsx(E,{size:"large",icon:e.jsx($,{}),onClick:()=>{D.submit()},loading:i||n,disabled:i||n})}),e.jsx(g,{span:4,style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(le,{title:"Click to Create Message",placement:"top",color:"green",children:e.jsx(E,{size:"large",icon:e.jsx(ze,{}),onClick:()=>{b(!0)},loading:i||n,disabled:i||n,style:{marginRight:30}})})})]}),e.jsx(je,{spinning:n,children:e.jsx("div",{style:{maxHeight:a.dash?"69vh":"",overflowY:"auto"},children:e.jsxs(Y,{align:"top",children:[o.length===0&&!n&&e.jsx(g,{span:24,style:{display:"flex",justifyContent:"center"},children:e.jsx(he,{image:"/images/nodata.png",imageStyle:{height:160},description:e.jsx("span",{style:{fontSize:16},children:"No Message Found ..."})})}),o.map(l=>{var w;return e.jsx(g,{span:24,children:e.jsxs(M,{hoverable:l.isActive,style:{marginRight:10,marginBottom:3},children:[e.jsxs(ee,{style:{right:0,position:"absolute"},children:[l.dispatched?e.jsx(e.Fragment,{children:e.jsx(le,{title:"Dispatched",placement:"top",color:"green",children:e.jsx(Ae,{style:{color:"green"}})})}):e.jsx(e.Fragment,{children:e.jsx(le,{title:"Not Dispatched",placement:"top",color:"red",children:e.jsx(Te,{style:{color:"red"}})})}),e.jsx(oe,{trigger:["click"],overlay:e.jsxs(T,{children:[e.jsx(T.Item,{icon:e.jsx(de,{}),onClick:()=>{z(l.id)},disabled:!(l!=null&&l.canDelete),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Delete"})}),!l.dispatched&&e.jsx(T.Item,{icon:e.jsx(Se,{}),disabled:!(l!=null&&l.canDelete),children:e.jsx(ge,{title:"Are you sure to Start Sending/Dispatching SMS?",onConfirm:()=>I(l.id),onCancel:()=>{},okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Dispatch"})})}),e.jsx(T.Item,{icon:e.jsx(Le,{}),disabled:!(l!=null&&l.canDelete),onClick:()=>N(l),children:e.jsx("a",{rel:"noopener noreferrer",children:"Dispatch Report"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:F=>F.preventDefault(),children:e.jsx(ce,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})]}),e.jsxs(ee,{direction:"vertical",style:{width:"100%",justifyContent:"center"},onClick:()=>{},children:[e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Created By:"}),e.jsx("span",{style:{marginLeft:5},children:(w=l==null?void 0:l.creator)==null?void 0:w.fullName})]}),e.jsx("span",{children:l.message}),e.jsxs(ee,{direction:"horizontal",children:[e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Created On:"}),e.jsx("span",{style:{marginLeft:5},children:ne(l.created).format("YYYY/MM/DD HH:MM")})]}),e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Channel:"}),e.jsxs("span",{style:{marginLeft:5},children:[l==null?void 0:l.channel.name,e.jsx("span",{style:{marginLeft:10},children:e.jsx(U,{color:"green",children:l==null?void 0:l.channel.code})})]})]}),e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Message Count:"}),e.jsx("span",{style:{marginLeft:5},children:e.jsx(U,{color:"green",children:l==null?void 0:l.messageCount})})]})]})]})]})})})]})})}),e.jsx(Q,{title:"Dispatch Report",width:"50vw",open:V,onClose:l=>_(l),children:e.jsx(Ie,{randKey:Math.random(),channelMessage:s})}),e.jsx(Q,{title:"Creating Message",open:B,width:"40vw",onClose:l=>b(l),children:e.jsx(Je,{onFinish:R})})]})},Qe=a=>{const[o,r]=t.useState(!1),[s,m]=t.useState(),{push:n}=se(),u=async()=>{r(!0);const{data:i}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolAnalytic",fields:["analytics"]}}).catch(c=>(x.error("Error fetching analytics"),{data:null})).then(c=>c);i&&m(i.analytics),r(!1)};return t.useEffect(()=>{u()},[a.randKey]),e.jsxs(e.Fragment,{children:[e.jsxs(Y,{style:{display:"flex",justifyContent:"center"},children:[e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>{},children:e.jsx(M,{children:e.jsx(H,{title:"Balances (Units)",value:s==null?void 0:s.balances,precision:0,valueStyle:{color:"#3f8600"}})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>n("/njiwa/channels"),children:e.jsx(M,{children:e.jsx(H,{title:"Channels",value:s==null?void 0:s.channels,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>n("/njiwa/contacts/phonenumbers"),children:e.jsx(M,{children:e.jsx(H,{title:"Phone Numbers",value:s==null?void 0:s.phone_numbers,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>n("/njiwa/contacts/emails"),children:e.jsx(M,{children:e.jsx(H,{title:"Emails",value:s==null?void 0:s.emails,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>n("/njiwa/messages"),children:e.jsx(M,{children:e.jsx(H,{title:"Messages",value:s==null?void 0:s.messages,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>n("/njiwa/messages/sent"),children:e.jsx(M,{children:e.jsx(H,{title:"Pending Messages",value:s==null?void 0:s.sent_messages,precision:0,valueStyle:{color:"#770622"},prefix:e.jsx(ve,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>n("/njiwa/messages/sent"),children:e.jsx(M,{children:e.jsx(H,{title:"Sent Messages",value:s==null?void 0:s.sent_messages,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>n("/njiwa/messages/failed"),children:e.jsx(M,{children:e.jsx(H,{title:"Failed Messages",value:s==null?void 0:s.failed_messages,precision:0,valueStyle:{color:"#861400"},prefix:e.jsx(ve,{})})})})})]}),e.jsxs(Y,{children:[e.jsx(g,{span:12,children:e.jsxs("div",{style:{marginTop:20},children:[e.jsx("span",{style:{fontSize:16,fontWeight:"bolder"},children:"Messages"}),e.jsx(Fe,{dash:!0})]})}),e.jsx(g,{span:12,children:e.jsx("div",{style:{marginTop:20},children:e.jsx(Ue,{})})})]})]})},Ge=()=>(t.useEffect(()=>{document.title=G.system_name+": Njiwa"},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa",children:"Home"})}),e.jsx("span",{children:"Channels"})]})}),e.jsx(Qe,{})]})),{TextArea:Xe}=O,ke=a=>{const o=async r=>{const{data:s}=await v.custom({url:"",method:"post",meta:{operation:"createNjiwaChannel",variables:{name:{value:r.name,type:"String",required:!0},description:{value:r.description,type:"String",required:!1}},fields:["success","message",{njiwaChannel:["id","name","description","code","icon","created","updated","isActive","canDelete","canEdit","canManage"]}]}}).catch(m=>(x.error("Error creating channel"),{data:null})).then(m=>m);s&&(s.success?(x.success(s.message),a.onFinish(s.njiwaChannel)):x.error(s.message))};return t.useEffect(()=>{},[a.randKey]),e.jsx(e.Fragment,{children:e.jsxs(j,{layout:"vertical",form:a.form,onFinish:r=>{o(r)},requiredMark:!0,children:[e.jsx(j.Item,{name:"name",label:"Name",rules:[{required:!0,type:"string",message:"Please input Channel Name ..."}],children:e.jsx(O,{size:"large",placeholder:"Enter Channel Name ..."})}),e.jsx(j.Item,{name:"description",label:"Description",rules:[{required:!1,type:"string",message:"Please input Description"}],children:e.jsx(Xe,{rows:4})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(E,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},{TextArea:Ze}=O,es=a=>{const o=async r=>{var m;const{data:s}=await v.custom({url:"",method:"post",meta:{operation:"updateNjiwaChannel",variables:{channelId:{value:(m=a.channel)==null?void 0:m.id,type:"Int",required:!0},name:{value:r.name,type:"String",required:!0},description:{value:r.description,type:"String",required:!1}},fields:["success","message",{njiwaChannel:["id","name","description","code","icon","created","updated","isActive","canDelete","canEdit","canManage"]}]}}).catch(n=>(x.error("Error Updating channel"),{data:null})).then(n=>n);s&&(s.success?(x.success(s.message),a.onFinish(s.njiwaChannel)):x.error(s.message))};return t.useEffect(()=>{var r,s;a.form.setFieldsValue({name:(r=a.channel)==null?void 0:r.name,description:(s=a.channel)==null?void 0:s.description})},[a.randKey]),e.jsx(e.Fragment,{children:e.jsxs(j,{layout:"vertical",form:a.form,onFinish:r=>{o(r)},requiredMark:!0,autoComplete:"off",children:[e.jsx(j.Item,{name:"name",label:"Name",rules:[{required:!0,type:"string",message:"Please input Channel Name"}],children:e.jsx(O,{size:"large",placeholder:"Enter Channel Name ..."})}),e.jsx(j.Item,{name:"description",label:"Description",rules:[{required:!1,type:"string",message:"Please input Description"}],children:e.jsx(Ze,{rows:4,maxLength:6})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(E,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},ss=a=>{const[o,r]=t.useState([]),[s,m]=t.useState(),[n,u]=t.useState(!1),[i,c]=t.useState(!1),[y,L]=t.useState(0),[D,V]=t.useState(1),[_,B]=t.useState(30),[b,N]=t.useState(""),{push:S}=se(),[I,z]=t.useState(!1),[K,R]=t.useState(!1),[l]=j.useForm(),[w]=j.useForm(),[F]=j.useForm(),X=d=>{V(d),q(d,b,_)},te=d=>{m(d),R(!0)},ae=()=>{z(!0)},ie=async d=>{r([d,...o]),l.resetFields(),z(!1)},re=async d=>{const h=o.findIndex(f=>f.id===d.id);o[h]=d,r([...o]),w.resetFields(),R(!1)},p=async d=>{const{data:h}=await v.custom({url:"",method:"post",meta:{operation:"deleteNjiwaChannel",variables:{channelId:{value:d,type:"Int",required:!0}},fields:["success","message"]}}).catch(f=>(x.error(f.message),{data:null})).then(f=>f);h&&(h.success?(x.success(h.message),r(o.filter(f=>f.id.toString()!==d.toString()))):x.error(h.message))},k=d=>{fe.confirm({title:e.jsxs(e.Fragment,{children:["Deleting ",d.name," Channel"]}),icon:e.jsx(pe,{}),content:"Are you sure ...",okText:"Yes",cancelText:"Cancel",onOk:()=>p(parseInt(d.id.toString()))})},q=async(d,h,f=20)=>{u(!0);const{data:A}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannels",variables:{page:{value:d,type:"Int",required:!0},key:{value:h,type:"String",required:!1},pageSize:{value:f,type:"Int",required:!0}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","name","code","description","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(J=>(x.error("Error fetching channels"),{data:null})).then(J=>J);A&&(L(A.total),r(A.results)),u(!1),c(!1)};return t.useEffect(()=>{q(1,b,_)},[a.randKey]),e.jsxs(e.Fragment,{children:[e.jsxs(Y,{children:[e.jsx(g,{span:14,children:e.jsx(j,{layout:"vertical",form:F,onFinish:d=>{N(d.key),c(!0),q(0,d.key,_)},children:e.jsx(j.Item,{name:"key",children:e.jsx(O,{size:"large",disabled:i,placeholder:"Search Channel(s)...",prefix:e.jsx($,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(g,{span:6,style:{display:"flex",justifyContent:"flex-start"},children:e.jsx(E,{size:"large",icon:e.jsx($,{}),onClick:()=>{F.submit()},loading:i||n,disabled:i||n})}),e.jsx(g,{span:4,style:{display:"flex",justifyContent:"flex-end"},children:e.jsxs(E,{size:"large",disabled:n||i,onClick:()=>{l.resetFields(),ae()},children:[e.jsx(me,{}),"Create Channel"]})})]}),e.jsxs(je,{spinning:n,size:"large",children:[e.jsxs(Y,{align:"top",children:[o.length===0&&!n&&e.jsx(g,{span:24,style:{display:"flex",justifyContent:"center"},children:e.jsx(he,{image:"/images/nodata.png",imageStyle:{height:160},description:e.jsx("span",{style:{fontSize:16},children:"No Communication Channel Found ..."}),children:e.jsx(E,{type:"primary",onClick:()=>{l.resetFields(),ae()},children:"Create Channel Now"})})}),o.map(d=>e.jsx(g,{span:4,children:e.jsxs(M,{hoverable:d.isActive,style:{marginRight:10},children:[e.jsx(ee,{style:{right:0,position:"absolute"},children:e.jsx(oe,{trigger:["click"],overlay:e.jsxs(T,{children:[e.jsx(T.Item,{icon:e.jsx(xe,{}),onClick:()=>{te(d)},disabled:!(d!=null&&d.canDelete),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Edit"})}),e.jsx(T.Item,{icon:e.jsx(de,{}),onClick:()=>{k(d)},disabled:!(d!=null&&d.canDelete),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Delete"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:h=>h.preventDefault(),children:e.jsx(ce,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})}),e.jsx("a",{onClick:()=>S("/njiwa/channel/"+d.id+"/"+d.name),children:e.jsxs(ee,{direction:"vertical",align:"center",style:{width:"100%",justifyContent:"center"},onClick:()=>{},children:[e.jsx(Ne,{size:{xs:24,sm:32,md:40,lg:40,xl:40,xxl:80},icon:e.jsx(_e,{}),src:d.icon}),e.jsx(le,{title:d.name,children:d.name.length>10?d.name.substring(0,10)+"...":d.name}),e.jsx("span",{children:e.jsx(U,{color:"green",children:d.code})})]})})]})}))]}),o.length>0&&e.jsx(Y,{style:{display:"flex",justifyContent:"center"},children:e.jsx("span",{style:{marginTop:20},children:e.jsx(Ke,{showQuickJumper:!0,showTotal:(d,h)=>`Total ${d} Channels`,defaultCurrent:D,total:y,pageSize:_,onChange:X,showSizeChanger:!0,onShowSizeChange:(d,h)=>{B(h),q(d,b,h)},disabled:n||i})})})]}),e.jsx(Q,{title:"Create Njiwa Channel",width:"40vw",open:I,onClose:d=>z(d),children:e.jsx(ke,{form:l,randKey:Math.random(),onFinish:ie})}),e.jsx(Q,{title:"Edit "+(s==null?void 0:s.name)+" Channel",width:"40vw",open:K,onClose:d=>R(d),children:e.jsx(es,{form:w,randKey:Math.random(),onFinish:re,channel:s})})]})},ts=()=>(t.useEffect(()=>{document.title=G.system_name+": Channels"},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:5,marginBottom:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa",children:"Home"})}),e.jsx("span",{children:"Channels"})]})}),e.jsx(ss,{randKey:Math.random()})]})),ns=a=>(t.useEffect(()=>{},[a.randKey]),e.jsx(e.Fragment,{children:e.jsx("p",{children:"Channel Emails"})})),as=a=>{const[o,r]=t.useState(!1),[s,m]=t.useState(),n=Z(),u=async()=>{r(!0);const{data:i}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannel",variables:{channelId:{value:parseInt(n.channelId),type:"Int",required:!0}},fields:["id","name","description","code","isActive","created","updated","canEdit","canDelete","canManage"]}}).catch(c=>(x.error("Error fetching channel"),{data:null})).then(c=>c);i&&m(i),r(!1)};return t.useEffect(()=>{document.title=G.system_name+": Channel Emails",u()},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:5,marginBottom:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa",children:"Home"})}),e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa/channels",children:"Channels"})}),e.jsx(C.Item,{children:e.jsxs(P,{to:"/njiwa/channel/"+(s==null?void 0:s.id)+"/"+(s==null?void 0:s.name),children:[s==null?void 0:s.name,e.jsx("span",{style:{marginLeft:10},children:e.jsx(U,{color:"green",children:s==null?void 0:s.code})})]})}),e.jsx("span",{children:"Emails"})]})}),e.jsx(ns,{randKey:Math.random(),channel:s})]})},rs=a=>(t.useEffect(()=>{},[a.randKey]),e.jsx(e.Fragment,{children:e.jsx("p",{children:"Channel Failed Messages"})})),is=a=>{const[o,r]=t.useState(!1),[s,m]=t.useState(),n=Z(),u=async()=>{r(!0);const{data:i}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannel",variables:{channelId:{value:parseInt(n.channelId),type:"Int",required:!0}},fields:["id","name","description","code","isActive","created","updated","canEdit","canDelete","canManage"]}}).catch(c=>(x.error("Error fetching channel"),{data:null})).then(c=>c);i&&m(i),r(!1)};return t.useEffect(()=>{document.title=G.system_name+": Failed Messages",u()},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa",children:"Home"})}),e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa/channels",children:"Channels"})}),e.jsx(C.Item,{children:e.jsxs(P,{to:"/njiwa/channel/"+(s==null?void 0:s.id)+"/"+(s==null?void 0:s.name),children:[s==null?void 0:s.name,e.jsx("span",{style:{marginLeft:10},children:e.jsx(U,{color:"green",children:s==null?void 0:s.code})})]})}),e.jsx(C.Item,{children:"Messages"}),e.jsx("span",{children:"Failed"})]})}),e.jsx(rs,{randKey:Math.random(),channel:s})]})},{TextArea:ls}=O,os=a=>{const o=Z(),r=async s=>{const{data:m}=await v.custom({url:"",method:"post",meta:{operation:"createNjiwaChannelMessage",variables:{channelId:{value:parseInt(o.channelId),type:"Int",required:!0},message:{value:s.message,type:"String",required:!1}},fields:["success","message",{njiwaChannelMessage:["id","message",{channel:["id","name","code"]},{creator:["id","firstName","middleName","lastName","fullName"]},"messageCount","created","updated","isActive","canDelete","canEdit","canManage"]}]}}).catch(n=>(x.error("Error creating channel message"),{data:null})).then(n=>n);m&&(m.success?(x.success(m.message),a.onFinish(m.njiwaChannelMessage)):x.error(m.message))};return t.useEffect(()=>{},[a.randKey]),e.jsx(e.Fragment,{children:e.jsxs(j,{layout:"vertical",form:a.form,onFinish:s=>{r(s)},requiredMark:!0,children:[e.jsx(j.Item,{name:"message",label:"Message",rules:[{required:!0,type:"string",message:"Please input Message"}],children:e.jsx(ls,{rows:4})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(E,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},{TextArea:ds}=O,cs=a=>{Z();const o=async r=>{const{data:s}=await v.custom({url:"",method:"post",meta:{operation:"updateNjiwaChannelMessage",variables:{channelMessageId:{value:r.channel_message_id,type:"Int",required:!0},message:{value:r.message,type:"String",required:!1}},fields:["success","message",{njiwaChannelMessage:["id","message",{channel:["id","name","code"]},{creator:["id","firstName","middleName","lastName","fullName"]},"created","updated","isActive","canDelete","canEdit","canManage"]}]}}).catch(m=>(x.error("Error creating channel message"),{data:null})).then(m=>m);s&&(s.success?(x.success(s.message),a.onFinish(s.njiwaChannelMessage)):x.error(s.message))};return t.useEffect(()=>{var r;a.form.setFieldsValue({message:(r=a==null?void 0:a.channelMessage)==null?void 0:r.message})},[a.randKey]),e.jsx(e.Fragment,{children:e.jsxs(j,{layout:"vertical",form:a.form,onFinish:r=>{var s;r.channel_message_id=(s=a.channelMessage)==null?void 0:s.id,o(r)},requiredMark:!0,children:[e.jsx(j.Item,{name:"message",label:"Message",rules:[{required:!0,type:"string",message:"Please input Message"}],children:e.jsx(ds,{rows:4})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(E,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},hs=a=>{const[o,r]=t.useState([]),[s,m]=t.useState(),[n,u]=t.useState(!1),[i,c]=t.useState(!1),[y,L]=t.useState(20);t.useState(""),se();const[D,V]=t.useState(!1),[_,B]=t.useState(!1),[b,N]=t.useState(!1),[S]=j.useForm(),[I]=j.useForm(),[z]=j.useForm(),K=Z(),R=p=>{m(p),N(!0)},l=p=>{m(p),B(!0)},w=()=>{V(!0)},F=async p=>{r([p,...o]),S.resetFields(),V(!1)},X=async p=>{r(o.map(k=>k.id.toString()===p.id.toString()?p:k)),I.resetFields(),B(!1)},te=async p=>{const{data:k}=await v.custom({url:"",method:"post",meta:{operation:"deleteNjiwaChannelMessage",variables:{channelMessageId:{value:p,type:"Int",required:!0}},fields:["success","message"]}});k.success?(x.success(k.message),r(o.filter(q=>q.id.toString()!==p.toString()))):x.error(k.message)},ae=async p=>{x("dispatching");const{data:k}=await v.custom({url:"",method:"post",meta:{operation:"dispatchChannelMessage",variables:{channelMessageId:{value:p,type:"Int",required:!0}},fields:["success","message"]}}).catch(q=>(x.error(q.message),{data:null})).then(q=>q);k&&(k.success?x.success(k.message):x.error(k.message))},ie=p=>{fe.confirm({title:"Deleting Njiwa Channel Message",icon:e.jsx(pe,{}),content:"Are you sure ...",okText:"Delete",cancelText:"Cancel",onOk:()=>te(parseInt(p.toString()))})},re=async(p,k,q=20)=>{const{data:d}=await v.custom({url:"",method:"get",meta:{operation:"njiwaChannelMessages",variables:{page:{value:p,type:"Int",required:!0},key:{value:k,type:"String",required:!1},pageSize:{value:q,type:"Int",required:!1},channelId:{value:parseInt(K.channelId),type:"Int",required:!0}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","message",{channel:["id","name","code"]},{creator:["id","firstName","middleName","lastName","fullName"]},"messageCount","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(h=>(x.error("Failed to fetch Channel Messages"),{data:null})).then(h=>h);d&&r(d.results),u(!1),c(!1)};return t.useEffect(()=>{re(1,"",20)},[a.randKey]),e.jsxs(e.Fragment,{children:[e.jsxs(Y,{children:[e.jsx(g,{span:14,children:e.jsx(j,{layout:"vertical",form:z,onFinish:p=>{c(!0),re(0,p.key,y)},children:e.jsx(j.Item,{name:"key",children:e.jsx(O,{size:"large",disabled:i,placeholder:"Search Channel Message(s)...",prefix:e.jsx($,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(g,{span:6,style:{display:"flex",justifyContent:"flex-start"},children:e.jsx(E,{size:"large",icon:e.jsx($,{}),onClick:()=>{z.submit()},loading:i||n,disabled:i||n})}),e.jsx(g,{span:4,style:{display:"flex",justifyContent:"flex-end"},children:e.jsxs(E,{size:"large",disabled:n||i,onClick:()=>{S.resetFields(),w()},children:[e.jsx(me,{}),"Create Message"]})})]}),e.jsx(je,{spinning:n,children:e.jsxs(Y,{align:"top",children:[o.length===0&&!n&&e.jsx(g,{span:24,style:{display:"flex",justifyContent:"center"},children:e.jsx(he,{image:"/images/nodata.png",imageStyle:{height:160},description:e.jsx("span",{style:{fontSize:16},children:"No Communication Channel Found ..."}),children:e.jsx(E,{type:"primary",onClick:()=>{S.resetFields(),w()},children:"Create Message"})})}),o.map(p=>{var k;return e.jsx(g,{span:24,children:e.jsxs(M,{hoverable:p.isActive,style:{marginRight:10},children:[e.jsx(ee,{style:{right:0,position:"absolute"},children:e.jsx(oe,{trigger:["click"],overlay:e.jsxs(T,{children:[e.jsx(T.Item,{icon:e.jsx(xe,{}),onClick:()=>{l(p)},disabled:!(p!=null&&p.canDelete),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Edit"})}),e.jsx(T.Item,{icon:e.jsx(de,{}),onClick:()=>{ie(p.id)},disabled:!(p!=null&&p.canDelete),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Delete"})}),e.jsx(T.Item,{icon:e.jsx(Se,{}),disabled:!(p!=null&&p.canDelete),children:e.jsx(ge,{title:"Are you sure to Start Sending/Dispatching SMS?",onConfirm:()=>ae(p.id),onCancel:()=>{},okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Dispatch"})})}),e.jsx(T.Item,{icon:e.jsx(Oe,{}),onClick:()=>{R(p)},disabled:!(p!=null&&p.canDelete),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Dispatch Report"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:q=>q.preventDefault(),children:e.jsx(ce,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})}),e.jsxs(ee,{direction:"vertical",style:{width:"100%",justifyContent:"center"},onClick:()=>{},children:[e.jsx("span",{children:p.message}),e.jsxs(ee,{direction:"horizontal",children:[e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Created On:"}),e.jsx("span",{style:{marginLeft:5},children:ne(p.created).format("YYYY/MM/DD HH:MM")})]}),e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Created By:"}),e.jsx("span",{style:{marginLeft:5},children:(k=p==null?void 0:p.creator)==null?void 0:k.fullName})]}),e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Channel:"}),e.jsx("span",{style:{marginLeft:5},children:p==null?void 0:p.channel.name})]}),e.jsxs("span",{children:[e.jsx("span",{style:{fontWeight:"bolder"},children:"Message Count:"}),e.jsx("span",{style:{marginLeft:5},children:e.jsx(U,{color:"green",children:p==null?void 0:p.messageCount})})]})]})]})]})})})]})}),e.jsx(Q,{title:"Create Njiwa Channel Message",width:"40vw",open:D,onClose:p=>V(p),children:e.jsx(os,{form:S,randKey:Math.random(),onFinish:F})}),e.jsx(Q,{title:"Edit Njiwa Channel Message",width:"40vw",open:_,onClose:p=>B(p),children:e.jsx(cs,{form:I,randKey:Math.random(),onFinish:X,channelMessage:s})}),e.jsx(Q,{title:"Dispatch Report",width:"50vw",open:b,onClose:p=>N(p),children:e.jsx(Ie,{randKey:Math.random(),channelMessage:s})})]})},us=a=>{const[o,r]=t.useState(!1),[s,m]=t.useState(),n=Z(),u=async()=>{r(!0);const{data:i}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannel",variables:{channelId:{value:parseInt(n.channelId),type:"Int",required:!0}},fields:["id","name","description","code","isActive","created","updated","canEdit","canDelete","canManage"]}}).catch(c=>(x.error("Error fetching channel"),{data:null})).then(c=>c);i&&m(i),r(!1)};return t.useEffect(()=>{document.title=G.system_name+": Channel Messages",u()},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa",children:"Home"})}),e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa/channels",children:"Channels"})}),e.jsx(C.Item,{children:e.jsxs(P,{to:"/njiwa/channel/"+(s==null?void 0:s.id)+"/"+(s==null?void 0:s.name),children:[s==null?void 0:s.name,e.jsx("span",{style:{marginLeft:10},children:e.jsx(U,{color:"green",children:s==null?void 0:s.code})})]})}),e.jsx("span",{children:"Messages"})]})}),e.jsx(hs,{randKey:Math.random(),channel:s})]})},ms=a=>{const o=Z(),{push:r}=se(),[s,m]=t.useState(!1),[n,u]=t.useState(),i=async()=>{m(!0);const{data:c}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannelAnalytic",variables:{channelId:{value:parseInt(o.channelId),type:"Int",required:!0}},fields:["analytics"]}}).catch(y=>(x.error("Error fetching analytics"),{data:null})).then(y=>y);c&&u(c.analytics),m(!1)};return t.useEffect(()=>{i()},[a.randKey]),e.jsx(e.Fragment,{children:e.jsxs(Y,{style:{display:"flex",justifyContent:"center",marginTop:10},children:[e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>{var c,y;return r("/njiwa/channel/"+((c=a.channel)==null?void 0:c.id)+"/"+((y=a.channel)==null?void 0:y.name)+"/phonenumbers")},children:e.jsx(M,{children:e.jsx(H,{title:"Phone Numbers",value:n==null?void 0:n.phone_numbers,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>{},children:e.jsx(M,{children:e.jsx(H,{title:"Emails",value:n==null?void 0:n.emails_addresses,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>{var c,y;return r("/njiwa/channel/"+((c=a.channel)==null?void 0:c.id)+"/"+((y=a.channel)==null?void 0:y.name)+"/messages")},children:e.jsx(M,{children:e.jsx(H,{title:"Messages",value:n==null?void 0:n.messages,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>{},children:e.jsx(M,{children:e.jsx(H,{title:"Pending Messages",value:n==null?void 0:n.pending_messages,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>{},children:e.jsx(M,{children:e.jsx(H,{title:"Sent Messages",value:n==null?void 0:n.sent_messages,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})}),e.jsx(g,{span:3,children:e.jsx("a",{onClick:()=>{},children:e.jsx(M,{children:e.jsx(H,{title:"Failed Messages",value:n==null?void 0:n.failed_messages,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(W,{})})})})})]})})},xs=a=>{const[o,r]=t.useState(!1),[s,m]=t.useState(),n=Z(),u=async()=>{r(!0);const{data:i}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannel",variables:{channelId:{value:parseInt(n.channelId),type:"Int",required:!0}},fields:["id","name","description","code","isActive","created","updated","canEdit","canDelete","canManage"]}}).catch(c=>(x.error("Error fetching channel"),{data:null})).then(c=>c);i&&m(i),r(!1)};return t.useEffect(()=>{document.title=G.system_name+": Channel",u()},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa",children:"Home"})}),e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa/channels",children:"Channels"})}),e.jsxs("span",{children:[s==null?void 0:s.name,e.jsx("span",{style:{marginLeft:10},children:e.jsx(U,{color:"green",children:s==null?void 0:s.code})})]})]})}),e.jsx(ms,{randKey:Math.random(),channel:s})]})},{Option:js}=ue,Ee=a=>{const[o,r]=t.useState([]),s=async n=>{const{data:u}=await v.custom({url:"",method:"post",meta:{operation:"createNjiwaChannelsPhoneNumber",variables:{phoneNumber:{value:n.phoneNumber,type:"String",required:!0},name:{value:n.name,type:"String",required:!1},channels:{value:n.channels,type:"[Int]",required:!0}},fields:["success","message"]}}).catch(i=>(x.error("Error creating channels phone number"),{data:null})).then(i=>i);u&&(u.success?(x.success(u.message),a.onFinish(u.njiwaChannel)):x.error(u.message))},m=async(n,u,i=20)=>{const{data:c}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannels",variables:{page:{value:n,type:"Int",required:!0},key:{value:u,type:"String",required:!1},pageSize:{value:i,type:"Int",required:!0}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","name","code","description","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(y=>(x.error("Error fetching channels"),{data:null})).then(y=>y);c&&r(c.results)};return t.useEffect(()=>{m(1,"",50)},[a.randKey]),e.jsx(e.Fragment,{children:e.jsxs(j,{layout:"vertical",form:a.form,onFinish:n=>{n.channels=n.channels.map(u=>parseInt(u)),s(n)},requiredMark:!0,autoComplete:"off",children:[e.jsx(j.Item,{name:"phoneNumber",label:"Phone Number",rules:[{required:!0,type:"string",message:"Please input Phone Number"}],children:e.jsx(O,{size:"large",placeholder:"Enter Phone Number ..."})}),e.jsx(j.Item,{name:"name",label:"Full Name",rules:[{required:!1,type:"string",message:"Please input Full Name"}],children:e.jsx(O,{size:"large",placeholder:"Enter Full Name ..."})}),e.jsx(j.Item,{name:"channels",label:"Channels",rules:[{required:!0,type:"array",message:"Please select Channel(s)..."}],children:e.jsx(ue,{size:"large",mode:"multiple",allowClear:!0,style:{width:"100%"},placeholder:"Please select",defaultValue:[],dropdownStyle:{zIndex:9999},children:o.map(n=>e.jsxs(js,{value:n.id,children:[n.name,e.jsx("span",{style:{marginLeft:5},children:e.jsx(U,{color:"green",children:n.code})})]},n.id))})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(E,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},Me=a=>{const o=async r=>{var m;const{data:s}=await v.custom({url:"",method:"post",meta:{operation:"updateNjiwaPhoneNumber",variables:{phoneNumberId:{value:(m=a.phoneNumber)==null?void 0:m.id,type:"Int",required:!0},phoneNumber:{value:r.phoneNumber,type:"String",required:!0},name:{value:r.name,type:"String",required:!1}},fields:["success","message",{phoneNumber:["id","name","phoneNumber","countryCode",{carrier:["id","name"]},{user:["id","fullName","firstName","lastName"]},{owner:["id","fullName","firstName","lastName"]},"isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(n=>(x.error("Error Updating Phone number"),{data:null})).then(n=>n);s&&(s.success?(x.success(s.message),a.onFinish(s.phoneNumber)):x.error(s.message))};return t.useEffect(()=>{var r,s;a.form.setFieldsValue({phoneNumber:(r=a.phoneNumber)==null?void 0:r.phoneNumber,name:(s=a.phoneNumber)==null?void 0:s.name})},[a.randKey]),e.jsx(e.Fragment,{children:e.jsxs(j,{layout:"vertical",form:a.form,onFinish:r=>{o(r)},requiredMark:!0,autoComplete:"off",children:[e.jsx(j.Item,{name:"phoneNumber",label:"Phone Number",rules:[{required:!0,type:"string",message:"Please input Phone Number"}],children:e.jsx(O,{size:"large",placeholder:"Enter Phone Number ..."})}),e.jsx(j.Item,{name:"name",label:"Full Name",rules:[{required:!1,type:"string",message:"Please input Full Name"}],children:e.jsx(O,{size:"large",placeholder:"Enter Full Name ..."})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(E,{type:"primary",size:"large",htmlType:"submit",children:"Update"})})]})})},{Option:ps}=ue,gs=a=>Array.isArray(a)?a:a==null?void 0:a.fileList,Pe=a=>{const[o,r]=t.useState([]),s=async n=>{const{data:u}=await v.custom({url:"",method:"post",meta:{operation:"uploadNjiwaChannelsPhoneNumbers",variables:{channels:{value:n.channels,type:"[Int]",required:!0},file:{value:n.file,type:"Upload",required:!0}},fields:["success","message"]}}).catch(i=>(x.error("Error creating channels phone number"),{data:null})).then(i=>i);u&&(u.success?(x.success(u.message),a.onFinish(u.njiwaChannel)):x.error(u.message))},m=async(n,u,i=20)=>{const{data:c}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannels",variables:{page:{value:n,type:"Int",required:!0},key:{value:u,type:"String",required:!1},pageSize:{value:i,type:"Int",required:!0}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","name","code","description","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(y=>(x.error("Error fetching channels"),{data:null})).then(y=>y);c&&r(c.results)};return t.useEffect(()=>{m(1,"",50)},[a.randKey]),e.jsxs(e.Fragment,{children:[e.jsx("span",{children:e.jsxs("a",{target:"_blank",href:G.base_url+"/static/templates/njiwa_channels_phone_numbers_template.xlsx",rel:"noreferrer",children:["Download Excel Template ",e.jsx(Ve,{})]})}),e.jsxs(j,{layout:"vertical",form:a.form,onFinish:n=>{n.channels=n.channels.map(u=>parseInt(u)),s(n)},requiredMark:!0,autoComplete:"off",children:[e.jsx(j.Item,{label:"Contacts File(Excel)",children:e.jsx(j.Item,{name:"file",valuePropName:"fileList",getValueFromEvent:gs,noStyle:!0,rules:[{required:!0,type:"array",message:"Please upload students excel file"}],children:e.jsxs(He.Dragger,{name:"file",accept:".xls, .xlsx",multiple:!1,beforeUpload:()=>!1,children:[e.jsx("p",{className:"ant-upload-drag-icon",children:e.jsx(Re,{})}),e.jsx("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"}),e.jsx("p",{className:"ant-upload-hint",children:"Support for a single or bulk upload."})]})})}),e.jsx(j.Item,{name:"channels",label:"Channels",rules:[{required:!0,type:"array",message:"Please select Channel(s)..."}],children:e.jsx(ue,{size:"large",mode:"multiple",allowClear:!0,style:{width:"100%"},placeholder:"Please select",defaultValue:[],dropdownStyle:{zIndex:9999},children:o.map(n=>e.jsxs(ps,{value:n.id,children:[n.name,e.jsx("span",{style:{marginLeft:5},children:e.jsx(U,{color:"green",children:n.code})})]},n.id))})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(E,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})]})},fs=a=>{const[o,r]=t.useState([]),[s,m]=t.useState(),[n,u]=t.useState(!1),[i,c]=t.useState(!1),[y,L]=t.useState(20),[D,V]=t.useState(0),[_,B]=t.useState("");se();const[b,N]=t.useState(!1),[S,I]=t.useState(!1),[z,K]=t.useState(!1),[R]=j.useForm(),[l]=j.useForm(),[w]=j.useForm(),[F]=j.useForm(),X=Z(),te=h=>{m(h),I(!0)},ae=()=>{N(!0)},ie=async()=>{q(1,"",20),N(!1),R.resetFields()},re=async h=>{r(o.map(f=>f.id.toString()===h.id.toString()?h:f)),l.resetFields(),I(!1)},p=async()=>{q(1,"",20),w.resetFields(),K(!1)},k=async h=>{const{data:f}=await v.custom({url:"",method:"post",meta:{operation:"deleteNjiwaChannel",variables:{id:{value:h,type:"Int",required:!0}},fields:["success","message"]}});f.success?(x.success(f.message),r(o.filter(A=>A.id.toString()!==h.toString()))):x.error(f.message)},q=async(h,f,A=20)=>{u(!0);const{data:J}=await v.custom({url:"",method:"get",meta:{operation:"njiwaChannelPhoneNumbers",variables:{page:{value:h,type:"Int",required:!0},key:{value:f,type:"String",required:!1},pageSize:{value:A,type:"Int",required:!1},channelId:{value:parseInt(X.channelId),type:"Int",required:!0}},fields:["pages","total","page","hasNext","hasPrev",{results:["id",{phoneContact:["id","name","phoneNumber","countryCode",{carrier:["id","name"]},{user:["id","fullName","firstName","lastName"]},{owner:["id","fullName","firstName","lastName"]}]},"isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(be=>(x.error("Error fetching phone numbers"),{data:null})).then(be=>be);J&&(V(J.total),r(J.results)),u(!1),c(!1)},d=[{title:"Phone Number",dataIndex:"phoneNumber",key:"phoneNumber",render:(h,f,A)=>e.jsx("a",{onClick:()=>{},children:f.phoneContact.phoneNumber})},{title:"Full Name",dataIndex:"fullName",key:"name",render:(h,f,A)=>e.jsx("span",{children:f.phoneContact.name})},{title:"Carrier",dataIndex:"carrier",key:"carrier",render:(h,f,A)=>{var J;return e.jsx(U,{color:"green",children:(J=f.phoneContact.carrier)==null?void 0:J.name})}},{title:"Created",dataIndex:"created",key:"created",render:(h,f,A)=>e.jsx(le,{title:ne(f.created).format("Y-mm-d hh:mm:ss"),children:e.jsx("span",{children:ne(f.created).format("Y-mm-d hh:mm:ss")})})},{title:"",dataIndex:"Action",key:"action",render:(h,f,A)=>e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(oe,{trigger:["click"],overlay:e.jsxs(T,{children:[e.jsx(T.Item,{disabled:!f.canDelete,icon:e.jsx(de,{}),onClick:()=>{},children:e.jsx(ge,{placement:"topLeft",title:"Deleting Phone Number",onConfirm:()=>k(parseInt(f.id)),okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Delete"})})}),e.jsx(T.Item,{disabled:!f.canEdit,icon:e.jsx(xe,{}),onClick:()=>te(f),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Edit"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:J=>J.preventDefault(),children:e.jsx(ce,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})})}];return t.useEffect(()=>{q(1,"",20)},[]),e.jsxs(e.Fragment,{children:[e.jsxs(Y,{children:[e.jsx(g,{span:8,children:e.jsx(j,{layout:"vertical",form:F,onFinish:h=>{c(!0),q(0,h.key,y)},children:e.jsx(j.Item,{name:"key",children:e.jsx(O,{size:"large",disabled:i,placeholder:"Search Phone Number(s)...",prefix:e.jsx($,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(g,{span:6,style:{display:"flex",justifyContent:"flex-start"},children:e.jsx(E,{size:"large",icon:e.jsx($,{}),onClick:()=>{F.submit()},loading:i||n,disabled:i||n})}),e.jsxs(g,{span:10,style:{display:"flex",justifyContent:"flex-end"},children:[e.jsx(E,{size:"large",disabled:n||i,onClick:()=>{R.resetFields(),ae()},icon:e.jsx(me,{}),children:"Add Phone Number"}),e.jsx(E,{size:"large",disabled:n||i,onClick:()=>K(!0),icon:e.jsx(we,{}),children:"Upload Phone Numbers"})]})]}),e.jsx(Ce,{loading:n,columns:d,dataSource:o,pagination:{onChange:(h,f)=>{L(f),q(h,_,f)},total:D,pageSize:y,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0}}),e.jsx(Q,{title:"Adding Phone Number",width:"40vw",open:b,onCancel:h=>N(h),children:e.jsx(Ee,{form:R,onFinish:ie,randKey:Math.random()})}),e.jsx(Q,{title:"Editting Phone Number",width:"40vw",open:S,onClose:h=>I(h),children:e.jsx(Me,{form:l,onFinish:re,randKey:Math.random()})}),e.jsx(Q,{title:"Uploading Phone Numbers",width:"40vw",open:z,onClose:h=>K(h),children:e.jsx(Pe,{form:w,onFinish:p,randKey:Math.random()})})]})},ys=a=>{const[o,r]=t.useState(!1),[s,m]=t.useState(),n=Z(),u=async()=>{r(!0);const{data:i}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannel",variables:{channelId:{value:parseInt(n.channelId),type:"Int",required:!0}},fields:["id","name","description","code","isActive","created","updated","canEdit","canDelete","canManage"]}}).catch(c=>(x.error("Error fetching channel"),{data:null})).then(c=>c);i&&m(i),r(!1)};return t.useEffect(()=>{document.title=G.system_name+": Phone Numbers",u()},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa",children:"Home"})}),e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa/channels",children:"Channels"})}),e.jsx(C.Item,{children:e.jsxs(P,{to:"/njiwa/channel/"+(s==null?void 0:s.id)+"/"+(s==null?void 0:s.name),children:[s==null?void 0:s.name,e.jsx("span",{style:{marginLeft:10},children:e.jsx(U,{color:"green",children:s==null?void 0:s.code})})]})}),e.jsx("span",{children:"Phone Numbers"})]})}),e.jsx(fs,{randKey:Math.random(),channel:s})]})},Cs=a=>(t.useEffect(()=>{},[a.randKey]),e.jsx(e.Fragment,{children:e.jsx("p",{children:"Channel Sent Messages"})})),bs=a=>{const[o,r]=t.useState(!1),[s,m]=t.useState(),n=Z(),u=async()=>{r(!0);const{data:i}=await v.custom({url:"",method:"get",meta:{operation:"njiwaSchoolChannel",variables:{channelId:{value:parseInt(n.channelId),type:"Int",required:!0}},fields:["id","name","description","code","isActive","created","updated","canEdit","canDelete","canManage"]}}).catch(c=>(x.error("Error fetching channel"),{data:null})).then(c=>c);i&&m(i),r(!1)};return t.useEffect(()=>{document.title=G.system_name+": Sent Messages",u()},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa",children:"Home"})}),e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa/channels",children:"Channels"})}),e.jsx(C.Item,{children:e.jsxs(P,{to:"/njiwa/channel/"+(s==null?void 0:s.id)+"/"+(s==null?void 0:s.name),children:[s==null?void 0:s.name,e.jsx("span",{style:{marginLeft:10},children:e.jsx(U,{color:"green",children:s==null?void 0:s.code})})]})}),e.jsx(C.Item,{children:"Messages"}),e.jsx("span",{children:"Sent"})]})}),e.jsx(Cs,{randKey:Math.random(),channel:s})]})},vs=a=>{const[o,r]=t.useState([]),[s,m]=t.useState(),[n,u]=t.useState(!1),[i,c]=t.useState(!1),[y,L]=t.useState(20);t.useState(""),se();const[D,V]=t.useState(!1),[_,B]=t.useState(!1),[b]=j.useForm();j.useForm();const[N]=j.useForm(),S=l=>{m(l),B(!0)},I=()=>{V(!0)},z=async l=>{const{data:w}=await v.custom({url:"",method:"post",meta:{operation:"deleteNjiwaChannel",variables:{id:{value:l,type:"Int",required:!0}},fields:["success","message"]}});w.success?(x.success(w.message),r(o.filter(F=>F.id.toString()!==l.toString()))):x.error(w.message)},K=l=>{fe.confirm({title:"Deleting Njiwa Email Address",icon:e.jsx(pe,{}),content:"Are you sure ...",okText:"Delete",cancelText:"Cancel",onOk:()=>z(parseInt(l.toString()))})},R=async(l,w,F=20)=>{const{data:X}=await v.custom({url:"",method:"get",meta:{operation:"njiwaChannels",variables:{control:{value:!0,type:"Boolean",required:!0}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","name","icon","description","isActive","created","updated","canEdit","canDelete","canManage"]}]}});r(X.results),u(!1),c(!1)};return t.useEffect(()=>{R(1,"",20)},[]),e.jsxs(e.Fragment,{children:[e.jsxs(Y,{children:[e.jsx(g,{span:14,children:e.jsx(j,{layout:"vertical",form:N,onFinish:l=>{c(!0),R(0,l.key,y)},children:e.jsx(j.Item,{name:"key",children:e.jsx(O,{size:"large",disabled:i,placeholder:"Search Channel(s)...",prefix:e.jsx($,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(g,{span:6,style:{display:"flex",justifyContent:"flex-start"},children:e.jsx(E,{size:"large",icon:e.jsx($,{}),onClick:()=>{N.submit()},loading:i||n,disabled:i||n})}),e.jsx(g,{span:4,style:{display:"flex",justifyContent:"flex-end"},children:e.jsxs(E,{size:"large",disabled:n||i,onClick:()=>{},children:[e.jsx(me,{}),"Add Email Address"]})})]}),e.jsxs(Y,{align:"top",children:[o.length===0&&e.jsx(g,{span:24,style:{display:"flex",justifyContent:"center"},children:e.jsx(he,{image:"images/nodata.png",imageStyle:{height:160},description:e.jsx("span",{style:{fontSize:16},children:"No Communication Channel Found ..."}),children:e.jsx(E,{type:"primary",onClick:()=>{b.resetFields(),I()},children:"Create Email Address Now"})})}),o.map(l=>e.jsx(g,{span:4,children:e.jsxs(M,{hoverable:l.isActive,style:{marginRight:10},children:[e.jsx(ee,{style:{right:0,position:"absolute"},children:e.jsx(oe,{trigger:["click"],overlay:e.jsxs(T,{children:[e.jsx(T.Item,{icon:e.jsx(xe,{}),onClick:()=>{S(l)},disabled:!(l!=null&&l.canDelete),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Edit"})}),e.jsx(T.Item,{icon:e.jsx(de,{}),onClick:()=>{K(l.id)},disabled:!(l!=null&&l.canDelete),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Delete"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:w=>w.preventDefault(),children:e.jsx(ce,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})}),e.jsx(ee,{direction:"vertical",align:"center",style:{width:"100%",justifyContent:"center"},onClick:()=>{},children:l.emailAddress})]})}))]}),e.jsx(Q,{title:"Create Njiwa Email Address",width:"40vw",open:D,onClose:l=>V(l),children:e.jsx(ke,{})})]})},Ss=()=>(t.useEffect(()=>{document.title=G.system_name+": Emails"},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa",children:"Home"})}),e.jsx("span",{children:"Emails Addresses"})]})}),e.jsx(vs,{})]})),ws=()=>(t.useEffect(()=>{document.title=G.system_name+": Messages"},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa",children:"Home"})}),e.jsx("span",{children:"Messages"})]})}),e.jsx(Fe,{})]})),Ns=a=>(t.useEffect(()=>{},[]),e.jsx(e.Fragment,{children:e.jsx("span",{children:"Settings"})})),Is=()=>(t.useEffect(()=>{document.title=G.system_name+": Settings"},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa",children:"Home"})}),e.jsx("span",{children:"Settings"})]})}),e.jsx(Ns,{})]})),Fs=a=>{const[o,r]=t.useState([]),[s,m]=t.useState(),[n,u]=t.useState(!1),[i,c]=t.useState(!1),[y,L]=t.useState(20),[D,V]=t.useState(0),[_,B]=t.useState("");se();const[b,N]=t.useState(!1),[S,I]=t.useState(!1),[z,K]=t.useState(!1),[R]=j.useForm(),[l]=j.useForm(),[w]=j.useForm(),[F]=j.useForm(),X=d=>{m(d),I(!0)},te=()=>{N(!0)},ae=async()=>{k(1,"",20),N(!1),R.resetFields()},ie=async d=>{r(o.map(h=>h.id.toString()===d.id.toString()?d:h)),l.resetFields(),I(!1)},re=async()=>{k(1,"",20),w.resetFields(),K(!1)},p=async d=>{const{data:h}=await v.custom({url:"",method:"post",meta:{operation:"deleteNjiwaChannel",variables:{id:{value:d,type:"Int",required:!0}},fields:["success","message"]}});h.success?(x.success(h.message),r(o.filter(f=>f.id.toString()!==d.toString()))):x.error(h.message)},k=async(d,h,f=20)=>{u(!0);const{data:A}=await v.custom({url:"",method:"get",meta:{operation:"njiwaChannelsPhoneContacts",variables:{page:{value:d,type:"Int",required:!0},key:{value:h,type:"String",required:!1},pageSize:{value:f,type:"Int",required:!1}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","name","phoneNumber","countryCode",{carrier:["id","name"]},{user:["id","fullName","firstName","lastName"]},{owner:["id","fullName","firstName","lastName"]},"isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch(J=>(x.error("Error fetching phone numbers"),{data:null})).then(J=>J);A&&(V(A.total),r(A.results)),u(!1),c(!1)},q=[{title:"Phone Number",dataIndex:"phoneNumber",key:"phoneNumber",render:(d,h,f)=>e.jsx("a",{onClick:()=>{},children:h.phoneNumber})},{title:"Full Name",dataIndex:"fullName",key:"name",render:(d,h,f)=>e.jsx("span",{children:h.name})},{title:"Carrier",dataIndex:"carrier",key:"carrier",render:(d,h,f)=>{var A;return e.jsx(U,{color:"green",children:(A=h.carrier)==null?void 0:A.name})}},{title:"Created",dataIndex:"created",key:"created",render:(d,h,f)=>e.jsx(le,{title:ne(h.created).format("Y-mm-d hh:mm:ss"),children:e.jsx("span",{children:ne(h.created).format("Y-mm-d hh:mm:ss")})})},{title:"",dataIndex:"Action",key:"action",render:(d,h,f)=>e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(oe,{trigger:["click"],overlay:e.jsxs(T,{children:[e.jsx(T.Item,{disabled:!h.canDelete,icon:e.jsx(de,{}),onClick:()=>{},children:e.jsx(ge,{placement:"topLeft",title:"Deleting Phone Number",onConfirm:()=>p(parseInt(h.id)),okText:"Yes",cancelText:"No",overlayStyle:{zIndex:9999},children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Delete"})})}),e.jsx(T.Item,{disabled:!h.canEdit,icon:e.jsx(xe,{}),onClick:()=>X(h),children:e.jsx("a",{target:"_blank",rel:"noopener noreferrer",children:"Edit"})})]}),overlayStyle:{zIndex:9999},children:e.jsx("a",{className:"ant-dropdown-link",onClick:A=>A.preventDefault(),children:e.jsx(ce,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})})}];return t.useEffect(()=>{k(1,"",20)},[]),e.jsxs(e.Fragment,{children:[e.jsxs(Y,{children:[e.jsx(g,{span:8,children:e.jsx(j,{layout:"vertical",form:F,onFinish:d=>{c(!0),k(0,d.key,y)},children:e.jsx(j.Item,{name:"key",children:e.jsx(O,{size:"large",disabled:i,placeholder:"Search Phone Number(s)...",prefix:e.jsx($,{}),autoComplete:"off",allowClear:!0})})})}),e.jsx(g,{span:6,style:{display:"flex",justifyContent:"flex-start"},children:e.jsx(E,{size:"large",icon:e.jsx($,{}),onClick:()=>{F.submit()},loading:i||n,disabled:i||n})}),e.jsxs(g,{span:10,style:{display:"flex",justifyContent:"flex-end"},children:[e.jsx(E,{size:"large",disabled:n||i,onClick:()=>{R.resetFields(),te()},icon:e.jsx(me,{}),children:"Add Phone Number"}),e.jsx(E,{size:"large",disabled:n||i,onClick:()=>K(!0),icon:e.jsx(we,{}),children:"Upload Phone Numbers"})]})]}),e.jsx(Ce,{loading:n,columns:q,dataSource:o,pagination:{onChange:(d,h)=>{L(h),k(d,_,h)},total:D,pageSize:y,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0}}),e.jsx(Q,{title:"Adding Phone Number",width:"40vw",open:b,onClose:d=>N(d),children:e.jsx(Ee,{form:R,onFinish:ae,randKey:Math.random()})}),e.jsx(Q,{title:"Editting Phone Number",width:"40vw",open:S,onClose:d=>I(d),children:e.jsx(Me,{phoneNumber:s,form:l,onFinish:ie,randKey:Math.random()})}),e.jsx(Q,{title:"Uploading Phone Numbers",width:"40vw",open:z,onClose:d=>K(d),children:e.jsx(Pe,{form:w,onFinish:re,randKey:Math.random()})})]})},ks=()=>(t.useEffect(()=>{document.title=G.system_name+": Phone Numbers"},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5,marginTop:5},children:e.jsxs(C,{children:[e.jsx(C.Item,{children:e.jsx(P,{to:"/njiwa",children:"Home"})}),e.jsx("span",{children:"Phone Numbers"})]})}),e.jsx(Fs,{})]})),Bs=a=>{const{page:o}=a;return o==="PhoneNumbersPage"?e.jsx(ks,{}):o==="NjiwaSettingsPage"?e.jsx(Is,{}):o==="MessagesPage"?e.jsx(ws,{}):o==="EmailsPage"?e.jsx(Ss,{}):o==="ChannelSentMessagesPage"?e.jsx(bs,{}):o==="ChannelPhoneNumbersPage"?e.jsx(ys,{}):o==="ChannelPage"?e.jsx(xs,{}):o==="ChannelMessagesPage"?e.jsx(us,{}):o==="ChannelFailedMessagesPage"?e.jsx(is,{}):o==="ChannelEmailsPage"?e.jsx(as,{}):o==="ChannelsPage"?e.jsx(ts,{}):o==="NjiwaDashboardPage"?e.jsx(Ge,{}):e.jsx("div",{children:"Page not found ..."})};export{Bs as NjiwaPages};
