"use strict";(self.webpackChunkolbongo=self.webpackChunkolbongo||[]).push([[312],{52312:function(e,n,t){t.r(n),t.d(n,{ControlApplicationsPage:function(){return _}});var i=t(69239),r=t(78164),s=t(43504),a=t(74165),l=t(93433),o=t(15861),c=t(29439),u=t(35796),d=t(79286),p=t(31752),m=t(82622),h=t(10711),x=t(68961),f=t(840),g=t(87012),j=t(72791),v=t(72351),y=t(80184),b=f.II.TextArea,Z=function(e){var n=(0,j.useState)(),t=(0,c.Z)(n,2),i=t[0],r=t[1],s=(0,j.useState)(!1),a=(0,c.Z)(s,2),l=a[0],o=a[1],u=(0,j.useState)(!1),d=(0,c.Z)(u,2),p=d[0],m=d[1],h=(0,j.useState)(!1),x=(0,c.Z)(h,2),g=x[0],Z=x[1],I=(0,j.useState)(!0),k=(0,c.Z)(I,2),C=k[0],q=k[1];return(0,y.jsx)(y.Fragment,{children:(0,y.jsxs)(f.l0,{layout:"vertical",form:e.form,onFinish:function(n){n.is_public=p,n.is_custom=g,n.must_login=C,n.icon=i,e.onFinish(n)},requiredMark:!1,initialValues:{remember:!1,email:"",password:""},children:[(0,y.jsx)(f.l0.Item,{name:"name",label:"Name",rules:[{required:!0,type:"string",message:"Please input name"}],children:(0,y.jsx)(f.II,{size:"large",placeholder:"Enter Name ..."})}),(0,y.jsx)(f.l0.Item,{name:"url",label:"Path",rules:[{required:!0,type:"string",message:"Please input url"}],children:(0,y.jsx)(f.II,{size:"large",placeholder:"Enter Path..."})}),(0,y.jsx)(f.l0.Item,{name:"must_login",rules:[{required:!1,type:"boolean"}],children:(0,y.jsx)(f.XZ,{onChange:function(){q(!C)},defaultChecked:C,children:"Must Login"})}),(0,y.jsx)(f.l0.Item,{name:"is_public",rules:[{required:!1,type:"boolean"}],children:(0,y.jsx)(f.XZ,{onChange:function(){m(!p)},children:"Public Available"})}),(0,y.jsx)(f.l0.Item,{name:"is_custom",rules:[{required:!1,type:"boolean"}],children:(0,y.jsx)(f.XZ,{onChange:function(){Z(!g)},children:"Custom Application"})}),(0,y.jsx)(f.l0.Item,{name:"description",label:"Description",style:{marginBottom:"12px"},children:(0,y.jsx)(b,{rows:4})}),(0,y.jsx)(f.l0.Item,{name:"icon",label:"Icon",style:{marginBottom:"12px"},children:(0,y.jsx)(f.gq,{beforeUpload:function(){return!1},maxCount:1,onChange:function(e){var n=e.file;i?i.uid!==n.uid&&(r(n),o(!0)):(r(n),o(!0))},onRemove:function(){r(void 0),o(!1)},accept:"image/*",children:(0,y.jsx)(f.zx,{icon:(0,y.jsx)(v.Z,{}),children:"Click to Select"})})}),(0,y.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,y.jsx)(f.zx,{type:"primary",size:"large",htmlType:"submit",disabled:!l,children:"Save"})})]})})},I=f.II.TextArea,k=function(e){var n=(0,j.useState)(),t=(0,c.Z)(n,2),i=t[0],r=t[1],s=(0,j.useState)(!0),a=(0,c.Z)(s,2),l=(a[0],a[1]);return(0,j.useEffect)((function(){e.form.setFieldsValue({name:e.app.name,url:e.app.url,description:e.app.description,must_login:e.app.mustLogin,is_public:e.app.isPublic,is_custom:e.app.isCustom,is_active:e.app.isActive,icon:e.app.icon}),r(null)}),[e.randKey]),(0,y.jsx)(y.Fragment,{children:(0,y.jsxs)(f.l0,{layout:"vertical",form:e.form,onFinish:function(n){n.id=parseInt(e.app.id),n.icon=i,e.onFinish(n)},requiredMark:!1,initialValues:{remember:!1,email:"",password:""},children:[(0,y.jsx)(f.l0.Item,{name:"name",label:"Name",rules:[{required:!0,type:"string",message:"Please input name"}],children:(0,y.jsx)(f.II,{size:"large",placeholder:"Enter Name ..."})}),(0,y.jsx)(f.l0.Item,{name:"url",label:"Path",rules:[{required:!0,type:"string",message:"Please input url"}],children:(0,y.jsx)(f.II,{size:"large",placeholder:"Enter Path..."})}),(0,y.jsx)(f.l0.Item,{name:"must_login",valuePropName:"checked",rules:[{required:!1,type:"boolean"}],children:(0,y.jsx)(f.XZ,{children:"Must Login"})}),(0,y.jsx)(f.l0.Item,{name:"is_public",valuePropName:"checked",rules:[{required:!1,type:"boolean"}],children:(0,y.jsx)(f.XZ,{children:"Public Available"})}),(0,y.jsx)(f.l0.Item,{name:"is_custom",valuePropName:"checked",rules:[{required:!1,type:"boolean"}],children:(0,y.jsx)(f.XZ,{children:"Custom Application"})}),(0,y.jsx)(f.l0.Item,{name:"is_active",valuePropName:"checked",rules:[{required:!1,type:"boolean"}],children:(0,y.jsx)(f.XZ,{children:"is Active"})}),(0,y.jsx)(f.l0.Item,{name:"description",label:"Description",style:{marginBottom:"12px"},children:(0,y.jsx)(I,{rows:4})}),(0,y.jsxs)(f.l0.Item,{name:"icon",label:"Icon:",style:{marginBottom:"12px"},children:[(0,y.jsx)(f.u,{title:e.app.icon,children:(0,y.jsx)("span",{style:{color:"green",display:"block"},children:e.app.icon})}),(0,y.jsx)(f.gq,{beforeUpload:function(){return!1},maxCount:1,onChange:function(e){var n=e.file;i?i.uid!==n.uid&&(r(n),l(!0)):(r(n),l(!0))},onRemove:function(){r(void 0),l(!1)},accept:"image/*",children:(0,y.jsx)(f.zx,{icon:(0,y.jsx)(v.Z,{}),children:"Click to Select"})})]}),(0,y.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,y.jsx)(f.zx,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},C=function(e){var n=(0,j.useState)([]),t=(0,c.Z)(n,2),r=t[0],s=t[1],v=(0,j.useState)(),b=(0,c.Z)(v,2),I=b[0],C=b[1],q=(0,j.useState)(!0),w=(0,c.Z)(q,2),A=w[0],S=w[1],_=((0,i.HJ)().push,(0,j.useState)(!1)),P=(0,c.Z)(_,2),D=P[0],E=P[1],F=(0,j.useState)(!1),z=(0,c.Z)(F,2),B=z[0],X=z[1],N=f.l0.useForm(),T=(0,c.Z)(N,1)[0],M=f.l0.useForm(),L=(0,c.Z)(M,1)[0],J=!f.rj.useBreakpoint().lg,U=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(n){var t,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.E.custom({url:"",method:"post",metaData:{operation:"createApp",variables:{name:{value:n.name,type:"String",required:!0},description:{value:n.description,type:"String",required:!1},url:{value:n.url,type:"String",required:!0},icon:{value:n.icon,type:"Upload",required:!0},isPublic:{value:n.is_public,type:"Boolean",required:!1},isCustom:{value:n.is_custom,type:"Boolean",required:!1},mustLogin:{value:n.must_login,type:"Boolean",required:!1}},fields:["success","message",{app:["id","name","url","icon","description","created","updated","isActive","canDelete","canEdit","canManage","canAccess"]}]}});case 2:t=e.sent,(i=t.data).success?(f.yw.success(i.message),s([i.app].concat((0,l.Z)(r))),T.resetFields(),E(!1)):f.yw.error(i.message);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),O=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(n){var t,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.E.custom({url:"",method:"post",metaData:{operation:"updateApp",variables:{id:{value:n.id,type:"Int",required:!0},name:{value:n.name,type:"String",required:!0},description:{value:n.description,type:"String",required:!1},url:{value:n.url,type:"String",required:!0},icon:{value:n.icon,type:"Upload",required:!1},isPublic:{value:n.is_public,type:"Boolean",required:!1},isCustom:{value:n.is_custom,type:"Boolean",required:!1},mustLogin:{value:n.must_login,type:"Boolean",required:!1},isActive:{value:n.is_active,type:"Boolean",required:!1}},fields:["success","message",{app:["id","name","url","icon","description","created","updated","isActive","canDelete","canEdit","canManage","canAccess"]}]}});case 2:t=e.sent,(i=t.data).success?(f.yw.success(i.message),s(r.map((function(e){return e.id.toString()===n.id.toString()?i.app:e}))),L.resetFields(),X(!1)):f.yw.error(i.message);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),R=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var n,t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.E.custom({url:"",method:"post",metaData:{operation:"syncDefaultApps",variables:{},fields:["success","message"]}});case 2:n=e.sent,(t=n.data).success?(f.yw.success(t.message),H()):f.yw.error(t.message);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(n){var t,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.E.custom({url:"",method:"post",metaData:{operation:"deleteApp",variables:{id:{value:n,type:"Int",required:!0}},fields:["success","message"]}});case 2:t=e.sent,(i=t.data).success?(f.yw.success(i.message),s(r.filter((function(e){return e.id.toString()!==n.toString()})))):f.yw.error(i.message);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),H=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var n,t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.E.custom({url:"",method:"get",metaData:{operation:"apps",variables:{control:{value:!0,type:"Boolean",required:!0}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","name","icon","url","isActive","mustLogin","isCustom","isPublic","created","updated","isActive","canEdit","canDelete","canManage","canAccess"]}]}});case 2:n=e.sent,t=n.data,s(t.results),S(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,j.useEffect)((function(){H()}),[]),A?(0,y.jsx)(y.Fragment,{children:(0,y.jsx)(f.Od,{loading:A,active:!0})}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(f.X2,{children:[(0,y.jsx)(f.JX,{span:20}),(0,y.jsxs)(f.JX,{span:4,style:{display:"flex",justifyContent:"flex-end",marginBottom:5,marginTop:5},children:[(0,y.jsxs)(f.zx,{size:"large",onClick:function(){T.resetFields(),E(!0)},danger:!0,children:[(0,y.jsx)(d.Z,{}),"Create App"]}),(0,y.jsxs)(f.zx,{size:"large",onClick:function(){R()},danger:!0,children:[(0,y.jsx)(d.Z,{}),"Sync Default Apps"]})]})]}),(0,y.jsxs)(f.X2,{align:"top",children:[0===r.length&&(0,y.jsx)(f.JX,{span:24,style:{display:"flex",justifyContent:"center"},children:(0,y.jsx)("h3",{children:"No Apps Found ..."})}),r.map((function(e){return(0,y.jsx)(f.JX,{span:J?12:4,children:(0,y.jsxs)(f.Zb,{hoverable:e.isActive,style:{marginRight:10,marginBottom:10},children:[(0,y.jsx)(f.T,{style:{right:0,position:"absolute"},children:(0,y.jsx)(f.Lt,{trigger:["click"],overlay:(0,y.jsxs)(f.v2,{children:[(0,y.jsx)(f.v2.Item,{icon:(0,y.jsx)(p.Z,{}),onClick:function(){!function(e){C(e),X(!0)}(e)},disabled:!(null!==e&&void 0!==e&&e.canDelete),children:(0,y.jsx)("a",{target:"_blank",rel:"noopener noreferrer",children:"Edit"})}),(0,y.jsx)(f.v2.Item,{icon:(0,y.jsx)(m.Z,{}),onClick:function(){var n;n=e.id,f.u_.confirm({title:"Deleting Application",icon:(0,y.jsx)(u.Z,{}),content:"Are you sure ...",okText:"Delete",cancelText:"Cancel",onOk:function(){return V(parseInt(n.toString()))}})},disabled:!(null!==e&&void 0!==e&&e.canDelete),children:(0,y.jsxs)("a",{target:"_blank",rel:"noopener noreferrer",children:["Delete ",e.canDelete]})})]}),children:(0,y.jsx)("a",{className:"ant-dropdown-link",onClick:function(e){return e.preventDefault()},children:(0,y.jsx)(h.Z,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})}),(0,y.jsxs)(f.T,{direction:"vertical",align:"center",style:{width:"100%",justifyContent:"center"},onClick:function(){},children:[(0,y.jsx)(f.qE,{size:{xs:24,sm:32,md:40,lg:40,xl:40,xxl:80},icon:(0,y.jsx)(x.Z,{}),src:e.icon}),e.name]})]})})}))]}),(0,y.jsx)(f.u_,{title:"Creating An Application",visible:D,onOk:function(){E(!1)},onCancel:function(){E(!1)},footer:[],children:(0,y.jsx)(Z,{form:T,onFinish:U})}),(0,y.jsx)(f.u_,{title:"Edit Application",visible:B,width:J?"100vw":"30vw",onOk:function(){X(!1)},onCancel:function(){X(!1)},footer:[],children:(0,y.jsx)(k,{app:I,form:L,onFinish:O,randKey:Math.random()})})]})},q=t(20852),w=t(59174),A=t(5397),S=function(){return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(r.Z,{children:[(0,y.jsx)(r.Z.Item,{children:(0,y.jsx)(s.rU,{to:"/control/analytics",children:"Home"})}),(0,y.jsx)(r.Z.Item,{children:"Applications"})]}),(0,y.jsx)(C,{})]})},_=function(){var e=(0,i.kS)().data;return(0,j.useEffect)((function(){!1!==(null===e||void 0===e?void 0:e.isStaff)&&!1!==(null===e||void 0===e?void 0:e.isAdmin)||(window.location.pathname="/home"),window.history.pushState({},"",(0,w.Z)())}),[]),(0,y.jsx)(q.u,{children:(0,y.jsx)(A.Q,{children:(0,y.jsx)(S,{})})})}}}]);
//# sourceMappingURL=312.0bd27d2a.chunk.js.map