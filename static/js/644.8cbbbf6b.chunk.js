"use strict";(self.webpackChunkolbongo=self.webpackChunkolbongo||[]).push([[644],{86644:function(e,t,n){n.r(t),n.d(t,{SchoolsPage:function(){return de}});var r=n(78164),a=n(43504),i=n(93433),s=n(74165),o=n(15861),l=n(29439),c=n(82622),u=n(31752),d=n(29529),h=n(92827),p=n(93451),m=n(10711),f=n(11730),g=n(60732),x=n(79286),v=n(69239),y=n(840),j=n(87012),Z=n(72791),w=n(72351),S=n(80184),b=y.Ph.Option,I=y.II.TextArea,C=function(e){var t,n,r,a,i,c,u,d,h,p,m,f,g,x,v,C,k,N,q,A,D,E,F=(0,Z.useState)([]),z=(0,l.Z)(F,2),T=z[0],_=z[1],P=(0,Z.useState)([]),M=(0,l.Z)(P,2),L=M[0],O=M[1],R=(0,Z.useState)([]),B=(0,l.Z)(R,2),U=B[0],V=B[1],X=(0,Z.useState)([]),Y=(0,l.Z)(X,2),J=Y[0],K=Y[1],W=(0,Z.useState)([]),H=(0,l.Z)(W,2),G=H[0],Q=H[1],$=(0,Z.useState)(0),ee=(0,l.Z)($,2),te=ee[0],ne=ee[1],re=(0,Z.useState)(0),ae=(0,l.Z)(re,2),ie=ae[0],se=ae[1],oe=(0,Z.useState)(),le=(0,l.Z)(oe,2),ce=le[0],ue=le[1],de=(0,Z.useState)(!1),he=(0,l.Z)(de,2),pe=(he[0],he[1]),me=(0,Z.useState)(!1),fe=(0,l.Z)(me,2),ge=fe[0],xe=fe[1],ve=(0,Z.useState)(!1),ye=(0,l.Z)(ve,2),je=ye[0],Ze=ye[1],we=(0,Z.useState)([]),Se=(0,l.Z)(we,2),be=Se[0],Ie=Se[1],Ce=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(){var t,n,r,a,i=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:1,n=i.length>1&&void 0!==i[1]?i[1]:"",e.next=4,j.E.custom({url:"",method:"get",metaData:{operation:"ownerships",variables:{page:{value:t,type:"Int",required:!0},key:{value:n,type:"String",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","isActive","created","updated","canEdit","canDelete","canManage"]}]}});case 4:r=e.sent,a=r.data,O(a.results);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ke=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t){var n,r,a,i=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:"",Ze(!0),e.next=4,j.E.custom({url:"",method:"get",metaData:{operation:"wards",variables:{key:{value:n,type:"String",required:!1},district:{value:t,type:"Int",requiqred:!1}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","name","created","updated","isActive","canEdit","canDelete","canManage"]}]}});case 4:r=e.sent,a=r.data,V(a.results),Ze(!1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ne=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t){var n,r,a,i=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:"",xe(!0),e.next=4,j.E.custom({url:"",method:"get",metaData:{operation:"districts",variables:{key:{value:n,type:"String",required:!1},region:{value:t,type:"Int",required:!1}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","name","created","updated","isActive","canEdit","canDelete","canManage"]}]}});case 4:r=e.sent,a=r.data,K(a.results),xe(!1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),qe=function(){var t=(0,o.Z)((0,s.Z)().mark((function t(){var n,r,a,i=arguments;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=i.length>0&&void 0!==i[0]?i[0]:"",t.next=3,j.E.custom({url:"",method:"get",metaData:{operation:"regions",variables:{key:{value:n,type:"String",required:!1}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","name","created","updated","isActive","canEdit","canDelete","canManage"]}]}});case 3:r=t.sent,a=r.data,Q(a.results),e.form.setFieldsValue({district:void 0,ward:void 0});case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Ae=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ne(t),Ne(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),De=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:se(t),ke(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ee=function(){var t=(0,o.Z)((0,s.Z)().mark((function t(){var n,r,a,i=arguments;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=i.length>0&&void 0!==i[0]?i[0]:"",t.next=3,j.E.custom({url:"",method:"get",metaData:{operation:"schoolsTypes",variables:{key:{value:n,type:"String",required:!1},excludeAssigned:{value:!0,type:"Boolean",required:!1},schoolId:{value:parseInt(e.school.id),type:"Int",required:!1}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","name","created","updated","isActive","canEdit","canDelete","canManage"]}]}});case 3:r=t.sent,a=r.data,_(a.results);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return(0,Z.useEffect)((function(){var t,n,r,a,i,s,o,l,c,u,d,h,p,m,f,g,x,v,y,j,Z,w,S,b,I,C,k,N,q,A;Ee(),Ce(),qe(),qe(null===(t=e.school)||void 0===t||null===(n=t.ward)||void 0===n||null===(r=n.district)||void 0===r||null===(a=r.region)||void 0===a?void 0:a.name),Ae(parseInt(null===(i=e.school)||void 0===i||null===(s=i.ward)||void 0===s||null===(o=s.district)||void 0===o?void 0:o.region.id)),xe(!1),De(parseInt(null===(l=e.school)||void 0===l||null===(c=l.ward)||void 0===c?void 0:c.district.id)),Ze(!1),e.form.setFieldsValue({name:null===(u=e.school)||void 0===u?void 0:u.name,serial_number:null===(d=e.school)||void 0===d?void 0:d.serialNumber,ownership_id:null===(h=e.school)||void 0===h||null===(p=h.ownership)||void 0===p?void 0:p.id,school_type_id:null===(m=e.school)||void 0===m||null===(f=m.schoolType)||void 0===f?void 0:f.id,region_id:null===(g=e.school)||void 0===g||null===(x=g.ward)||void 0===x||null===(v=x.district)||void 0===v||null===(y=v.region)||void 0===y?void 0:y.id,district_id:null===(j=e.school)||void 0===j||null===(Z=j.ward)||void 0===Z||null===(w=Z.district)||void 0===w?void 0:w.id,ward_id:null===(S=e.school)||void 0===S||null===(b=S.ward)||void 0===b?void 0:b.id,longitude:null===(I=e.school)||void 0===I?void 0:I.longitude,latitude:null===(C=e.school)||void 0===C?void 0:C.latitude,bio:null===(k=e.school)||void 0===k?void 0:k.bio,logo:null===(N=e.school)||void 0===N?void 0:N.logo,is_universal:null===(q=e.school)||void 0===q?void 0:q.isUniversal,njiwa_account:null===(A=e.school)||void 0===A?void 0:A.hasNjiwaAccount})}),[e.randKey]),(0,S.jsx)(S.Fragment,{children:(0,S.jsxs)(y.l0,{layout:"vertical",form:e.form,onFinish:function(t){t.schoolTypes=be,t.id=e.school.id,t.is_active=e.school.isActive,e.onFinish(t)},requiredMark:!1,initialValues:{name:null===(t=e.school)||void 0===t?void 0:t.name,serial_number:null===(n=e.school)||void 0===n?void 0:n.serialNumber,ownership_id:null===(r=e.school)||void 0===r||null===(a=r.ownership)||void 0===a?void 0:a.id,school_type_id:null===(i=e.school)||void 0===i||null===(c=i.schoolType)||void 0===c?void 0:c.id,region_id:null===(u=e.school)||void 0===u||null===(d=u.ward)||void 0===d||null===(h=d.district)||void 0===h||null===(p=h.region)||void 0===p?void 0:p.id,district_id:null===(m=e.school)||void 0===m||null===(f=m.ward)||void 0===f||null===(g=f.district)||void 0===g?void 0:g.id,ward_id:null===(x=e.school)||void 0===x||null===(v=x.ward)||void 0===v?void 0:v.id,longitude:null===(C=e.school)||void 0===C?void 0:C.longitude,latitude:null===(k=e.school)||void 0===k?void 0:k.latitude,bio:null===(N=e.school)||void 0===N?void 0:N.bio,logo:null===(q=e.school)||void 0===q?void 0:q.logo,is_universal:null===(A=e.school)||void 0===A?void 0:A.isUniversal,njiwa_account:null===(D=e.school)||void 0===D?void 0:D.hasNjiwaAccount},children:[(0,S.jsxs)(y.X2,{children:[(0,S.jsxs)(y.JX,{span:11,children:[(0,S.jsx)(y.l0.Item,{name:"name",label:"Name",rules:[{required:!0,type:"string",message:"Please input name"}],children:(0,S.jsx)(y.II,{size:"large",placeholder:"Enter Name ..."})}),(0,S.jsx)(y.l0.Item,{name:"serial_number",label:"Serial Number",rules:[{required:!0,type:"string",message:"Please input Serial Number ..."}],children:(0,S.jsx)(y.II,{size:"large",placeholder:"Enter Serial Number ..."})}),(0,S.jsx)(y.l0.Item,{label:"School Type",rules:[{required:!0,type:"string",message:"Please choose School Type"}],children:(0,S.jsx)(y.Ph,{mode:"multiple",showSearch:!0,size:"large",placeholder:"Select a School Type",optionFilterProp:"children",onChange:function(e){Ie(e)},onSearch:function(e){},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:T.map((function(e,t){return(0,S.jsx)(b,{value:e.id,children:e.name})}))})}),(0,S.jsx)(y.l0.Item,{name:"ownership_id",label:"School Ownership",rules:[{required:!0,type:"string",message:"Please choose Ownership"}],children:(0,S.jsx)(y.Ph,{showSearch:!0,size:"large",placeholder:"Select a Ownership",optionFilterProp:"children",onChange:function(e){},onSearch:function(e){},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:L.map((function(e,t){return(0,S.jsx)(b,{value:e.id,children:e.name})}))})}),(0,S.jsx)(y.l0.Item,{name:"bio",label:"Biography",style:{marginBottom:"12px"},children:(0,S.jsx)(I,{rows:4})}),(0,S.jsx)(y.l0.Item,{name:"logo",label:"Logo",style:{marginBottom:"12px"},children:(0,S.jsx)(y.gq,{beforeUpload:function(){return!1},maxCount:1,onChange:function(e){var t=e.file;ce?ce.uid!==t.uid&&(ue(t),pe(!0)):(ue(t),pe(!0))},onRemove:function(){ue(void 0),pe(!1)},accept:"image/*",children:(0,S.jsx)(y.zx,{icon:(0,S.jsx)(w.Z,{}),size:"large",children:"Click to Select"})})})]}),(0,S.jsxs)(y.JX,{span:11,offset:2,children:[(0,S.jsx)(y.l0.Item,{name:"region_id",label:"Region",rules:[{required:!0,type:"string",message:"Please Choose Region ..."}],children:(0,S.jsx)(y.Ph,{showSearch:!0,size:"large",placeholder:"Select a region",optionFilterProp:"children",onChange:function(t){Ae(parseInt(t)),e.form.resetFields(["district_id","ward_id"]),e.form.setFieldsValue({district_id:void 0,ward_id:void 0}),K([]),V([])},onSearch:function(e){e.length>2&&qe(e)},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:G.map((function(e,t){return(0,S.jsx)(b,{value:e.id,children:e.name})}))})}),(0,S.jsx)(y.l0.Item,{name:"district_id",label:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("span",{children:"District"}),(0,S.jsx)(y.yC,{spinning:ge})]}),rules:[{required:!0,type:"string",message:"Please Choose District ..."}],children:(0,S.jsx)(y.Ph,{showSearch:!0,size:"large",disabled:ge||0===J.length,placeholder:"Select a district",optionFilterProp:"children",onChange:function(t){De(parseInt(t)),e.form.setFieldsValue({ward:void 0}),V([])},onSearch:function(e){e.length>2&&0!==te&&Ne(te,e)},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:J.map((function(e,t){return(0,S.jsx)(b,{value:e.id,children:e.name})}))})}),(0,S.jsx)(y.l0.Item,{name:"ward_id",label:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("span",{children:"Ward"}),(0,S.jsx)(y.yC,{spinning:je})]}),children:(0,S.jsx)(y.Ph,{showSearch:!0,size:"large",disabled:je||0===U.length,placeholder:"Select a ward",optionFilterProp:"children",onChange:function(e){},onSearch:function(e){e.length>2&&ke(ie,e)},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:U.map((function(e,t){return(0,S.jsx)(b,{value:e.id,children:e.name})}))})}),(0,S.jsx)(y.l0.Item,{name:"website",label:"Website",rules:[{required:!1,type:"url",message:"Please input Website Address ..."}],children:(0,S.jsx)(y.II,{size:"large",placeholder:"Enter Website Address ..."})}),(0,S.jsx)(y.l0.Item,{name:"latitude",label:"Latitude",rules:[{required:!1,type:"string",message:"Please input Latitude ..."}],children:(0,S.jsx)(y.II,{size:"large",placeholder:"Enter Latitude..."})}),(0,S.jsx)(y.l0.Item,{name:"longitude",label:"Longitude",rules:[{required:!1,type:"string",message:"Please input Longitude ..."}],children:(0,S.jsx)(y.II,{size:"large",placeholder:"Enter Longitude..."})}),(0,S.jsx)(y.l0.Item,{name:"is_universal",valuePropName:"checked",children:(0,S.jsx)(y.XZ,{children:"Universal"})}),(0,S.jsx)(y.l0.Item,{name:"njiwa_account",valuePropName:"checked",children:(0,S.jsx)(y.XZ,{disabled:null===(E=e.school)||void 0===E?void 0:E.hasNjiwaAccount,children:"Auto Create Njiwa Account"})})]})]}),(0,S.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,S.jsx)(y.zx,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},k=n(98395),N=n(40802),q=n(66106),A=n(30914),D=n(86005),E=n(97587),F=n(30426),z=n(14771),T=n(98200),_=n(96038),P=function(e){var t=(0,Z.useState)([]),n=(0,l.Z)(t,2),r=n[0],a=n[1],c=(0,Z.useState)(!0),u=(0,l.Z)(c,2),d=u[0],h=u[1],p=(0,Z.useState)(1),m=(0,l.Z)(p,2),g=m[0],x=m[1],w=(0,Z.useState)(25),b=(0,l.Z)(w,2),I=(b[0],b[1],y.l0.useForm()),C=(0,l.Z)(I,1)[0],P=(0,Z.useState)(0),M=(0,l.Z)(P,2),L=(M[0],M[1]),O=(0,Z.useState)(0),R=(0,l.Z)(O,2),B=R[0],U=R[1],V=(0,Z.useState)(!0),X=(0,l.Z)(V,2),Y=X[0],J=X[1],K=((0,v.HJ)().push,(0,Z.useState)(!1)),W=(0,l.Z)(K,2),H=(W[0],W[1],(0,Z.useState)(!1)),G=(0,l.Z)(H,2),Q=(G[0],G[1],(0,Z.useState)()),$=(0,l.Z)(Q,2),ee=($[0],$[1],function(){var t=(0,o.Z)((0,s.Z)().mark((function t(n){var i,o;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j.E.custom({url:"",method:"post",metaData:{operation:"addSchoolAdminstrator",variables:{schoolId:{value:parseInt(e.school.id),type:"Int",required:!0},userId:{value:parseInt(n.toString()),type:"Int",required:!0}},fields:["success","message",{member:["id",{school:["id","name"]},{user:["id","firstName","middleName","lastName","fullName","email","pic"]},"created","updated","isActive","canEdit","canDelete","canManage"]}]}});case 2:i=t.sent,(o=i.data).success?(k.Z.success(o.message),a(r.filter((function(e){return e.id.toString()!==n.toString()}))),e.onAdd(o.member)):k.Z.error(o.message),N.Z.destroyAll();case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),te=function(){var t=(0,o.Z)((0,s.Z)().mark((function t(n){var o,l,c,u=arguments;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=u.length>1&&void 0!==u[1]?u[1]:"",u.length>2&&void 0!==u[2]&&u[2],t.next=4,j.E.custom({url:"",method:"get",metaData:{operation:"notSchoolAdminstrators",variables:{schoolId:{value:parseInt(e.school.id),type:"Int",required:!0},page:{value:n,type:"Int",required:!0},key:{value:o,type:"String",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","firstName","middleName","lastName","fullName","email","pic","created","updated","isActive","canEdit","canDelete","canManage"]}]}});case 4:l=t.sent,c=l.data,U(c.total),L(c.pages),x(c.page),J(c.hasNext),a([].concat((0,i.Z)(r),(0,i.Z)(c.results))),h(!1);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,Z.useEffect)((function(){r.length=0,a([]),te(1)}),[e.randKey]),(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(q.Z,{children:(0,S.jsx)(A.Z,{span:24,children:(0,S.jsx)(y.l0,{layout:"vertical",form:C,onFinish:function(e){r.length=0,a([]),te(1,e.key,!0)},children:(0,S.jsx)(y.l0.Item,{name:"key",children:(0,S.jsx)(D.Z,{size:"large",placeholder:"Search Adminstrator(s)...",prefix:(0,S.jsx)(f.Z,{}),autoComplete:"off",allowClear:!0})})})})}),(0,S.jsx)(y.yC,{spinning:d,children:(0,S.jsx)("div",{id:"scrollableAdminstratorDiv",style:{maxHeight:"80vh",overflowY:"auto"},children:(0,S.jsx)(z.Z,{dataLength:B,next:function(){return te(g)},hasMore:Y,scrollableTarget:"scrollableAdminstratorDiv",loader:(0,S.jsx)(S.Fragment,{children:r.length>0?(0,S.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:10},children:(0,S.jsx)(y.yC,{})}):(0,S.jsx)(S.Fragment,{})}),endMessage:(0,S.jsx)("p",{style:{textAlign:"center",display:r.length>0?"block":"none"},children:(0,S.jsx)("b",{children:"Yay! You have seen it all"})}),children:(0,S.jsx)(E.Z,{itemLayout:"horizontal",dataSource:r,renderItem:function(t){return(0,S.jsx)("div",{style:{background:"white",marginBottom:5,paddingLeft:10,paddingTop:10},children:(0,S.jsx)(E.Z.Item,{style:{margin:0,padding:0},actions:[(0,S.jsx)(_.Z,{placement:"topLeft",title:"Adding "+t.fullName+" to "+e.school.name+"?",onConfirm:function(){return ee(t.id)},okText:"Yes",cancelText:"No",children:(0,S.jsx)(y.zx,{icon:(0,S.jsx)(T.Z,{})})})],children:(0,S.jsx)(E.Z.Item.Meta,{avatar:(0,S.jsx)(F.Z,{src:t.pic}),title:(0,S.jsx)("a",{children:t.fullName}),description:(0,S.jsx)(S.Fragment,{children:(0,S.jsx)("p",{children:t.email})})})},"file-"+t.id)})}})})})})]})},M=y.Ph.Option,L=["female","male","others"],O=function(e){var t=(0,Z.useState)(!1),n=(0,l.Z)(t,2),r=(n[0],n[1]),a=(0,Z.useState)(!1),i=(0,l.Z)(a,2),c=(i[0],i[1]),u=(0,Z.useState)(!1),d=(0,l.Z)(u,2),h=(d[0],d[1]),p=(0,Z.useState)(!1),m=(0,l.Z)(p,2),f=m[0],g=m[1],x=(0,Z.useState)(),v=(0,l.Z)(x,2),w=v[0],b=v[1],I=y.l0.useForm(),C=(0,l.Z)(I,1)[0],N=function(){var t=(0,o.Z)((0,s.Z)().mark((function t(n){var a,i;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return g(!0),t.next=3,j.E.custom({url:"",method:"post",metaData:{operation:"createSchoolAdminstratorPlain",variables:{schoolId:{value:parseInt(n.school_id),type:"Int",required:!0},firstName:{value:n.first_name,type:"String",required:!0},middleName:{value:n.middle_name,type:"String",required:!0},lastName:{value:n.last_name,type:"String",required:!0},phoneNumber:{value:n.phone_number,type:"String",required:!0},email:{value:n.email,type:"String",required:!1},gender:{value:n.gender,type:"String",required:!1}},fields:["success","message","memberExists","existSameSchool","existSameSchoolNotAuthenticated",{member:["id",{school:["id","name"]},{user:["id","firstName","middleName","lastName","fullName","email","pic"]},"created","updated","isActive","canEdit","canDelete","canManage"]}]}}).catch((function(e){return k.Z.error("Error in Creating School Adminstrator"),{data:null}})).then((function(e){return e}));case 3:a=t.sent,(i=a.data)&&(i.success?(k.Z.success(i.message),e.onFinish(i.member)):(k.Z.error(i.message),b(i.message),r(i.memberExists),c(i.existSameSchool),h(i.existSameSchoolNotAuthenticated))),g(!1);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,Z.useEffect)((function(){}),[e.randKey]),(0,S.jsxs)(S.Fragment,{children:[w&&(0,S.jsx)(y.bZ,{description:(0,S.jsx)(S.Fragment,{children:w}),type:"error",closable:!0}),(0,S.jsxs)(y.l0,{layout:"vertical",form:C,onFinish:function(t){t.school_id=e.school.id,N(t)},requiredMark:!0,autoComplete:"off",initialValues:{remember:!1,email:"",password:""},children:[(0,S.jsx)(y.l0.Item,{name:"first_name",label:"First Name",rules:[{required:!0,type:"string",message:"Please input First Name"}],children:(0,S.jsx)(y.II,{size:"large",placeholder:"Enter First Name ..."})}),(0,S.jsx)(y.l0.Item,{name:"middle_name",label:"Middle Name",rules:[{required:!0,type:"string",message:"Please input Middle Name"}],children:(0,S.jsx)(y.II,{size:"large",placeholder:"Enter Middle Name ..."})}),(0,S.jsx)(y.l0.Item,{name:"last_name",label:"Last Name",rules:[{required:!0,type:"string",message:"Please input Last Name"}],children:(0,S.jsx)(y.II,{size:"large",placeholder:"Enter Last Name ..."})}),(0,S.jsx)(y.l0.Item,{label:"Gender",name:"gender",rules:[{required:!0,type:"string",message:"Please choose Gender..."}],children:(0,S.jsx)(y.Ph,{size:"large",showSearch:!0,placeholder:"Select a School Type",optionFilterProp:"children",onSearch:function(e){},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:L.map((function(e,t){return(0,S.jsx)(M,{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)})}))})}),(0,S.jsx)(y.l0.Item,{name:"phone_number",label:"Mobile Phone Number",rules:[{required:!0,type:"string",message:"Please input Mobile Phone Number"}],children:(0,S.jsx)(y.II,{size:"large",placeholder:"Enter Mobile Phone Number ..."})}),(0,S.jsx)(y.l0.Item,{name:"email",label:"Email Address",rules:[{required:!0,type:"string",message:"Please input Email Address ..."}],children:(0,S.jsx)(y.II,{size:"large",placeholder:"Enter First Name ..."})}),(0,S.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,S.jsx)(y.zx,{type:"ghost",size:"large",color:"red",onClick:function(){C.resetFields()},danger:!0,children:"Clear"}),(0,S.jsx)(y.zx,{size:"large",htmlType:"submit",disabled:f,loading:f,danger:!0,children:"Save"})]})]})]})},R=function(e){var t=(0,Z.useState)([]),n=(0,l.Z)(t,2),r=n[0],a=n[1],u=(0,Z.useState)(!0),d=(0,l.Z)(u,2),h=d[0],p=d[1],w=(0,Z.useState)(1),b=(0,l.Z)(w,2),I=b[0],C=b[1],T=(0,Z.useState)(25),_=(0,l.Z)(T,2),M=_[0],L=(_[1],(0,Z.useState)("")),R=(0,l.Z)(L,2),B=R[0],U=R[1],V=y.l0.useForm(),X=(0,l.Z)(V,1)[0],Y=(0,Z.useState)(0),J=(0,l.Z)(Y,2),K=(J[0],J[1]),W=(0,Z.useState)(0),H=(0,l.Z)(W,2),G=H[0],Q=H[1],$=(0,Z.useState)(!0),ee=(0,l.Z)($,2),te=ee[0],ne=ee[1],re=((0,v.HJ)().push,(0,Z.useState)(!1)),ae=(0,l.Z)(re,2),ie=ae[0],se=ae[1],oe=(0,Z.useState)(!1),le=(0,l.Z)(oe,2),ce=le[0],ue=le[1],de=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t){var n,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.E.custom({url:"",method:"post",metaData:{operation:"removeSchoolAdminstrator",variables:{id:{value:t,type:"Int",required:!0}},fields:["success","message"]}});case 2:n=e.sent,i=n.data,k.Z.destroy(),i.success?(k.Z.success(i.message),a(r.filter((function(e){return e.id.toString()!==t.toString()})))):k.Z.error(i.message),N.Z.destroyAll();case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),he=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t){var n,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.E.custom({url:"",method:"post",metaData:{operation:"deleteSchoolMember",variables:{id:{value:t,type:"Int",required:!0}},fields:["success","message"]}});case 2:n=e.sent,i=n.data,k.Z.destroy(),i.success?(k.Z.success(i.message),a(r.filter((function(e){return e.id.toString()!==t.toString()})))):k.Z.error(i.message),N.Z.destroyAll();case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),pe=function(){var t=(0,o.Z)((0,s.Z)().mark((function t(n){var o,l,c,u,d=arguments;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=d.length>1&&void 0!==d[1]?d[1]:"",l=d.length>2&&void 0!==d[2]?d[2]:20,t.next=4,j.E.custom({url:"",method:"get",metaData:{operation:"schoolMembers",variables:{schoolId:{value:parseInt(e.school.id),type:"Int",required:!0},adminstrator:{value:!0,type:"Boolean",required:!0},page:{value:n,type:"Int",required:!0},key:{value:o,type:"String",required:!1},pageSize:{value:l,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{school:["id","name"]},{user:["id","firstName","middleName","lastName","fullName","email","pic"]},"created","updated","isActive","canEdit","canDelete","canManage"]}]}});case 4:c=t.sent,u=c.data,Q(u.total),K(u.pages),C(u.page),ne(u.hasNext),a([].concat((0,i.Z)(r),(0,i.Z)(u.results))),p(!1);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,Z.useEffect)((function(){r.length=0,a([]),pe(1,"",20)}),[e.randKey]),(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(q.Z,{children:[(0,S.jsx)(A.Z,{span:16,children:(0,S.jsx)(y.l0,{layout:"vertical",form:X,onFinish:function(e){U(e.key),pe(0,e.key,M)},children:(0,S.jsx)(y.l0.Item,{name:"key",children:(0,S.jsx)(D.Z,{size:"large",placeholder:"Search Adminstrator(s)...",prefix:(0,S.jsx)(f.Z,{}),autoComplete:"off",allowClear:!0})})})}),(0,S.jsxs)(A.Z,{span:8,style:{display:"flex",justifyContent:"flex-end"},children:[(0,S.jsx)(y.zx,{size:"large",icon:(0,S.jsx)(x.Z,{}),onClick:function(){se(!0)},children:"Enroll"}),(0,S.jsx)(y.zx,{size:"large",icon:(0,S.jsx)(x.Z,{}),onClick:function(){return ue(!0)},children:"Register New"})]})]}),(0,S.jsx)(y.yC,{spinning:h,children:(0,S.jsx)("div",{id:"scrollableAdminstratorDiv",style:{maxHeight:"65vh",overflowY:"auto"},children:(0,S.jsx)(z.Z,{dataLength:G,next:function(){return pe(I,B,M)},hasMore:te,scrollableTarget:"scrollableAdminstratorDiv",loader:(0,S.jsx)(S.Fragment,{children:r.length>0?(0,S.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:10},children:(0,S.jsx)(y.yC,{})}):(0,S.jsx)(S.Fragment,{})}),endMessage:(0,S.jsx)("p",{style:{textAlign:"center",display:r.length>0?"block":"none"},children:(0,S.jsx)("b",{children:"Yay! You have seen it all"})}),children:(0,S.jsx)(E.Z,{itemLayout:"horizontal",dataSource:r,renderItem:function(e){var t,n,r;return(0,S.jsx)("div",{style:{background:"white",marginBottom:5,paddingLeft:10,paddingTop:10},children:(0,S.jsx)(E.Z.Item,{style:{margin:0,padding:0},actions:[(0,S.jsx)(y.Lt,{trigger:["click"],placement:"bottomRight",overlay:(0,S.jsxs)(y.v2,{children:[(0,S.jsx)(y.v2.Item,{disabled:!e.canDelete,icon:(0,S.jsx)(c.Z,{}),children:(0,S.jsx)(y.gn,{placement:"topRight",title:"Are you sure you want to delete this adminstrator?",onConfirm:function(){return he(parseInt(e.id.toString()))},okText:"Yes",cancelText:"No",children:(0,S.jsx)("a",{target:"_blank",rel:"noopener noreferrer",children:"Delete"})})}),(0,S.jsx)(y.v2.Item,{disabled:!e.canDelete,icon:(0,S.jsx)(g.Z,{}),children:(0,S.jsx)(y.gn,{placement:"topRight",title:"Are you sure you want to Remove Adminstrator Role?",onConfirm:function(){return de(parseInt(e.id.toString()))},okText:"Yes",cancelText:"No",children:(0,S.jsx)("a",{target:"_blank",rel:"noopener noreferrer",children:"Remove Adminstrator Role"})})})]}),children:(0,S.jsx)("a",{className:"ant-dropdown-link",onClick:function(e){return e.preventDefault()},children:(0,S.jsx)(m.Z,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})],children:(0,S.jsx)(E.Z.Item.Meta,{avatar:(0,S.jsx)(F.Z,{src:null===(t=e.user)||void 0===t?void 0:t.pic}),title:(0,S.jsx)("a",{children:null===(n=e.user)||void 0===n?void 0:n.fullName}),description:(0,S.jsx)(S.Fragment,{children:(0,S.jsx)("p",{children:null===(r=e.user)||void 0===r?void 0:r.email})})})},"file-"+e.id)})}})})})}),(0,S.jsx)(y.dy,{title:"Adding School Adminstrators",width:"30vw",closable:!0,onClose:function(){return se(!1)},visible:ie,children:(0,S.jsx)(P,{randKey:Math.random(),school:e.school,onAdd:function(e){a([e].concat((0,i.Z)(r)))}})}),(0,S.jsx)(y.dy,{title:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("span",{children:"Registering School Adminstrators"}),(0,S.jsx)(y.Vp,{color:"green",style:{marginLeft:10},children:e.school.name})]}),width:"40vw",closable:!0,onClose:function(){return ue(!1)},visible:ce,destroyOnClose:!0,children:(0,S.jsx)(O,{school:e.school,randKey:Math.random(),onFinish:function(e){a([e].concat((0,i.Z)(r))),ue(!1)}})})]})},B=y.Ph.Option,U=y.II.TextArea,V=function(e){var t=(0,Z.useState)([]),n=(0,l.Z)(t,2),r=n[0],a=n[1],i=(0,Z.useState)([]),c=(0,l.Z)(i,2),u=c[0],d=c[1],h=(0,Z.useState)([]),p=(0,l.Z)(h,2),m=p[0],f=p[1],g=(0,Z.useState)([]),x=(0,l.Z)(g,2),v=x[0],b=x[1],I=(0,Z.useState)([]),C=(0,l.Z)(I,2),k=C[0],N=C[1],q=(0,Z.useState)(0),A=(0,l.Z)(q,2),D=A[0],E=A[1],F=(0,Z.useState)(0),z=(0,l.Z)(F,2),T=z[0],_=z[1],P=(0,Z.useState)(),M=(0,l.Z)(P,2),L=M[0],O=M[1],R=(0,Z.useState)(!1),V=(0,l.Z)(R,2),X=(V[0],V[1]),Y=(0,Z.useState)(!1),J=(0,l.Z)(Y,2),K=J[0],W=J[1],H=(0,Z.useState)(!1),G=(0,l.Z)(H,2),Q=G[0],$=G[1],ee=(0,Z.useState)([]),te=(0,l.Z)(ee,2),ne=te[0],re=te[1],ae=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(){var t,n,r,a,i=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:1,n=i.length>1&&void 0!==i[1]?i[1]:"",e.next=4,j.E.custom({url:"",method:"get",metaData:{operation:"ownerships",variables:{page:{value:t,type:"Int",required:!0},key:{value:n,type:"String",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","isActive","created","updated","canEdit","canDelete","canManage"]}]}});case 4:r=e.sent,a=r.data,d(a.results);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ie=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t){var n,r,a,i=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:"",$(!0),e.next=4,j.E.custom({url:"",method:"get",metaData:{operation:"wards",variables:{key:{value:n,type:"String",required:!1},district:{value:t,type:"Int",requiqred:!1}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","name","created","updated","isActive","canEdit","canDelete","canManage"]}]}});case 4:r=e.sent,a=r.data,f(a.results),$(!1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),se=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t){var n,r,a,i=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:"",W(!0),e.next=4,j.E.custom({url:"",method:"get",metaData:{operation:"districts",variables:{key:{value:n,type:"String",required:!1},region:{value:t,type:"Int",required:!1}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","name","created","updated","isActive","canEdit","canDelete","canManage"]}]}});case 4:r=e.sent,a=r.data,b(a.results),W(!1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oe=function(){var t=(0,o.Z)((0,s.Z)().mark((function t(){var n,r,a,i=arguments;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=i.length>0&&void 0!==i[0]?i[0]:"",t.next=3,j.E.custom({url:"",method:"get",metaData:{operation:"regions",variables:{key:{value:n,type:"String",required:!1}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","name","created","updated","isActive","canEdit","canDelete","canManage"]}]}});case 3:r=t.sent,a=r.data,N(a.results),e.form.setFieldsValue({district:void 0,ward:void 0});case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),le=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(){var t,n,r,i=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:"",e.next=3,j.E.custom({url:"",method:"get",metaData:{operation:"schoolsTypes",variables:{key:{value:t,type:"String",required:!1}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","name","created","updated","isActive","canEdit","canDelete","canManage"]}]}});case 3:n=e.sent,r=n.data,a(r.results);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ce=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:E(t),se(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ue=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:_(t),ie(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,Z.useEffect)((function(){le(),ae(),oe()}),[]),(0,S.jsx)(S.Fragment,{children:(0,S.jsxs)(y.l0,{layout:"vertical",form:e.form,onFinish:function(t){t.schoolTypes=ne,e.onFinish(t)},requiredMark:!0,children:[(0,S.jsxs)(y.X2,{children:[(0,S.jsxs)(y.JX,{span:11,children:[(0,S.jsx)(y.l0.Item,{name:"name",label:"Name",rules:[{required:!0,type:"string",message:"Please input name"}],children:(0,S.jsx)(y.II,{size:"large",placeholder:"Enter Name ..."})}),(0,S.jsx)(y.l0.Item,{name:"serial_number",label:"Serial Number",rules:[{required:!0,type:"string",message:"Please input Serial Number ..."}],children:(0,S.jsx)(y.II,{size:"large",placeholder:"Enter Serial Number ..."})}),(0,S.jsx)(y.l0.Item,{label:"School Type",name:"schoolTypes",rules:[{required:!0,type:"array",message:"Please choose School Type"}],children:(0,S.jsx)(y.Ph,{size:"large",mode:"multiple",showSearch:!0,placeholder:"Select a School Type",optionFilterProp:"children",onChange:function(e){re(e)},onSearch:function(e){},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:r.map((function(e,t){return(0,S.jsx)(B,{value:e.id,children:e.name})}))})}),(0,S.jsx)(y.l0.Item,{name:"ownership_id",label:"School Ownership",rules:[{required:!0,type:"string",message:"Please choose Ownership"}],children:(0,S.jsx)(y.Ph,{size:"large",showSearch:!0,placeholder:"Select a Ownership",optionFilterProp:"children",onChange:function(e){},onSearch:function(e){},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:u.map((function(e,t){return(0,S.jsx)(B,{value:e.id,children:e.name})}))})}),(0,S.jsx)(y.l0.Item,{name:"bio",label:"Biography",style:{marginBottom:"12px"},children:(0,S.jsx)(U,{rows:4})}),(0,S.jsx)(y.l0.Item,{name:"logo",label:"Logo",style:{marginBottom:"12px"},children:(0,S.jsx)(y.gq,{beforeUpload:function(){return!1},maxCount:1,onChange:function(e){var t=e.file;L?L.uid!==t.uid&&(O(t),X(!0)):(O(t),X(!0))},onRemove:function(){O(void 0),X(!1)},accept:"image/*",children:(0,S.jsx)(y.zx,{icon:(0,S.jsx)(w.Z,{}),children:"Click to Select"})})})]}),(0,S.jsxs)(y.JX,{span:11,offset:2,children:[(0,S.jsx)(y.l0.Item,{name:"region_id",label:"Region",rules:[{required:!0,type:"string",message:"Please Choose Region ..."}],children:(0,S.jsx)(y.Ph,{size:"large",showSearch:!0,placeholder:"Select a region",optionFilterProp:"children",onChange:function(t){ce(parseInt(t)),e.form.setFieldsValue({district:void 0,ward:void 0}),b([]),f([])},onSearch:function(e){e.length>2&&oe(e)},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:k.map((function(e,t){return(0,S.jsx)(B,{value:e.id,children:e.name})}))})}),(0,S.jsx)(y.l0.Item,{name:"district_id",label:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("span",{children:"District"}),(0,S.jsx)(y.yC,{spinning:K})]}),rules:[{required:!0,type:"string",message:"Please Choose District ..."}],children:(0,S.jsx)(y.Ph,{size:"large",showSearch:!0,disabled:K||0===v.length,placeholder:"Select a district",optionFilterProp:"children",onChange:function(t){ue(parseInt(t)),e.form.setFieldsValue({ward:void 0}),f([])},onSearch:function(e){e.length>2&&0!==D&&se(D,e)},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:v.map((function(e,t){return(0,S.jsx)(B,{value:e.id,children:e.name})}))})}),(0,S.jsx)(y.l0.Item,{name:"ward_id",label:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("span",{children:"Ward"}),(0,S.jsx)(y.yC,{spinning:Q})]}),children:(0,S.jsx)(y.Ph,{size:"large",showSearch:!0,disabled:Q||0===m.length,placeholder:"Select a ward",optionFilterProp:"children",onChange:function(e){},onSearch:function(e){e.length>2&&ie(T,e)},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:m.map((function(e,t){return(0,S.jsx)(B,{value:e.id,children:e.name})}))})}),(0,S.jsx)(y.l0.Item,{name:"website",label:"Website",rules:[{required:!1,type:"url",message:"Please input Website Address ..."}],children:(0,S.jsx)(y.II,{size:"large",placeholder:"Enter Website Address ..."})}),(0,S.jsx)(y.l0.Item,{name:"latitude",label:"Latitude",rules:[{required:!1,type:"string",message:"Please input Latitude ..."}],children:(0,S.jsx)(y.II,{size:"large",placeholder:"Enter Latitude..."})}),(0,S.jsx)(y.l0.Item,{name:"longitude",label:"Longitude",rules:[{required:!1,type:"string",message:"Please input Longitude ..."}],children:(0,S.jsx)(y.II,{size:"large",placeholder:"Enter Longitude..."})}),(0,S.jsx)(y.l0.Item,{name:"is_universal",valuePropName:"checked",children:(0,S.jsx)(y.XZ,{children:"Universal"})}),(0,S.jsx)(y.l0.Item,{name:"njiwa_account",valuePropName:"checked",children:(0,S.jsx)(y.XZ,{children:"Auto Create Njiwa Account"})})]})]}),(0,S.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,S.jsx)(y.zx,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},X=n(59467),Y=n(14057),J=n(70309),K=n(65323),W=function(e){var t=y.l0.useForm(),n=(0,l.Z)(t,1)[0],r=function(){var t=(0,o.Z)((0,s.Z)().mark((function t(n){var r,a;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j.E.custom({url:"",method:"post",metaData:{operation:"createSchoolNjiwaAccountBilling",variables:{amount:{value:n.amount,type:"Float",required:!1},units:{value:0,type:"Int",required:!1},schoolId:{value:parseInt(e.school.id.toString()),type:"Int",required:!0}},fields:["success","message",{bill:["id",{account:["id"]},"billNumber","amount","units","source",{creator:["id","fullName","firstName","middleName","lastName","email","phone"]},"isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch((function(e){return{data:null}})).then((function(e){return e}));case 2:r=t.sent,(a=r.data)&&(a.success?(y.yw.success(a.message),e.onFinish(a.bill)):y.yw.error(a.message));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,Z.useEffect)((function(){}),[]),(0,S.jsx)(S.Fragment,{children:(0,S.jsxs)(y.l0,{layout:"vertical",form:n,onFinish:function(e){r(e)},requiredMark:!0,children:[(0,S.jsx)(y.l0.Item,{name:"amount",label:"Amount",rules:[{required:!0,type:"number",message:"Please input Amount"}],children:(0,S.jsx)(y.Rn,{min:1,style:{width:"50%"},size:"large"})}),(0,S.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,S.jsx)(y.zx,{size:"large",htmlType:"submit",danger:!0,icon:(0,S.jsx)(K.Z,{}),children:"Save"})})]})})},H=function(e){var t=y.l0.useForm(),n=(0,l.Z)(t,1)[0],r=function(){var t=(0,o.Z)((0,s.Z)().mark((function t(n){var r,a;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j.E.custom({url:"",method:"post",metaData:{operation:"createSchoolNjiwaAccountBilling",variables:{amount:{value:0,type:"Float",required:!1},units:{value:n.units,type:"Int",required:!1},schoolId:{value:parseInt(e.school.id.toString()),type:"Int",required:!0}},fields:["success","message",{bill:["id",{account:["id"]},"billNumber","amount","units","source",{creator:["id","fullName","firstName","middleName","lastName","email","phone"]},"isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch((function(e){return{data:null}})).then((function(e){return e}));case 2:r=t.sent,(a=r.data)&&(a.success?(y.yw.success(a.message),e.onFinish(a.bill)):y.yw.error(a.message));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,Z.useEffect)((function(){}),[]),(0,S.jsx)(S.Fragment,{children:(0,S.jsxs)(y.l0,{layout:"vertical",form:n,onFinish:function(e){r(e)},requiredMark:!0,children:[(0,S.jsx)(y.l0.Item,{name:"units",label:"Unit",rules:[{required:!0,type:"number",message:"Please input Unit"}],children:(0,S.jsx)(y.Rn,{min:1,style:{width:"50%"},size:"large"})}),(0,S.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,S.jsx)(y.zx,{size:"large",htmlType:"submit",danger:!0,icon:(0,S.jsx)(K.Z,{}),children:"Save"})})]})})},G=y.ZT.Title,Q=y.ZT.Text,$=function(e){var t=(0,Z.useState)(),n=(0,l.Z)(t,2),r=n[0],a=n[1],u=(0,Z.useState)([]),d=(0,l.Z)(u,2),h=d[0],p=d[1],m=(0,Z.useState)(!1),f=(0,l.Z)(m,2),g=f[0],v=f[1],w=(0,Z.useState)(!1),b=(0,l.Z)(w,2),I=b[0],C=b[1],k=(0,Z.useState)(!1),N=(0,l.Z)(k,2),q=N[0],A=N[1],D=(0,Z.useState)(!1),E=(0,l.Z)(D,2),F=E[0],z=E[1],T=(0,Z.useState)(!1),_=(0,l.Z)(T,2),P=(_[0],_[1]),M=function(){var t=(0,o.Z)((0,s.Z)().mark((function t(n){var r,a,o,l,c=arguments;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=c.length>1&&void 0!==c[1]?c[1]:"",a=c.length>2&&void 0!==c[2]?c[2]:20,t.next=4,j.E.custom({url:"",method:"get",metaData:{operation:"schoolNjiwaAccountBillings",variables:{page:{value:n,type:"Int",required:!0},key:{value:r,type:"String",required:!1},pageSize:{value:a,type:"Int",required:!1},schoolId:{value:parseInt(e.school.id.toString()),type:"Int",required:!0}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{account:["id"]},"billNumber","amount","units","source","synced",{creator:["id","fullName","firstName","middleName","lastName","email","phone"]},"isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch((function(e){return y.yw.error("Error occured while fetching Bills"),{data:null}})).then((function(e){return e}));case 4:o=t.sent,(l=o.data)&&p((0,i.Z)(l.results)),v(!1);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),L=function(){var t=(0,o.Z)((0,s.Z)().mark((function t(){var n,r;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return P(!0),t.next=3,j.E.custom({url:"",method:"post",metaData:{operation:"ressetNjiwaAccount",variables:{schoolId:{value:parseInt(e.school.id),type:"Int",required:!0}},fields:["success","message"]}}).catch((function(e){return{data:null}})).then((function(e){return e}));case 3:n=t.sent,(r=n.data)&&(r.success?(y.yw.success(r.message),V(),M(1)):y.yw.error(r.message)),P(!1);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),O=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t){var n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.E.custom({url:"",method:"post",metaData:{operation:"deleteNjiwaAccountBilling",variables:{billId:{value:parseInt(t.toString()),type:"Int",required:!0}},fields:["success","message"]}}).catch((function(e){return{data:null}})).then((function(e){return e}));case 2:n=e.sent,(r=n.data)&&(r.success?(y.yw.success(r.message),V(),M(1)):y.yw.error(r.message));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),R=function(){var t=(0,o.Z)((0,s.Z)().mark((function t(){var n,r;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return z(!0),t.next=3,j.E.custom({url:"",method:"post",metaData:{operation:"syncNjiwaAccount",variables:{schoolId:{value:parseInt(e.school.id),type:"Int",required:!0}},fields:["success","message"]}}).catch((function(e){return{data:null}})).then((function(e){return e}));case 3:n=t.sent,(r=n.data)&&(r.success?(y.yw.success(r.message),V()):y.yw.error(r.message)),z(!1);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),B=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p([t].concat((0,i.Z)(h))),C(!1),V();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p([t].concat((0,i.Z)(h))),A(!1),V();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){var t=(0,o.Z)((0,s.Z)().mark((function t(){var n,r;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j.E.custom({url:"",method:"get",metaData:{operation:"njiwaAccount",variables:{schoolId:{value:parseInt(e.school.id),type:"Int",required:!0}},fields:["id","balance","messageUnits"]}}).catch((function(e){return{data:null}})).then((function(e){return e}));case 2:n=t.sent,(r=n.data)&&a(r);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),X=[{title:"Bill Number",dataIndex:"bill_number",key:"billNumber",render:function(e,t,n){return(0,S.jsxs)("span",{children:[(0,S.jsx)("span",{style:{marginRight:3},children:t.billNumber}),t.synced&&(0,S.jsx)(y.Vp,{color:"green",children:"Synced"}),!t.synced&&(0,S.jsx)(y.Vp,{color:"red",children:"Not Synced"})]})}},{title:"Amount",dataIndex:"amount",key:"amount",render:function(e,t,n){return(0,S.jsx)("span",{children:t.amount})}},{title:"Units",dataIndex:"units",key:"units",render:function(e,t,n){return(0,S.jsx)("span",{children:t.units})}},{title:"Paid",dataIndex:"isPaid",key:"isPaid",render:function(e,t,n){return(0,S.jsx)("span",{children:t.isPaid?"Yes":"No"})}},{title:"Source",dataIndex:"source",key:"source",render:function(e,t,n){return(0,S.jsx)("span",{children:t.source})}},{title:"",dataIndex:"actions",key:"actions",render:function(e,t,n){return(0,S.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end"},children:[(0,S.jsx)(y.gn,{title:"Are you sure delete this bill - > "+t.billNumber+"?",placement:"topRight",onConfirm:function(){return O(t.id)},onCancel:function(){},okText:"Yes",cancelText:"No",children:(0,S.jsx)(y.zx,{danger:!0,icon:(0,S.jsx)(c.Z,{})})}),!t.synced&&(0,S.jsx)(y.zx,{danger:!0,icon:(0,S.jsx)(Y.Z,{}),style:{marginLeft:5}})]})}}];return(0,Z.useEffect)((function(){V(),M(1,"",20)}),[e.randKey,e.school]),(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(y.X2,{children:(0,S.jsxs)(y.JX,{span:24,style:{display:"flex",justifyContent:"space-between",marginBottom:5},children:[(0,S.jsx)("span",{children:(0,S.jsx)(y.gn,{title:"Are you sure you want to reset the account?",onConfirm:function(){return L()},onCancel:function(){},okText:"Reset",cancelText:"No",children:(0,S.jsx)(y.zx,{icon:(0,S.jsx)(J.Z,{}),danger:!0,loading:F,children:"Reset"})})}),(0,S.jsxs)("span",{children:[(0,S.jsx)(y.zx,{icon:(0,S.jsx)(x.Z,{}),danger:!0,onClick:function(){return C(!0)},children:"Balance"}),(0,S.jsx)(y.zx,{icon:(0,S.jsx)(x.Z,{}),danger:!0,onClick:function(){return A(!0)},children:"Units"}),(0,S.jsx)(y.zx,{icon:(0,S.jsx)(Y.Z,{}),danger:!0,onClick:R,loading:F,children:"Sync"})]})]})}),(0,S.jsxs)(y.X2,{children:[(0,S.jsx)(y.JX,{span:8,children:(0,S.jsx)(y.Od,{loading:g,active:!0,children:(0,S.jsx)(y.Zb,{hoverable:!0,style:{marginRight:10},onClick:function(){},children:(0,S.jsxs)(y.T,{direction:"vertical",align:"center",style:{width:"100%",justifyContent:"center"},children:[(0,S.jsx)(G,{level:2,children:null===r||void 0===r?void 0:r.balance}),(0,S.jsx)(Q,{children:"Balance"})]})})})}),(0,S.jsx)(y.JX,{span:8,children:(0,S.jsx)(y.Od,{loading:g,active:!0,children:(0,S.jsx)(y.Zb,{hoverable:!0,style:{marginRight:10},onClick:function(){},children:(0,S.jsxs)(y.T,{direction:"vertical",align:"center",style:{width:"100%",justifyContent:"center"},children:[(0,S.jsx)(G,{level:2,children:null===r||void 0===r?void 0:r.messageUnits}),(0,S.jsx)(Q,{children:"Units"})]})})})})]}),(0,S.jsx)(y.X2,{style:{marginTop:10},children:(0,S.jsxs)(y.JX,{span:24,children:[(0,S.jsx)(y.iA,{columns:X,dataSource:h}),","]})}),(0,S.jsx)(y.u_,{title:"Add Balance",width:"40vw",destroyOnClose:!0,visible:I,footer:[],onOk:function(){return C(!1)},onCancel:function(){return C(!1)},children:(0,S.jsx)(W,{school:e.school,onFinish:B})}),(0,S.jsx)(y.u_,{title:"Add Units",destroyOnClose:!0,width:"40vw",footer:[],visible:q,onOk:function(){return A(!1)},onCancel:function(){return A(!1)},children:(0,S.jsx)(H,{school:e.school,onFinish:U})})]})},ee=n(92365),te=n(31694),ne=function(e){var t=y.l0.useForm(),n=(0,l.Z)(t,1)[0],r=(0,Z.useState)(),a=(0,l.Z)(r,2),i=a[0],c=a[1],u=(0,Z.useState)(!1),d=(0,l.Z)(u,2),h=d[0],p=d[1],m=function(){var t=(0,o.Z)((0,s.Z)().mark((function t(r){var a,o;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return k.Z.destroy(),t.next=3,j.E.custom({url:"",method:"post",metaData:{operation:"createSchoolContract",variables:{contractNumber:{value:r.contract_number,type:"String",required:!0},contractValue:{value:r.contract_value,type:"Float",required:!0},startDate:{value:r.start_date,type:"String",required:!0},endDate:{value:r.end_date,type:"String",required:!0},schoolId:{value:parseInt(e.school.id.toString()),type:"Int",required:!0},contractDocument:{value:i,type:"Upload",required:!0}},fields:["success","message"]}});case 3:a=t.sent,(o=a.data).success?(k.Z.success(o.message),e.onFinish(),n.resetFields()):k.Z.error(o.message);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,Z.useEffect)((function(){}),[]),(0,S.jsx)(S.Fragment,{children:(0,S.jsxs)(y.l0,{layout:"vertical",form:n,onFinish:function(e){m(e)},requiredMark:!0,children:[(0,S.jsx)(y.l0.Item,{name:"contract_number",label:"Contract Number",rules:[{required:!0,type:"string",message:"Please input Contract Number ..."}],children:(0,S.jsx)(y.II,{size:"large",placeholder:"Enter Contract Number ..."})}),(0,S.jsx)(y.l0.Item,{name:"contract_value",label:"Contract Value",rules:[{required:!0,type:"number",message:"Please input Contract Value ..."}],children:(0,S.jsx)(y.Rn,{min:0,defaultValue:0,onChange:function(){},size:"large",style:{width:"100%"}})}),(0,S.jsx)(y.l0.Item,{name:"start_date",label:"Contract Start Date",rules:[{required:!0,type:"object",message:"Please input Contract Start Date ..."}],children:(0,S.jsx)(y.Mt,{onChange:function(){}})}),(0,S.jsx)(y.l0.Item,{name:"end_date",label:"Contract End Date",rules:[{required:!0,type:"object",message:"Please input Contract End Date ..."}],children:(0,S.jsx)(y.Mt,{onChange:function(){}})}),(0,S.jsx)(y.l0.Item,{name:"contract_document",label:"Contract Document",style:{marginBottom:"12px"},rules:[{required:!h,type:"object",message:"Please Pick a Contract Document ..."}],children:(0,S.jsx)(y.gq,{beforeUpload:function(){return!1},maxCount:1,onChange:function(e){var t=e.file;i?i.uid!==t.uid&&(c(t),p(!0)):(c(t),p(!0))},onRemove:function(){c(void 0),p(!1)},accept:".pdf",children:(0,S.jsx)(y.zx,{icon:(0,S.jsx)(w.Z,{}),children:"Click to Select"})})}),(0,S.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:20},children:[(0,S.jsx)(y.zx,{size:"large",icon:(0,S.jsx)(K.Z,{}),onClick:function(){c(void 0),p(!1),n.resetFields()},danger:!0,children:"Reset"}),(0,S.jsx)(y.zx,{size:"large",htmlType:"submit",icon:(0,S.jsx)(K.Z,{}),danger:!0,children:"Save"})]})]})})},re=n(60438),ae=n.n(re),ie=function(e){var t=y.l0.useForm(),n=(0,l.Z)(t,1)[0],r=(0,Z.useState)([]),a=(0,l.Z)(r,2),i=a[0],d=a[1],h=(0,Z.useState)(),p=(0,l.Z)(h,2),m=(p[0],p[1]),g=(0,Z.useState)(!1),v=(0,l.Z)(g,2),w=(v[0],v[1]),b=(0,Z.useState)(1),I=(0,l.Z)(b,2),C=I[0],N=I[1],E=(0,Z.useState)(0),F=(0,l.Z)(E,2),z=(F[0],F[1]),T=(0,Z.useState)(!1),_=(0,l.Z)(T,2),P=(_[0],_[1]),M=(0,Z.useState)(!1),L=(0,l.Z)(M,2),O=(L[0],L[1],(0,Z.useState)("")),R=(0,l.Z)(O,2),B=R[0],U=(R[1],(0,Z.useState)(!1)),V=(0,l.Z)(U,2),X=V[0],Y=V[1],J=[{title:"Contract Number",dataIndex:"contractNumber",key:"contractNumber",render:function(e,t){return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("a",{children:e}),t.contractDocument&&(0,S.jsx)(y.u,{title:"Click to Download Contract Document",children:(0,S.jsx)(y.zx,{size:"small",style:{marginLeft:5},danger:!0,onClick:function(){window.open(t.contractDocument)},children:(0,S.jsx)(ee.Z,{})})})]})}},{title:"Start Date",dataIndex:"startDate",key:"startDate",render:function(e){return(0,S.jsx)(S.Fragment,{children:ae()(e).format("lll")})}},{title:"End Date",dataIndex:"endDate",key:"endDate",render:function(e){return(0,S.jsx)(S.Fragment,{children:ae()(e).format("lll")})}},{title:"Contract Value",dataIndex:"contractValue",key:"contractValue"},{title:"Created",dataIndex:"created",key:"created",render:function(e){return(0,S.jsx)(S.Fragment,{children:ae()(e).format("lll")})}},{title:"Created",dataIndex:"created",key:"created",render:function(e){return(0,S.jsx)(S.Fragment,{children:ae()(e).format("lll")})}},{title:"",dataIndex:"actions",key:"actions",render:function(e,t){return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(y.zx,{size:"small",onClick:function(){m(t)},danger:!0,icon:(0,S.jsx)(u.Z,{})}),(0,S.jsx)(y.gn,{title:"Delete the contract?",placement:"topRight",onConfirm:function(){return W(t.id)},onCancel:function(){},okText:"Yes",cancelText:"No",children:(0,S.jsx)(y.zx,{size:"small",danger:!0,icon:(0,S.jsx)(c.Z,{})})})]})}}],K=function(){var t=(0,o.Z)((0,s.Z)().mark((function t(n){var r,a,i,o,l=arguments;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=l.length>1&&void 0!==l[1]?l[1]:"",a=l.length>2&&void 0!==l[2]?l[2]:20,t.next=4,j.E.custom({url:"",method:"get",metaData:{operation:"schoolContracts",variables:{page:{value:n,type:"Int",required:!0},pageSize:{value:a,type:"Int",required:!0},key:{value:r,type:"String",required:!1},schoolId:{value:parseInt(e.school.id.toString()),type:"Int",required:!0}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","contractNumber","contractValue","contractDocument","startDate","endDate","created","updated","isActive","canEdit","canDelete","canManage"]}]}});case 4:i=t.sent,o=i.data,N(o.page),z(o.total),P(o.hasNext),d(o.results),w(!1);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),W=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t){var n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.E.custom({url:"",method:"post",metaData:{operation:"deleteSchoolContract",variables:{id:{value:t,type:"Int",required:!0}},fields:["success","message"]}});case 2:n=e.sent,(r=n.data).success?(k.Z.success(r.message),K(C,B)):k.Z.error(r.message);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,Z.useEffect)((function(){K(C,B)}),[e.randKey,e.school]),(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(q.Z,{style:{marginTop:10},children:[(0,S.jsx)(A.Z,{span:10,children:(0,S.jsx)(y.l0,{layout:"vertical",form:n,onFinish:function(e){},children:(0,S.jsx)(y.l0.Item,{name:"key",children:(0,S.jsx)(D.Z,{size:"large",placeholder:"Search ...",prefix:(0,S.jsx)(f.Z,{}),autoComplete:"off",allowClear:!0})})})}),(0,S.jsx)(A.Z,{span:14,style:{textAlign:"right"},children:(0,S.jsx)(y.zx,{icon:(0,S.jsx)(x.Z,{}),size:"large",onClick:function(){Y(!0)},danger:!0,children:"Add Contract"})})]}),(0,S.jsx)(te.Z,{dataSource:i,columns:J}),(0,S.jsx)(y.dy,{title:"Adding New Contract",destroyOnClose:!0,placement:"right",width:"35vw",onClose:function(){return Y(!1)},visible:X,children:(0,S.jsx)(ne,{school:e.school,onFinish:function(){Y(!1),K(1,"")}})})]})},se=function(e){var t=(0,Z.useState)(),n=(0,l.Z)(t,2),r=n[0],a=n[1],w=(0,Z.useState)([]),b=(0,l.Z)(w,2),I=b[0],k=b[1],N=(0,Z.useState)([]),q=(0,l.Z)(N,2),A=q[0],D=q[1],E=(0,Z.useState)([]),F=(0,l.Z)(E,2),z=F[0],T=F[1],_=(0,Z.useState)(1),P=(0,l.Z)(_,2),M=P[0],L=P[1],O=(0,Z.useState)(0),B=(0,l.Z)(O,2),U=B[0],Y=B[1],J=(0,Z.useState)(20),K=(0,l.Z)(J,2),W=K[0],H=K[1],G=(0,Z.useState)(""),Q=(0,l.Z)(G,2),ee=Q[0],te=(Q[1],(0,Z.useState)(!1)),ne=(0,l.Z)(te,2),re=(ne[0],ne[1]),se=(0,Z.useState)(!0),oe=(0,l.Z)(se,2),le=(oe[0],oe[1]),ce=((0,v.HJ)().push,(0,Z.useState)(!1)),ue=(0,l.Z)(ce,2),de=ue[0],he=ue[1],pe=(0,Z.useState)(!1),me=(0,l.Z)(pe,2),fe=me[0],ge=me[1],xe=(0,Z.useState)(!1),ve=(0,l.Z)(xe,2),ye=ve[0],je=ve[1],Ze=y.l0.useForm(),we=(0,l.Z)(Ze,1)[0],Se=y.l0.useForm(),be=(0,l.Z)(Se,1)[0],Ie=(0,Z.useState)(!1),Ce=(0,l.Z)(Ie,2),ke=Ce[0],Ne=Ce[1],qe=(0,Z.useState)(!1),Ae=(0,l.Z)(qe,2),De=Ae[0],Ee=Ae[1],Fe=(0,Z.useState)(!1),ze=(0,l.Z)(Fe,2),Te=ze[0],_e=ze[1],Pe=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a(t),_e(!0);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Me=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t){var n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.E.custom({url:"",method:"post",metaData:{operation:"createSchool",variables:{name:{value:t.name,type:"String",required:!0},serialNumber:{value:t.serial_number,type:"String",required:!0},ownershipId:{value:parseInt(t.ownership_id),type:"Int",required:!0},schoolTypes:{value:t.schoolTypes,type:"[String]",required:!0},regionId:{value:parseInt(t.region_id),type:"Int",required:!1},districtId:{value:parseInt(t.district_id),type:"Int",required:!1},wardId:{value:parseInt(t.ward_id),type:"Int",required:!1},bio:{value:t.bio,type:"String",required:!1},website:{value:t.website,type:"String",required:!1},longitude:{value:t.longitude,type:"Float",required:!1},latitude:{value:t.latitude,type:"Float",required:!1},isUniversal:{value:t.is_universal,type:"Boolean",required:!1},njiwaAccount:{value:t.njiwa_account,type:"Boolean",required:!1}},fields:["success","message",{school:["id","name","serialNumber","hasNjiwaAccount",{region:["id","name"]},{district:["id","name"]},{ownership:["id","name"]},{schoolType:["id","name"]},{ward:["id","name",{district:["id","name",{region:["id","name"]}]}]},{level:["id"]},{schoolOperatingTypes:["id",{schoolType:["id","name","code"]}]},"latitude","longitude","bio","logo","created","updated","isActive","isUniversal","canEdit","canDelete","canManage"]}]}});case 2:n=e.sent,(r=n.data).success?(y.yw.success(r.message),k([r.school].concat((0,i.Z)(I))),he(!1),we.resetFields()):y.yw.error(r.message);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Le=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t){var n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.E.custom({url:"",method:"post",metaData:{operation:"updateSchool",variables:{id:{value:parseInt(t.id),type:"Int",required:!0},name:{value:t.name,type:"String",required:!0},serialNumber:{value:t.serial_number,type:"String",required:!0},ownershipId:{value:parseInt(t.ownership_id),type:"Int",required:!0},schoolTypes:{value:t.schoolTypes,type:"[String]",required:!0},regionId:{value:parseInt(t.region_id),type:"Int",required:!1},districtId:{value:parseInt(t.district_id),type:"Int",required:!1},wardId:{value:parseInt(t.ward_id),type:"Int",required:!1},bio:{value:t.bio,type:"String",required:!1},website:{value:t.website,type:"String",required:!1},longitude:{value:t.longitude,type:"Float",required:!1},latitude:{value:t.latitude,type:"Float",required:!1},isActive:{value:t.is_active,type:"Boolean",required:!1},isUniversal:{value:t.is_universal,type:"Boolean",required:!1},njiwaAccount:{value:t.njiwa_account,type:"Boolean",required:!1}},fields:["success","message",{school:["id","name","serialNumber","hasNjiwaAccount",{region:["id","name"]},{district:["id","name"]},{ward:["id","name",{district:["id","name",{region:["id","name"]}]}]},{ownership:["id","name"]},{schoolType:["id","name"]},{level:["id"]},{schoolOperatingTypes:["id",{schoolType:["id","name","code"]}]},"latitude","longitude","bio","logo","created","updated","isActive","isUniversal","canEdit","canDelete","canManage"]}]}});case 2:n=e.sent,(r=n.data).success?(y.yw.success(r.message),k(I.map((function(e){return e.id===t.id?r.school:e}))),we.resetFields(),ge(!1)):y.yw.error(r.message);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Oe=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t){var n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.E.custom({url:"",method:"post",metaData:{operation:"deleteSchool",variables:{id:{value:t,type:"Int",required:!0}},fields:["success","message"]}});case 2:n=e.sent,(r=n.data).success?(y.yw.success(r.message),k(I.filter((function(e){return parseInt(e.id.toString())!==parseInt(t.toString())})))):y.yw.error(r.message);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Re=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t,n){var r,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.E.custom({url:"",method:"post",metaData:{operation:"deleteSchoolOperatingType",variables:{schoolOperatingTypeId:{value:parseInt(t.toString()),type:"Int",required:!0}},fields:["success","message",{school:["id","name","serialNumber",{region:["id","name"]},{district:["id","name"]},{ward:["id","name",{district:["id","name",{region:["id","name"]}]}]},{ownership:["id","name"]},{schoolType:["id","name"]},{level:["id"]},{schoolOperatingTypes:["id",{schoolType:["id","name","code"]}]},"latitude","longitude","bio","logo","created","updated","isActive","isUniversal","canEdit","canDelete","canManage"]}]}});case 2:r=e.sent,(a=r.data).success?(y.yw.success(a.message),k(I.map((function(e){return e.id===n?a.school:e})))):y.yw.error(a.message);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Be=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t){var n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.E.custom({url:"",method:"post",metaData:{operation:"createNjiwaAccount",variables:{schoolId:{value:parseInt(t.toString()),type:"Int",required:!0}},fields:["success","message",{school:["id","name","serialNumber","hasNjiwaAccount",{region:["id","name"]},{district:["id","name"]},{ward:["id","name",{district:["id","name",{region:["id","name"]}]}]},{ownership:["id","name"]},{schoolType:["id","name"]},{level:["id"]},{schoolOperatingTypes:["id",{schoolType:["id","name","code"]}]},"latitude","longitude","bio","logo","created","updated","isActive","isUniversal","canEdit","canDelete","canManage"]}]}});case 2:n=e.sent,(r=n.data).success?(y.yw.success(r.message),k(I.map((function(e){return e.id===t?r.school:e})))):y.yw.error(r.message);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ue=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t){var n,r,a,i,o=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:"",r=o.length>2&&void 0!==o[2]?o[2]:20,e.next=4,j.E.custom({url:"",method:"get",metaData:{operation:"schools",variables:{page:{value:t,type:"Int",required:!0},pageSize:{value:r,type:"Int",required:!0},key:{value:n,type:"String",required:!1},schoolTypes:{value:z,type:"[Int]",required:!1}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","name","serialNumber","hasNjiwaAccount",{region:["id","name"]},{district:["id","name"]},{ward:["id","name",{district:["id","name",{region:["id","name"]}]}]},{ownership:["id","name"]},{schoolType:["id","name"]},{level:["id"]},{schoolOperatingTypes:["id",{schoolType:["id","name","code"]}]},"latitude","longitude","bio","logo","created","updated","isUniversal","contractEndDate","isActive","canEdit","canDelete","canManage"]}]}});case 4:a=e.sent,i=a.data,L(i.page),Y(i.total),re(i.hasNext),k(i.results),le(!1);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ve=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t){var n,r,a,i,o=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:"",r=o.length>2&&void 0!==o[2]?o[2]:20,e.next=4,j.E.custom({url:"",method:"get",metaData:{operation:"schoolsTypes",variables:{page:{value:t,type:"Int",required:!0},pageSize:{value:r,type:"Int",required:!0},key:{value:n,type:"String",required:!1}},fields:["pages","total","page","hasNext","hasPrev",{results:["id","name","created","updated","isActive","canEdit","canDelete","canManage"]}]}});case 4:a=e.sent,i=a.data,D(i.results);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(0,Z.useEffect)((function(){Ve(1,"",20),Ue(1,"",20)}),[]);var Xe=[{title:"Name",dataIndex:"name",key:"name",render:function(e,t,n){return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("a",{onClick:function(){},children:t.name}),(0,S.jsx)("span",{style:{marginLeft:10},children:t.isUniversal?(0,S.jsx)(y.Vp,{color:"red",children:"Universal"}):(0,S.jsx)(y.Vp,{color:"green",children:"Not Universal"})})]})}},{title:"Serial Number",dataIndex:"serialNumber",key:"serialNumber"},{title:"Region",dataIndex:"region",key:"region",render:function(e,t,n){var r,a,i;return(0,S.jsx)("span",{children:null===t||void 0===t||null===(r=t.ward)||void 0===r||null===(a=r.district)||void 0===a||null===(i=a.region)||void 0===i?void 0:i.name})}},{title:"District",dataIndex:"district",key:"district",render:function(e,t,n){var r,a;return(0,S.jsx)("span",{children:null===t||void 0===t||null===(r=t.ward)||void 0===r||null===(a=r.district)||void 0===a?void 0:a.name})}},{title:"Ward",dataIndex:"ward",key:"ward",render:function(e,t,n){var r;return(0,S.jsx)("span",{children:null===t||void 0===t||null===(r=t.ward)||void 0===r?void 0:r.name})}},{title:"School Type",dataIndex:"schoolType",key:"schoolType",render:function(e,t,n){return t.schoolOperatingTypes.map((function(e){return(0,S.jsx)(y.u,{title:"Click to Remove "+e.schoolType.name,placement:"bottom",children:(0,S.jsx)(y.gn,{title:"Are you sure to delete this Operating Type?",onConfirm:function(){return Re(e.id,t.id)},onCancel:function(){},okText:"Yes",cancelText:"No",children:(0,S.jsx)("a",{children:(0,S.jsx)(y.Vp,{color:"green",children:e.schoolType.name})})})})}))}},{title:"Ownership",dataIndex:"Ownership",key:"ownership",render:function(e,t,n){return(0,S.jsx)("span",{children:t.ownership.name})}},{title:"Has Njiwa",dataIndex:"hasNjiwaAccount",key:"hasNjiwaAccount",render:function(e,t,n){return(0,S.jsx)("span",{children:t.hasNjiwaAccount?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(y.Vp,{color:"green",children:"Yes"}),(0,S.jsx)(y.zx,{size:"small",onClick:function(){return function(e){a(e),Ee(!0)}(t)},danger:!0,children:"Config"})]}):(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(y.gn,{title:"Are you sure to Activate Njiwa Account for this School? by default School Adminstrator will be granted access to Njiwa Module",onConfirm:function(){return Be(t.id)},onCancel:function(){},okText:"Yes",cancelText:"No",children:(0,S.jsx)("a",{children:(0,S.jsx)(y.Vp,{color:"red",children:"No"})})})})})}},{title:"Contract End Date",dataIndex:"contractEndDate",key:"contractEndDate",render:function(e,t,n){return t.contractEndDate?(0,S.jsx)("span",{children:ae()(t.contractEndDate).format("DD/MM/YYYY")}):(0,S.jsx)(y.zx,{size:"small",onClick:function(){Pe(t)},danger:!0,children:"Add a Contract"})}},{title:"",dataIndex:"Action",key:"action",render:function(e,t,n){return(0,S.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,S.jsx)(y.Lt,{trigger:["click"],overlay:(0,S.jsxs)(y.v2,{children:[(0,S.jsx)(y.v2.Item,{disabled:!t.canDelete,icon:(0,S.jsx)(c.Z,{}),onClick:function(){},children:(0,S.jsx)(y.gn,{placement:"topLeft",title:"Deleting School: "+t.name,onConfirm:function(){return Oe(parseInt(t.id))},okText:"Yes",cancelText:"No",children:(0,S.jsx)("a",{target:"_blank",rel:"noopener noreferrer",children:"Delete"})})}),(0,S.jsx)(y.v2.Item,{disabled:!t.canEdit,icon:(0,S.jsx)(u.Z,{}),onClick:function(){return function(e){a(e),ge(!0)}(t)},children:(0,S.jsx)("a",{target:"_blank",rel:"noopener noreferrer",children:"Edit"})}),(0,S.jsx)(y.v2.Item,{disabled:!t.canEdit,icon:(0,S.jsx)(d.Z,{}),onClick:function(){return function(e){a(e),je(!0)}(t)},children:(0,S.jsx)("a",{target:"_blank",rel:"noopener noreferrer",children:"Adminstrators"})}),(0,S.jsx)(y.v2.Item,{disabled:!t.canManage,icon:(0,S.jsx)(h.Z,{}),onClick:function(){return Pe(t)},children:(0,S.jsx)("a",{target:"_blank",rel:"noopener noreferrer",children:"Contracts"})}),(0,S.jsx)(y.v2.Item,{disabled:!t.canManage,icon:(0,S.jsx)(d.Z,{}),onClick:function(){return function(e){a(e),Ne(!0)}(t)},children:(0,S.jsx)("a",{target:"_blank",rel:"noopener noreferrer",children:"School Settings"})}),!t.hasNjiwaAccount&&(0,S.jsx)(y.v2.Item,{disabled:!t.canManage,icon:(0,S.jsx)(p.Z,{}),children:(0,S.jsx)(y.gn,{title:"Are you sure to Activate Njiwa Account for this School? by default School Adminstrator will be granted access to Njiwa Module",onConfirm:function(){return Be(t.id)},onCancel:function(){},okText:"Yes",cancelText:"No",children:(0,S.jsx)("a",{rel:"noopener noreferrer",children:"Register Njiwa Account"})})})]}),children:(0,S.jsx)("a",{className:"ant-dropdown-link",onClick:function(e){return e.preventDefault()},children:(0,S.jsx)(m.Z,{style:{color:"orange",fontSize:28,fontWeight:"bold"}})})})})}}];return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(y.X2,{children:[(0,S.jsx)(y.JX,{span:16,children:(0,S.jsx)(y.l0,{layout:"vertical",form:be,onFinish:function(e){L(1),I.length=0,Ue(1,e.key,W)},children:(0,S.jsxs)(y.X2,{style:{marginBottom:0},children:[(0,S.jsx)(y.JX,{span:20,children:(0,S.jsx)(y.l0.Item,{name:"key",style:{marginBottom:3},children:(0,S.jsx)(y.II,{size:"large",placeholder:"Search ...",prefix:(0,S.jsx)(f.Z,{}),autoComplete:"off",allowClear:!0})})}),(0,S.jsx)(y.JX,{span:4,children:(0,S.jsx)(y.l0.Item,{style:{marginBottom:3},children:(0,S.jsxs)(y.zx,{size:"large",htmlType:"submit",onClick:function(){return be.submit()},children:[(0,S.jsx)(f.Z,{}),"Search"]})})}),(0,S.jsx)(y.JX,{span:24,children:(0,S.jsx)(y.l0.Item,{children:(0,S.jsxs)("div",{children:[A.map((function(e){return z.includes(parseInt(e.id.toString()))?(0,S.jsx)("a",{onClick:function(){z.includes(parseInt(e.id.toString()))&&T(z.filter((function(t){return t!==parseInt(e.id.toString())})))},children:(0,S.jsx)(y.Vp.CheckableTag,{checked:!0,style:{padding:5},children:e.name})}):(0,S.jsx)("a",{onClick:function(){z.includes(parseInt(e.id.toString()))||T([].concat((0,i.Z)(z),[parseInt(e.id.toString())]))},children:(0,S.jsx)(y.Vp,{style:{padding:5},children:e.name})})})),z.length>0&&(0,S.jsx)("a",{onClick:function(){T([]),be.submit()},children:(0,S.jsx)(y.Vp,{style:{padding:5},icon:(0,S.jsx)(g.Z,{}),color:"red",children:"Clear All"})})]})})})]})})}),(0,S.jsx)(y.JX,{span:8,style:{display:"flex",justifyContent:"flex-end"},children:(0,S.jsxs)(y.zx,{size:"large",onClick:function(){he(!0)},children:[(0,S.jsx)(x.Z,{}),"Create School"]})})]}),(0,S.jsx)(y.iA,{dataSource:I,columns:Xe,pagination:{onChange:function(e,t){H(t),Ue(e,ee,t)},total:U,pageSize:W,position:["bottomCenter"],showQuickJumper:!0}}),(0,S.jsx)(y.u_,{title:"Registering School",width:"50%",destroyOnClose:!0,visible:de,onOk:function(){he(!1)},onCancel:function(){he(!1)},footer:[],children:(0,S.jsx)(V,{form:we,onFinish:Me})}),(0,S.jsx)(y.u_,{title:"Edit School Informations",width:"50%",destroyOnClose:!0,visible:fe,onOk:function(){ge(!1)},onCancel:function(){ge(!1)},footer:[],children:(0,S.jsx)(C,{school:r,form:we,onFinish:Le,randKey:Math.random()})}),(0,S.jsx)(y.u_,{title:"School System Adminstrators",width:"50%",destroyOnClose:!0,visible:ye,onOk:function(){return je(!1)},onCancel:function(){return je(!1)},footer:[],children:(0,S.jsx)(R,{randKey:Math.random(),school:r})}),(0,S.jsx)(y.u_,{title:"School Settings",width:"50%",destroyOnClose:!0,visible:ke,onOk:function(){return Ne(!1)},onCancel:function(){return Ne(!1)},footer:[],children:(0,S.jsx)(X.r,{school:r,full:!0,randKey:Math.random()})}),(0,S.jsx)(y.u_,{title:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("span",{style:{color:"red"},children:null===r||void 0===r?void 0:r.name}),(0,S.jsx)("span",{style:{marginLeft:5},children:"Contracts"})]}),width:"70vw",destroyOnClose:!0,visible:De,onOk:function(){return Ee(!1)},onCancel:function(){return Ee(!1)},footer:[],children:(0,S.jsx)($,{school:r,full:!0,randKey:Math.random()})}),(0,S.jsx)(y.u_,{title:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("span",{style:{color:"red"},children:null===r||void 0===r?void 0:r.name}),(0,S.jsx)("span",{style:{marginLeft:5},children:"Contracts"})]}),width:"90vw",destroyOnClose:!0,visible:Te,onOk:function(){return _e(!1)},onCancel:function(){Ue(M,ee,W),_e(!1)},footer:[],children:(0,S.jsx)(ie,{school:r,randKey:Math.random()})})]})},oe=n(20852),le=n(59174),ce=n(5397),ue=function(){return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(r.Z,{children:[(0,S.jsx)(r.Z.Item,{children:(0,S.jsx)(a.rU,{to:"/control/analytics",children:"Home"})}),(0,S.jsx)(r.Z.Item,{children:"Schools"})]}),(0,S.jsx)(se,{})]})},de=function(){return(0,Z.useEffect)((function(){window.history.pushState({},"",(0,le.Z)())}),[]),(0,S.jsx)(oe.u,{children:(0,S.jsx)(ce.Q,{children:(0,S.jsx)(ue,{})})})}}}]);
//# sourceMappingURL=644.8cbbbf6b.chunk.js.map