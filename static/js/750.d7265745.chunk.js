"use strict";(self.webpackChunkolbongo=self.webpackChunkolbongo||[]).push([[750],{56750:function(e,n,t){t.r(n),t.d(n,{OrdersPage:function(){return I}});var r=t(78164),a=t(43504),i=t(93433),s=t(74165),o=t(15861),c=t(29439),l=t(38999),d=t(73956),u=t(82622),p=t(11730),f=t(840),x=t(72518),m=t(87012),h=t(72791),g=t(50333),v=t(80184),j=function(e){var n=(0,h.useState)(),t=(0,c.Z)(n,2),r=(t[0],t[1],(0,h.useState)([])),a=(0,c.Z)(r,2),j=a[0],y=a[1],k=(0,h.useState)(1),Z=(0,c.Z)(k,2),b=Z[0],I=Z[1],w=(0,h.useState)(0),S=(0,c.Z)(w,2),C=S[0],N=S[1],A=(0,h.useState)(20),T=(0,c.Z)(A,2),E=T[0],O=T[1],D=(0,h.useState)(""),q=(0,c.Z)(D,2),z=q[0],M=(q[1],(0,h.useState)(!1)),P=(0,c.Z)(M,2),B=(P[0],P[1]),U=(0,h.useState)(!0),F=(0,c.Z)(U,2),V=F[0],J=F[1],H=((0,x.HJ)().push,f.l0.useForm()),Q=(0,c.Z)(H,1)[0],X=!f.rj.useBreakpoint().lg,L=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(n){var t,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.E.custom({url:"",method:"post",metaData:{operation:"deleteOrder",variables:{orderId:{value:parseInt(n.toString()),type:"Int",required:!0}},fields:["success","message"]}});case 2:t=e.sent,(r=t.data).success?(f.yw.success(r.message),y(j.filter((function(e){return e.id!==n})))):f.yw.error(r.message);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),Y=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(n,t){var r,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.E.custom({url:"",method:"post",metaData:{operation:"blockUnblockOrder",variables:{orderId:{value:parseInt(n.toString()),type:"Int",required:!0},blocked:{value:t,type:"Boolean",required:!0}},fields:["success","message",{order:["id",{user:["id","firstName","middleName","lastName","fullName"]},{package:["id","name","description","code","amount","vatIncluded"]},"title","amount","vatIncluded","orderNumber","paymentStatus","paymentType","internalCallback","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch((function(e){return t?f.yw.error("Error occured while Unblocking Payment Package"):f.yw.error("Error occured while Blocking Payment Package"),{data:null}})).then((function(e){return e}));case 2:r=e.sent,(a=r.data)&&(a.success?(f.yw.success(a.message),y(j.map((function(e){return e.id===n?a.order:e})))):f.yw.error(a.message));case 5:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),_=[{title:"Order#",dataIndex:"order_number",fixed:!0,render:function(e,n,t){return(0,v.jsx)("span",{children:(0,v.jsx)("a",{children:n.orderNumber})})}},{title:"Client",dataIndex:"client",fixed:!0,render:function(e,n,t){return(0,v.jsx)("span",{children:n.user.fullName})}},{title:"Amount",dataIndex:"amount",fixed:!0,render:function(e,n,t){return(0,v.jsxs)("span",{children:[n.amount,(0,v.jsx)("span",{style:{marginLeft:10},children:n.vatIncluded?(0,v.jsx)(f.Vp,{color:"green",children:"+VAT"}):(0,v.jsx)(f.Vp,{color:"red",children:"1VAT"})})]})}},{title:"Created",dataIndex:"created",render:function(e,n,t){return(0,v.jsx)(v.Fragment,{children:(0,v.jsx)("span",{children:(0,v.jsx)(g.Z,{date:new Date(n.created)})})})}},{title:"Status",dataIndex:"isActive",render:function(e,n,t){return(0,v.jsx)("span",{children:null!==n&&void 0!==n&&n.isActive?(0,v.jsx)("span",{style:{color:"green"},children:"Active"}):(0,v.jsx)("span",{style:{color:"red"},children:"Inactive"})})}},{title:"",dataIndex:"action",render:function(e,n,t){return(0,v.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end"},children:[n.isActive?(0,v.jsx)(f.gn,{title:"Are you sure to Block this Order?",onConfirm:function(){return Y(null===n||void 0===n?void 0:n.id,!1)},onCancel:function(){},okText:"Block",cancelText:"No",disabled:!(null!==n&&void 0!==n&&n.canManage),children:(0,v.jsx)(f.zx,{icon:(0,v.jsx)(l.Z,{}),disabled:!(null!==n&&void 0!==n&&n.canManage)})}):(0,v.jsx)(f.gn,{title:"Are you sure to Unblock this Order?",onConfirm:function(){return Y(null===n||void 0===n?void 0:n.id,!0)},onCancel:function(){},okText:"Unblock",cancelText:"No",disabled:!(null!==n&&void 0!==n&&n.canManage),children:(0,v.jsx)(f.zx,{icon:(0,v.jsx)(d.Z,{}),disabled:!(null!==n&&void 0!==n&&n.canManage)})}),(0,v.jsx)(f.gn,{title:"Are you sure to delete this Order?",onConfirm:function(){return L(null===n||void 0===n?void 0:n.id)},onCancel:function(){},okText:"Yes",cancelText:"No",disabled:!(null!==n&&void 0!==n&&n.canDelete),children:(0,v.jsx)(f.zx,{icon:(0,v.jsx)(u.Z,{}),disabled:!(null!==n&&void 0!==n&&n.canDelete)})})]})}}],G=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(n){var t,r,a,o,c=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>1&&void 0!==c[1]?c[1]:"",r=c.length>2&&void 0!==c[2]?c[2]:20,e.next=4,m.E.custom({url:"",method:"get",metaData:{operation:"orders",variables:{page:{value:n,type:"Int",required:!0},key:{value:t,type:"String",required:!1},pageSize:{value:r,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id",{user:["id","firstName","middleName","lastName","fullName"]},{package:["id","name","description","code","amount","vatIncluded"]},"title","amount","vatIncluded","orderNumber","paymentStatus","paymentType","internalCallback","isActive","created","updated","canEdit","canDelete","canManage"]}]}}).catch((function(e){return f.yw.error("Error occured while fetching Orders"),{data:null}})).then((function(e){return e}));case 4:a=e.sent,(o=a.data)&&(I(o.page),N(o.total),B(o.hasNext),y((0,i.Z)(o.results))),J(!1);case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,h.useEffect)((function(){G(b)}),[]),(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(f.X2,{style:{marginTop:10},children:(0,v.jsx)(f.JX,{span:X?24:20,children:(0,v.jsx)(f.l0,{layout:"vertical",form:Q,onFinish:function(e){I(1),j.length=0,G(1,e.key)},children:(0,v.jsx)(f.l0.Item,{name:"key",children:(0,v.jsx)(f.II,{size:"large",placeholder:"Search ...",prefix:(0,v.jsx)(p.Z,{}),autoComplete:"off",allowClear:!0})})})})}),(0,v.jsx)(f.iA,{loading:V,columns:_,dataSource:j,pagination:{onChange:function(e,n){O(n),G(e,z,n)},total:C,pageSize:E,position:["bottomCenter"],showQuickJumper:!1},scroll:{x:!0}})]})},y=t(20852),k=t(59174),Z=t(5397),b=function(){return(0,v.jsxs)("div",{style:{marginTop:10},children:[(0,v.jsxs)(r.Z,{children:[(0,v.jsx)(r.Z.Item,{children:(0,v.jsx)(a.rU,{to:"/control/analytics",children:"Home"})}),(0,v.jsx)(r.Z.Item,{children:"Orders"})]}),(0,v.jsx)(j,{height:80})]})},I=function(){return(0,h.useEffect)((function(){window.history.pushState({},"",(0,k.Z)())}),[]),(0,v.jsx)(y.u,{children:(0,v.jsx)(Z.Q,{children:(0,v.jsx)(b,{})})})}}}]);
//# sourceMappingURL=750.d7265745.chunk.js.map