"use strict";(self.webpackChunkolbongo=self.webpackChunkolbongo||[]).push([[373],{23373:function(e,t,n){n.r(t),n.d(t,{SubjectsPage:function(){return P}});var r=n(78164),s=n(43504),a=n(93433),i=n(74165),c=n(15861),o=n(29439),l=n(82622),u=n(31752),d=n(11730),p=n(79286),h=n(14057),m=n(840),f=n(72518),x=n(87012),j=n(72791),g=n(50333),y=n(66776),v=n(80184),b=m.Ph.Option,S=m.II.TextArea,Z=function(e){return Array.isArray(e)?e:null===e||void 0===e?void 0:e.fileList},w=function(e){var t=(0,j.useState)([]),n=(0,o.Z)(t,2),r=n[0],s=n[1],a=m.l0.useForm(),l=(0,o.Z)(a,1)[0],u=function(){var e=(0,c.Z)((0,i.Z)().mark((function e(){var t,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.E.custom({url:"",method:"get",metaData:{operation:"schoolTypes",variables:{showAll:{value:!0,type:"Boolean",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","code","isActive","created","updated","canEdit","canDelete","canManage"]}]}});case 2:t=e.sent,n=t.data,s(n.results);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),d=function(){var t=(0,c.Z)((0,i.Z)().mark((function t(n){var r,s;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x.E.custom({url:"",method:"post",metaData:{operation:"createSubject",variables:{schoolTypeId:{value:n.school_type_id,type:"Int",required:!0},name:{value:n.name,type:"String",required:!0},description:{value:n.description,type:"String",required:!1},icon:{value:n.icon,type:"Upload",required:!1}},fields:["success","message",{subject:["id","name","description",{schoolType:["id","name","code"]},"icon","isActive","created","updated","canEdit","canDelete","canManage"]}]}});case 2:r=t.sent,(s=r.data).success?(m.yw.success(s.message),e.onFinish(s.subject),l.resetFields()):m.yw.error(s.message);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,j.useEffect)((function(){u()}),[e.randKey]),(0,v.jsx)(v.Fragment,{children:(0,v.jsxs)(m.l0,{layout:"vertical",form:l,onFinish:function(e){d(e)},children:[(0,v.jsx)(m.l0.Item,{name:"name",label:"Name",rules:[{required:!0,type:"string",message:"Please input Name"}],children:(0,v.jsx)(m.II,{size:"large",placeholder:"Enter Name ..."})}),(0,v.jsx)(m.l0.Item,{label:"School Type",name:"school_type_id",rules:[{required:!0,type:"number",message:"Please choose School Type"}],children:(0,v.jsx)(m.Ph,{size:"large",showSearch:!0,placeholder:"Select a School Type",optionFilterProp:"children",onSearch:function(e){},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:r.map((function(e,t){return(0,v.jsx)(b,{value:parseInt(e.id.toString()),children:e.name})}))})}),(0,v.jsx)(m.l0.Item,{name:"description",label:"Description",rules:[{required:!1,type:"string",message:"Please input Description ..."}],children:(0,v.jsx)(S,{rows:4,placeholder:"Enter Description ..."})}),(0,v.jsx)(m.l0.Item,{label:"Subject Icon",name:"icon",valuePropName:"fileList",getValueFromEvent:Z,rules:[{required:!1,type:"array",message:"Please pick a Subject Icon"}],children:(0,v.jsxs)(m.gq.Dragger,{name:"icon",accept:".jpg,.jpeg,.png,.gif,.svg",beforeUpload:function(){return!1},children:[(0,v.jsx)("p",{className:"ant-upload-drag-icon",children:(0,v.jsx)(y.Z,{})}),(0,v.jsx)("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"})]})}),(0,v.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:10},children:(0,v.jsx)(m.zx,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},I=m.Ph.Option,k=m.II.TextArea,C=function(e){return Array.isArray(e)?e:null===e||void 0===e?void 0:e.fileList},q=function(e){var t=(0,j.useState)([]),n=(0,o.Z)(t,2),r=n[0],s=n[1],a=m.l0.useForm(),l=((0,o.Z)(a,1)[0],function(){var e=(0,c.Z)((0,i.Z)().mark((function e(){var t,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.E.custom({url:"",method:"get",metaData:{operation:"schoolTypes",variables:{showAll:{value:!0,type:"Boolean",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","code","isActive","created","updated","canEdit","canDelete","canManage"]}]}});case 2:t=e.sent,n=t.data,s(n.results);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()),u=function(){var t=(0,c.Z)((0,i.Z)().mark((function t(n){var r,s;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x.E.custom({url:"",method:"post",metaData:{operation:"updateSubject",variables:{subjectId:{value:parseInt(e.subject.id),type:"Int",required:!0},schoolTypeId:{value:n.school_type_id,type:"Int",required:!0},name:{value:n.name,type:"String",required:!0},description:{value:n.description,type:"String",required:!1},icon:{value:n.icon,type:"Upload",required:!1}},fields:["success","message",{subject:["id","name","description",{schoolType:["id","name","code"]},"icon","isActive","created","updated","canEdit","canDelete","canManage"]}]}});case 2:r=t.sent,(s=r.data).success?(m.yw.info(s.message),e.onFinish(s.subject)):m.yw.error(s.message);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,j.useEffect)((function(){l(),e.form.setFieldsValue({name:e.subject.name,school_type_id:parseInt(e.subject.schoolType.id),description:e.subject.description})}),[e.form,e.subject]),(0,v.jsx)(v.Fragment,{children:(0,v.jsxs)(m.l0,{layout:"vertical",form:e.form,onFinish:function(e){u(e)},requiredMark:!1,children:[(0,v.jsx)(m.l0.Item,{name:"name",label:"Name",rules:[{required:!0,type:"string",message:"Please input Name"}],children:(0,v.jsx)(m.II,{size:"large",placeholder:"Enter Name ..."})}),(0,v.jsx)(m.l0.Item,{label:"School Type",name:"school_type_id",rules:[{required:!0,type:"number",message:"Please choose School Type"}],children:(0,v.jsx)(m.Ph,{size:"large",showSearch:!0,placeholder:"Select a School Type",optionFilterProp:"children",onSearch:function(e){},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:r.map((function(e,t){return(0,v.jsx)(I,{value:parseInt(e.id.toString()),children:e.name})}))})}),(0,v.jsx)(m.l0.Item,{name:"description",label:"Description",rules:[{required:!1,type:"string",message:"Please input Description ..."}],children:(0,v.jsx)(k,{rows:4,placeholder:"Enter Description ..."})}),(0,v.jsx)(m.l0.Item,{label:"Subject Icon",name:"icon",valuePropName:"fileList",getValueFromEvent:C,rules:[{required:!1,type:"array",message:"Please pick a Subject Icon"}],children:(0,v.jsxs)(m.gq.Dragger,{name:"icon",accept:".jpg,.jpeg,.png,.gif,.svg",beforeUpload:function(){return!1},children:[(0,v.jsx)("p",{className:"ant-upload-drag-icon",children:(0,v.jsx)(y.Z,{})}),(0,v.jsx)("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"})]})}),(0,v.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:10},children:(0,v.jsx)(m.zx,{type:"primary",size:"large",htmlType:"submit",children:"Save"})})]})})},T=function(e){var t=(0,j.useState)(),n=(0,o.Z)(t,2),r=n[0],s=n[1],y=(0,j.useState)([]),b=(0,o.Z)(y,2),S=b[0],Z=b[1],I=(0,j.useState)(1),k=(0,o.Z)(I,2),C=k[0],T=k[1],E=(0,j.useState)(0),D=(0,o.Z)(E,2),F=D[0],A=D[1],P=(0,j.useState)(20),z=(0,o.Z)(P,2),N=z[0],_=z[1],L=(0,j.useState)(""),O=(0,o.Z)(L,2),M=O[0],U=(O[1],(0,j.useState)(!1)),J=(0,o.Z)(U,2),V=(J[0],J[1]),B=(0,j.useState)(!0),X=(0,o.Z)(B,2),H=X[0],K=X[1],Q=((0,f.HJ)().push,m.l0.useForm()),Y=(0,o.Z)(Q,1)[0],G=m.l0.useForm(),R=(0,o.Z)(G,1)[0],W=(m.rj.useBreakpoint().lg,(0,j.useState)(!1)),$=(0,o.Z)(W,2),ee=$[0],te=$[1],ne=(0,j.useState)(!1),re=(0,o.Z)(ne,2),se=re[0],ae=re[1],ie=function(){var e=(0,c.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Z(S.map((function(e){return e.id===t.id?t:e}))),s(void 0),te(!1);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ce=function(){var e=(0,c.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Z([t].concat((0,a.Z)(S)));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oe=function(){var e=(0,c.Z)((0,i.Z)().mark((function e(){var t,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.E.custom({url:"",method:"post",metaData:{operation:"syncSchoolsTypes",variables:{},fields:["success","message"]}});case 2:t=e.sent,(n=t.data).success?(m.yw.success(n.message),pe(C,"",20)):m.yw.error(n.message);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),le=function(){var e=(0,c.Z)((0,i.Z)().mark((function e(t){var n,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.E.custom({url:"",method:"post",metaData:{operation:"deleteSubject",variables:{subjectId:{value:parseInt(t.toString()),type:"Int",required:!0}},fields:["success","message"]}});case 2:n=e.sent,(r=n.data).success?(m.yw.success(r.message),Z(S.filter((function(e){return e.id!==t})))):m.yw.error(r.message);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ue=function(){m.yw.info("Canceled")},de=[{title:"Name",dataIndex:"name",fixed:!0,render:function(e,t,n){return(0,v.jsxs)("span",{children:[t.icon&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(m.qE,{size:"large",src:t.icon})," "]}),!t.icon&&(0,v.jsx)(m.qE,{size:"large",style:{backgroundColor:"#f56a00"},children:(0,v.jsx)(v.Fragment,{children:(r=t.name,r.split(" ").map((function(e){return e.charAt(0)})).join("").toUpperCase())}),src:t.icon}),(0,v.jsx)("a",{style:{marginLeft:10},children:t.name})]});var r}},{title:"School Type",dataIndex:"schooltype",fixed:!0,render:function(e,t,n){return(0,v.jsx)("span",{children:(0,v.jsxs)("a",{children:[t.schoolType.name,(0,v.jsx)(m.Vp,{color:"red",style:{marginLeft:5},children:t.schoolType.code})]})})}},{title:"Created",dataIndex:"created",render:function(e,t,n){return(0,v.jsx)(v.Fragment,{children:(0,v.jsx)("span",{children:(0,v.jsx)(g.Z,{date:new Date(t.created)})})})}},{title:"Status",dataIndex:"isActive",render:function(e,t,n){return(0,v.jsx)("a",{children:null!==t&&void 0!==t&&t.isActive?(0,v.jsx)("span",{style:{color:"green"},children:"Active"}):(0,v.jsx)("span",{style:{color:"red"},children:"Inactive"})})}},{title:"",dataIndex:"action",render:function(e,t,n){return(0,v.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end"},children:[(0,v.jsx)(m.gn,{title:"Are you sure to delete this member?",onConfirm:function(){return le(null===t||void 0===t?void 0:t.id)},onCancel:function(){return ue},okText:"Yes",cancelText:"No",disabled:!(null!==t&&void 0!==t&&t.canDelete),children:(0,v.jsx)(m.zx,{icon:(0,v.jsx)(l.Z,{}),disabled:!(null!==t&&void 0!==t&&t.canDelete)})}),(0,v.jsx)(m.zx,{disabled:!(null!==t&&void 0!==t&&t.canEdit),onClick:function(){return function(e){s(e),te(!0)}(t)},icon:(0,v.jsx)(u.Z,{})})]})}}],pe=function(){var e=(0,c.Z)((0,i.Z)().mark((function e(t){var n,r,s,a,c=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>1&&void 0!==c[1]?c[1]:"",r=c.length>2&&void 0!==c[2]?c[2]:20,e.next=4,x.E.custom({url:"",method:"get",metaData:{operation:"subjects",variables:{page:{value:t,type:"Int",required:!0},key:{value:n,type:"String",required:!1},pageSize:{value:r,type:"Int",required:!1}},fields:["total","page","pages","hasNext","hasPrev",{results:["id","name","description",{schoolType:["id","name","code"]},"icon","isActive","created","updated","canEdit","canDelete","canManage"]}]}});case 4:s=e.sent,a=s.data,T(a.page),A(a.total),V(a.hasNext),Z(a.results),K(!1);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,j.useEffect)((function(){pe(C,"",20)}),[]),(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(m.X2,{style:{marginTop:10},children:[(0,v.jsx)(m.JX,{span:12,children:(0,v.jsx)(m.l0,{layout:"vertical",form:Y,onFinish:function(e){T(1),S.length=0,pe(1,e.key)},children:(0,v.jsx)(m.l0.Item,{name:"key",children:(0,v.jsx)(m.II,{size:"large",placeholder:"Search ...",prefix:(0,v.jsx)(d.Z,{}),autoComplete:"off",allowClear:!0})})})}),(0,v.jsxs)(m.JX,{span:12,style:{display:"flex",justifyContent:"flex-end"},children:[(0,v.jsx)(m.zx,{size:"large",icon:(0,v.jsx)(p.Z,{}),onClick:function(){return ae(!0)},children:"Add Subject"}),(0,v.jsx)(m.zx,{size:"large",icon:(0,v.jsx)(h.Z,{}),onClick:function(){return oe()},children:"Sync Subjects"})]})]}),(0,v.jsx)("div",{children:(0,v.jsx)(m.iA,{loading:H,columns:de,dataSource:S,scroll:{x:!0},pagination:{onChange:function(e,t){_(t),pe(e,M,t)},total:F,pageSize:N,position:["bottomCenter"],showQuickJumper:!0}})}),(0,v.jsx)(m.u_,{title:"Edit Subject Informations",width:"30vw",destroyOnClose:!0,visible:ee,onOk:function(){te(!1)},onCancel:function(){te(!1)},footer:[],children:(0,v.jsx)(q,{form:R,subject:r,onFinish:ie})}),(0,v.jsx)(m.u_,{title:"Creating a new Subject",width:"30vw",destroyOnClose:!0,visible:se,onOk:function(){return ae(!1)},onCancel:function(){return ae(!1)},footer:[],children:(0,v.jsx)(w,{onFinish:ce,randKey:Math.random()})})]})},E=n(20852),D=n(59174),F=n(5397),A=function(){return(0,v.jsxs)("div",{style:{marginTop:10},children:[(0,v.jsxs)(r.Z,{children:[(0,v.jsx)(r.Z.Item,{children:(0,v.jsx)(s.rU,{to:"/control/subjects",children:"Home"})}),(0,v.jsx)(r.Z.Item,{children:"Subjects"})]}),(0,v.jsx)(T,{height:80})]})},P=function(){return(0,j.useEffect)((function(){window.history.pushState({},"",(0,D.Z)())}),[]),(0,v.jsx)(E.u,{children:(0,v.jsx)(F.Q,{children:(0,v.jsx)(A,{})})})}}}]);
//# sourceMappingURL=373.fd8b597a.chunk.js.map